var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
var _destructuring=[].push.apply([],[].concat($jscomp.arrayFromIterable([])));Ext.define("Generali.data.Model",{override:"Ext.data.Model",init:function(){var a=this.idField.name;this.phantom&&this.id===this.data[a]&&delete this.data[a]}});
Ext.define("Generali.standard.ViewController",{extend:"Ext.app.ViewController",uses:["Generali.standard.CbaDateUtils"],constructor:function(a){var b;a&&a.hasOwnProperty("config")&&(b=a.config,delete a.config);this.callParent([a]);Ext.isDefined(b)&&(Ext.isDefined(this.config)?Ext.apply(this.config,b):this.config=b)},addRef:function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b].ref;this["get"+Ext.String.capitalize(d)]=new Function('return this.lookupReference("'+d+'")');var e=a[b].selector;Ext.each(e.split(" "),
function(a){0!=a.indexOf("#")&&StdSipcar.error('Caso non supportato "'+e+'": solo riferimenti diretti')})}},onLaunch:function(){}});
Ext.define("Generali.standard.ControlledContainer",{extend:"Ext.container.Container",isCbaControlledContainer:!0,referenceHolder:!0,layout:{type:"fit"},cls:"backgroundContainer",constructor:function(a){var b=this,c=Sipcar,d=this.$className.split("."),e=Ext.Array.indexOf(d,"view");d[e]="controller";d=d.join(".");this.callParent(arguments);Ext.isDefined(a)||(a={});Ext.apply(a,{containerId:this.getItemId(),application:c});this.on("beforerender",this.localize);this.controller=Ext.create(d,a);this.controller.setView(this);
this.controller.init();this.controller.onLaunch(c.app);a&&a.cbaConfig&&"L"==a.cbaConfig.permesso&&(containerSolaLettura(this.getId()),49===CBA.moduli.moduloAttivo&&(this.down("container").on("afterrender",function(a){var b=a.up("window");if(b){var c=b.getHeader(),d=0;a.intval=setInterval(function(){c.down("#LabelTitoloWinCss")?(Ext.defer(function(){var a=c.down("#LabelTitoloWinCss").text,d=traduci("WIN_SOLA_LETTURA");-1===a.indexOf(d)&&b.impostaTitolo(a+" "+d)},50),clearInterval(a.intval)):50===d&&
(clearInterval(a.intval),a.intval=null);d++},20)}}),this.down("container").on("destroy",function(a){return a.intval?clearInterval(a.intval):!1}),this.query("grid").forEach(function(a){containerSolaLettura(a,!1);a.getSelectionModel().deselectAll();a.on("selectionchange",function(a){a.deselectAll()})})));if(null!=CBA.moduli){var d=CBA.moduli,c=d.moduloAttivo,g=d.modulo49,d=function(){return b.on("destroy",function(a){a.videataLoggata||console.error("CBA Log accesso videata "+a.$className+":","Attenzione, videata non loggata, inserire fn doLogVideata sul launch videata.")})},
e=this.$className,h=[49];-1!=h.indexOf(c)&&!Ext.isEmpty(g.dizionarioLogVideate)&&g.dizionarioLogVideate[e]?(c=g.dizionarioLogVideate[e],doLogVideata(this,{className:e,desVideata:c.desVideata,logOspite:c.portletLog}),d()):-1==h.indexOf(c)||Ext.isEmpty(g.dizionarioLogVideate_escluse)||-1==g.dizionarioLogVideate_escluse.indexOf(this.$className)||d()}},initialize:function(){var a=this.items,b;Generali.standard.ControlledContainer.prototype.initComponent||(Generali.standard.ControlledContainer.prototype.initComponent=
Ext.emptyFn);!this.initialized&&this.initComponent&&(this.initComponent(),b=this.items,b!==a&&(this.items=a,this.applyItems(b,a)));this.callParent()},initInheritedState:function(a){this.callParent(arguments);this.controller&&(a.controller=this.controller)},localize:function(a){Localizer.localize(a)},destroy:function(){var a=this.controller;this.callParent();a.clearListeners();Ext.destroy(a)}});
Ext.define("Ext.ux.Localizer",{singleton:!0,baseLocale:"en",currLocale:"en",localizableProps:{button:["text","tooltip"],splitbutton:["text","tooltip"],menuitem:["text","tooltip"],checkboxfield:["fieldLabel","boxLabel"],field:["fieldLabel","emptyText"],filefield:["fieldLabel","buttonText"],radiofield:["fieldLabel","boxLabel"],combobox:["fieldLabel","emptyText"],checkboxgroup:["fieldLabel"],fieldcontainer:["fieldLabel"],fieldset:["title"],label:["text"],htmleditor:["fieldLabel"],gridcolumn:["text"],
panel:["title"],tooltip:["html"],image:["src"]},localizableColumns:["status_description","bounced"],columnRenderer:function(a,b,c,d,e,g,h){return Localizer.localeStrings.get(a)||a},excludeTypes:{pagingtoolbar:{itemIds:"first prev inputItem afterTextItem next last refresh displayItem".split(" ")}},getXTypes:function(a){if(!a)return[];try{return a.getXTypes().split("/").reverse()}catch(b){return[]}},isExcludeByXType:function(a){var b=this,c=!1;Ext.each(a,function(a){a=b.excludeTypes[a];if(Ext.isBoolean(a)&&
!0===a)return c=!0,!1});return c},getItemIdsToExclude:function(a){if(!a)return[];var b=this;a=b.getXTypes(a);var c=[];Ext.each(a,function(a){a=b.excludeTypes[a];if(Ext.isArray(a))return c=a,!1});return c},getLocalizableProps:function(a){var b=this,c;Ext.each(a,function(a){if(c=b.localizableProps[a])return!1});return c},localize2:function(a,b){var c=this,d=c.getXTypes(a);if(!c.isExcludeByXType(d)){if(a.itemId){var e=c.getItemIdsToExclude(a.ownerCt);if(Ext.Array.contains(e,a.itemId))return}b&&(a.items&&
a.items.each&&a.items.each(function(a){c.localize2(a,b)}),a.dockedItems&&Ext.each(a.dockedItems.items,function(a){c.localize2(a,b)}),a.tip&&c.localize2(a.tip,!1),a.menu&&a.menu.items&&a.menu.items.each(function(a){c.localize2(a,!1)}));(d=c.getLocalizableProps(d))&&Ext.each(d,function(b){var d=Ext.String.capitalize(b),e=a.initialConfig[b];e||(e=a[b]);if(!e){var g=a["get"+d];g&&(e=g.call(a))}e&&isNaN(e)&&!Ext.isObject(e)&&(e=e.toUpperCase(),e=c.localeStrings.get(e))&&("EmptyText"!=d&&"Text"!=d&&"FieldLabel"!=
d&&(e=e.replace(/ /g,"&nbsp;")),"BoxLabel"==d&&a.boxLabelEl?a.boxLabelEl.update(e):"EmptyText"==d?a.setEmptyText(e):"Title"==d?"fieldset"==a.xtype?Ext.getCmp(a.id+"-legendTitle").update(e):"panel"==a.xtype||"treepanel"==a.xtype?a.title=e:a.setTitle(e):(d=a["set"+d])?d.call(a,e):a[b]=e)})}},localize:function(a,b,c){a&&(this.localeStrings||this.loadLocaleStrings(),Ext.isDefined(c)||(c=!0),(this.localeStrings=this.getLocaleStrings())&&this.localize2(a,c))},loadLocaleStrings:function(a){var b="it";this.localeStrings||
(this.localeStrings=new Ext.util.HashMap,Ext.Ajax.request({url:"/cba/gen/config/language",method:"GET",async:!1,success:function(a){a=Ext.decode(a.responseText).data;Ext.apply(CBA.parametriGenerali,{lingua:a});b=a}}),CBA.parametriGenerali.produzione?this.caricaLingua(b,"/cba/lingue/generali-"+b+".js"):this.caricaLingua(b,"/cba/generali/lingue/"+b+".js"));a&&this.caricaLingua(CBA.parametriGenerali.lingua,a);return this.localeStrings},caricaLingua:function(a,b){var c=this;Ext.Ajax.request({url:b,method:"GET",
async:!1,success:function(a){a=Ext.decode(a.responseText);Ext.each(a,function(a){a&&a.key&&c.localeStrings.add(a.key,a.value)});traduciCmpExtJS()},failure:function(){}})},getLocaleStrings:function(){var a;a=this.loadLocaleStrings();if(!Ext.isBoolean(a)||a)return a},getLocalizedString:function(a,b,c){this.localeStrings&&(c=CBA.parametriGenerali.lingua);if(!a||!c)return a;c=this.getLocaleStrings();if(!c)return a;c=a?c.get(a.toUpperCase()):"";if(!c)return a;if(Array.isArray(b))for(a=0;a<b.length;a++)c=
c.replace("{"+a+"}",b[a]);return c}});Localizer=Ext.ux.Localizer;_=function(a,b){return Localizer.getLocalizedString(a,null,b)};
Ext.define("Generali.portletController.view.Portlet",{extend:"Ext.panel.Panel",alias:"widget.portlet",layout:"fit",anchor:"100%",frame:!0,closable:!1,collapsible:!0,animCollapse:!0,draggable:{moveOnDrag:!1},resizeHandles:"s",resizable:!0,cls:"x-portlet",doClose:function(){this.closing||(this.closing=!0,this.el.animate({opacity:0,callback:function(){var a=this.closeAction;this.closing=!1;this.fireEvent("close",this);this[a]();"hide"==a&&this.el.setOpacity(1)},scope:this}))}});
Ext.define("Generali.data.Store",{extend:"Ext.data.Store",newRecordCls:"cba-new-record",dirtyRecordCls:"cba-dirty-record",deletedRecordCls:"cba-deleted-record",constructor:function(a){a=Ext.merge({listeners:{add:function(a,c){a._add_recs||(a._add_recs=[]);a._add_recs=a._add_recs.concat(c)},remove:function(a,c){a._del_recs||(a._del_recs=[]);Ext.each(c,function(b){b.phantom||-1!=a._del_recs.indexOf(b)||a._del_recs.push(b);a._add_recs&&Ext.Array.remove(a._add_recs,b);a._upd_recs&&Ext.Array.remove(a._upd_recs,
b)})},update:function(a,c,d){d===Ext.data.Model.REJECT||d===Ext.data.Model.COMMIT||a._add_recs&&-1!=a._add_recs.indexOf(c)||a._del_recs&&-1!=a._del_recs.indexOf(c)||(a._upd_recs||(a._upd_recs=[]),-1==a._upd_recs.indexOf(c)&&a._upd_recs.push(c))},load:function(a){a._add_recs=[];a._del_recs=[];a._upd_recs=[]},clear:function(a){a._add_recs=[];a._del_recs=[];a._upd_recs=[]}}},a);this.callParent([a])},loadData:function(a,b){b||(this._add_recs=[],this._del_recs=[],this._upd_recs=[]);this.callParent([a,
b])},removeRecordFromLists:function(a){this.isRecordNew(a)?Ext.Array.remove(this._add_recs,a):this.isRecordDeleted(a)?Ext.Array.remove(this._del_recs,a):this.isRecordUpdated(a)&&Ext.Array.remove(this._upd_recs,a)},afterCommit:function(a){this.removeRecordFromLists(a);this.callParent([a])},afterReject:function(a){var b=this.isRecordNew(a);this.removeRecordFromLists(a);b?(this.remove(a),this._del_recs&&(Ext.Array.remove(this._del_recs,a),this.fireEvent("datachanged",this))):this.callParent([a])},commitChanges:function(){var a,
b;a=this.getNewRecords();for(b=a.length-1;0<=b;b--)a[b].commit();a=this.getUpdatedRecords();for(b=a.length-1;0<=b;b--)a[b].commit();this._del_recs&&(this._del_recs.length=0)},rejectChanges:function(a){this.callParent();for(var b=this._add_recs.slice(0),c=0,d=b.length;c<d;c++)b[c].reject();this._del_recs&&this._del_recs.length&&(this._del_recs=[],a||this.fireEvent("datachanged",this));this._upd_recs&&this._upd_recs.length&&(this._upd_recs=[],a||this.fireEvent("datachanged",this));a||this.fireEvent("reject",
this)},getRejectRecords:function(){var a=[],b=Ext.Array.push;this._add_recs&&this._add_recs.length&&b(a,this._add_recs);this._upd_recs&&this._upd_recs.length&&b(a,this._upd_recs);this._del_recs&&this._del_recs.length&&b(a,this._del_recs);return a},getNewRecords:function(){return this._add_recs||[]},getUpdatedRecords:function(){return this._upd_recs||[]},getDeletedRecords:function(){return this._del_recs||[]},isModified:function(){var a=!1;0<this.data.length&&(a=this._upd_recs&&0<this._upd_recs.length||
this._add_recs&&0<this._add_recs.length||this._del_recs&&0<this._del_recs.length?!0:!1);return a},classifyRecord:function(a){return this.isRecordDeleted(a)?this.deletedRecordCls:this.isRecordNew(a)?this.newRecordCls:this.isRecordUpdated(a)?this.dirtyRecordCls:""},isRecordDeleted:function(a){return this._del_recs&&-1!=this._del_recs.indexOf(a)?!0:!1},isRecordUpdated:function(a){return this._upd_recs&&-1!=this._upd_recs.indexOf(a)?!0:!1},isRecordNew:function(a){return this._add_recs&&-1!=this._add_recs.indexOf(a)?
!0:!1},deleteRecord:function(a){this._del_recs||(this._del_recs=[]);this._add_recs&&-1!=this._add_recs.indexOf(a)?(this.remove(a),Ext.Array.remove(this._del_recs,a),this.fireEvent("datachanged",this)):-1==this._del_recs.indexOf(a)&&(this._del_recs.push(a),this._upd_recs&&Ext.Array.remove(this._upd_recs,a),this.fireEvent("update",this,a,Ext.data.Record.EDIT,[]),this.fireEvent("datachanged",this))},createNewRecord:function(a){if(this.model){var b={},c=this.model.prototype.fields.keys;a&&Ext.apply(b,
a);for(var d=0,e=c.length;d<e;d++){var g=c[d];"undefined"==typeof b[g]&&(b[g]=null)}b=new this.model(b);if(a){var c=b.modified,h;for(h in a)c[h]=void 0}return b}return!1},getTotalCount:function(){return(this.totalCount||0)+(this._add_recs?this._add_recs.length:0)},getChanges:function(){if(!this.isModified())return null;var a=this.getUpdatedRecords(),b=this.getNewRecords(),c=this.getDeletedRecords(),d=[],e,g,h,k;e=0;for(g=c.length;e<g;e++)if(h=c[e])k={eliminare:"T"},k[h.idProperty]=h.get(h.idProperty),
d.push(k);e=0;for(g=b.length;e<g;e++)h=b[e],k=Ext.apply({eliminare:"F"},h.getData()),d.push(k);e=0;for(g=a.length;e<g;e++)h=a[e],k=Ext.apply({eliminare:"F"},h.getData()),d.push(k);return d}});Ext.define("Generali.data.StoreJson",{extend:"Ext.data.Store",constructor:function(a){a=Ext.merge({proxy:{type:"ajax",reader:{type:"json",messageProperty:"message",rootProperty:"data"}}},a);this.callParent([a])},autoDestroy:!0});
Ext.define("Generali.data.StoreJsonTree",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"idPadre"}],root:{expanded:!1},constructor:function(a){a=Ext.merge({proxy:{type:"ajax",reader:{type:"json",messageProperty:"message",rootProperty:"children"}}},a);this.callParent([a])},autoLoad:!1,autoDestroy:!0});
Ext.define("Generali.data.StoreCodiceValore",{extend:"Generali.data.StoreJson",fields:[{name:"codice"},{name:"valore"},{name:"extra"}]});Ext.define("Generali.data.StoreCodiceValoreDataData",{extend:"Generali.data.StoreCodiceValore",fields:[{name:"data1"},{name:"data2"}]});Ext.define("Generali.data.StoreCodiceValoreDate",{extend:"Generali.data.StoreCodiceValore",fields:[{name:"date",type:"date"}]});Ext.define("Generali.data.StoreCodiceValoreTipo",{extend:"Generali.data.StoreCodiceValore",fields:[{name:"tipo"}]});
Ext.define("Generali.standard.CbaDateUtils",{alternateClassName:"CbaDateUtils",statics:{today:function(a){var b=new Date;if(null==a||1==a)b=new Date(b.getFullYear(),b.getMonth(),b.getDate());return b},yesterday:function(){return new Date((new Date).getTime()+864E5)},tomorrow:function(){return new Date((new Date).getTime()+864E5)},getPrevDay:function(a){return new Date(a.getTime()-864E5)},getNextDay:function(a){return new Date(a.getTime()+864E5)},getPrevWeek:function(a){return new Date(a.getTime()-
6048E5)},getNextWeek:function(a){return new Date(a.getTime()+6048E5)},startOfWeek:function(a){if(1===a.getDay())return a;var b=a;for(a=(0===a.getDay()?7:a.getDay())-1;0<a;a--)b=this.getPrevDay(b);return b},endOfWeek:function(a){if(0===a.getDay())return a;var b=a;for(a=a.getDay();7>a;a++)b=this.getNextDay(b);return b},startOfYear:function(a){return new Date(a.getFullYear(),0,1)},endOfYear:function(a){return new Date(a.getFullYear(),11,31)},getPrevMonth:function(a){var b=0===a.getMonth()?12:a.getMonth(),
c=0===a.getMonth()?a.getFullYear()-1:a.getFullYear();return new Date(b+"/"+a.getDate()+"/"+c)},getNextMonth:function(a){var b=13===a.getMonth()+2?1:a.getMonth()+2,c=13===a.getMonth()+2?a.getFullYear()+1:a.getFullYear();return new Date(b+"/"+a.getDate()+"/"+c)},daysInMonth:function(a,b){return(new Date(b,a,0)).getDate()},preciseDiff:function(a,b,c){function d(a,b){return a+" "+h[b+(1===a?"":"s")]}function e(a,b,c,e,g,k){var l=[];a&&l.push(d(a,"year"));b&&l.push(d(b,"month"));c&&l.push(d(c,"day"));
e&&l.push(d(e,"hour"));g&&l.push(d(g,"minute"));k&&l.push(d(k,"second"));return l.join(h.delimiter)}function g(a,b,c,d,e,g,h){return{years:a,months:b,days:c,hours:d,minutes:e,seconds:g,firstDateWasLater:h}}var h={nodiff:"",year:"year",years:"years",month:"month",months:"months",day:"day",days:"days",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes",second:"second",seconds:"seconds",delimiter:" "};a=moment(a);b=moment(b);var k;a.add(b.utcOffset()-a.utcOffset(),"minutes");if(a.isSame(b))return c?
g(0,0,0,0,0,0,!1):h.nodiff;a.isAfter(b)?(k=a,a=b,b=k,k=!0):k=!1;var l=b.year()-a.year(),m=b.month()-a.month(),n=b.date()-a.date(),p=b.hour()-a.hour(),q=b.minute()-a.minute(),t=b.second()-a.second();0>t&&(t=60+t,q--);0>q&&(q=60+q,p--);0>p&&(p=24+p,n--);0>n&&(b=moment(b.year()+"-"+(b.month()+1),"YYYY-MM").subtract(1,"M").daysInMonth(),n=b<a.date()?b+n+(a.date()-b):b+n,m--);0>m&&(m=12+m,l--);return c?g(l,m,n,p,q,t,k):e(l,m,n,p,q,t)}}});
Ext.define("winCBA",{extend:"Ext.window.Window",alias:"winCBA",closable:this.closable?this.closable:!1,plain:!0,layout:"fit",modal:!0,maximizable:!0,stateful:!1,iconCls:this.iconCls,autoScroll:!1,constrain:!0,initComponent:function(){var a=setWindow(this.dimensione),b=a[0],a=a[1];Ext.isEmpty(this.altezzaWin)||(b=this.altezzaWin);Ext.isEmpty(this.larghezzaWin)||(a=this.larghezzaWin);b>document.body.getClientRects()[0].height&&(b=document.body.getClientRects()[0].height,a-=29);a>document.body.getClientRects()[0].width&&
(a=document.body.getClientRects()[0].width);this.height=b;this.width=a;this.title=traduci(this.titolo);b="";"L"==this.permesso&&(b=Localizer.getLocalizedString("SOLA_LETTURA"),this.iconCls="icon-solalettura",this.title=this.title+" - "+b);this.nominativo&&(this.title='<table width="100%"><tr>',this.title+='<td width="33%" align="left">'+b+"</td>",this.title+='<td width="34%" align="center">'+traduci(this.titolo)+"</td>",this.title+='<td width="33%" align="right">'+this.nominativo+"</td>",this.title+=
"</tr></table>");Ext.isString(this.name)?this.items=[Ext.create(this.name,{cbaConfig:this.configItem})]:this.items=this.name;this.callParent(arguments)},render:function(){this.callParent(arguments);var a=!1;this.down("form")?a=this.down("form"):this.isContainer&&(a=this);if(a){var b=a.query("field[hidden=false]")[0];b&&setTimeout(function(){b.focus()},500)}(a=this.items.items[0].controller)&&a.callBackRenderWin&&a.callBackRenderWin();this.callBackRenderWin&&this.callBackRenderWin()}});
function cdaDoubleClick(a,b){var c=a.up("form").getForm(),d=a.up("cda"),e="",g,h,k,l,m,n,p,q;d&&d.extraFieldName&&(e=d.extraFieldName);var t=c.findField(e+"cda");c.findField("idEsercizio")&&(m=c.findField("idEsercizio").getValue());d&&d.cbaConfig&&d.cbaConfig.allowChangeAnno?n=d.cbaConfig.allowChangeAnno:a&&a.cbaConfig&&a.cbaConfig.allowChangeAnno&&(n=a.cbaConfig.allowChangeAnno);a.cbaConfig.codVideataChiamante&&(q=a.cbaConfig.codVideataChiamante);if(a.cbaConfig.tipoContabilita)g=a.cbaConfig.tipoContabilita,
"string"===typeof g&&(g=parseInt(g));else if(d&&d.cbaConfig.tipoContabilita)g=d.cbaConfig.tipoContabilita,"string"===typeof g&&(g=parseInt(g));else{g=c.findField("tipoContabilita").getValue();"string"===typeof g&&(g=parseInt(g));if(3==g)return m=[],msgAddWarning(m,"MSG_WARNING_NESSUNA_CONTABILITA"),msgShow("",m);if(2!=g&&4!=g&&5!=g)return!1;(k=c.findField(b).getValue())||(k=c.findField("anno")?c.findField("anno").getValue():m);if(Ext.isEmpty(g)||t.readOnly)return!1;k=null==k?(new Date).getFullYear():
Ext.isDate(k)?k.getFullYear():k;k=(h=c.findField(e+"annoCda").getValue())?h:k}var v=null;[4,5].includes(g)?(k=(new Date).getFullYear(),h="CENTRI_DI_ATTIVITA",a&&a.cbaConfig.idEsercizio?m=a.cbaConfig.idEsercizio:d&&d.cbaConfig.idEsercizio&&(m=d.cbaConfig.idEsercizio),a&&a.cbaConfig.bottoneCdaFinali&&(v=a.cbaConfig.bottoneCdaFinali)):h=traduci("CONTABILITA_ECONOMICA")+" "+traduci("ANNO")+" "+k;0==k&&(k=(new Date).getFullYear());l=a.cbaConfig.soloIntermedi;p=a.cbaConfig.idOrganizzazione?a.cbaConfig.idOrganizzazione:
d&&d.cbaConfig.idOrganizzazione?d.cbaConfig.idOrganizzazione:getIdOrg();Ext.create("winCBA",{name:"Generali.cda.view.PnlGestCda",titolo:h,dimensione:2,configItem:{idAnno:k,onlyTree:!0,allowChangeAnno:n,multiSelezione:!1,tipoContabilita:g,currentCda:t.getValue(),soloIntermedi:l,idAnnoVideata:m,idOrganizzazione:p,bottoneCdaFinali:v,codVideataChiamante:q,afterConferma:function(b){var h=b[0].get("cdaCode"),k=b[0].get("descrizione");isAreaUtenti()&&(k=[4,5].includes(g)?b[0].get("descrizioneCodice"):h);
t.setValue(h);if(d&&d.showDesCda){var l=c.findField(e+"descrizioneCodice");l&&l.setValue(k)}(l=c.findField(e+"cda1"))&&l.setValue(2==g?null:h);"cdaGrid"==a.getXType()?c.findField(e+"desCda")?c.findField(e+"desCda").setValue(k):c.findField(e+"descrCda")?c.findField(e+"descrCda").setValue(k):t&&t.setValue(k):isAreaUtenti()&&t.setValue(k);c.findField(e+"annoCda")&&(c.findField(e+"annoCda").setValue(b.annoCda),c.findField(e+"desAnnoCda").setValue(b.desAnnoCda||b.annoCda));c.soloFinali=b.soloFinali}},
listeners:{close:function(){"cdaGrid"==a.getXType()&&setTimeout(function(){a.selectText();a.focus()},200)}}}).show()}
function cdaCancella(a){var b="";"cdaGrid"!==a.xtype?a.up("cda").extraFieldName&&(b=a.up("cda").extraFieldName):a.extraFieldName&&(b=a.extraFieldName);a=a.up("form").getForm();null!=a.findField(b+"codiceCda")?a.findField(b+"codiceCda").setValue(""):a.findField(b+"cda").setValue("");a.findField(b+"annoCda")&&(a.findField(b+"annoCda").setValue(""),a.findField(b+"cda1").setValue(""));a.findField(b+"desCda")&&a.findField(b+"desCda").setValue("");(b=a.findField(b+"descrizioneCodice"))&&b.setValue(traduci("NESSUNA_SELEZIONE"))}
function setContextMenuCda(a){a.getEl().on("contextmenu",function(b){b.stopEvent();a.menu||(a.menu=Ext.create("Ext.menu.Menu",{items:[{text:traduci("ELIMINA"),handler:function(){cdaCancella(a)}}]}));a.up().solaLettura||a.menu.showAt(b.getXY())})}function cdaRender(a,b,c){c&&(creaToolTip(a.getId(),"MODIFICA_CDA_DBLCLICK",""),a.getEl().on("dblclick",function(){cdaDoubleClick(a,b.annoData)}));setContextMenuCda(a);a.on("keydown",function(a,b,c){9!=b.getKey()&&b.stopEvent()})}
function getCallerFunction(){if(Error.captureStackTrace){var a=Error();Error.captureStackTrace(a);var a=a.stack.split("\n")[4],b=a.indexOf("(");return a.slice(b+1,a.length-1)}}
Ext.define("Generali.standard.EsportaXls",{constructor:function(a){this.grid=a.grid;this.file_name=a.file_name?a.file_name+".xlsx":"test.xlsx";this.sheet_name=a.sheet_name?a.sheet_name:null;this.titolo=a.titolo?a.titolo:null},esportaXls:function(){var a=this.grid,b=this.grid.getStore(),c=a.getColumns(),a=Ext.id(),d=Array(c.length).fill(20).join(","),e='<table id = "'+a+'" data-cols-width="'+d+'">';this.titolo&&(e=e+"<tr><td>"+this.titolo+"</td></tr><tr></tr>");e+="<tr>";c.forEach(function(a){e+="<td>"+
a.text+"</td>"});e+="</tr>";b.each(function(a){e+="<tr>";a.getFields();c.forEach(function(b){var c=a.get(b.dataIndex);if(null==c)e+="<td></td>";else switch(b.getXType()){case "gridcolumn":e+="<td>"+c+"</td>";break;case "datecolumn":"H:i"==b.format?(c=FormattaOra(c),e+="<td>"+c+"</td>"):"d/m/Y H:i"==b.format?(c=FormattaData(c,"m-d-Y H:i"),e+='<td data-t="d" data-num-fmt="DD/MM/YYYY HH:mm">'+c+"</td>"):e+='<td data-t="d" data-num-fmt="dd/mm/YYYY">'+c+"</td>";break;case "numbercolumn":e+='<td data-t="n" data-num-fmt="'+
b.format+'">'+c+"</td>";break;default:e+="<td>"+c+"</td>"}});e+="</tr>"});e+="</table>";b=document.createElement("DIV");b.innerHTML=e;document.body.appendChild(b);b=document.getElementById(a);TableToExcel.convert(b,{name:this.file_name,sheet:{name:this.sheet_name}});b.remove()}});
Ext.define("Generali.standard.PannelloBottoni",{extend:"Ext.panel.Panel",border:0,layout:{type:"hbox"},title:"",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnHelp",cls:"cba-button-25",iconCls:"icon-help20",text:"Help",margin:"0 1 0 0",hidden:!0,handler:function(){var b=a.cbaConfig.help_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnHelp: utilizzo di eval ***********"))},listeners:{beforerender:function(){a.cbaConfig.help_callback&&
this.show()}}},{xtype:"button",disabled:!1,id:"_btnNuovo"+a.id,itemId:"_btnNuovo"+a.id,cls:"cba-button-25",iconCls:"icon-inserisci",text:"Nuovo",margin:"0 1 0 0",handler:function(){a.setBtnEditMode(!0);var b=a.cbaConfig.nuovo_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnNuovo: utilizzo di eval ***********"))}},{xtype:"button",disabled:!1,id:"_btnElimina"+a.id,itemId:"_btnElimina"+a.id,cls:"cba-button-25",iconCls:"icon-elimina",text:"Elimina",margin:"0 1 0 0",handler:function(){var b=
a.cbaConfig.elimina_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnElimina: utilizzo di eval ***********"))}},{xtype:"button",disabled:!0,id:"_btnConferma"+a.id,itemId:"_btnConferma"+a.id,cls:"cba-button-25",iconCls:"icon-conferma",text:"Conferma",margin:"0 1 0 0",handler:function(){var b=!1,c,d=a.cbaConfig.verificaCampiForm_callback,e=a.cbaConfig.conferma_callback;d&&("function"==typeof e?b=d():StdSipcar.warn("*********** _btnConferma: utilizzo di eval ***********"));b&&(a.setBtnEditMode(!1),
"function"==typeof e?c=e():StdSipcar.warn("*********** _btnConferma: utilizzo di eval ***********"),Ext.isDefined(c)&&1==c&&a.setBtnEditMode(!0))}},{xtype:"button",disabled:!0,id:"_btnAnnulla"+a.id,itemId:"_btnAnnulla"+a.id,cls:"cba-button-25",iconCls:"icon-annulla",text:"Ripristina",margin:"0 1 0 0",handler:function(){a.setBtnEditMode(!1);var b=a.cbaConfig.annulla_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnAnnulla: utilizzo di eval ***********"))}},{xtype:"buttonStampa",
nonDisabilitare:!0,disabled:!1,id:"_btnStampa"+a.id,itemId:"_btnStampa"+a.id,cls:"cba-button-25",iconCls:"icon-stampa",text:"Stampa",margin:"0 1 0 0",hidden:!0,scale:"small",cbaConfig:a.cbaConfig.parametriStampa},{xtype:"button",nonDisabilitare:!0,disabled:!1,id:"_btnEsci"+a.id,itemId:"_btnEsci"+a.id,cls:"cba-button-25",iconCls:"icon-esci",text:"Esci",margin:"0 5 0 0",handler:function(){var b=a.cbaConfig.esci_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnEsci: utilizzo di eval ***********"))}}]});
a.callParent(arguments)},setBtnEditMode:function(a){Ext.getCmp("_btnNuovo"+this.id).setDisabled(a);Ext.getCmp("_btnElimina"+this.id).setDisabled(a);Ext.getCmp("_btnConferma"+this.id).setDisabled(!a);Ext.getCmp("_btnAnnulla"+this.id).setDisabled(!a);Ext.getCmp("_btnStampa"+this.id).setDisabled(a);Ext.getCmp("_btnEsci"+this.id).setDisabled(a)}});
Ext.define("Generali.standard.PannelloBottoniVert",{extend:"Ext.panel.Panel",border:0,margin:"5 5 0 0",layout:{type:"vbox"},title:"",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnHelp",cls:"cba-button-25",iconCls:"icon-help20",text:"Help",margin:"0 0 1 0",hidden:!0,handler:function(){var b=a.cbaConfig.help_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnHelp: utilizzo di eval ***********"))},listeners:{beforerender:function(){a.cbaConfig.help_callback&&
this.show()}}},{xtype:"button",disabled:!1,id:"_btnNuovo"+a.id,itemId:"_btnNuovo"+a.id,cls:"cba-button-25",iconCls:"icon-inserisci",text:"Nuovo",margin:"0 0 1 0",handler:function(){a.setBtnEditMode(!0);var b=a.cbaConfig.nuovo_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnNuovo: utilizzo di eval ***********"))}},{xtype:"button",disabled:!1,id:"_btnElimina"+a.id,itemId:"_btnElimina"+a.id,cls:"cba-button-25",iconCls:"icon-elimina",text:"Elimina",margin:"0 0 1 0",handler:function(){var b=
a.cbaConfig.elimina_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnNuovo: utilizzo di eval ***********"))}},{xtype:"button",disabled:!0,id:"_btnConferma"+a.id,itemId:"_btnConferma"+a.id,cls:"cba-button-25",iconCls:"icon-conferma",text:"Conferma",margin:"0 0 1 0",handler:function(){var b=!1,c,d=a.cbaConfig.verificaCampiForm_callback,e=a.cbaConfig.conferma_callback;d&&("function"==typeof e?b=d():StdSipcar.warn("*********** _btnConferma: utilizzo di eval ***********"));b&&(a.setBtnEditMode(!1),
"function"==typeof e?c=e():StdSipcar.warn("*********** _btnConferma: utilizzo di eval ***********"),Ext.isDefined(c)&&1==c&&a.setBtnEditMode(!0))}},{xtype:"button",disabled:!0,id:"_btnAnnulla"+a.id,itemId:"_btnAnnulla"+a.id,cls:"cba-button-25",iconCls:"icon-annulla",text:"Ripristina",margin:"0 0 1 0",handler:function(){a.setBtnEditMode(!1);var b=a.cbaConfig.annulla_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnAnnulla: utilizzo di eval ***********"))}},{xtype:"buttonStampa",
nonDisabilitare:!0,disabled:!1,id:"_btnStampa"+a.id,itemId:"_btnStampa"+a.id,cls:"cba-button-25",iconCls:"icon-stampa",text:"Stampa",margin:"0 0 1 0",hidden:!0,scale:"small",cbaConfig:a.cbaConfig.parametriStampa},{xtype:"button",nonDisabilitare:!0,disabled:!1,id:"_btnEsci"+a.id,itemId:"_btnEsci"+a.id,cls:"cba-button-25",iconCls:"icon-esci",text:"Esci",margin:"5 0 10 0",handler:function(){var b=a.cbaConfig.esci_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** _btnEsci: utilizzo di eval ***********"))}}]});
a.callParent(arguments)},setBtnEditMode:function(a){Ext.getCmp("_btnNuovo"+this.id).setDisabled(a);Ext.getCmp("_btnElimina"+this.id).setDisabled(a);Ext.getCmp("_btnConferma"+this.id).setDisabled(!a);Ext.getCmp("_btnAnnulla"+this.id).setDisabled(!a);Ext.getCmp("_btnStampa"+this.id).setDisabled(a);Ext.getCmp("_btnEsci"+this.id).setDisabled(a)}});
Ext.define("Ext.ux.form.TinyMCETextArea",{extend:"Ext.form.field.TextArea",alias:["widget.tinymce_textarea","widget.tinymce"],wysiwygIntialized:!1,intializationInProgress:!1,lastHeight:null,lastFrameHeight:null,noWysiwyg:!1,tinyMCEConfig:{},liquidLayout:!1,cbaTag:!1,cbaNumerazionePagina:!1,afterRender:function(){var a=this;a.callParent(arguments);a.on("blur",function(b,c,d){b=document.getElementById(a.getInputId());a.wysiwygIntialized?(c=tinymce.get(a.getInputId()))&&c.isHidden()&&(b&&(a.positionBeforeBlur=
{start:b.selectionStart,end:b.selectionEnd}),c.load()):b&&(a.positionBeforeBlur={start:b.selectionStart,end:b.selectionEnd})},a);a.on("resize",function(b,c,d,e,g,h){a.noWysiwyg||a.wysiwygIntialized?a.syncEditorHeight(d):a.initEditor(d)},a)},syncEditorHeight:function(a){this.lastHeight=a;if(this.wysiwygIntialized&&this.rendered&&!tinymce.get(this.getInputId()).isHidden()){var b=Ext.get(this.getInputId()+"_ifr"),c=b.up(".mce-edit-area"),c=c.up(".mce-container-body"),d=c.down(".mce-toolbar-grp");d&&
(a-=d.getHeight());(d=c.down(".mce-menubar"))&&(a-=d.getHeight());(c=c.down(".mce-statusbar"))&&(a-=c.getHeight());this.lastFrameHeight=a-3;b.setHeight(a-3);return a-3}},showBorder:function(a){var b=Ext.getDom(this.getId()+"-inputWrap");b&&(a?b.classList.remove("tinymce-hide-border"):b.classList.add("tinymce-hide-border"),(b=Ext.getDom(this.getId()+"-triggerWrap"))&&(a?b.classList.remove("tinymce-hide-border"):b.classList.add("tinymce-hide-border")))},initEditor:function(a){var b=this;if(!(b.noWysiwyg||
b.intializationInProgress||b.wysiwygIntialized)){b.intializationInProgress=!0;if(b.tinyMCEConfig){var c=b.tinyMCEConfig;b.tinyMCEConfig={};Ext.Object.merge(b.tinyMCEConfig,c)}else b.tinyMCEConfig={};b.tinyMCEConfig.language=CBA.parametriGenerali.lingua;b.tinyMCEConfig.mode="exact";b.tinyMCEConfig.resize=!1;b.tinyMCEConfig.elements=b.getInputId();c="";b.cbaTag&&(c="cbaTag | ");b.cbaNumerazionePagina&&(c+="cbaNumerazionePagina | ");Ext.apply(b.tinyMCEConfig,{theme:"modern",plugins:["advlist charmap colorpicker anchor autolink code lists spellchecker pagebreak layer table insertdatetime preview searchreplace print hr visualblocks",
"contextmenu paste directionality visualchars nonbreaking template textcolor textpattern bdesk_photo noneditable lineheight"],toolbar1:c+"fontselect fontsizeselect | forecolor backcolor | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify |",toolbar2:" bullist numlist | outdent indent | cut copy paste undo redo | table | preview print | bdesk_photo | lineheightselect",image_advtab:!0,menubar:!1,statusbar:!1});b.tinyMCEConfig.force_br_newlines=!0;b.tinyMCEConfig.force_p_newlines=
!1;b.tinyMCEConfig.forced_root_block="";b.tinyMCEConfig.height=b.lastFrameHeight?b.lastFrameHeight:30;b.readOnly&&(b.tinyMCEConfig.readonly=!0);b.isDisabled()&&(b.tinyMCEConfig.readonly=!0);if(b.labelEl)b.labelEl.on("click",function(a,c,d){b.focus(!1)},b.labelEl);var d=null;b.tinyMCEConfig.setup&&(d=b.tinyMCEConfig.setup);b.tinyMCEConfig.setup=function(c){b.cbaTag&&b.createButtonCbaTag(c);b.cbaNumerazionePagina&&b.createButtonNumerazionePagina(c);c.on("keydown",function(a){if(9==a.keyCode)return a.preventDefault(),
a.stopPropagation(),!1});c.on("init",function(d){b.wysiwygIntialized=!0;b.intializationInProgress=!1;b.showBorder(!1);var e=c.setContent;c.setContent=function(){e.apply(c,arguments);c.fire("change",{})};a&&setTimeout(function(){b.syncEditorHeight(a)},200)});c.on("change",function(a){a=b.getValue();var d=c.getContent();c.save();b.fireEvent("change",b,d,a,{});b.checkDirty();b.validateOnChange&&b.validate()});c.on("focus",function(a){(a=b.findParentByType("window"))&&a.toFront(!0)});d&&d(c)};tinymce.init(b.tinyMCEConfig);
b.intializationInProgress=!1;b.wysiwygIntialized=!0}},getEditor:function(){},isEditorHidden:function(){if(!this.wysiwygIntialized)return!0;var a=tinymce.get(this.getInputId());return a?a.isHidden():!0},showEditor:function(){this.storedCursorPosition=null;if(this.wysiwygIntialized){var a=tinymce.get(this.getInputId());a&&(a.show(),this.showBorder(!1),a.nodeChanged(),this.lastHeight&&this.syncEditorHeight(this.lastHeight),this.focus())}else this.noWysiwyg=!1,this.initEditor(this.getHeight())},hideEditor:function(){if(this.wysiwygIntialized){var a=
tinymce.get(this.getInputId());if(a){var b=a.selection.getNode();if(b&&"#document"!==b.nodeName&&"BODY"!==b.nodeName&&"body"!==b.nodeName){a.selection.collapse(!0);a.execCommand("mceInsertContent",0,'<a id="_____sys__11223___"></a>');a.hide();this.showBorder(!0);var a=document.getElementById(this.getInputId()),b=-1,c="";a&&(c=a.value,b=c.indexOf('<a id="_____sys__11223___"></a>'));-1!==b&&(c=c.replace(RegExp('<a id="_____sys__11223___"></a>',"g"),""),a.value=c,a.setSelectionRange&&(a.focus(),a.setSelectionRange(b,
b)))}else a.hide(),this.showBorder(!0)}}},toggleEditor:function(){this.wysiwygIntialized?tinymce.get(this.getInputId()).isHidden()?this.showEditor():this.hideEditor():this.showEditor()},removeEditor:function(){if(this.intializationInProgress||!this.wysiwygIntialized)return this;var a=tinymce.get(this.getInputId());a&&(a.save(),a.destroy(!1),(a=Ext.get(this.getInputId()+"_ifr"))&&a.destroy(),this.showBorder(!0));this.wysiwygIntialized=!1;return this},reinitEditor:function(a){if(this.noWysiwyg||this.intializationInProgress)return this;
this.tinyMCEConfig||(this.tinyMCEConfig={});a||(a={});Ext.apply(this.tinyMCEConfig,a);if(!this.wysiwygIntialized)return this;a=!0;var b=tinymce.get(this.getInputId());b&&(a=b.isHidden(),b.save(),b.destroy(!1),(b=Ext.get(this.getInputId()+"_ifr"))&&b.destroy());this.wysiwygIntialized=!1;a||this.initEditor(this.getHeight());return this},setValue:function(a){var b=this.callParent(arguments);if(this.wysiwygIntialized){var c=tinymce.get(this.getInputId());c&&(c.load(),c.save())}return b},focus:function(a,
b){var c=this;if(c.isDisabled())return c;if(b)return isNaN(b)&&(b=10),setTimeout(function(){c.focus.call(c,a,!1)},b),c;if(!c.wysiwygIntialized)return c.callParent(arguments);var d=tinymce.get(c.getInputId());if(d&&!d.isHidden())c.callParent(arguments),d.focus();else return c.callParent(arguments);return c},enable:function(a){var b=this.callParent(arguments);if(!b)return b;this.tinyMCEConfig.readonly&&this.reinitEditor({readonly:!1});return b},disable:function(a){var b=this.callParent(arguments);if(!b)return b;
this.tinyMCEConfig.readonly||this.reinitEditor({readonly:!0});return b},setReadOnly:function(a){var b=this.callParent(arguments);a!==this.tinyMCEConfig.readonly&&this.reinitEditor({readonly:a});return b},storeCurrentSelection:function(){var a=!1,b=tinymce.get(this.getInputId());this.wysiwygIntialized&&b&&!b.isHidden()&&(a=!0);var c=document.getElementById(this.getInputId());a?this.storedCursorPosition=b.selection.getBookmark("simple"):c&&(this.storedCursorPosition=this.positionBeforeBlur)},restoreCurrentSelection:function(){if(this.storedCursorPosition){var a=
!1,b=tinymce.get(this.getInputId());this.wysiwygIntialized&&b&&!b.isHidden()&&(a=!0);var c=document.getElementById(this.getInputId());a?b.selection.moveToBookmark(this.storedCursorPosition):c&&c.setSelectionRange(this.storedCursorPosition.start,this.storedCursorPosition.end)}},insertText:function(a){var b=!1,c=tinymce.get(this.getInputId());this.wysiwygIntialized&&c&&!c.isHidden()&&(b=!0);var d=document.getElementById(this.getInputId());b?(c.focus(),c.execCommand("mceInsertContent",0,a)):d&&(d.focus(),
b=d.selectionStart+a.length,d.value=d.value.slice(0,d.selectionStart)+a+d.value.slice(d.selectionEnd),d.setSelectionRange(b,b))},beforeDestroy:function(){var a=tinymce.get(this.getInputId());a&&a.destroy(!1)},renderActiveError:function(){var a=this,b=!!a.getActiveError(),c=Ext.get(a.getInputId()+"_ifr");if(!c)return a.callParent(arguments);var d=tinymce.get(a.getInputId());if(!d)return a.callParent(arguments);c=c.up(".mce-edit-area");c=c.up(".mce-container-body");if(!c)return a.callParent(arguments);
c=c.up(".mce-tinymce");if(!c)return a.callParent(arguments);if(a.rendered&&!a.isDestroyed&&!a.preventMark){var e=function(b){a.clearInvalid()};b?(c.addCls("tinymce-error-field"),d.on("keydown",e),d.on("change",e)):(c.removeCls("tinymce-error-field"),d.off("keydown",e),d.off("change",e))}return!0},scriviPopupMenu:function(a,b,c){var d=this;Ext.each(a,function(a){if(Ext.isArray(a.tags)){var c={text:a.descrizione,menu:{items:[]}};d.scriviPopupMenu(a.tags,c.menu,a.root);b.items.push(c)}else b.items.push({text:a.descrizione,
onclick:function(){"_DSAN#SCHEDELIBERE"==a.tags||"_DSAN#SCHEDAFKT"==a.tags||"_DSAN#DIARITIPOLOGIE"==a.tags||"_DSAN#BILANCIOECOLOGICO"==a.tags||"_DSAN#GORDON"==a.tags||a.tags.startsWith("_DSAN#GRIDSCORE")?Ext.create("winCBA",{name:"CS.schedeLibere.view.SchedeLibereTags",titolo:"SELEZIONA_TAG",maximizable:!1,minWidth:480,minHeight:190,layout:"fit",clsWin:"cbaCssBordoPopup",configItem:{controllerTe:d,prefisso:a.tags,schedeLibere:"_DSAN#SCHEDELIBERE"==a.tags?!0:!1,schedafkt:"_DSAN#SCHEDAFKT"==a.tags?
!0:!1,tipologieDiari:"_DSAN#DIARITIPOLOGIE"==a.tags?!0:!1,bilancioEcologico:"_DSAN#BILANCIOECOLOGICO"==a.tags?!0:!1,gordon:"_DSAN#GORDON"==a.tags?!0:!1,gridScore:a.tags.startsWith("_DSAN#GRIDSCORE")?!0:!1}}).show():d.insertText(a.tags)}})})},createButtonNumerazionePagina:function(a){var b=this;a.addButton("cbaNumerazionePagina",{text:traduci("TINY_NUMERAZIONE_PAGINA"),type:"button",onclick:function(){b.insertText(traduci("TINY_PAGINA")+" $[page] "+traduci("TINY_PAGINA_DI")+" $[total]")}})},createButtonCbaTag:function(a){var b=
this,c="";Ext.Ajax.request({url:"/cba/gen/ws/general/reports/docPers/tagsUrlModulo",async:!1,params:{idModulo:CBA.moduli.moduloAttivo},method:"GET",success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c=a.data:msgShowError("",a.message)}});c&&Ext.Ajax.request({url:c,async:!1,params:{idModulo:CBA.moduli.moduloAttivo,idOrganizzazione:b.idOrganizzazione},method:"GET",success:function(c){c=Ext.JSON.decode(c.responseText);c.success?(c=c.data,a.addButton("cbaTag",{text:traduci("TINY_TAG"),type:"splitbutton",
icon:!0,image:"/cba/generali/images/16/tag.png",menu:{items:[]},onclick:function(){this.showMenu()}}),b.scriviPopupMenu(c,a.buttons.cbaTag.menu)):msgShowError("",c.message)}})}});
Ext.define("Generali.standard.calcolatrice.controller.Calculator",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.erroreDivisione=traduci("ERRORE_DIVISIONE");this.callParent(arguments);this.addRef([{ref:"CalcHH",selector:a+"#CalcHH"},{ref:"CalcMM",selector:a+"#CalcMM"},{ref:"CalcPIU",selector:a+"#CalcPIU"},{ref:"CalcMEN",selector:a+"#CalcMEN"},{ref:"CalcPER",selector:a+"#CalcPER"},{ref:"CalcDIV",selector:a+"#CalcDIV"},{ref:"CalcOk",selector:a+"#CalcOk"},
{ref:"CalcVIR",selector:a+"#CalcVIR"},{ref:"ContCampi",selector:a+"#ContCampi"},{ref:"Tastierino",selector:a+"#Tastierino"},{ref:"Parziale",selector:a+"#Parziale"},{ref:"BtnClose",selector:a+"#BtnClose"}]);this.control(a+"#BtnClose",{click:this.clickBtnClose})},clickBtnClose:function(){this.cbaConfig.close(this.ultimoRisultato);this.getCalcHH().up("window").close()},onKeypressOreMin:function(a,b){var c=b.keyCode?b.keyCode:b.charCode;43==c?(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcPIU())):
46==c?(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcVIR())):45==c?(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcMEN())):42==c?(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcPER())):47==c?(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcDIV())):13==c&&(b.preventDefault(),this.onClickBtnsTastierino(this.getCalcOk()))},onFocusCampiOreMin:function(a){this.campoFocus=a},onBlurCampiOreMin:function(a){""==a.getValue()&&a.reset()},calcolaRisultato:function(a){var b=
this.getCalcHH().getValue(),c=this.getCalcMM().getValue(),d,e,b=Ext.isEmpty(b)?0:b,c=Ext.isEmpty(c)?0:c;10>c&&(c="0"+c);d=parseFloat(b+"."+c);if(null!=this.ore_mem)switch(e=10>this.minuti_mem?"0"+this.minuti_mem:this.minuti_mem,e=parseFloat(this.ore_mem+"."+e),this.operatore){case "/":risultato=inSessantesimi(inCentesimi(e)/inCentesimi(d));break;case "*":risultato=inSessantesimi(inCentesimi(e)*inCentesimi(d));break;case "-":risultato=inSessantesimi(inCentesimi(e)-inCentesimi(d));break;case "+":risultato=
inSessantesimi(inCentesimi(e)+inCentesimi(d))}else risultato=d;d=risultato.toString().split(".");this.getCalcHH().setValue(d[0]);d[1]?1==d[1].length&&(d[1]+="0"):d[1]="00";this.getCalcMM().setValue(d[1]);this.ultimoRisultato=this.risultato=d[0]+"."+d[1];this.operatore=a;this.addParziale(b,c)},onClickBtnsTastierino:function(a,b,c){var d=(b=this.campoFocus.getValue())?b.toString():"";b=this.getCalcHH();c=this.getCalcMM();switch(a.getItemId()){case "Calc0":case "Calc1":case "Calc2":case "Calc3":case "Calc4":case "Calc5":case "Calc6":case "Calc7":case "Calc8":case "Calc9":this.campoFocus.setValue(d+
a.getText());break;case "CalcVIR":"CalcMM"===this.campoFocus.getItemId()?this.getCalcHH().focus():this.getCalcMM().focus();break;case "CalcDEL":this.campoFocus.setValue(d.substr(0,d.length-1));break;case "CalcCAN":this.getCalcHH().setValue();this.getCalcMM().setValue();this.getParziale().setValue();this.azzeraVar();break;case "CalcDIV":case "CalcPER":case "CalcMEN":case "CalcPIU":var d=b.getValue(),e=c.getValue();if(Ext.isEmpty(d)&&Ext.isEmpty(e))break;Ext.isEmpty(d);Ext.isEmpty(e);this.calcolaRisultato(a.getText());
this.ore_mem=b.getValue();this.minuti_mem=c.getValue();this.ore_mem=Ext.isEmpty(this.ore_mem)?0:this.ore_mem;this.minuti_mem=Ext.isEmpty(this.minuti_mem)?0:this.minuti_mem;b.setValue("");c.setValue("");b.focus(!0);break;case "CalcOk":null!=this.operatore&&(this.calcolaRisultato(),this.getParziale().setValue(this.getParziale().getValue()+"\n"),this.azzeraVar(),b.focus(!0))}},azzeraVar:function(){this.risultato=this.operatore=this.minuti_mem=this.ore_mem=null;this.getCalcHH().focus()},addParziale:function(a,
b){var c,d=this.getParziale();c=this.operatore?this.operatore:"";null==this.ore_mem?c=a+"."+b+" "+c+"\n":(isNaN(this.risultato)&&(this.risultato=this.erroreDivisione),c=a+"."+b+" =\n----------\n"+this.risultato+" "+c+"\n");d.setValue(d.getValue()+c);d.focus()},onLaunch:function(){var a=this;a.cbaConfig&&a.cbaConfig.showBtnClose&&a.getBtnClose().show();this.ultimoRisultato=0;a.azzeraVar();Ext.each(a.getContCampi().query("numberfield"),function(b){b.on("blur",Ext.bind(a.onBlurCampiOreMin,a));b.on("focus",
Ext.bind(a.onFocusCampiOreMin,a));b.on("keypress",Ext.bind(a.onKeypressOreMin,a))});Ext.each(a.getTastierino().query("button"),function(b){b.on("click",Ext.bind(a.onClickBtnsTastierino,a))});a.getCalcHH().focus(!0,200)}});
Ext.define("Generali.standard.calcolatrice.view.Calculator",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},animCollapse:!0,title:"CALCOLATRICE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",ui:"cbaPanelBlu",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",itemId:"ContCampi",reference:"ContCampi",layout:{type:"vbox",align:"center"},items:[{xtype:"container",layout:{type:"hbox"},margin:"0 0 15 0",items:[{xtype:"numberfield",itemId:"CalcHH",
reference:"CalcHH",labelAlign:"top",width:60,fieldLabel:"HH",labelSeparator:" ",labelWidth:16,hideTrigger:!0,keyNavEnabled:!0,mouseWheelEnabled:!0,allowDecimals:!1,margin:"0 8 0 0",enableKeyEvents:!0,baseChars:"0123456789"},{xtype:"numberfield",itemId:"CalcMM",reference:"CalcMM",width:32,fieldLabel:"MM",labelAlign:"top",labelSeparator:" ",labelWidth:16,hideTrigger:!0,keyNavEnabled:!0,mouseWheelEnabled:!0,allowDecimals:!1,maxValue:59,minValue:0,maxLength:2,enforceMaxLength:!0,enableKeyEvents:!0,baseChars:"0123456789"}]}]},
{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"tbspacer",flex:1},{xtype:"container",itemId:"Tastierino",reference:"Tastierino",margin:"0 10 10 10",width:144,items:[{xtype:"button",itemId:"CalcDEL",reference:"CalcDEL",height:32,margin:2,width:32,text:"D"},{xtype:"button",itemId:"CalcCAN",reference:"CalcCAN",height:32,margin:2,width:32,text:"C"},{xtype:"button",itemId:"CalcDIV",reference:"CalcDIV",height:32,margin:2,width:32,text:"/"},{xtype:"button",itemId:"CalcPER",
reference:"CalcPER",height:32,margin:2,width:32,text:"*"},{xtype:"button",itemId:"Calc7",reference:"Calc7",height:32,margin:2,width:32,text:"7"},{xtype:"button",itemId:"Calc8",reference:"Calc8",height:32,margin:2,width:32,text:"8"},{xtype:"button",itemId:"Calc9",reference:"Calc9",height:32,margin:2,width:32,text:"9"},{xtype:"button",itemId:"CalcMEN",reference:"CalcMEN",height:32,margin:2,width:32,text:"-"},{xtype:"button",itemId:"Calc4",reference:"Calc4",height:32,margin:2,width:32,text:"4"},{xtype:"button",
itemId:"Calc5",reference:"Calc5",height:32,margin:2,width:32,text:"5"},{xtype:"button",itemId:"Calc6",reference:"Calc6",height:32,margin:2,width:32,text:"6"},{xtype:"button",itemId:"CalcPIU",reference:"CalcPIU",height:32,margin:2,width:32,text:"+"},{xtype:"button",itemId:"CalcOk",reference:"CalcOk",height:68,margin:2,style:"float:right",width:32,text:"OK"},{xtype:"container",width:108,items:[{xtype:"button",itemId:"Calc1",reference:"Calc1",height:32,margin:2,width:32,text:"1"},{xtype:"button",itemId:"Calc2",
reference:"Calc2",height:32,margin:2,width:32,text:"2"},{xtype:"button",itemId:"Calc3",reference:"Calc3",height:32,margin:2,width:32,text:"3"},{xtype:"button",itemId:"Calc0",reference:"Calc0",height:32,margin:2,width:68,text:"0"},{xtype:"button",itemId:"CalcVIR",reference:"CalcVIR",height:32,margin:2,width:32,text:"."}]}]},{xtype:"tbspacer",flex:1}]}]},{xtype:"panel",ui:"cbaPanelRosa",layout:{align:"stretch",type:"vbox"},width:200,padding:5,items:[{xtype:"textareafield",title:"PARZIALI",itemId:"Parziale",
reference:"Parziale",readOnly:!0,flex:1,fieldStyle:"text-align: right"},{xtype:"button",text:"CALC_CHIUDI_AGGIORNA_ORE",hidden:!0,itemId:"BtnClose",reference:"BtnClose"}]}]});this.callParent(arguments)}});
Ext.define("Generali.standard.calendar.controller.Calendar",{extend:"Generali.standard.ViewController",today:Ext.Date.clearTime(new Date),itemsDay:null,store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"day",type:"date"},{name:"eventType"},{name:"iconCls"},{name:"text"},{name:"textTip"},{name:"area"},{name:"letto"}],data:[[Ext.Date.clearTime(new Date),1,null,"riunione","Dalle 6:00 alle 18:00","P,O",!1],[Ext.Date.clearTime(creaData(3,6,2016)),1,null,null,null,"P,O,A,E",!1]]}),init:function(){this.selContainer=
"#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Anno",selector:this.selContainer+"#Anno"},{ref:"Mese",selector:this.selContainer+"#Mese"},{ref:"BtnAvanti",selector:this.selContainer+"#BtnAvanti"},{ref:"BtnIndietro",selector:this.selContainer+"#BtnIndietro"},{ref:"SelPeriodo",selector:this.selContainer+"#SelPeriodo"}])},addWeek:function(a,b){for(var c=this,d=Ext.create("Ext.container.Container",{itemId:"week"+a,flex:b?0:1,layout:{type:"hbox",align:"stretch"}}),e={xtype:"container",
layout:{type:"hbox"},defaults:{padding:1},items:[{xtype:"image",itemId:"area1",height:16,width:16,hidden:!0,src:"/cba/generali/images/16/css-icon-green.png"},{xtype:"image",itemId:"area2",height:16,width:16,hidden:!0,src:"/cba/generali/images/16/css-icon-orange.png"},{xtype:"image",itemId:"area3",height:16,width:16,hidden:!0,src:"/cba/generali/images/16/css-icon-violet.png"},{xtype:"image",itemId:"area4",height:16,width:16,hidden:!0,src:"/cba/generali/images/16/css-icon-red.png"}]},g={xtype:"label",
itemId:"firstEvent",style:{"border-radius":"5px",background:"#73AD21",padding:"2px"}},h=1;7>=h;h++)d.add({xtype:"panel",bodyPadding:b?0:3,title:b?getGiorno(h):"",flex:1,isDay:!b,layout:{type:"vbox",align:"stretch"},items:[{xtype:"label",itemId:"lbDay"},b?null:e,b?null:g,b?null:c.itemsDay],listeners:{render:function(a){a.el.on("click",function(){!b&&a.isValidDay&&c.clickDay(c,a)})}}});return d},changePeriodo:function(a,b){var c=this,d=creaData(1,b,a),e=dataFineMese(b,a),e=parseInt(Ext.Date.format(e,
"d"),10),d=parseInt(Ext.Date.format(d,"w"),10),g=0==d?7:d,h=e+g-1,d=c.view.query("panel[isDay=true]"),k=0,l=0;Ext.each(d,function(d){k++;var e=d.down("#lbDay");c.clearDay(d);if(k>=g&&k<=h){l++;var m=Ext.Date.clearTime(creaData(l,b,a));d.isValidDay=!0;d.dateDay=m;e.setText(l);m.getTime()==c.today.getTime()?e.addCls("cbaGrassetto"):e.removeCls("cbaGrassetto");0==parseInt(Ext.Date.format(m,"w"),10)?d.setBodyStyle("background","#ffe5e5"):d.setBodyStyle("background","none")}else d.isValidDay=!1,d.dateDay=
null,e.setText(""),d.setBodyStyle("background","#f1f2f3")});d=c.view.down("#week6");d.setVisible(d.down("panel[isValidDay=true]"));c.store.load()},clearDay:function(a){a.down("#area1").hide();a.down("#area2").hide();a.down("#area3").hide();a.down("#area4").hide();a.down("#firstEvent").hide()},updateDay:function(a){var b=this.view.down("panel[dateDay="+a.get("day")+"]");if(b){var c=a.get("area").split(",");b.down("#area1").setVisible(Ext.Array.contains(c,"P"));b.down("#area2").setVisible(Ext.Array.contains(c,
"O"));b.down("#area3").setVisible(Ext.Array.contains(c,"A"));b.down("#area4").setVisible(Ext.Array.contains(c,"E"));Ext.isEmpty(a.get("text"))||(b=b.down("#firstEvent"),b.show(),b.setText('<span data-qtip="'+a.get("textTip")+'">'+a.get("text")+"</span>",!1))}},loadStore:function(a,b){var c=this;Ext.each(b,function(a){c.updateDay(a)})},clickDay:function(a,b){Ext.create("Ext.window.Window",{title:"Giorno "+FormattaData(b.dateDay),closable:!0,modal:!0,height:200,width:300,layout:{type:"fit"},listeners:{close:function(a){b.down("#area1").hide();
b.down("#area2").hide();b.down("#area3").hide();b.down("#area4").hide()}}}).show()},onLaunch:function(){this.getSelPeriodo().changePeriodo=Ext.bind(this.changePeriodo,this);this.store.on("load",this.loadStore,this);this.view.add([this.addWeek(0,!0),this.addWeek(1),this.addWeek(2),this.addWeek(3),this.addWeek(4),this.addWeek(5),this.addWeek(6)]);this.changePeriodo(2016,6)}});
Ext.define("Generali.standard.calendar.view.Calendar",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"selPeriodo",itemId:"SelPeriodo",reference:"SelPeriodo",pack:"center",align:"middle"}]});this.callParent(arguments)}});
Ext.define("Generali.standard.controller_PannelloBottoni",{extend:"Ext.panel.Panel",uses:["Generali.standard.stampe.Button"],border:0,layout:{type:"hbox"},title:"",initComponent:function(){var a=this,b=a.cbaConfig.noText,c=a.cbaConfig.personIcons;Ext.applyIf(a,{items:[{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnHelp",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnHelp?c.btnHelp:"icon-help20",testo:traduci("Help"),
text:b?"":"Help",width:b?30:!1,margin:"0 1 0 0",hidden:!0,handler:function(){var b=a.cbaConfig.help_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnHelp : utilizzo di eval ***********"))},listeners:{beforerender:function(){a.cbaConfig.help_callback&&this.show()}}},{xtype:"button",disabled:!1,itemId:"btnNuovo",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnNuovo?c.btnNuovo:"icon-inserisci",testo:traduci("Nuovo"),
text:b?"":"Nuovo",width:b?30:!1,margin:"0 1 0 0",handler:function(){a.setBtnEditMode(!0);var b=a.cbaConfig.nuovo_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnNuovo : utilizzo di eval ***********"))}},{xtype:"button",disabled:!1,itemId:"btnElimina",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnElimina?c.btnElimina:"icon-elimina",testo:traduci("Elimina"),text:b?"":"Elimina",width:b?30:!1,
margin:"0 1 0 0",handler:function(){var b=a.cbaConfig.elimina_callback;if(b)if("function"==typeof b){if(CBA.moduli.modulo49){var c=a.lookupController().cbaConfig.codVideata;if(CBA.moduli.modulo49.noteAnnullamentoAbilitata&&c&&(c.startsWith("9")||c.startsWith("Diari"))){a.showWinNoteAnnullamento(b);return}}b()}else StdSipcar.warn("*********** btnElimina: utilizzo di eval ***********")}},{xtype:"button",disabled:!0,itemId:"btnConferma",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:
"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnConferma?c.btnConferma:"icon-conferma",testo:traduci("Conferma"),text:b?"":"Conferma",width:b?30:!1,margin:"0 1 0 0",handler:function(){var b=!1,c,g=a.cbaConfig.verificaCampiForm_callback,h=a.cbaConfig.conferma_callback;g&&("function"==typeof h?b=g():StdSipcar.warn("*********** btnConferma: utilizzo di eval ***********"));b&&(a.setBtnEditMode(!1),"function"==typeof h?c=h():StdSipcar.warn("*********** btnConferma: utilizzo di eval ***********"),
Ext.isDefined(c)&&1==c&&a.setBtnEditMode(!0))}},{xtype:"button",disabled:!0,itemId:"btnAnnulla",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnAnnulla?c.btnAnnulla:"icon-annulla",testo:traduci("Ripristina"),text:b?"":"Ripristina",width:b?30:!1,margin:"0 1 0 0",handler:function(){var b=!0;a.cbaConfig.beforeAnnulla&&(b=a.cbaConfig.beforeAnnulla());b?(a.setBtnEditMode(!1),(b=a.cbaConfig.annulla_callback)&&("function"==
typeof b?b():StdSipcar.warn("*********** btnAnnulla: utilizzo di eval ***********"))):a.setBtnEditMode(!0)}},{xtype:"newButtonStampa",nonDisabilitare:!0,disabled:!1,itemId:"BtnStampa",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.BtnStampa?c.BtnStampa:"icon-stampa",testo:traduci("Stampa"),text:b?"":a.cbaConfig.textButtonStampa?a.cbaConfig.textButtonStampa:"Stampa",width:b?30:!1,margin:"0 1 0 0",hidden:!0,scale:"small"},
{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnEsci",cls:b?"cbaBtnFunzione-mini":a.cbaConfig.classeBottoni?a.cbaConfig.classeBottoni:"cba-button-25",iconCls:a.cbaConfig.noIcon?"":c&&c.btnEsci?c.btnEsci:"icon-esci",testo:traduci("Esci"),text:b?"":"Esci",width:b?30:!1,margin:"0 5 0 0",handler:function(){var b=a.cbaConfig.esci_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnEsci: utilizzo di eval ***********"))}}]});a.callParent(arguments)},listeners:{afterrender:function(a){a.cbaConfig.noText&&
Ext.each(a.query("button"),function(a){a.on("mouseover",function(a){if(!a.isDisabled()){a.cbaTip||(a.cbaTip=Ext.create("CbaIconBtnTip",{html:a.testo,cls:"cba-tip-button",listeners:{show:function(a){Ext.defer(function(){Ext.isDefined(a)&&(a.destroyed||a.hide())},2E3)}}}));a.cbaTip.setStyle("opacity",.1);var b=a.getPosition();a.cbaTip.showAt(b[0],b[1]+a.getHeight());a.cbaTip.showAt(b[0]-a.cbaTip.getWidth()/2+a.getWidth()/2,b[1]+a.getHeight());a.cbaTip.setStyle("opacity",1)}});a.on("mouseout",function(a){a.isDisabled()||
a.cbaTip.hide()});a.on("destroy",function(a){a.cbaTip&&a.cbaTip.destroy()})})}},setBtnEditMode:function(a){this.queryById("btnNuovo").setDisabled(a);var b=this.queryById("btnElimina");b.cssModeAnnullabile||b.setDisabled(a);this.queryById("btnConferma").setDisabled(!a);this.queryById("btnAnnulla").setDisabled(!a);this.queryById("BtnStampa").setDisabled(a);this.queryById("btnEsci").setDisabled(a)},showWinNoteAnnullamento:function(a){a=void 0===a?function(){}:a;var b=this,c=Ext.create("winCBA",{titolo:traduci("TERAPIE_MOTIVO_ANNULLAMENTO"),
larghezzaWin:350,altezzaWin:300,closable:!1,layout:"fit",maximizable:!1,name:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},flex:1,bodyPadding:5,items:[{xtype:"cbaFieldsetHtmlEditor",flex:1,itemId:"Note",reference:"Note",title:this.TERAPIE_MOTIVO_ANNULLAMENTO}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"CSSButtonsPanel",flex:1,layout:{type:"hbox",align:"bottom",pack:"end"},items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",handler:function(d){var e=c.down("#Note").getValue();
Ext.isEmpty(e)?Messaggio("Elimina",b.TERAPIE_NOTE_OBBLIGATORIO,"OK","WARNING"):(a(e),d.up("window").close())}},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",handler:function(a){a.up("window").close()}}]}]}]}]});c.show()}});
Ext.define("Generali.standard.controller_PannelloBottoniVert",{extend:"Ext.panel.Panel",uses:["Generali.standard.stampe.Button"],border:0,bodyPadding:"5 0 0 0",layout:{type:"vbox"},title:"",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnHelp",cls:"cba-button-25",iconCls:"icon-help20",text:"HELP",margin:"0 0 1 0",hidden:!0,handler:function(){var b=a.cbaConfig.help_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnHelp: utilizzo di eval ***********"))},
listeners:{beforerender:function(){a.cbaConfig.help_callback&&this.show()}}},{xtype:"button",disabled:!1,itemId:"btnNuovo",cls:"cba-button-25",iconCls:"icon-inserisci",text:"NUOVO",margin:"0 0 1 0",handler:function(){a.setBtnEditMode(!0);var b=a.cbaConfig.nuovo_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnNuovo: utilizzo di eval ***********"))}},{xtype:"button",disabled:!1,itemId:"btnElimina",cls:"cba-button-25",iconCls:"icon-elimina",text:"Elimina",margin:"0 0 1 0",handler:function(){var b=
a.cbaConfig.elimina_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnElimina: utilizzo di eval ***********"))}},{xtype:"button",disabled:!0,itemId:"btnConferma",cls:"cba-button-25",iconCls:"icon-conferma",text:"Conferma",margin:"0 0 1 0",handler:function(){var b=!1,c,d=a.cbaConfig.verificaCampiForm_callback,e=a.cbaConfig.conferma_callback;d&&("function"==typeof e?b=d():StdSipcar.warn("*********** btnConferma: utilizzo di eval ***********"));b&&(a.setBtnEditMode(!1),"function"==
typeof e?c=e():StdSipcar.warn("*********** btnConferma: utilizzo di eval ***********"),Ext.isDefined(c)&&1==c&&a.setBtnEditMode(!0))}},{xtype:"button",disabled:!0,itemId:"btnAnnulla",cls:"cba-button-25",iconCls:"icon-annulla",text:"Ripristina",margin:"0 0 1 0",handler:function(){var b=!0;a.cbaConfig.beforeAnnulla&&(b=a.cbaConfig.beforeAnnulla());b?(a.setBtnEditMode(!1),(b=a.cbaConfig.annulla_callback)&&("function"==typeof b?b():StdSipcar.warn("*********** btnConferma: utilizzo di eval ***********"))):
a.setBtnEditMode(!0)}},{xtype:"newButtonStampa",nonDisabilitare:!0,disabled:!1,itemId:"BtnStampa",cls:"cba-button-25",iconCls:"icon-stampa",text:a.cbaConfig.textButtonStampa?a.cbaConfig.textButtonStampa:"Stampa",margin:"0 0 1 0",hidden:!0,scale:"small"},{xtype:"button",nonDisabilitare:!0,disabled:!1,itemId:"btnEsci",cls:"cba-button-25",iconCls:"icon-esci",text:"Esci",margin:"5 0 10 0",handler:function(){var b=a.cbaConfig.esci_callback;b&&("function"==typeof b?b():StdSipcar.warn("*********** btnEsci: utilizzo di eval ***********"))}}]});
a.callParent(arguments)},setBtnEditMode:function(a){this.queryById("btnNuovo").setDisabled(a);var b=this.queryById("btnElimina");b.cssModeAnnullabile||b.setDisabled(a);this.queryById("btnConferma").setDisabled(!a);this.queryById("btnAnnulla").setDisabled(!a);this.queryById("BtnStampa").setDisabled(a);this.queryById("btnEsci").setDisabled(a)}});
function controller_generaliRicaricaStore(a,b,c,d,e,g,h,k){if(a){var l,m,n=a.isXType("gridview")||a.isXType("grid")||a.isXType("treepanel");h?l=h:(n?a.getSelectionModel().getSelection()[0]&&(l=a.getSelectionModel().getSelection()[0].get(e)):l=b.getAt(0),d&&d.getSelectionModel().getSelection()[0]&&(l=d.getSelectionModel().getSelection()[0].get(e)));b.cbaConfig={idRecord:l};b.load({params:c,callback:function(c,h,t){t?d?c&&0<c.length?((m=trovaRecord(b,e,l))?d.getSelectionModel().select([m]):(d.getSelectionModel().select(0),
m=d.getSelectionModel().getSelection()[0]),g(m)):g():(n?0<b.getTotalCount()&&cmpPortletComponent&&cmpPortletComponent.getSelectionModel().select(0):g&&g(b.getAt(0)),k&&k(a,c)):msgShow("",h.getError())}})}}
function controller_abilitaBottoni(a){var b=!0,c=!0;a.permesso||(a.permesso="S");"S"==a.permesso&&(b=a.getForm().isDirty(),c=!b);var d=a.boxBottoni.queryById("btnNuovo"),e=a.boxBottoni.queryById("btnElimina"),g=a.boxBottoni.queryById("btnAnnulla"),h=a.boxBottoni.queryById("btnConferma"),k=a.boxBottoni.queryById("btnStampa")||a.boxBottoni.queryById("BtnStampa");a=a.boxBottoni.queryById("btnEsci");d&&d.setDisabled(b);e&&!e.nonDisabilitare&&e.setDisabled(b);g&&g.setDisabled(c);h&&h.setDisabled(c);k&&
k.setDisabled(b);a&&a.setDisabled(b)}function controller_nuovoRecord(a,b,c){c=void 0===c?!0:c;clearForm(a);a.getForm().findField("id").setValue(-9999);validaForm(a);if(c)if(b)setTimeout(function(){b.focus()},500);else{var d=a.query("field[hidden=false]")[0];d&&setTimeout(function(){d.focus()},500)}}
function controller_nuovoRecordGrid(a,b,c,d,e){d=void 0===d?!0:d;c=Ext.isDefined(c)?c:0;var g=b.getStore().insert(c,a);d&&b.getStore().clearFilter();b.getSelectionModel().select(g);setTimeout(function(){e?b.getPlugin().startEdit(g[0],e):b.getPlugin().startEdit(g[0])},100)}function controller_bottoniSolaLettura(a){a.queryById("btnNuovo").setDisabled(!0);a.queryById("btnElimina").setDisabled(!0);a.queryById("btnAnnulla").setDisabled(!0);a.queryById("btnConferma").setDisabled(!0)}
function controller_salvaRecord(a,b,c,d,e,g,h,k,l){Ext.isEmpty(h)&&(h="id");var m=!1,n=b&&b[h]||d&&d[h],p="",q=a.store,t=a.boxBottoni,v={};Ext.isEmpty(e)&&(e=!0);var u=trovaRecord(q,h,n,null,!0),w=!u||u&&u.phantom,q=w?q.getProxy().api.create:q.getProxy().api.update;if(null==q)return msgShowError("ATTENZIONE","Errore salvataggio dati: URL non presente"),!1;d&&(p=d);""==p&&(p={});k&&(p.forzaRegistrazione?p.forzaRegistrazione="T":Ext.apply(p,{forceStore:!0}));Ext.Ajax.request({url:q,method:"POST",jsonData:b,
params:p,async:!1,headers:l||{},success:function(k){k=Ext.JSON.decode(k.responseText);var l=[],p="";k.msg&&null!==k.msg&&(k.message=k.msg,delete k.msg);if(k.success)v=k.data,c?(g&&g(k),a.up("window").close()):(w&&k.data&&(n=k.data[h]),a.controller?a.controller.aggiornaStore(n,k):a.aggiornaStore(n)),e&&(k.message&&"$"==k.message[0]?(k.message=k.message.substring(1),msgAddWarning(l,k.message)):(p="MSG_SALVATAGGIO_DATI",msgAdd(l,k.message)));else{if(k.message&&("?"==k.message[0]||k.message[0].testo&&
"?"==k.message[0].testo[0])){Messaggio("ATTENZIONE",k.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){controller_salvaRecord(a,b,c,d,e,g,h,!0)});return}k.message&&"$"==k.message[0]?k.message=k.message.substring(1):msgAddError(l,k.message);g&&g(k)}msgShow(p,l);m=k.success},failure:function(a){}});!m&&t&&controller_abilitaBottoni(a);return m?v:!1}
function controller_salvaRecord_GET(a,b,c,d,e,g,h,k){Ext.isEmpty(h)&&(h="id");var l=!1,m=b[h],n="",p=a.store,q=a.boxBottoni;Ext.isEmpty(e)&&(e=!0);var t=trovaRecord(p,h,m),v=!t||t&&t.phantom,p=v?p.getProxy().api.create:p.getProxy().api.update;if(null==p)return msgShowError("ATTENZIONE","Errore salvataggio dati: URL non presente"),!1;d&&(n=d);k&&(""==n?n={forceStore:!0}:n.forzaRegistrazione?n.forzaRegistrazione="T":Ext.apply(n,{forceStore:!0}));Ext.Ajax.request({url:p,method:"GET",jsonData:b,params:n,
async:!1,success:function(k){k=Ext.JSON.decode(k.responseText);var n=[],p="";if(k.success)recordRisultante=k.data,c?(g&&g(k),a.up("window").close()):(v&&k.data&&(m=k.data[h]),a.controller?a.controller.aggiornaStore(m,k):a.aggiornaStore(m)),e&&(k.message&&"$"==k.message[0]?(k.message=k.message.substring(1),msgAddWarning(n,k.message)):(p="MSG_SALVATAGGIO_DATI",msgAdd(n,k.message)));else{if(k.message&&("?"==k.message[0]||k.message[0].testo&&"?"==k.message[0].testo[0])){Messaggio("ATTENZIONE",k.message[0].testo.slice(1),
"YESNO","QUESTION",!1,function(){controller_salvaRecord_GET(a,b,c,d,e,g,h,!0)});return}k.message&&"$"==k.message[0]?k.message=k.message.substring(1):msgAddError(n,k.message);g&&g(k)}msgShow(p,n);l=k.success},failure:function(a){}});!l&&q&&controller_abilitaBottoni(a);return l?recordRisultante:!1}function controller_puoiUscire(a,b,c,d,e){b.getForm().isDirty()?Messaggio("Attenzione","MSG_DATI_DA_CONFERMARE","YESNOCANCEL","QUESTION","",c,d):e()}
function controller_eliminaRecord(a,b,c,d,e,g,h,k,l,m){l=void 0===l?{}:l;controller_eliminaRecord_obj({store:a,parametri:b,callback_aggiornaStore:c,callback_beforedelete:d,messaggio:e,titoloMessaggio:g,forceStore:h,methodType:k,headers:l,showConfirm:void 0===m?!0:m})}
function controller_eliminaRecord_obj(a){function b(){if(!a.callback_beforedelete||a.callback_beforedelete(a.parametri)){var b=["GET","POST"].includes(a.methodType)?a.methodType:"GET";Ext.Ajax.request({method:b,url:a.store.getProxy().api.destroy,async:!1,params:a.parametri,timeout:a.timeout?a.timeout:3E4,headers:a.headers,success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),a.callback_aggiornaStore&&a.callback_aggiornaStore(c)):b.message&&("?"==b.message[0]||
b.message[0].testo&&"?"==b.message[0].testo[0])?Messaggio("ATTENZIONE",b.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){controller_eliminaRecord(a)}):msgAddError(c,b.message);msgShow("MSG_ELIMINAZIONE_DATI",c)},failure:function(a){}})}}if(a.forceStore)a.parametri.forzaRegistrazione="T",b();else if(a.store.tree||0!==a.store.getTotalCount()){var c=a.store.controller&&a.store.controller.modeAnnullabile,d=a.messaggio?a.messaggio:c?"MSG_ANNULLA_RECORD":"MSG_ELIMINA",c=a.titoloMessaggio?a.titoloMessaggio:
c?"ANNULLA_RECORD":"Elimina";if(a.showConfirm)return Messaggio(c,d,"YESNOCANCEL","QUESTION","",function(){b()});b()}else return Messaggio("Elimina","MSG_NORECORD","OK","WARNING")}
Ext.define("Generali.standard.datePicker.Store",{extend:"Ext.data.Store",fields:[{name:"lun",type:"date"},{name:"mar",type:"date"},{name:"mer",type:"date"},{name:"gio",type:"date"},{name:"ven",type:"date"},{name:"sab",type:"date"},{name:"dom",type:"date"},{name:"stato_lun"},{name:"stato_mar"},{name:"stato_mer"},{name:"stato_gio"},{name:"stato_ven"},{name:"stato_sab"},{name:"stato_dom"}],autoDestroy:!0});
Ext.define("Generali.standard.datePicker.View",{extend:"Ext.grid.Panel",alias:"widget.cbaDatePicker",titleAlign:"center",selType:"cellmodel",sortableColumns:!1,viewConfig:{autoLoad:!1},initComponent:function(){var a=this;a.listaIdGg=[];a.listaGg=[];a.store=Ext.create("Generali.standard.datePicker.Store");a.columns=[{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?
this.cbaConfig.widget:!1,dataIndex:"lun",align:"center",text:this.cbaConfig.labelGgExt?traduci("LUNEDI"):traduci("L"),flex:1,minWidth:20,renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"mar",align:"center",text:this.cbaConfig.labelGgExt?traduci("MARTEDI"):traduci("M"),flex:1,minWidth:20,
renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"mer",align:"center",text:this.cbaConfig.labelGgExt?traduci("MERCOLEDI"):traduci("M"),flex:1,minWidth:20,renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?
this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"gio",align:"center",text:this.cbaConfig.labelGgExt?traduci("GIOVEDI"):traduci("G"),flex:1,minWidth:20,renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"ven",align:"center",
text:this.cbaConfig.labelGgExt?traduci("VENERDI"):traduci("V"),flex:1,minWidth:20,renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"sab",align:"center",text:this.cbaConfig.labelGgExt?traduci("SABATO"):traduci("S"),flex:1,minWidth:20,renderer:a.rendererCell},{xtype:this.cbaConfig.usaWidgetCella?
"widgetcolumn":"datecolumn",onWidgetAttach:this.cbaConfig.onWidgetAttach?this.cbaConfig.onWidgetAttach:!1,widget:this.cbaConfig.usaWidgetCella&&this.cbaConfig.widget?this.cbaConfig.widget:!1,dataIndex:"dom",align:"center",text:this.cbaConfig.labelGgExt?traduci("DOMENICA"):traduci("D"),flex:1,minWidth:20,renderer:a.rendererCell}];this.cbaConfig&&this.cbaConfig.scartaHeaderStd||(a.tools=[{xtype:"tool",type:"prev",itemId:"BtnMesePrec",reference:"BtnMesePrec",handler:function(){1==a.mese?(a.mese=12,a.anno--):
a.mese--;a.updateMonth(a.mese,a.anno)}},{xtype:"tool",type:"next",itemId:"BtnMeseSuc",reference:"BtnMeseSuc",handler:function(){12==a.mese?(a.mese=1,a.anno++):a.mese++;a.updateMonth(a.mese,a.anno)}},{xtype:"tool",type:"close",tooltip:traduci("ANNULLA"),itemId:"BtnClearSelection",reference:"BtnClearSelection",handler:function(){a.resetSelection()}}]);if(this.cbaConfig.mese&&this.cbaConfig.anno)a.mese=this.cbaConfig.mese,a.anno=this.cbaConfig.anno;else{var b=new Date;a.mese=b.getMonth()+1;a.anno=b.getFullYear()}a.giorniSel=
[];a.callParent(arguments);a.updateMonth(a.mese,a.anno)},rendererCell:function(a,b,c,d,e,g){if(a){var h;switch(e){case 0:h="lun";break;case 1:h="mar";break;case 2:h="mer";break;case 3:h="gio";break;case 4:h="ven";break;case 5:h="sab";break;case 6:h="dom"}b.tdCls=c.get("stato_"+h)?"selezionato":""}return FormattaData(a,"d")},updateMonth:function(a,b){a=parseInt(a,10);b=parseInt(b,10);this.mese=a;this.anno=b;var c=this.getStore(),d=creaData(1,a,b),e=dataFineMese(a,b),g,h={};Ext.suspendLayouts();this.cbaConfig&&
this.cbaConfig.scartaHeaderStd||this.setTitle(traduci(getMese(a))+" "+b);svuotaStore(c);for(var k;d<=e;){g=parseInt(Ext.Date.format(d,"w"),10);k=!1;Ext.each(this.giorniSel,function(a){a.getTime()==d.getTime()&&(k=!0)});switch(g){case 0:h.dom=d;h.stato_dom=k;break;case 1:h.lun=d;h.stato_lun=k;break;case 2:h.mar=d;h.stato_mar=k;break;case 3:h.mer=d;h.stato_mer=k;break;case 4:h.gio=d;h.stato_gio=k;break;case 5:h.ven=d;h.stato_ven=k;break;case 6:h.sab=d,h.stato_sab=k}if(0==g||Ext.Date.isEqual(d,e))c.loadData([h],
!0),h={};g=Ext.Date.clone(d);g.setDate(g.getDate()+1);d=new Date(g)}Ext.resumeLayouts(!0)},listeners:{cellclick:function(a,b,c,d,e,g,h,k){if(!this.cbaConfig||!this.cbaConfig.scartaCellClickStd){var l=a.up().columns[a.up().getSelectionModel().getCurrentPosition().column],m=d.data[l.dataIndex],n=this;if(m){Ext.fly(b.id);var p=!1;Ext.each(n.giorniSel,function(a,b){a&&a.getTime()==m.getTime()&&(p=!0,n.giorniSel.splice(b,1),d.set("stato_"+l.dataIndex,!1))});p||(n.giorniSel.push(m),d.set("stato_"+l.dataIndex,
!0));n.getSelectionModel().setCurrentPosition()}}}},getValue:function(){return this.giorniSel},setValue:function(a){var b=this,c=this.store,d;this.resetSelection();Ext.each(a,function(a){d=parseInt(Ext.Date.format(a,"w"),10);switch(d){case 0:d="dom";break;case 1:d="lun";break;case 2:d="mar";break;case 3:d="mer";break;case 4:d="gio";break;case 5:d="ven";break;case 6:d="sab"}c.each(function(c){Ext.Date.format(c.get(d),"d/m/Y")==Ext.Date.format(a,"d/m/Y")&&(c.set("stato_"+d,!0),b.giorniSel.push(c.get(d)))})})},
resetSelection:function(){this.giorniSel=[];Ext.suspendLayouts();this.store.each(function(a){a.set("stato_lun",!1);a.set("stato_mar",!1);a.set("stato_mer",!1);a.set("stato_gio",!1);a.set("stato_ven",!1);a.set("stato_sab",!1);a.set("stato_dom",!1)});Ext.resumeLayouts()}});
Ext.define("Generali.standard.indiciDocumentale.controller.WinIndiciDocumentale",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"ContainerDettagli",selector:this.selContainer+"#ContainerDettagli"},{ref:"GridIndici",selector:this.selContainer+"#GridIndici"},{ref:"boxBottoni",selector:this.selContainer+"#boxBottoni"},{ref:"Form",selector:this.selContainer+
"#Form"},{ref:"valore",selector:this.selContainer+"#valore"}]);this.control(this.selContainer+"#GridIndici",{beforeedit:this.onGridroweditingpluginBeforeEdit,canceledit:this.onGridroweditingpluginCanceledit,edit:this.onGridroweditingpluginEdit,validateedit:this.onGridroweditingpluginValidateedit})},checkCampiObbligatori:function(a){for(var b=!0,c=0;c<a.items.length;c+=1)a.items[c].data.obbligatorio&&!Ext.isDefined(a.items[c].data.valore)&&(b=!1);return b},onGridroweditingpluginBeforeEdit:function(a,
b,c,d){this.aggiornaView(this.id_profilo,this.records,a,b,c,d)},onGridroweditingpluginCanceledit:function(){},onGridroweditingpluginEdit:function(a,b,c,d){},onGridroweditingpluginValidateedit:function(a,b,c){this.abilitaBottoni(b);return!0},abilitaBottoni:function(a){var b=this.getForm(),c=!0;b.boxBottoni=this.getBoxBottoni();b.boxBottoni.queryById("_btnNuovoBoxBottoni").hide();b.boxBottoni.queryById("_btnEliminaBoxBottoni").hide();this.getGridIndici().getStore().each(function(b){"T"==b.get("obbligatorio")&&
(a.newValues.descrizione==b.get("descrizione")?Ext.isEmpty(a.newValues.valore)&&(c=!1):Ext.isEmpty(b.get("valore"))&&(c=!1))});c&&0<this.getGridIndici().getStore().getCount()?(this.getForm().boxBottoni.queryById("_btnConfermaBoxBottoni").enable(),this.getForm().boxBottoni.queryById("_btnAnnullaBoxBottoni").enable()):(this.getForm().boxBottoni.queryById("_btnConfermaBoxBottoni").disable(),this.getForm().boxBottoni.queryById("_btnAnnullaBoxBottoni").disable())},verificaCampiForm:function(){return!0},
aggiornaStore:function(a){var b=this,c=b.getGridIndici().getStore();b.id_profilo=null;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/getIdProfiloByIdStampa",params:{idStampa:b.cbaConfig.idStampa},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(b.id_profilo=a.data,c.load({params:{id_profilo:b.id_profilo,soloPerson:"T"},callback:function(a,c,d){d?0==a.length?(b.cbaConfig.callbackRitorno(a),b.getForm().up("window").close()):b.records=a:(msgShowError(traduci("MSG_ERRORE_SERVER_GENERICO"),
c),b.getForm().up("window").close())}})):(msgShowError("",a.message[0].testo),b.getForm().up("window").close())}})},aggiornaView:function(a,b,c,d,e,g){c=null;b=b[d.rowIdx];"L"!=b.get("tipoDato")?"textfield"!=this.getGridIndici().getColumns()[2].getEditor().getXType()&&(this.getGridIndici().getColumns()[2].setEditor({xtype:"textfield"}),c=!1):"L"==b.get("tipoDato")&&"combo"!=this.getGridIndici().getColumns()[2].getEditor().getXType()&&(this.getGridIndici().getColumns()[2].setEditor({xtype:"combo",
store:Ext.create("Generali.standard.indiciDocumentale.store.IndiciDocList",{autoLoad:!1}),displayField:"descrizione",valueField:"descrizione"}),c=!0);c&&this.getGridIndici().getColumns()[2].getEditor().getStore().load({params:{id_profilo:a,idCampi:b.get("idCampo")}})},salva:function(){var a=this.getGridIndici().getStore().data;this.cbaConfig.callbackRitorno(a);this.getForm().up("window").close()},esci:function(){this.uscitaBtn=!0;this.getForm().up("window").close()},onLaunch:function(){var a=this;
a.getForm();a.getGridIndici().controller=a;var b=Ext.create("Generali.standard.PannelloBottoniVert",{id:"BoxBottoni",itemId:"BoxBottoni",cbaConfig:{conferma_callback:function(){a.salva()},esci_callback:function(){a.esci()},annulla_callback:function(){a.aggiornaStore()},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});a.aggiornaStore();inserisciBottoni(a.getBoxBottoni(),b);a.abilitaBottoni()},destroy:function(){this.callParent()}});
Ext.define("Generali.standard.indiciDocumentale.store.IndiciDoc",{extend:"Ext.data.Store",fields:[{name:"idProfilo"},{name:"idcampo"},{name:"descrizione"},{name:"tipoDato"},{name:"coll_sipcar"},{name:"obbligatorio"},{name:"ordine"},{name:"suggerisci_tutti"},{name:"nascosto"},{name:"disattivato"},{name:"digitalizzazione"},{name:"valore"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/getIndiciDocByProfilo",timeout:18E4,reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.standard.indiciDocumentale.store.IndiciDocList",{extend:"Ext.data.Store",fields:[{name:"idProfilo"},{name:"idcampi"},{name:"autoinc"},{name:"descrizione"},{name:"attivo"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/getIndiciDocList",timeout:18E4,reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.standard.indiciDocumentale.view.WinIndiciDocumentale",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"form",itemId:"Form",reference:"Form",trackResetOnLoad:!0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",flex:.8,items:[{xtype:"gridpanel",itemId:"GridIndici",reference:"GridIndici",store:Ext.create("Generali.standard.indiciDocumentale.store.IndiciDoc"),height:320,margin:5,columns:[{xtype:"gridcolumn",flex:1,
dataIndex:"descrizione",text:"DESCRIZIONE"},{xtype:"gridcolumn",width:80,dataIndex:"obbligatorio",text:"OBBLIGATORIO",renderer:function(a,b,c,d,e,g,h){return renderCheckColumn(b,a)}},{xtype:"gridcolumn",flex:1,dataIndex:"valore",text:"VALORE",editor:{xtype:"textfield"}}],viewConfig:{loadMask:!1},selType:"cellmodel",plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})]}]},{xtype:"panel",region:"east",itemId:"boxBottoni",reference:"boxBottoni",margin:5,flex:.2}]}]});this.callParent(arguments)}});
Ext.define("Generali.standard.profiliStampe.controller.Gestione",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Grid",selector:this.selContainer+"#Grid"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"}]);this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#Grid",{beforeedit:this.beforeeditGrid,edit:this.editGrid,canceledit:this.canceleditGrid,
validateedit:this.validateeditGrid})},clickBtnElimina:function(a){var b=this;a=b.getGrid();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGrid:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},editGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,!1)?this.abilitaBottoniGrid(!0):a.startEdit(b.record,
0)},canceleditGrid:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGrid:function(a,b,c){return!0},abilitaBottoniGrid:function(a){this.getBtnElimina().setDisabled(!a)},aggiornaStore:function(a){var b=this.getGrid(),c=b.getStore();c.load({params:{idModulo:CBA.moduli.moduloAttivo,codStampa:this.cbaConfig.codStampa,idGruppo:getIdGruppo()},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?
[d]:0)):msgShowError("",e.getError())}})},onLaunch:function(){this.aggiornaStore()},destroy:function(){eliminaStore(this.comboGiustif);this.callParent()}});
Ext.define("Generali.standard.profiliStampe.controller.Profili",{extend:"Generali.standard.ViewController",id_record:null,init:function(){var a="#"+this.containerId+" ";this.erroreDivisione=traduci("ERRORE_DIVISIONE");this.callParent(arguments);this.PROF_STAMPE_PROFILI=traduci("PROF_STAMPE_PROFILI");this.PROF_STAMPE_MSG_SOVRASCRIVI=traduci("PROF_STAMPE_MSG_SOVRASCRIVI");this.PROF_STAMPE_SOVRASCRIVI=traduci("PROF_STAMPE_SOVRASCRIVI");this.SALVA=traduci("SALVA");this.NUOVO=traduci("NUOVO");this.ESCI=
traduci("ESCI");this.PROF_STAMPE_GESTIONE_PROFILI=traduci("PROF_STAMPE_GESTIONE_PROFILI");this.PROF_STAMPE_NOME_PROFILO=traduci("PROF_STAMPE_NOME_PROFILO");this.PROF_STAMPE_NUOVO_PROFILO=traduci("PROF_STAMPE_NUOVO_PROFILO");this.CAMPO_OBBLIGATORIO=traduci("CAMPO_OBBLIGATORIO");this.addRef([{ref:"CboxProfilo",selector:a+"#CboxProfilo"}]);this.control(a+"#CboxProfilo",{change:this.changeCboxProfilo});this.separatoreFields="|"},getItemsTarget:function(){var a=this,b="",c="";this.target.query("textfield, radiogroup, checkboxfield, gridpanel, grid, CBAShortcutGrid, treepanel, cbaMultipleChoice, comboModifica").forEach(function(d){if(d.itemId&&
d.isProfileComponent&&!0===d.isProfileComponent){var e=d.getXType();"radiogroup"===e?c=d.getValue()[d.items.items[0].name]:"gridpanel"===e||"grid"===e||"CBAShortcutGrid"===e?(e=d.getStore().idProperty?d.getStore().idProperty:"id",c=getStringFromGridSelection(d,e)):"treepanel"===e?(e=d.getStore().idProperty?d.getStore().idProperty:"id",c=getListCheckedTree(d,!0,e)):c="cbaMultipleChoice"===e?d.getValueExclusive():"datefield"===e?Ext.Date.format(d.getValue(),"Y-m-d"):"timefield"===e||"timefield24"===
e?Ext.Date.format(d.getValue(),"Y-m-d H:i:s"):d.getValue();null==c&&(c="");b=b+d.itemId+"="+c+a.separatoreFields}});return b.slice(0,-1)},setItemsTarget:function(a){a=void 0===a?null:a;var b=this;this.itemsTarget&&this.itemsTarget.split(this.separatoreFields).forEach(function(c){var d=c.split("=");c=d[1];var d=b.target.down("#"+d[0]),e=d.getXType();if(d&&d.isProfileComponent&&1==d.isProfileComponent&&(null===a||d.getItemId()===a))if("radiogroup"===e)e={},d.setValue((e[d.items.items[0].name]=c,e));
else if("gridpanel"===e||"grid"===e||"CBAShortcutGrid"===e){var g=d.getStore(),h=d.getSelectionModel(),k=g.idProperty?d.getStore().idProperty:"id";Ext.suspendLayouts();h.deselectAll();c.split(",").forEach(function(a){(a=trovaRecord(g,k,a))&&h.select([a],!0)});Ext.resumeLayouts(!0)}else"treepanel"===e?b.setValuesTree(d,c):"cbaMultipleChoice"===e?d.setValueExclusive(c):"datefield"===e||"timefield"===e||"timefield24"===e?Ext.isEmpty(c)||d.setValue(new Date(c)):d.setValue(c)})},setValuesTree:function(a,
b){var c=a.getStore(),d=c.idProperty?c.idProperty:"id",e=b.split(",");a.suspendLayouts();var c=null,g=a.store.isFiltered();g&&(c=a.store.getFilters().clone(),a.store.clearFilter());a.getRootNode().cascadeBy(function(a){a.isRoot()||a.parentNode.isRoot()&&a.isLeaf()&&"cba-disabled-element"==a.get("cls")||a.isLeaf()&&a.set("checked",0<=e.indexOf(a.get(d).toString()))});g&&Ext.each(c.items,function(b){a.store.filters.add(b)});a.resumeLayouts(!0)},loadCampi:function(a,b,c){c=void 0===c?{id:a}:c;var d=
this;Ext.Ajax.request({method:"GET",url:void 0===b?"/cba/gen/ws/general/profStp/get":b,params:c,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(d.id_record=a.data&&a.data.id,d.itemsTarget=a.data&&a.data.campiStampa,d.setItemsTarget()):msgShowError("",a.message)}})},changeCboxProfilo:function(a,b){b&&this.loadCampi(b)},salva:function(a,b,c,d,e){d=void 0===d?"/cba/gen/ws/general/profStp/":d;e=void 0===e?{id:a,idModulo:CBA.moduli.moduloAttivo,idGruppo:getIdGruppo(),codStampa:this.codStampa,
idOperatore:CBA.parametriGenerali.codUtente,descrizione:b,campiStampa:this.getItemsTarget()}:e;var g=this;Ext.Ajax.request({method:"POST",url:d+(a?"update":"new"),jsonData:e,success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(g.id_record=b.data.id,c&&c(),a||g.loadCombo(b.data.id)):msgShowError("",b.message)}})},nuovo:function(){var a=this;Ext.create("Ext.window.Window",{title:this.PROF_STAMPE_NUOVO_PROFILO,modal:!0,height:130,width:400,closable:!1,layout:"fit",items:[{xtype:"container",
layout:{type:"hbox",align:"center",pack:"center"},padding:3,items:[{xtype:"textfield",itemId:"TxtDescrizione",fieldLabel:this.PROF_STAMPE_NOME_PROFILO,labelClsExtra:"cbaLabel",flex:1}]}],buttonAlign:"center",buttons:[{xtype:"button",text:this.SALVA,handler:function(b){var c=b.up("window");if(b=c.down("#TxtDescrizione").getValue())a.salva(null,b,function(){return c.close()});else return b=[],msgAddError(b,a.PROF_STAMPE_NUOVO_PROFILO+a.CAMPO_OBBLIGATORIO),msgShow("",b)}},{xtype:"button",text:this.ESCI,
handler:function(a){a.up("window").close()}}],listeners:{afterrender:function(a){setTimeout(function(){a.down("#TxtDescrizione").focus()},100)}}}).show()},gestione:function(){var a=this,b=Ext.create("winCBA",{name:"Generali.standard.profiliStampe.view.Gestione",titolo:this.PROF_STAMPE_GESTIONE_PROFILI,dimensione:3,closable:!0,configItem:{permesso:"S",codStampa:this.codStampa}});b.show();b.on("close",function(){a.loadCombo()})},openMessage:function(){var a=this,b=this.getCboxProfilo(),c=b.getValue();
Ext.create("Ext.window.Window",{title:this.PROF_STAMPE_PROFILI,modal:!0,height:130,width:400,closable:!1,layout:"fit",items:[{xtype:"container",layout:{type:"hbox",align:"center",pack:"center"},items:[{xtype:"image",height:32,width:32,cls:"x-message-box-question",margin:"0 10 0 0"},{xtype:"label",html:this.PROF_STAMPE_MSG_SOVRASCRIVI}]}],buttonAlign:"center",buttons:[{xtype:"button",text:this.PROF_STAMPE_SOVRASCRIVI,hidden:!c,handler:function(d){a.salva(c,b.getSelection().get("valore"),function(){return d.up("window").close()})}},
{xtype:"button",text:this.NUOVO,handler:function(b){a.nuovo();b.up("window").close()}},{xtype:"button",text:this.PROF_STAMPE_GESTIONE_PROFILI,handler:function(b){a.gestione();b.up("window").close()}},{xtype:"button",text:this.ESCI,handler:function(a){a.up("window").close()}}]}).show()},loadCombo:function(a){var b=this.getCboxProfilo();b.getStore().load({params:{idModulo:CBA.moduli.moduloAttivo,codStampa:this.codStampa,idGruppo:getIdGruppo()},callback:function(c,d,e){e?a&&b.setValue(a):msgShowError("",
d.getError())}})},onLaunch:function(){this.getCboxProfilo().controller=this;this.loadCombo()}});
Ext.define("Generali.standard.profiliStampe.store.Profili",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idModulo"},{name:"idOperatore"},{name:"codStampa"},{name:"descrizione"},{name:"campiStampa"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/profStp/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/profStp/src",create:"/cba/gen/ws/general/profStp/new",update:"/cba/gen/ws/general/profStp/update",destroy:"/cba/gen/ws/general/profStp/delete"}},
autoDestroy:!0});Ext.define("Generali.standard.profiliStampe.store.ProfiliCbox",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/profStp/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.standard.profiliStampe.view.Gestione",{extend:"Generali.standard.ControlledContainer",initComponent:function(){this.labelSolalettura=traduci("SOLA_LETTURA");Ext.applyIf(this,{items:[{xtype:"CBAShortcutGrid",itemId:"Grid",reference:"Grid",store:Ext.create("Generali.standard.profiliStampe.store.Profili"),columns:[{xtype:"gridcolumn",flex:1,dataIndex:"descrizione",text:"DESCRIZIONE",editor:{xtype:"textfield",enforceMaxLength:!0,allowBlank:!1}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.standard.profiliStampe.view.Profili",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"combobox",itemId:"CboxProfilo",reference:"CboxProfilo",minChars:0,displayField:"valore",valueField:"codice",queryMode:"local",emptyText:"SELEZIONA_PROFILO",store:Ext.create("Generali.standard.profiliStampe.store.ProfiliCbox"),triggers:{salva:{cls:"icon-save",tooltip:traduci("SALVA_IMPOSTAZIONI"),itemID:"BtnSave",reference:"BtnSave",
handler:function(){a.controller.openMessage()}}}}]});a.callParent(arguments)}});
Ext.define("Generali.standard.stampe.Button",{extend:"Ext.button.Split",alias:"widget.newButtonStampa",iconCls:CBA&&CBA.moduli&&CBA.moduli.moduloAttivo&&49==CBA.moduli.moduloAttivo?"":"icon-stampa32",scale:"large",hide_text:!1,initComponent:function(){0==this.hide_text&&this.setText(this.getText()?this.getText():traduci("STAMPA"));this.menu={xtype:"menu",itemId:"BtnStampa_menu",showSeparator:!1,plain:!0,items:[{xtype:"menuitem",itemId:"BtnStampa_Pdf",text:'<div style="display: inline-block; margin-bottom: 5px;"><img style="border:0 !important; height: 32px; width: 32px; vertical-align: middle" class="icon-pdf" src="'+
Ext.BLANK_IMAGE_URL+'"></img>'+traduci("STAMPA_PDF")+"</div>"},{xtype:"menuitem",itemId:"BtnStampa_Excel",text:'<div style="display: inline-block; margin-bottom: 5px;"><img style="border:0 !important; height: 32px; width: 32px; vertical-align: middle" class="icon-xls" src="'+Ext.BLANK_IMAGE_URL+'"></img>'+traduci("ESPORTA_XLS")+"</div>"},{xtype:"menuitem",itemId:"BtnStampa_Csv",text:'<div style="display: inline-block; margin-bottom: 5px;"><img style="border:0 !important; height: 32px; width: 32px; vertical-align: middle" class="icon-csv" src="'+
Ext.BLANK_IMAGE_URL+'"></img>'+traduci("ESPORTA_CSV")+"</div>"},{xtype:"menuitem",itemId:"BtnStampa_Xml",text:'<div style="display: inline-block; margin-bottom: 5px;"><img style="border:0 !important; height: 32px; width: 32px; vertical-align: middle" class="icon-xml" src="'+Ext.BLANK_IMAGE_URL+'"></img>'+traduci("ESPORTA_XML")+"</div>"},{xtype:"menuitem",itemId:"BtnStampa_Text",text:'<div style="display: inline-block;"><img style="border:0 !important; height: 32px; width: 32px; vertical-align: middle" class="icon-txt" src="'+
Ext.BLANK_IMAGE_URL+'"></img>'+traduci("ESPORTA_TXT")+"</div>"}]};this.callParent(arguments)},listeners:{render:function(){CBA&&CBA.moduli&&CBA.moduli.moduloAttivo&&49!=CBA.moduli.moduloAttivo&&("small"==this.scale?this.setIconCls("icon-stampa16"):"medium"==this.scale?this.setIconCls("icon-stampa"):this.setIconCls("icon-stampa32"))}}});
Ext.define("Generali.standard.stampe.Controller",{extend:"Generali.standard.ViewController",parametriStampa:{url:"foobar",hideBtnStampaOnSecondaryWin:!1,titolo:"Stampa",reportDaEsportare:!1,winElaborazione:!1,list:[],params:{format:"pdf",defaultFormat:"pdf"}},constructor:function(a){a.parametriStampa=Ext.apply({},this.parametriStampa,this.superclass.parametriStampa);this.callParent([a])},init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnStampa",selector:a+
"#BtnStampa"}]);(a=this.getBtnStampa())&&(!1===a.showPreview||a.up("panel")&&"stampaCBA"==a.up("panel").getXType()?this.configurePrintButton(a,"print"):this.configurePrintButton(a,"preview"))},configurePrintButton:function(a,b){var c=this,d,e,g,h="print"==b?c.printButtonClick:c.previewButtonClick;a.on("click",h,c);a.menu&&a.menu.items&&(c.parametriStampa&&!Ext.isEmpty(c.parametriStampa.list)&&c.parametriStampa.list.forEach(function(b){return a.menu.add(b)}),a.menu.items.each(function(a){a.on("click",
h,c)}),c.parametriStampa.hideMenu?(a.menu.setHeight(0),a.setArrowVisible(!1)):a.menu.items.each(function(a){d=a.getItemId();if(g=d.split("_"))e=g[1].toLowerCase(),(c.parametriStampa["hide"+Ext.String.capitalize(e)]||"pdf"!=e&&49==CBA.moduli.moduloAttivo&&!c.parametriStampa.ignoreFormatCss)&&a.hide()}))},previewButtonClick:function(a){var b=a.getItemId();a=this.parametriStampa.params.defaultFormat;b=0>b.indexOf("_")?a:b.split("_")[1].toLowerCase();this.showPrintPreview(b);this.parametriStampa.params.defaultFormat=
a},printButtonClick:function(a){var b=a.getItemId(),c=this.parametriStampa.params.defaultFormat,b=0>b.indexOf("_")?c:b.split("_")[1].toLowerCase();a.isButton||(a=a.up("button"));this.doPrint(a,b);this.parametriStampa.params.defaultFormat=c},showPrintPreview:function(a){var b=this.parametriStampa;this.winStampa=Ext.create("winCBA",{name:[{xtype:"stampaCBA",useNewButtonStampa:!0}],titolo:b.titolo,dimensione:1});Ext.isDefined(a)&&(b.params.format=a);b.hideBtnStampaOnSecondaryWin&&(a=this.winStampa.down("stampaCBA"))&&
(a=a.tabBar)&&(a=a.queryById("BtnStampa"))&&a.hide();this.winStampa.show(null,Ext.bind(this.configurePreviewWindow,this,[this.winStampa]))},configurePreviewWindow:function(a){a=a.down("#BtnStampa");this.configurePrintButton(a,"print");this.doPrint(a)},afterAnnulla:function(a){Ext.isDefined(this.getBtnStampa)&&this.getBtnStampa()&&this.getBtnStampa().setDisabled(!1);var b;Ext.isDefined(this.getCntProgressBar)&&(b=this.getCntProgressBar());b&&b.pbar&&(b.pbar=void 0)},doPrint:function(a,b,c){var d=this,
e=d.parametriStampa,g=a.up("tabpanel"),h=g.down("#PageAnteprima"),k=g.down("#CntProgressBar"),l=h.queryById("iframePdf");Ext.isDefined(b)&&(e.params.format=b);Ext.isDefined(c)||(c=!0);g.setActiveTab(h);e.renderTo=h;e.params=Ext.apply({},{reportDaEsportare:"pdf"!=e.params.format},e.params);var m;this.cbaConfig.winElaborazione&&(m=newIdElab(),Ext.apply(e.params,{idAvanzamentoElaborazione:m}));c?k.setVisible(!1):d.creaWinElaborazioneSenzaPopUp(d,m,k,l);this.cbaConfig.idStampaDocumentale?"UPL_DOC"===
b?Ext.create("winCBA",{name:"Generali.standard.indiciDocumentale.view.WinIndiciDocumentale",titolo:"INDICI_PERSONALIZZATI_ARCHIV_DOC",altezzaWin:380,larghezzaWin:650,configItem:{idStampa:d.cbaConfig.idStampaDocumentale,callbackRitorno:function(b){var c="";0<b.length&&b.items.forEach(function(a){Ext.isDefined(a.data.valore)&&(""!=c&&(c+=","),c+='{"codice":'+a.data.idCampo+',"valore":"'+a.data.valore+'"}')});""!=c&&Ext.apply(e.params,{indiciDocumentale:"["+c+"]"});d.getBtnArchiviaDocumentale()?stampaEsporta(d.getBtnArchiviaDocumentale(),
e,Ext.bind(d.afterArchiviazione,d)):stampaEsporta(a,e,Ext.bind(d.afterArchiviazione,d))}},closable:!1}).show():(c&&d.creaWinElaborazione(d,m,l),Ext.isDefined(d.getBtnArchiviaDocumentale)?stampaEsporta(d.getBtnArchiviaDocumentale(),e,Ext.bind(d._afterPrint,d)):stampaEsporta(a,e,Ext.bind(d._afterPrint,d))):(c&&d.creaWinElaborazione(d,m,l),49==CBA.moduli.moduloAttivo&&(this.cbaConfig.desVideata||this.cbaConfig.controllerTestata)&&(CBA.moduli.modulo49.dizionarioLogVideate[this.$className]={desVideata:this.cbaConfig.desVideata?
this.cbaConfig.desVideata:this.cbaConfig.controllerTestata.cbaConfig.desVideata?this.cbaConfig.controllerTestata.cbaConfig.desVideata:this.cbaConfig.controllerTestata.cbaConfig.codVideata},doLogVideata(this.view,{className:this.$className,desVideata:this.cbaConfig.desVideata?this.cbaConfig.desVideata:this.cbaConfig.controllerTestata.cbaConfig.desVideata?this.cbaConfig.controllerTestata.cbaConfig.desVideata:this.cbaConfig.controllerTestata.cbaConfig.codVideata,logOspite:0<CBA.moduli.modulo49.storeAnagraficaSel.getData().items.length?
!0:!1,tipoOperazione:"R"})),stampaEsporta(a,e,Ext.bind(d._afterPrint,d)))},creaWinElaborazione:function(a,b,c){a=this;setTimeout(function(){a.cbaConfig.winElaborazione&&Ext.create("winElaborazione",{idElaborazione:b,alwaysOnTop:!0,afterAnnulla:Ext.bind(a.afterAnnulla,a),callback_ok:function(){c||a.cbaConfig.erroreStampa||inizioAttesa()}}).start()},10)},creaWinElaborazioneSenzaPopUp:function(a,b,c,d){this.cbaConfig.winElaborazione&&(c.pbar||(a=Ext.create("winElaborazioneNoPopup",{idElaborazione:b,
alwaysOnTop:!0,afterAnnulla:Ext.bind(a.afterAnnulla,a),callback_ok:function(){d||inizioAttesa()}}),c.pbar=a,c.add(a)),c.setVisible(!0),c.pbar.start())},afterPrint:Ext.emptyFn,_afterPrint:function(a){fineAttesa();this.afterPrint(a)},afterArchiviazione:function(a){-1!==a.message[0].testo.indexOf("Operazione eseguita con successo")?Messaggio("ATTENZIONE","ARCHIVIAZIONE_TERMINATA","OK","INFORMATION"):Messaggio("ATTENZIONE","DOCUMENTI_NON_ARCHIVIATI\n"+a.message[0].testo,"OK","INFORMATION")}});
var terminationEvent="onpagehide"in self?"pagehide":"unload",channel_cba=new BroadcastChannel("channel-cba"),ws_refresh_token="/cba/gen/auth/refreshJwt",ws_jwt_exclude=["/CBA/GEN/WS/GENERAL/NTF/COUNT"],type_message_channel={REDIRECT_TO_LOGIN:"REDIRECT_TO_LOGIN"},CBATipoAuth={SIPCAR2:"",AZURE:"Azure"},numChiamateInizioAttesa=0,CBAServerTimeGAP=0,CBAMessageChannel=function(a,b){this.type=a;this.data=void 0===b?null:b};window.addEventListener("keydown",function(a){"F5"===a.key&&(f5_pressed=!0)});
function loadScript(a,b,c){Ext.Loader.loadScript({url:a,onLoad:function(){b&&b()},onError:function(){c&&c()}})}
function insertTipologiaCss(a){var b=a.getTabApplicativi();if(!Ext.isEmpty(b.down("#CntTipologia")))return!1;Ext.require("GeneraliCS.anagrafica.store.CboxTipologiaCartella");a.storeTipologia=Ext.create("GeneraliCS.anagrafica.store.CboxTipologiaCartella");var c=Ext.create("Ext.Container",{itemId:"CntTipologia",layout:{type:"hbox",align:"center",pack:"end"},items:[{xtype:"label",style:{"font-size":"20px","font-family":"Oswald"}},{xtype:"button",cls:"btnLarge",itemId:"BtnTipologia",formBind:!0,margin:"10 5 0 5",
width:40,hidden:CBA.moduli.modulo49.cartella_old,iconCls:"icon-change-org",scale:"large",listeners:{click:function(b){if(Ext.isDefined(a.menu)&&"MenuStoreTip"===a.menu.getItemId())return a.menu.show(),!1;a.menu=Ext.create("Ext.menu.Menu",{showSeparator:!1,items:[],itemId:"MenuStoreTip"});a.storeTipologia.getData().items.forEach(function(b){a.menu.add([{xtype:"menuitem",text:b.get("valore"),cbaConfig:{codice:b.get("codice"),idProfiloPwdDeCss:b.get("extra"),cbaidProfiloPwdDe:CBA.parametriGenerali.idProfiloPwdDe},
handler:function(a){Ext.isEmpty(a.cbaConfig)||(localStorage.setItem("idProfiloCss",a.cbaConfig.codice),localStorage.setItem("cbaidProfiloPwdDe",a.cbaConfig.cbaidProfiloPwdDe),localStorage.setItem("idProfiloPwdDeCss",a.cbaConfig.idProfiloPwdDeCss),localStorage.setItem("filtroRepartoCss",CBA.parametriGenerali.filtroRepartoCss),localStorage.setItem("filtroServiziCss",CBA.parametriGenerali.filtroServiziCss),localStorage.setItem("filtroMedico",CBA.parametriGenerali.filtroMedico),openSecondaryWin(!0))}}])});
a.menu.showBy(b,!1,[0,0])}}}]});b.tabBar.insert(c);Ext.Ajax.request({url:"/cba/gen/ws/pwd/utentipwd/get",method:"GET",async:!1,params:{codUtente:CBA.parametriGenerali.codUtente},success:function(b){a.utentePwd=Ext.JSON.decode(b.responseText)}});a.storeTipologia.load({params:{idProfiloPwdDe:CBA.parametriGenerali.idProfiloPwdDe},callback:function(b,e,g){b.forEach(function(b){b.get("codice")==CBA.parametriGenerali.idProfiloCss&&(c.down("label").setText(b.get("valore")),a.storeTipologia.remove(b))});
c.down("button").setHidden(0==a.storeTipologia.data.length)}})}function loadScripts(a,b,c){var d=a.length;Ext.each(a,function(a){loadScript(a,function(){1==d&&b&&b();return--d},c)})}function inizioAttesa(){numChiamateInizioAttesa++;Ext.getBody().setStyle("cursor","wait");1==numChiamateInizioAttesa&&Ext.getBody().mask(Localizer.getLocalizedString("MSG_CARICAMENTO_DATI")).setZIndex(5E4)}
function fineAttesa(a){numChiamateInizioAttesa--;if(a||0>numChiamateInizioAttesa)numChiamateInizioAttesa=0;0==numChiamateInizioAttesa&&(Ext.getBody().setStyle("cursor","default"),Ext.getBody().unmask())}function isSecondWinCss(){return"T"==sessionStorage.getItem("isSecondWinCss")}function setTitleDocument(a){isSecondWinCss()?document.title=traduci("TAB_SECONDARO_CSS")+" "+a:document.title=a}
function openSecondaryWin(a){a=void 0===a?!1:a;var b=encodeURI(CBA.parametriGenerali.nomeUtente.replace("/\\/g","\\")),c=sessionStorage.getItem("TabHash"),d=isSecondWinCss()?"T":"F",e=CBA.parametriGenerali.filtroRepartoCss;e&&localStorage.setItem("current_filtriRepartiCss",e);a?window.open(window.location.origin+"/cba/?loginParams="+b+"&0&0&"+CBA.moduli.moduloAttivo+"&T&"+d,"_self"):(sessionStorage.removeItem("TabHash"),window.open(window.location.origin+"/cba/?loginParams="+b+"&0&0&"+CBA.moduli.moduloAttivo+
"&T&T","_blank"),sessionStorage.setItem("TabHash",c),sessionStorage.setItem("isSecondWinCss",d))}window.addEventListener(terminationEvent,function(a){sessionStorage.setItem("cbaLastUnload",Date.now())},{capture:!0});window.onbeforeunload=function(a){if("T"!=localStorage.getItem("cbaLogoutEseguito"))return""};
window.onunload=function(a){if(a=sessionStorage.getItem("TabHash")){var b=JSON.parse(localStorage.getItem("CbaTabsOpen")||"{}");delete b[a];localStorage.setItem("CbaTabsOpen",JSON.stringify(b))}localStorage.removeItem("cartella_old");localStorage.removeItem("ricovero_old")};function countOpenedTabs(a){a=void 0===a?!1:a;var b=JSON.parse(localStorage.getItem("CbaTabsOpen")||"{}"),b=Object.values(b);return a?b.filter(function(a){return"F"==a}).length:b.length}
function areOpenedOnlySecondaryTabs(){var a=JSON.parse(localStorage.getItem("CbaTabsOpen")||"{}"),a=Object.values(a);return 0<a.length&&a.every(function(a){return"T"==a})}
function abort_and_redirect_to_login(a){a=void 0===a?!0:a;localStorage.setItem("cbaLogoutEseguito","T");localStorage.removeItem("cba_jwt_token");localStorage.removeItem("cba_jwt_refresh_token");localStorage.removeItem("access_token_dm7");localStorage.removeItem("cartella_old");localStorage.removeItem("ricovero_old");sessionStorage.removeItem("isSecondWinCss");sessionStorage.removeItem("abilitaModificaProfiliCU2");a&&(sessionStorage.setItem("cbaRedirectToLogin","T"),Ext.Ajax.abortAll(),window.location=
"/cba/login.html")}function handle_401(a,b){localStorage.setItem("cba_last_401_url",JSON.stringify([a.url,a.headers,a.params,new Date]));(a.url===ws_refresh_token||b.responseText&&"session not found"===b.responseText.toLowerCase())&&abort_and_redirect_to_login()}
Ext.Ajax.on("requestexception",function(a,b,c,d){a=localStorage.getItem("cbaErroreConnessione");d="T"==localStorage.getItem("cbaLogoutEseguito");fineAttesa(!0);localStorage.removeItem("access_token_dm7");0==b.status&&b.timedout?(a&&"F"!=a||localStorage.setItem("cbaErroreConnessione","T"),localStorage.removeItem("cartella_old"),localStorage.removeItem("ricovero_old"),alert(Localizer.getLocalizedString("MSG_TIMEOUT"))):401==b.status?handle_401(c,b):503==b.status||412==b.status||404==b.status?a&&"F"!=
a||Messaggio(d?"ATTENZIONE":"MSG_ERRORE_SERVER_GENERICO",d?"MSG_LOGOUT_ESEGUITO":b.responseText,"OK",d?"WARNING":"ERROR",404==b.status?null:function(){abort_and_redirect_to_login()}):a&&"F"!=a||(localStorage.setItem("cbaErroreConnessione","T"),d||(c=b.statusText,0==b.status&&(c=Localizer.getLocalizedString("MSG_SERVER_UNAVAILABLE")+"\n"+b.statusText),-1!=b.status&&alert(Localizer.getLocalizedString("MSG_ERRORE_SERVER")+" ["+b.status+"]:\n"+c)))});
Ext.onReady(function(){Ext.define("CBA.AbstractStore",{override:"Ext.data.AbstractStore",constructor:function(a){var b=Ext.isDefined(this.config)&&this.config.model?this.config.model:null;this.callParent([a]);b&&this.model&&(this.model.$className=b);this.cbaConfig=this.cbaConfig||{};return this}});Ext.define("CBA.AbstractComponent",{override:"Ext.AbstractComponent",constructor:function(a){this.callParent([a]);this.cbaConfig=this.cbaConfig||{};return this}});Ext.String.rightPad=function(a,b,c){for(c=
c||" ";a.length<b;)a+=c;return a};Ext.override(Ext.form.field.Base,{isValid:function(){var a=this.callParent();this.cbaConfig&&Ext.isDefined(this.cbaConfig.erroreBloccante)&&(a=!this.cbaConfig.erroreBloccante);return a}});Ext.apply(Ext.data.field.Date.prototype,{dateFormat:"c"});Ext.form.field.File&&Ext.apply(Ext.form.field.File.prototype,{buttonText:traduci("ALLEGA_FILE")});Ext.EventManager.addListener(Ext.getBody(),"keydown",function(a){"text"!=a.getTarget().type&&"password"!=a.getTarget().type&&
"textarea"!=a.getTarget().type&&"8"==a.getKey()&&a.preventDefault()});Ext.override(Ext.grid.RowEditor,{showToolTip:function(a){},beforeEdit:function(){var a=this.up();return a.solaLettura&&1==a.solaLettura?!1:this.callParent()}});Ext.override(Ext.grid.plugin.CellEditing,{showToolTip:function(a){},beforeEdit:function(){var a=this.grid;return a.solaLettura&&1==a.solaLettura?!1:this.callParent()}});Ext.override(Ext.form.CheckboxGroup,{listeners:{afterrender:function(a){a.blankText=traduci("SELEZIONARE_UN_ELEMENTO")}}});
Ext.override(Ext.form.field.HtmlEditor,{enableAlignments:!0,enableColors:!0,enableFont:!0,enableFontSize:!0,enableFormat:!0,enableLists:!0,enableLinks:!1,enableSourceEdit:!1,afterRender:function(){this.callParent(arguments);var a=this.up("form");a&&(a=a.getForm()._record)&&(a=a.get(this.getName()),void 0!=a&&(this.textareaEl.dom.value=a))},getValue:function(){var a=this.callParent();""===a&&(a=null);return a},setValue:function(a){this.callParent([a])},initEditor:function(){this.callOverridden();var a=
this.getDoc();Ext.isChrome&&a.addEventListener("keydown",function(){})},fireTab:function(a){Ext.event.Event.TAB==a.keyCode&&alert("")}});Ext.override(Ext.form.field.Time,{enableKeyEvents:!0,enforceMaxLength:!0,maxLength:5,hideTrigger:!0,formatText:"",forceSelection:!1,onKeyPress:function(a,b,c){b=a.button;b=0>=a.button?a.getKey():b+1;48<=b&&57>=b||8==b||37==b||39==b||46==b||9==b?8!=b&&2==this.getRawValue().length&&this.setRawValue(this.getRawValue()+":"):a.stopEvent()},getPicker:function(){var a=
this.callParent();a.hide();return a},getValue:function(){var a=this.callParent();a&&(a=new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds()));return a},listeners:{render:function(a){a.getEl().on("dblclick",function(){a.selectText()})}}});Ext.override(Ext.form.DateField,{enableKeyEvents:!0,altFormats:"d-m-Y",enforceMaxLength:!0,maxLength:10,useStrict:!0,initComponent:function(){Ext.isDefined(this.initialConfig.startDay)||(this.startDay=Ext.picker.Date.prototype.startDay);this.callParent()},
onKeyPress:function(a,b,c){b=a.button;b=0>=a.button?a.getKey():b+1;48<=b&&57>=b||8==b||37==b||39==b||46==b||47==b||9==b?8==b||2!=this.getRawValue().length&&5!=this.getRawValue().length||this.setRawValue(this.getRawValue()+"/"):a.stopEvent()},listeners:{render:function(a){a.getEl().on("dblclick",function(){a.selectText()})}}});Ext.Ajax.on("beforerequest",function(a,b){var c=b.url.toUpperCase(),d=localStorage.getItem("cba_jwt_token"),e=localStorage.getItem("cba_jwt_refresh_token");"undefined"===d&&
(localStorage.removeItem("cba_jwt_token"),localStorage.removeItem("cba_jwt_refresh_token"),e=d=null);if(d&&-1==c.indexOf("GEN/AUTH/LOGIN")){var g=d;if(c==ws_refresh_token.toUpperCase())g=e;else{var h=Date.now()-CBAServerTimeGAP>1E3*(parseJwt(g).exp-2),d=parseJwt(d).exp>parseJwt(e).exp;(h||b.params&&b.params.force_refresh_token||d)&&Ext.Ajax.request({url:ws_refresh_token,method:"POST",async:!1,success:function(a){a=Ext.JSON.decode(a.responseText).data.split(";");g=a[0];localStorage.setItem("cba_jwt_token",
a[0]);ws_jwt_exclude.includes(c)||localStorage.setItem("cba_jwt_refresh_token",a[1])}})}b.headers=b.headers||{};b.headers["CBA-JWT"]="Bearer "+g}var k=!1;Ext.each(["STATOELAB/NEWID","STATOELAB/GET"],function(a){-1!=c.indexOf(a)&&(k=!0)});b&&b.params&&b.params.hideInizioAttesa&&(k=b.hideInizioAttesa=!0,delete b.params.hideInizioAttesa);!k&&Ext.ClassManager.isCreated("CBA.parametriGenerali.lingua")&&(inizioAttesa(),Ext.getBody().setStyle("cursor","wait"))},Ext.getBody());Ext.Ajax.on("requestcomplete",
function(a,b,c,d){fineAttesa();b.responseText&&0<b.responseText.indexOf("token")&&"expired"==Ext.JSON.decode(b.responseText).token&&(localStorage.removeItem("access_token_dm7"),StdSipcar.doSecureLogin())},Ext.getBody());Ext.override(Ext.form.ComboBox,{puoiCancellare:!0,esegui_doQuery:!0,initComponent:function(){if(!this.value&&0<this.minChars){var a=1==this.minChars?traduci("CARATTERE"):traduci("CARATTERI");this.emptyText=traduci("INSERIRE")+" "+this.minChars+" "+a+" "+traduci("PER_CERCARE")}this.enableRegEx=
"local"==this.queryMode?!0:!1;this.callParent()},setStyleNonAttivo:function(a,b,c){b=void 0===b?0:b;c=void 0===c?"T":c;a.tpl=Ext.create("Ext.XTemplate",'\n\t\t\t\t\t<tpl for=".">\n\t\t\t\t\t\t<tpl if="extra.split(\',\')['+b+"] == '"+c+'\'" >\n\t\t\t\t\t\t\t<div class="x-boundlist-item testoAnnullato non_attivi">{valore}</div>\n\t\t\t\t\t\t<tpl else>\n\t\t\t\t\t\t\t<div class="x-boundlist-item">{valore}</div>\n\t\t\t\t\t\t</tpl>\n\t\t\t\t\t</tpl>');a.displayTpl=Ext.create("Ext.XTemplate",'<tpl for=".">',
"<tpl>{[this.renderDisplay(values)]}</tpl>","</tpl>",{renderDisplay:function(d){a.inputEl.removeCls("testoAnnullato non_attivi");d.extra.split(",")[b]==c&&a.inputEl.addCls("testoAnnullato non_attivi");return d[a.displayField]}})},listConfig:{loadMask:!1},forceSelection:!0,enableKeyEvents:!0,onKeyUp:function(a,b){var c=a.getKey();this.enableKeyEvents&&this.callParent(arguments);46===c&&!1===this.readOnly&&this.puoiCancellare&&(this.clearValue(),this.fireEvent("select",this,[]))},doLocalQuery:function(a){var b=
a.query,c=this.getStore().getFilters(),d=this.queryFilter;this.queryFilter=null;this.changingFilters=!0;c.beginUpdate();d&&c.remove(d);b&&(d=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),d=this.queryFilter=new Ext.util.Filter({id:this.id+"-filter",anyMatch:this.anyMatch,caseSensitive:this.caseSensitive,root:"data",property:this.displayField,value:this.enableRegEx?new RegExp(d,"i"):b}),c.add(d));c.endUpdate();this.changingFilters=!1;this.store.getCount()||this.getPicker().emptyText?(this.getPicker().refresh(),
this.expand()):this.collapse();this.afterQuery(a)},onListSelectionChange:function(a,b){var c="local"===this.queryMode;this.callParent([a,b]);c&&0<b.length&&(this.queryFilter.disabled=!0,this.queryFilter.setValue(void 0),this.store.filter())},checkValueOnChange:function(){if(!this.isExpanded)return this.callParent()}});Ext.override(Ext.form.NumberField,{baseChars:"-0123456789,.",currencySymbol:null,useThousandSeparator:!0,thousandSeparator:".",decimalSeparator:",",allowDecimals:!0,alwaysDisplayDecimals:!0,
fieldStyle:"text-align:right",formatOra:!1,repeatTriggerClick:!1,hideTrigger:!0,mouseWheelEnabled:!1,keyNavEnabled:!1,setValue:function(a){Ext.form.field.Number.superclass.setValue.call(this,null!=a?a.toString().replace(".",this.decimalSeparator):a);this.setRawValue(this.getFormattedValue(this.getValue()))},getFormattedValue:function(a){if(Ext.isEmpty(a)||!this.hasFormat())return a;var b;a=(b=0>a)?-1*a:a;a=parseFloat(a);a=this.allowDecimals&&this.alwaysDisplayDecimals?a.toFixed(this.decimalPrecision):
a;if(this.useThousandSeparator){if(this.useThousandSeparator&&Ext.isEmpty(this.thousandSeparator))throw"NumberFormatException: invalid thousandSeparator, property must has a valid character.";if(this.thousandSeparator==this.decimalSeparator)throw"NumberFormatException: invalid thousandSeparator, thousand separator must be different from decimalSeparator.";a=a.toString();a=a.split(".");a[1]=a[1]?a[1]:null;for(var c=a[0],d=/(\d+)(\d{3})/,e=this.thousandSeparator;d.test(c);)c=c.replace(d,"$1"+e+"$2");
a=c+(a[1]?this.decimalSeparator+a[1]:"")}return Ext.String.format("{0}{1}{2}",b?"-":"",Ext.isEmpty(this.currencySymbol)?"":this.currencySymbol+" ",a)},parseValue:function(a){a=this.removeFormat(a);""===a&&(a=null);if(a){if(a.match(/\,/g))a=String(a).replace(/\./g,""),a=parseFloat(String(a).replace(this.decimalSeparator,"."));else{var b=0;a&&a.match(/\./g)&&(b=a.match(/\./g).length);1<b?(this.allowDecimals&&(b=a.lastIndexOf("."),a=a.substr(0,b+1)+","+a.substr(b+1)),a=String(a).replace(/\./g,"")):this.allowDecimals||
(a=String(a).replace(/\./g,""))}isNaN(a)&&(a=0)}return a},removeFormat:function(a){!Ext.isEmpty(a)&&this.hasFormat()&&(a=a.toString().replace(this.currencySymbol+" ",""));return a},getErrors:function(a){var b=[],c=Ext.String.format,d;a=this.removeFormat(a);d=this.parseValue(a);Ext.isEmpty(a)&&!this.allowBlank&&b.push(this.blankText);0===this.minValue&&0>d?b.push(this.negativeText):d<this.minValue&&b.push(c(this.minText,this.minValue));d>this.maxValue&&b.push(c(this.maxText,this.maxValue));this.formatOra&&
(c=(d+"").split("."),c[1]&&(1==c[1].length&&(c[1]*=10),59<c[1]&&b.push(traduci("MSG_MIN_MAX"))));Ext.isEmpty(b)&&this.validator&&(a=this.validator(a),1!=a&&b.push(a));return b},hasFormat:function(){return"."!=this.decimalSeparator||1==this.useThousandSeparator&&null!=this.getRawValue()||!Ext.isEmpty(this.currencySymbol)||this.alwaysDisplayDecimals},onFocus:function(){this.setRawValue(this.removeFormat(this.getRawValue()));this.callParent(arguments)}});Ext.apply(Ext.form.field.VTypes,{Float:function(a){return/^([.\-0-9])+$/i.test(a)},
MskFloatMask:/([.\-0-9])+/i});Ext.apply(Ext.form.field.VTypes,{Integer:function(a){return/^([\-0-9])+$/i.test(a)},MskIntegerMask:/([\-0-9])+/i});Ext.apply(Ext.form.field.VTypes,{IPAddress:function(a){return this.IPAddressRe.test(a)},IPAddressRe:/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IPAddressMask:/[\d\.]/i});Ext.apply(Ext.form.field.VTypes,{email:function(a){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a)}});Ext.override(Ext.form.field.Radio,{initComponent:function(){var a=this;if(this.cbaConfig&&
this.cbaConfig.deselezionabile)this.on("afterrender",function(){a.getEl().on("click",function(){a.disabled||a.readOnly||a.setValue(!a.checked)});a.boxLabelEl.on("click",function(){a.disabled||a.readOnly||a.setValue(!a.checked)})});this.callParent()}})});
function traduciCmpExtJS(){Ext.grid.RowEditor.prototype.saveBtnText=Localizer.getLocalizedString("CONFERMA");Ext.grid.RowEditor.prototype.cancelBtnText=Localizer.getLocalizedString("RIPRISTINA");Ext.grid.RowEditor.prototype.errorsText=Localizer.getLocalizedString("ATTENZIONE");Ext.grid.RowEditor.prototype.dirtyText=Localizer.getLocalizedString("RECORD_MODIFICATO_QUESTION");Ext.grid.Panel.prototype.enableColumnMove=!1;Ext.grid.Panel.prototype.enableColumnHide=!1;Ext.MessageBox&&(Ext.MessageBox.msgButtons.ok.text=
Localizer.getLocalizedString("OK"),Ext.MessageBox.msgButtons.yes.text=Localizer.getLocalizedString("SI"),Ext.MessageBox.msgButtons.cancel.text=Localizer.getLocalizedString("ANNULLA"),Ext.MessageBox.msgButtons.no.text=Localizer.getLocalizedString("NO"))}function isValidDate(a){return a.getValue()&&a.isValid()&&10==a.getRawValue().length}
function getFormDirty(a){if(!a||0<a.query("stampaCBA").length)return!1;var b=a.query("form");a=a.query("gridview");var c=!1;Ext.each(a,function(a){if(a.editingPlugin){var d=a.editingPlugin.editor&&a.editingPlugin.getEditor(),g=a.up("gridpanel");d&&d.isVisible()?b.push(a.editingPlugin.getEditor().getForm()):(a=a.getStore(),g&&!g.noModificaDati&&(a.getModifiedRecords&&0<a.getModifiedRecords().length?c=!0:a.getDeletedRecords&&0<a.getDeletedRecords().length&&(c=!0)))}});if(c)return!0;Ext.each(b,function(a){(a.isDirty()||
Ext.isEmpty(a.xtype)&&!a.isValid())&&!a.noModificaDati&&(Ext.isDefined(a.isVisible)&&a.isVisible(!0)&&!a.isDisabled()||!Ext.isDefined(a.isVisible))&&(c=!0)});return c}function controllaDirtyForm(a,b){var c=!1;Ext.isDefined(a.cbaConfig.puoiChiudere)?c=!a.cbaConfig.puoiChiudere():(c=getFormDirty(a))&&Messaggio("ATTENZIONE","MSG_FORM_DIRTY","YESNO","WARNING",!1,function(){var c=b?b:a;c.events.beforeclose.clearListeners();c.close()},function(){});return!c}
function setValue(a,b){var c=Ext.getCmp(a);c||(c=a);""===b&&(b=null);if(b||0===b)c.setValue(b),c.resetOriginalValue(),c.validateValue(b)}function setText(a,b){Ext.getCmp(a).setText(b)}function getValue(a){a=Ext.getCmp(a).getValue();return""!=a&&void 0!=a&&null!=a||"number"==typeof a?a:null}function expireCookie(){return new Date((new Date).getTime()+36E5)}
function getLoaderHistory(){for(var a=document.styleSheets,b=Ext.Loader,c=b.history,d=b.getPath,b=[],e=a.length,g=0;g<e;g++){var h=a[g].href;h&&("http://127.0.0.1:8080/"===h.substring(0,22)&&(h=h.substring(21)),b.push(h))}a=Ext.Array.map(c,function(a){a=d(a);"http://127.0.0.1:8080/"===a.substring(0,22)&&(a=a.substring(21));return a});return Ext.encode(b.concat(a))}
function HTML_to_Text(a){if(a){var b=RegExp("<br>","gi");a=a.replace(b,String.fromCharCode(13)+String.fromCharCode(10));b=RegExp("&nbsp;","gi");a=a.replace(b," ");b=RegExp("&amp;","gi");a=a.replace(b,"&");b=RegExp("&lt;","gi");a=a.replace(b,"<");b=RegExp("&gt;","gi");a=a.replace(b,">");b=RegExp("&quot;","gi");a=a.replace(b,'"');b=RegExp("&apos;","gi");a=a.replace(b,"'")}return a}
function Text_to_HTML(a){if(a){var b=new RegExp(String.fromCharCode(13)+String.fromCharCode(10),"gi");a=a.replace(b,"<br>");b=new RegExp(String.fromCharCode(32),"gi");a=a.replace(b,"&nbsp;")}return a}function getBoolValue(a,b,c){b||(b="T");c||(c="F");return 1==a?b:c}function formattaIban(a,b,c,d,e){var g="";Ext.isEmpty(a)||(g=traduci("IBAN")+": "+b+" "+a);Ext.isEmpty(c)||(g=g+" "+c);Ext.isEmpty(d)||(g=g+" "+d);Ext.isEmpty(e)||(g=g+" "+e);return g}
function getPopupMenuFoto(a,b){a.el.on("contextmenu",function(c){c.stopEvent();if(a.contextMenu)return a.contextMenu.showAt(c.getXY()),!1;c=Ext.create("Ext.Action",{iconCls:"icon-elimina16",text:traduci("ELIMINA"),handler:function(){a.urlDelete&&Ext.Ajax.request({method:"GET",url:a.urlDelete,success:function(c){c=Ext.JSON.decode(c.responseText);c.success?b?(a.setSrc(b),Ext.getCmp(a.getId()+"Tooltip")&&Ext.getCmp(a.getId()+"Tooltip").setSrc(b)):a.setSrc("#"):msgShowError("",c.message)}})}});c=Ext.create("Ext.menu.Menu",
{items:c});a.contextMenu=c;c.showAt(a.getXY());return!1})}function checkMandatoryField(a,b){var c=0,d=traduci("CAMPO_OBBLIGATORIO");a.getForm().getFields().each(function(a){a.isValid()||(c++,a.getFieldLabel&&msgAddError(b,a.getFieldLabel()+d))});return 0<c}
function treeCheckchange(a,b,c){if(null!=a){var d=!0,e=!0,g=a.parentNode,h=g.parentNode,k=a.getOwnerTree(),l=null,m=k.store.isFiltered();m&&(l=k.store.getFilters().clone(),k.store.clearFilter());b?(a.getOwnerTree().suspendLayouts(),g&&g.set("checked",!0),h&&h.set("checked",!0),a.getOwnerTree().resumeLayouts(!0)):(g.eachChild(function(a){a.get("checked")&&(d=!1)}),d&&(g.set("checked",!1),h&&(h.eachChild(function(a){a.get("checked")&&(e=!1)}),e&&h.set("checked",!1))));a.isLeaf()?(c=c&&c.checkAllNode,
d||c||0!=a.parentNode.get("checked")||a.parentNode.set("checked",!0)):(a.getOwnerTree().suspendLayouts(),a.cascadeBy(function(a){a.set("checked",b)}),a.getOwnerTree().resumeLayouts(!0));m&&Ext.each(l.items,function(a){k.store.filters.add(a)})}}
function checkAllNodeTree(a,b){a.suspendLayouts();var c=null,d=a.store.isFiltered();d&&(c=a.store.getFilters().clone(),a.store.clearFilter());a.getRootNode().cascadeBy(function(a){a.isRoot()||a.parentNode.isRoot()&&a.isLeaf()&&"cba-disabled-element"==a.get("cls")||a.set("checked",b)});d&&Ext.each(c.items,function(b){a.store.filters.add(b)});a.resumeLayouts(!0);a.fireEvent("checkchange",null,b,{checkAllNode:!0,tree:a})}
function getPopupMenuTree(a,b,c,d){d=void 0===d?[]:d;a.stopEvent();var e=b.up();if(e.contextMenu)return e.contextMenu.showAt(a.getXY()),!1;b=e.getRootNode().getChildAt(0);c=[];if(b&&1==b.get("checked")||0==b.get("checked"))c.push(Ext.create("Ext.Action",{iconCls:"icon-checked",text:traduci("TREE_SELEZIONA_TUTTO"),handler:function(){inizioAttesa();checkAllNodeTree(e,!0);fineAttesa()}})),c.push(Ext.create("Ext.Action",{iconCls:"icon-unchecked",text:traduci("TREE_DESELEZIONA_TUTTO"),handler:function(){inizioAttesa();
checkAllNodeTree(e,!1);fineAttesa()}}));c.push(Ext.create("Ext.Action",{iconCls:"icon-expand-arrows ",text:traduci("TREE_ESPANDI_TUTTO"),handler:function(){e.suspendLayouts();e.expandAll();e.resumeLayouts(!0)}}));c.push(Ext.create("Ext.Action",{iconCls:"icon-minimize-arrows ",text:traduci("TREE_RIDUCI_TUTTO"),handler:function(){e.suspendLayouts();e.collapseAll();e.resumeLayouts(!0)}}));d=Ext.create("Ext.menu.Menu",{items:c.concat(d)});e.contextMenu=d;d.showAt(a.getXY());return!1}
function abilitaCmp(a,b){var c=Ext.getCmp(a);c||(c=a);c.setReadOnly?c.setReadOnly(!b):c.setDisabled(!b);c.validateValue&&c.validateValue(c.getValue())}
function Messaggio(a,b,c,d,e,g,h,k,l){function m(a){"ok"==a&&Ext.isDefined(e)?"function"==typeof e?e():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********"):"yes"==a&&Ext.isDefined(g)?"function"==typeof g?g():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********"):"no"==a&&Ext.isDefined(h)?"function"==typeof h?h():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********"):"cancel"==a&&Ext.isDefined(k)&&("function"==typeof k?k():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********"))}
var n=b&&b.msg?b.msg:b;a=Localizer.getLocalizedString(a);var n=Localizer.getLocalizedString(n),p;p=n.split("\n");if(1<p.length)for(var n="",q=0;q<p.length;q++)n=""==p[q][0]?n+traduci(p[q].slice(1)):"?"==p[q][0]?n+"<li>"+traduci(p[q].slice(1))+"</li>":n+"<li>"+traduci(p[q])+"</li>";d=""==d?"":"INFO"==d||"QUESTION"==d||"WARNING"==d||"ERROR"==d?Ext.Msg[d]:d;var t;l&&(t="msg_floating");l=1;if("YESNOCANCEL"==c||"YESNO"==c)l=2;"YESNOCANCEL"==c&&"function"!=typeof k&&(c="YESNO");if(b.type){if("strongStr"==
b.type){var v=Math.random().toString(36).substr(2).substring(5);c="<Font size=4>"+v+"</Font>";n="<B><Font size=2>"+traduci(n)+"</Font></B><BR><BR>"+traduci("MSG_INSERISCI_CODICE")+"<BR>"+c+"<BR>";return Ext.Msg.show({prompt:!0,title:traduci(a),message:n,buttons:Ext.Msg.OKCANCEL,icon:d,closable:!0,callback:function(a,c){c==v?"strongStr"==b.type?"no"==a&&Ext.isDefined(h)?"function"==typeof h?h():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********"):"ok"==a&&Ext.isDefined(g)&&("function"==
typeof g?g():StdSipcar.warn("*********** Messaggio : utilizzo di eval ***********")):m(a):(msgShowError("","MSG_CODICE_ERRATO"),Ext.isDefined(k)&&("function"==typeof k?k():StdSipcar.warn("*********** Messaggio show: utilizzo di eval ***********")))},modal:!0,cls:t,defaultFocus:l})}StdSipcar.warn("*********** Messaggio show: operazione non prevista ***********")}else return Ext.Msg.show({title:traduci(a),msg:traduci(n),buttons:Ext.Msg[c],icon:d,closable:!1,fn:m,onEsc:function(){Ext.isDefined(k)&&("function"==
typeof k?k():StdSipcar.warn("*********** Messaggio show: utilizzo di eval ***********"))},modal:!0,cls:t,defaultFocus:l})}function FormattaData(a,b){if(null==a)return"";if(Ext.isString(a)){var c=Ext.Date.parse(a,"c");Ext.isDefined(c)||(c=new Date(Date.parse(a)));a=c}void 0==b&&(b="d/m/Y");return Ext.util.Format.date(a,b)}
function FormattaOra(a,b){if(null==a)return"";Ext.isDate(a)||(a=Ext.Date.parse(a,"c"));return Ext.Date.isEqual(a,new Date(1899,11,31,0,0,0))?"24:00":Ext.util.Format.date(new Date(a),"H:i")}function dataAttuale(a){a||(a="d/m/Y");return Ext.util.Format.date(new Date,a)}function domani(){return new Date((new Date).getTime()+864E5)}
function tempoTrascorsoText(a,b){var c=b.getTime()-a.getTime(),d=0;b.getDay()==a.getDay()+1?d=-1:b.getDay()==a.getDay()+2&&(d=-2);return 3E4>c&&0==d?"ora":6E4>c&&0==d?"1 minuto fa":36E5>c&&0==d?Math.round(c/6E4)+" minuti fa":72E5>c&&0==d?"1 ora fa":54E6>c&&0==d?Math.round(c/36E5)+" ore fa":864E5>c&&0==d?"oggi":1728E5>c&&-1==d?"ieri":2592E5>c&&-2==d?"l'altro ieri":31536E6>c?Math.round(c/864E5)+" giorni fa":63072E6>c?"un anno fa":Math.round(c/31536E6)+" anni fa"}
function msgAddError(a,b){Ext.isArray(b)?Ext.each(b,function(b){a.push(b)}):a.push({testo:b,tipo:2})}function msgAddWarning(a,b){Ext.isArray(b)?Ext.each(b,function(b){a.push(b)}):a.push({testo:b,tipo:1})}function msgAdd(a,b){Ext.isArray(b)?Ext.each(b,function(b){a.push(b)}):a.push({testo:b,tipo:0})}function msgShowText(a,b){var c=[];msgAdd(c,b);msgShow(a,c)}function msgShowError(a,b,c){var d=[];msgAddError(d,b&&b.message?b.message:b);msgShow(a,d,null,c)}
function msgShowWarning(a,b){var c=[];msgAddWarning(c,b);msgShow(a,c)}
function msgShow(a,b,c,d,e,g,h,k,l,m){controllaWinElaborazione();if(Ext.isEmpty(b)||1==b.length&&Ext.isObject(b[0].testo))return!0;a=traduci(a);var n=0,p=0,q="",t="",v="",u="",w="",w="";if(Ext.isArray(b))Ext.each(b,function(a){var b;u="";switch(a.tipo){case 1:b='class="li-warning"';break;case 2:b='class="li-errore"';break;default:b=""}if(a.testo)for(var c=a.testo.split("\n"),d=0;d<c.length;d++)u=0==d?u+"<li "+b+">"+traduci(c[d])+"</li>":u+"<li>"+traduci(c[d])+"</li>";switch(a.tipo){case 1:t+=u;p++;
break;case 2:q+=u;n++;break;default:v+=u}}),l||(l=0),0==l?w=q+t+v:1==l&&(w=v+q+t),w='<ul class="ulMsg">'+w+"</ul>";else{b=b.split("\n");1<b.length&&b.splice(0,1);l="";for(w=0;w<b.length;w++)l=l+"<li>"+traduci(b[w])+"</li>";w=l}0==n+p?msgShowPopup.msg(a,w,m):(a=a?a+"<br>":"",k||(0<n&&(a=a+traduci("MSG_ERRORI_TROVATI")+": "+n),0<p&&(0<n&&(a+=" - "),a=a+traduci("MSG_WARNING_TROVATI")+": "+p)),c||(c="OK"),Ext.Msg.show({title:'<span class="cbaLabel labelErrore">'+a+"</span>",cls:"msgError msg_floating",
msg:w,buttons:Ext.Msg[c],closable:!1,modal:!0,width:400,fn:function(a){"ok"==a&&d?d():"yes"==a&&e?e():"no"==a&&g?g():"cancel"==a&&h&&h()}}));return 0==n}msgShowPopup=function(){var a;return{msg:function(b,c,d){a||(a=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},!0));b=Ext.DomHelper.append(a,'<div class="msg" style="text-align: center"><h3>'+traduci(b)+'</h3><ul class="ulMsg">'+c+"</ul></div>",!0);b.hide();b.slideIn("t").ghost("t",{delay:d?d:1500,remove:!0})}}}();
function SvuotaCombo(a){a.clearValue();a.store.removeAll();a.setValue("");a.lastquery="";a.queryFilter&&(a.queryFilter.disabled=!0);a.store.filter()}
function creaWin(a){var b="win_"+a.id,c=setWindow(a.dimensioneWindow),d=c[0],c=c[1];Ext.isEmpty(a.altezzaWin)||(d=a.altezzaWin);Ext.isEmpty(a.larghezzaWin)||(c=a.larghezzaWin);var e="",g=Localizer.getLocalizedString(a.titolo);if("L"==a.permesso)e="icon-solalettura",g=g+" - "+Localizer.getLocalizedString("SOLA_LETTURA");else if(a.isLegatoServizio&&!permettiModificheDopoDimissione()){var e="icon-solalettura",g=g+" - "+Localizer.getLocalizedString("MSG_ERRORE_MODIFICHE_OSPITE_DIMESSO"),h=getModulo(a.id);
h&&(a.permesso="L",h.permesso="L")}void 0==Ext.getCmp(b)&&(d>document.body.getClientRects()[0].height&&(d=document.body.getClientRects()[0].height,c-=29),c>document.body.getClientRects()[0].width&&(c=document.body.getClientRects()[0].width),b=Ext.create("Ext.window.Window",{id:b,itemId:b,height:d,width:c,minHeight:d,minWidth:c,closable:a.closable,plain:!0,layout:"fit",modal:!0,maximizable:!0,title:g,stateful:!1,iconCls:e,autoScroll:!0,constrain:!0,items:[Ext.create(a.projectName+".view."+a.id,{cbaConfig:a})]}),
b.show(),a.nascondiHeader&&b.header.hide());a&&(a.permesso&&(a.permesso=a.permessoDB),a.id&&(a.id=a.idDB));Ext.getCmp("messaggio")&&Ext.WindowManager.bringToFront(Ext.getCmp("messaggio"))}
function showCalc(a){var b=CBA.moduli["modulo"+CBA.moduli.moduloAttivo];Ext.isDefined(b.winCalcolatrice)&&b.winCalcolatrice.close();b.winCalcolatrice=Ext.create("winCBA",{name:"Generali.standard.calcolatrice.view.Calculator",titolo:"CALCOLATRICE",dimensione:"Calcolatrice",closable:!0,modal:a.modal,configItem:a,listeners:{close:function(){delete b.winCalcolatrice;a&&a.closeCallBack&&a.closeCallBack()}}}).show()}
function showWinStampa(a,b,c,d){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/menuItem/src/byPrj",params:{idModulo:a,codEnte:b,progetto:c},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(a=a.data[0],Ext.apply(a,{eseguiStampa:!0}),d&&Ext.apply(a,d),Ext.create("winCBA",{name:a.nomeForm,titolo:a.titolo,dimensione:1,configItem:a,callBackRenderWin:function(){var a=this.down("#TabPrincipale");a.down("#BtnStampa");for(var b=0;b<a.items.getCount()-1;b++)a.items.items[b].tab.hide();
this.down("#BtnAvanti").hide();this.down("#BtnIndietro").hide();a.setActiveTab(a.down("#PageAnteprima"))}}).show()):msgShowError("",a.message)}})}function creaItemDownload(a,b,c,d){return{xtype:"container",flex:1,minHeight:90,layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"image",height:32,width:32,imgCls:a},{xtype:"label",html:'<a href="'+b+'" download="'+c+'"  onclick="clickHref(this);">'+traduci("DOWNLOAD")+" "+d+"</a>"}]}}
function stampaEsporta(a,b,c){var d=b.url;if(a){var e=a.up();e.down("#BtnEsci");var g=e.down("#BtnDownload")}e=b.headers||{};delete b.headers;a&&a.setDisabled(!0);b.renderTo&&(b.renderTo.down("#CntAnteprima").removeAll(),b.renderTo.down("#CntDownload").removeAll());Ext.Ajax.request({method:"POST",url:d,params:b.params,jsonData:b.jsonData?b.jsonData:"",timeout:36E5,headers:e,success:function(d){d=Ext.JSON.decode(d.responseText);if(d.success)if(controllaWinElaborazione(),Ext.isEmpty(d.data))msgShowText("",
d.message);else{var e=getPathServer()+d.data.filePath,h=d.data.fileType?d.data.fileType.toLowerCase():"";"xlsx"==h&&(h="xls");b.renderTo&&(d.data.otherFiles?b.renderTo.down("#CntDownload").show():b.renderTo.down("#CntDownload").hide());g&&-1!=e.indexOf("-downld")?(g.show(),g.setHref(e.split(".pdf")[0]+".zip")):g&&g.hide();if("pdf"==h||-1!=Ext.Array.indexOf(getEstensioniImg(),h))e={itemId:"iframePdf",reference:"iframePdf",html:'<iframe width="100%" height="100%" src="'+e+'" onload="fineAttesa()"></iframe>'};
else{var m=e.split("\\").pop().split("/").pop();b.titolo=b.titolo?b.titolo:m;e=creaItemDownload("icon-"+h,e,m,b.titolo);if(d.message){var n=[];d.message.forEach(function(a){1!==a.tipo&&2!==a.tipo||n.push({xtype:"label",html:'<div class="'+(1===a.tipo?"li-warning":"li-errore")+'">'+a.testo+"</div>"})});0<n.length&&(e={xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",margin:20,padding:10,cls:"bgYellow",layout:{type:"vbox",align:"stretch"},items:n},e]})}}if(b.renderTo){b.renderTo.down("#CntAnteprima").removeAll();
b.renderTo.down("#CntAnteprima").add(e);var p=b.renderTo.down("#CntDownload");p.removeAll();d.data.otherFiles&&Ext.Array.each(d.data.otherFiles,function(a){if(a){var b=a.fileType.toLowerCase();a=getPathServer()+a.filePath;var c=a.split("\\").pop().split("/").pop(),b=creaItemDownload("icon-"+b,a,c,c);p.add(b)}})}else Ext.create("winCBA",{name:e,titolo:b.titolo,dimensione:1,closable:!0}).show();c&&c(d)}else{controllaWinElaborazione();(e=Ext.WindowManager.getActive())&&e.config&&e.config.name&&e.config.name[0]&&
e.config.name[0].xtype&&"stampaCBA"==e.config.name[0].xtype&&(e.isDestroyed||e.close());if(d.message&&("?"==d.message[0]||d.message[0].testo&&"?"==d.message[0].testo[0])){Messaggio("ATTENZIONE",d.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){Ext.apply(b.params,{recordVuotoSeNull:"T"});stampaEsporta(a,b,c)});return}d.message&&"$"==d.message[0]?d.message=d.message.substring(1):msgShowError("",d.message);b&&b.callbackStampaErrori&&b.callbackStampaErrori(d)}a&&!a.isDestroyed&&a.setDisabled(!1)}})}
function controllaWinElaborazione(){var a=Ext.WindowManager.getActive();a&&"winElaborazione"==a.getXType()&&a.task&&(a.task.destroy(),a.isDestroyed||a.close())}
function clearForm(a){function b(a){var c="panel fieldset gridpanel CBAShortcutGrid tabpanel container form radiogroup checkboxgroup cda cbaFieldsetHtmlEditor cbaMultipleChoice".split(" ");a.items.each(function(a){a&&(a.xtype&&-1!=c.indexOf(a.xtype)?(b(a),a.lastValue&&(a.lastValue=null)):("radiofield"==a.xtype?a.setValue(!1):"displayfield"==a.xtype?a.setValue(""):"combo"==a.xtype&&a.queryFilter&&(a.lastquery="",a.queryFilter.setDisabled(!0),a.store.filter()),a.name&&(d[a.name]=null)))})}var c=Ext.getCmp(a);
c||(c=a);var d={};Ext.suspendLayouts();b(c);c.getForm().setValues(d);c.getForm().reset();Ext.resumeLayouts(!0)}function puoiUscire(a,b,c,d,e){var g="function opSalva(){";c&&(g+=c);g+="};opSalva();";c="function opRipristina(){";d&&(c+=d);c=c+"\tExt.getCmp('"+a+"').close();};opRipristina();";Ext.getCmp(b).getForm().isDirty()?Messaggio("Attenzione","MSG_DATI_DA_CONFERMARE","YESNOCANCEL","QUESTION","",g,c):(e&&e(),Ext.getCmp(a).close())}
function formatFloat(a,b,c){void 0==b&&(b=2);a+=1/Math.pow(10,b+3);return Ext.util.Format.number(a,(c?"0,":"")+(0).toFixed(b))}function formatCDA(a,b,c,d){return a||b||c||d?(a?(10>a?"0":"")+a:"00")+"."+(b?(10>b?"0":"")+b:"00")+"."+(c?(10>c?"0":"")+c:"00")+"."+(d?(10>d?"0":"")+d:"00"):""}function getInvalidFormFields(a){return Ext.getCmp(a).query("field{isValid()==false}")}
function abilitaBottoni(a,b,c){var d=!0,e=!0;b=Ext.getCmp(b);c=c?Ext.getCmp(c).cbaConfig:Ext.getCmp(b.id).up().cbaConfig;c&&c.permesso||(c.permesso="S");"S"==c.permesso&&(d=b.getForm().isDirty(),e=!d);c=Ext.getCmp("_btnNuovo"+a);b=Ext.getCmp("_btnElimina"+a);var g=Ext.getCmp("_btnAnnulla"+a),h=Ext.getCmp("_btnConferma"+a),k;Ext.getCmp("_btnStampa"+a);k=Ext.getCmp("_btnStampa"+a);a=Ext.getCmp("_btnEsci"+a);c&&c.setDisabled(d);b&&b.setDisabled(d);g&&g.setDisabled(e);h&&h.setDisabled(e);k&&k.setDisabled(d);
a&&a.setDisabled(d)}function setCombo(a,b,c,d,e){var g=null,g=a.valueField?a:Ext.getCmp(a);g.store.load({params:d||{valore:c},callback:function(c,d,g){g?(setValue(a,b),e&&e()):msgShowError("",d.getError())}})}function forceQueryCombo(a,b,c){if(!a)return!1;setTimeout(function(){var d=a.getRawValue();Ext.isEmpty(d)||d.length!=StdSipcar.coalesce(b,3)||a.store.load({params:{valore:d+StdSipcar.coalesce(c,"")},callback:function(b,c,h){h&&(a.setRawValue(d),a.expand())}})},300)}
function setWindow(a){var b=Array(2);1==a?(b[0]=530,b[1]=900):2==a?(b[0]=400,b[1]=900):3==a?(b[0]=350,b[1]=700):4==a?(b[0]=530,b[1]=450):5==a?(b[0]=530,b[1]=600):6==a?(b[0]=530,b[1]=650):7==a?(b[0]=700,b[1]=1025):8==a?(b[0]=570,b[1]=900):"Calcolatrice"==a?(b[0]=320,b[1]=400):"PopUpSmall"==a?(b[0]=400,b[1]=450):"GestioneUtente"==a&&(b[0]=665,b[1]=1025);return b}
function getHeightPortlet(a){var b=220;switch(a){case "StoriciPresenze":b=2*b+getPaddingPortlet();break;case "Classificazioni":if(CBA.moduli.modulo43.abilitato||50==CBA.moduli.moduloAttivo)b=2*b+getPaddingPortlet()}return b}function getPaddingPortlet(){return 10}function getGiornoAttuale(){var a=(new Date).getDay();0==a&&(a=7);return a}
function generaliRicaricaStore(a,b,c,d,e,g,h,k){var l=Ext.getCmp(a);if(l){var m,n,p=b.isStore?b:Ext.getStore(b),q=l.isXType("gridview")||l.isXType("grid")||l.isXType("CBAShortcutGrid"),t=Ext.getCmp(d);h?m=h:(q?l.getSelectionModel().getSelection()[0]&&(m=l.getSelectionModel().getSelection()[0].get(e)):m=p.getAt(0),t&&t.getSelectionModel().getSelection()[0]&&(m=t.getSelectionModel().getSelection()[0].get(e)));p.cbaConfig={idRecord:m};p.load({params:c,callback:function(b,c,h){h?(t=Ext.getCmp(d))?b&&
0<b.length?((n=trovaRecord(p,e,m))?t.getSelectionModel().select([n]):0<p.getTotalCount()&&(t.getSelectionModel().select(0),n=t.getSelectionModel().getSelection()[0]),g(n)):g():(q&&0<p.getTotalCount()&&l&&l.getSelectionModel().select(0),k&&k(a,b)):msgShowError("",c.getError())}})}}function svuotaStore(a){a?(a.isStore||(a=Ext.getStore(a)),a.loadData([],!1),a.totalCount=0):StdSipcar.warn("Funzione SvuotaStore chiamata con parametro a null in "+getCallerFunction())}
function creaData(a,b,c){return new Date(c,b-1,a)}function azzeraData(a){a&&!Ext.Date.isEqual(a,new Date(1899,11,31,0,0,0))&&(a.setFullYear(1899),a.setMonth(11),a.setDate(30));return a}function dataFineMese(a,b){return new Date(b,a,0)}function giornoInizioMese(a){return new Date(a.getFullYear(),a.getMonth(),1)}function giornoFineMese(a){return new Date(a.getFullYear(),a.getMonth()+1,0)}
function ConvertiDataInMMGGAAAA(a){if(""!=a){var b=a.substr(6),c=a.substr(3,2);a=a.substr(0,2);return creaData(a,c,b)}return""}function calcolaGGTrimestre(a,b){for(var c=0,d=[],e=3*(a-1)+1,g=e+2,h=1;12>=h;h++)d[h]=(new Date(b,h,0)).getDate();for(h=e;h<=g;h++)c+=d[h];return c}function ToolTipPortlet(a){Ext.create("Ext.tip.ToolTip",{target:a,html:Localizer.getLocalizedString("MSG_DBLCLICK_PORTLET")})}
function setToolTip(a,b,c,d,e,g,h,k,l){var m=Ext.getCmp("ToolTip"+a),n=!0;e||(e=null);g||(g=null);0==k&&(k=!0,n=!1);d=traduci(d);c=traduci(c);m&&m.destroy();Ext.create("Ext.tip.ToolTip",{id:"ToolTip"+a,itemId:"ToolTip"+a,target:b,title:d,html:c,items:h,height:e,width:g,maxWidth:g,closable:k,autoHide:n,layout:{type:"fit"},listeners:{beforeshow:function(a,b){l&&l(a,b)}}})}
function setToolTipInfo(a,b,c){var d=a.id+"_info";a=a.bodyEl.insertHtml("afterEnd",'<div class="x-form-trigger icon-info" style="display: table-cell" id="'+d+'"></div>',!0);setToolTip(d,a,b,c)}function creaToolTip2(a){return creaToolTip(a.target,a.msg,a.titolo,a.height,a.width,a.items,a.closable,a.callback_beforeshow,a.trackMouse,a.showDelay,a.elementiConTooltip)}
function creaToolTip(a,b,c,d,e,g,h,k,l,m,n){d||(d=null);e||(e=null);c=traduci(c);b=traduci(b);var p="",q=Ext.getCmp(a);!q||"gridpanel"!=q.xtype&&"CBAShortcutGrid"!=q.xtype||(p=q.getView().itemSelector);"string"!=typeof a&&a.isComponent&&(a=a.getId());return Ext.create("Ext.tip.ToolTip",{target:a,delegate:p,title:c,html:b,items:g,height:d,width:e,maxWidth:e,closable:h,autoHide:!h,showDelay:m?m:500,trackMouse:l||!1,layout:{type:"fit"},listeners:{beforeshow:function(a,b){Ext.isEmpty(n)||Array.isArray(n)||
(StdSipcar.warn("creaTooltip: elementiConTooltip non  un array valido"),n=[]);if(!Ext.isEmpty(n)){for(var c=a.pointerEvent.target.id,d=!1,e=$jscomp.makeIterator(n),g=e.next();!g.done;g=e.next())if(g=g.value,c&&0<=c.toLowerCase().indexOf(g.toLowerCase())){d=!0;break}if(d)return!1}if(k)return c=k(a),Ext.isDefined(c)?c:!0}}})}
function creaToolTipInfo(a,b,c,d,e,g,h,k){var l=a.id+"_info";a.bodyEl?l=a.bodyEl.insertHtml("afterEnd",'<div class="x-form-trigger" style="width: 20px; display: table-cell"; display: inherit;><img style="border:0 !important; margin-top:4px; margin-left:2px;" class="icon-info" src="'+Ext.BLANK_IMAGE_URL+'" id="'+l+'"></img></div>',!0):(a=a.el.dom.firstChild,a.innerHTML='<img style="border:0 !important; margin-top:2px; margin-left:2px;" class="icon-info" src="'+Ext.BLANK_IMAGE_URL+'" id="'+l+'"></img>',
l=a);return creaToolTip(l,b,c,d,e,g,h,k)}function creaToolTipBubble(a,b,c,d,e,g,h,k,l,m){return creaToolTip(a,b,c,d,e,g,h,function(a){k&&k();if(m&&Ext.isString(m)&&""!=m){switch(m){case "V":a.addCls("cbabubble-valid");break;case "W":a.addCls("cbabubble-warning");break;case "X":a.addCls("cbabubble-error");break;default:a.addCls("cbabubble-action")}a.addBodyCls("cbabubble-text-color-blue")}},l,!m||""==m||"V"!=m&&"W"!=m&&"X"!=m?1E3:300)}function getMese(a){return Ext.Date.monthNames[a-1]}
function getGiorno(a){7==a&&(a=0);return Ext.Date.dayNames[a]}function validaForm(a){function b(a){a.items.each(function(a){a&&("panel"==a.xtype||"fieldset"==a.xtype||"gridpanel"==a.xtype||"CBAShortcutGrid"==a.xtype||"tabpanel"==a.xtype||"container"==a.xtype||"form"==a.xtype?b(a):a.validateValue&&a.validateValue(a.getValue()))})}var c=Ext.getCmp(a);c||(c=a);b(c)}
function nuovoRecord(a){clearForm(a.id+"Form");Ext.getCmp(a.id+"RecordId")?Ext.getCmp(a.id+"RecordId").setValue(-9999):a.queryById("recordId").setValue(-9999);a.getStoricoGrid()&&a.getStoricoGrid().setDisabled(!0);validaForm(a.id+"Form");(a=a.query("field[hidden=false]")[0])&&a.focus()}
function salvaRecord(a,b,c,d,e,g,h,k){var l=!1,m,n,p,q="";void 0==h&&(h=!0);e?(n=b[e],p=e):Ext.getCmp(a.id+"RecordId")?(n=getValue(a.id+"RecordId"),p=Ext.getCmp(a.id+"RecordId").name):(n=Ext.getCmp(a.id).queryById("recordId").getValue(),p=Ext.getCmp(a.id).queryById("recordId").name);m=null===n||0>=n?c.getProxy().api.create:c.getProxy().api.update;g&&(q=g);k&&(""==q?q={forceStore:!0}:Ext.apply(q,{forceStore:!0}));Ext.Ajax.request({url:m,method:"POST",jsonData:b,params:q,async:!1,success:function(k){k=
Ext.JSON.decode(k.responseText);var m="",q=[];if(k.success){if(d)a.aggiornaStore(),Ext.getCmp("win_"+a.id).close();else if(k.data){if(null===n||0>=n)n=k.data[p];a.aggiornaStore(n,k)}else a.aggiornaStore();h&&(k.message&&"$"==k.message[0]?(k.message=k.message.substring(1),msgAddWarning(q,k.message)):(m="MSG_SALVATAGGIO_DATI",msgAdd(q,k.message)))}else{if(k.message&&("?"==k.message[0]||k.message[0].testo&&"?"==k.message[0].testo[0])){Messaggio("ATTENZIONE",k.message[0].testo.slice(1),"YESNO","QUESTION",
!1,function(){salvaRecord(a,b,c,d,e,g,h,!0)});return}k.message&&"$"==k.message[0]?k.message=k.message.substring(1):msgAddError(q,k.message)}msgShow(m,q);l=k.success},failure:function(a){}});!l&&Ext.getCmp(a.id+"BoxBottoni")&&abilitaBottoni(a.id+"BoxBottoni",a.id+"Form",a.id);return l}
function eliminaRecord(a,b,c,d,e){var g=Ext.getCmp(a);g||(g=a);a=b.isStore?b:Ext.getStore(b);for(var h=b="",k=0;k<c.length;k++)0<k&&(h=k+1,b+="&"),b="gridpanel"==g.xtype||"CBAShortcutGrid"==g.xtype?b+c[k]+"="+a.cbaConfig[c[k]]:Ext.getCmp(g.id+"RecordId"+h)?b+c[k]+"="+getValue(g.id+"RecordId"+h):Ext.getCmp(g.id).queryById("recordId"+h)?b+c[k]+"="+Ext.getCmp(g.id).queryById("recordId"+h).getValue():b+c[k]+"="+a.cbaConfig[c[k]],h=""==h?2:h+1;"GET"!=e&&"POST"!=e&&(e="GET");Ext.Ajax.request({method:e,
url:a.getProxy().api.destroy,params:b,success:function(a){a=Ext.JSON.decode(a.responseText);var b=[];a.success?msgAdd(b,a.message):msgAddError(b,a.message);msgShow("MSG_ELIMINAZIONE_DATI",b);d&&d();d&&d();g.aggiornaStore()},failure:function(a){}})}function eliminaRecordQuestion(a,b,c,d,e){var g;g=b.isStore?b:Ext.getStore(b);g.tree||0!==g.count()?Messaggio("Elimina","MSG_ELIMINA","YESNOCANCEL","QUESTION","",function(){eliminaRecord(a,b,c,d,e)}):Messaggio("Elimina","MSG_NORECORD","OK","WARNING")}
function trovaRecord(a,b,c,d,e){var g=!0;d&&(g=!1);return c||!isNaN(c)?a.tree?a.getRootNode().findChild(b,c,!0):e&&a.isFiltered()?(!(d=a.getDataSource().find(b,c,0,!1,g,!0))&&(d=Ext.isString(c))&&(d=a.getDataSource().find(b,c,0,!1,g,!0)),d):a.findRecord(b,c,0,!1,!1,g)||Ext.isString(c)&&a.findRecord(b,c.toString(),0,!1,!1,g):!1}
function newIdElab(a){var b;Ext.Ajax.request({url:getPathGeneralModulo(null,a)+"statoElab/newId",async:!1,method:"GET",success:function(a){""!=a.responseText&&(a=Ext.decode(a.responseText),a.success&&(b=a.data))}});return b}
function getValoriCodiceFiscale(a,b,c,d){var e={};if(16==a.length){a=a.toUpperCase();var g=a[8].charCodeAt();if(65<=g&&84>=g&&(Ext.isEmpty(b)||Ext.isEmpty(c)||Ext.isEmpty(d))){var h=parseInt(a[9]+a[10]),k;c=a[6]+a[7];31<h?(e.sesso="F",b=h-40):(e.sesso="M",b=h);switch(a[8]){case "A":k="01";break;case "B":k="02";break;case "C":k="03";break;case "D":k="04";break;case "E":k="05";break;case "H":k="06";break;case "L":k="07";break;case "M":k="08";break;case "P":k="09";break;case "R":k="10";break;case "S":k=
"11";break;case "T":k="12"}e.dataNascita=0<b?"0"==a[6]?creaData(b,k,"20"+c):creaData(b,k,"19"+c):null;h=a.substr(11,4);Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/comuni/cbox/codfisc",params:{codFiscale:h,dataControllo:new Date},success:function(a){a.responseText?(a=Ext.JSON.decode(a.responseText),0<a.length&&(e.comuneNascita=h,e.nazioneNascita="0",e.desComuneNascita=a[0].valore)):(e.comuneNascita=null,e.nazioneNascita=h,e.desComuneNascita=null)}})}}return e}
function CalcolaCodiceFiscale(a,b,c,d,e,g){var h=!0;a&&b&&c&&Ext.isDate(d)&&g||(h=!1);h&&"0"==g&&!e&&(h=!1);if(!h)return"";var k=h="",l="",m,n;a=a.toUpperCase();b=b.toUpperCase();c=c.toUpperCase();d=FormattaData(d);e&&(e=e.toUpperCase());g&&(g=g.toUpperCase());m=parseInt(d.substr(0,2),10);n=parseInt(d.substr(3,2),10);d=parseInt(d.substr(8),10);d=10>d?"0"+d:d;"0"!=g&&(e=g);1==n&&(l="A");2==n&&(l="B");3==n&&(l="C");4==n&&(l="D");5==n&&(l="E");6==n&&(l="H");7==n&&(l="L");8==n&&(l="M");9==n&&(l="P");
10==n&&(l="R");11==n&&(l="S");12==n&&(l="T");for(g=0;g<a.length;g++)switch(a.charAt(g)){case "A":case "E":case "I":case "O":case "U":break;default:"Z">=a.charAt(g)&&"A"<a.charAt(g)&&(h+=a.charAt(g))}if(3>h.length){for(g=0;g<a.length;g++)switch(a.charAt(g)){case "A":case "E":case "I":case "O":case "U":h+=a.charAt(g)}if(3>h.length)for(g=h.length;3>=g;g++)h+="X"}h=h.substring(0,3);for(g=0;g<b.length;g++)switch(b.charAt(g)){case "A":case "E":case "I":case "O":case "U":break;default:"Z">=b.charAt(g)&&
"A"<b.charAt(g)&&(k+=b.charAt(g))}if(3<k.length)k=k.substring(0,1)+k.substring(2,4);else{if(3>k.length){for(g=0;g<b.length;g++)switch(b.charAt(g)){case "A":case "E":case "I":case "O":case "U":k+=b.charAt(g)}if(3>k.length)for(g=k.length;3>=g;g++)k+="X"}k=k.substring(0,3)}"F"==c&&(m+=40);a=h+k+d+l+(10>m?"0"+m:m)+e;a.toLowerCase();b=0;for(g=1;13>=g;g+=2)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(g))));
for(g=0;14>=g;g+=2)b+="BAKPLCQDREVOSFTGUHMINJWZYX".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(g))));b="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(b%26);return a+b}
function ControllaCF(a,b){var c,d;if(""==a)return!0;a=a.toUpperCase();if(16!=a.length)return Localizer.getLocalizedString("MSG_CF_LUNGHEZZA")+"\n";for(c=0;16>c;c++)if(-1=="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(a.charAt(c)))return Localizer.getLocalizedString("MSG_CF_CHAR_NON_VALIDO")+" "+a.charAt(c)+" \n";d=0;for(c=1;13>=c;c+=2)d+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(c))));for(c=0;14>=c;c+=
2)d+="BAKPLCQDREVOSFTGUHMINJWZYX".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(c))));c=!0;b&&(Ext.isEmpty(b.cognome)||Ext.isEmpty(b.nome)||Ext.isEmpty(b.sesso)||Ext.isEmpty(b.dataNascita)||Ext.isEmpty(b.comuneNascita))&&(c=!1);return c&&d%26!=a.charCodeAt(15)-65?Localizer.getLocalizedString("MSG_CF_NON_VALIDO"):!0}
function ControllaPIVA(a){if(""==a)return"";if(11!=a.length)return"La lunghezza della partita IVA non e' \ncorretta: la partita IVA dovrebbe essere lunga\nesattamente 11 caratteri.\n";var b,c,d;for(b=0;11>b;b++)if(-1=="0123456789".indexOf(a.charAt(b)))return"La partita IVA contiene un carattere non valido `"+a.charAt(b)+"'.\nI caratteri validi sono le cifre.\n";for(b=c=0;9>=b;b+=2)c+=a.charCodeAt(b)-48;for(b=1;9>=b;b+=2)d=2*(a.charCodeAt(b)-48),9<d&&(d-=9),c+=d;return(10-c%10)%10!=a.charCodeAt(10)-
48?"La partita IVA non e' valida:\nil codice di controllo non corrisponde.\n":""}function bottoniSolaLettura(a){a=Ext.getCmp(a);for(var b=a.items.getCount(),c=0;c<b;c++){var d=a.items.items[c];!0!==d.nonDisabilitare&&d.setDisabled(!0)}}
function containerSolaLettura(a,b){function c(a){a.items.each(function(a){if(a&&Ext.isDefined(a.getXType)){var d=a.getXType(),e,g="gridpanel"==d||"grid"==d||"CBAShortcutGrid"==d||"treepanel"==d||"treeview"==d,m="filefield"==d;"cda"==d&&(a.solaLettura=b);m&&a.button?a.button.setDisabled(b):m&&(e=!0===a.nonDisabilitare,a.setDisabled(b&&!e));g?(a.solaLettura=b,"treeview"==d&&(d=a.up())&&(d.solaLettura=b),(a=a.query("toolbar"))&&0<a.length&&a.forEach(function(a){a.items.each(function(a){e="icon-esciGriglia"==
a.iconCls||!0===a.nonDisabilitare;"button"!=a.getXType()||e||a.setDisabled(b)})})):a.items?(e=!0===a.nonDisabilitare)||c(a):a.setReadOnly?a.nonDisabilitare||a.setReadOnly(b):a.setDisabled&&((e=!0===a.nonDisabilitare)||a.setDisabled(b))}})}var d=Ext.getCmp(a);d||(d=a);void 0==b&&(b=!0);c(d)}function setEditForm(a){a.isDirty()||a.queryById("recordId").setValue(0+a.queryById("recordId").getValue())}
function inserisciBottoni(a,b,c,d){a.defaults=Ext.apply({},{margin:"1 1 1 1"},a.defaults);c?(void 0==d&&(d="end"),a.layout={type:"hbox",pack:d,align:"middle"}):a.layout={type:"vbox",align:"center"};a.border=0;a.add(b)}
function permettiModificheDopoDimissione(){if("undefined"!==typeof currRicovero&&!Ext.isEmpty(currRicovero)&&currRicovero.dataAl){var a=new Date(CBA.moduli["modulo"+CBA.moduli.moduloAttivo].serverDate),b=new Date(currRicovero.dataAl);if(new Date(b.setDate(b.getDate()+currRicovero.ggModificaFascicolo))<a)return!1}return!0}function isAreaUtenti(){return isArea("Utenti")}function isArea(a){return trovaRecord(Sipcar.app.getController("Login").storeModuli,"codice",getModuloAttivo()).get("area")==a}
function isAreaAbilita(a){var b=!1;Sipcar.app.getController("Login").storeModuli.each(function(c){c.get("area")==a&&c.get("abilitato")&&(b=!0)});return b}function getModulo(a){var b=!1;CBA.moduli.modulo43.moduli&&Ext.each(CBA.moduli["modulo"+CBA.moduli.moduloAttivo].moduli,function(c){if(c.id==a)return b=c,!1});return b}function getModuloAttivo(){var a=-1;CBA&&CBA.moduli&&CBA.moduli.moduloAttivo?a=CBA.moduli.moduloAttivo:a=-1;return a}
function getPathGeneralModulo(a,b){var c;b=b?b:getModuloAttivo();switch(b){case 43:case 50:a=a?a:"ws/genOsp/";c="/cba/osp/co/";break;case 46:a=a?a:"ws/genOsp/";c="/cba/osp/den/";break;case 48:a=a?a:"ws/genOsp/";c="/cba/osp/la/";break;case 55:a=a?a:"ws/genOsp/";c="/cba/osp/far/";break;case 64:a=a?a:"ws/genOsp/";c="/cba/osp/rap/";break;case 45:c="/cba/per/prz/";break;case 44:c="/cba/amm/cp/";break;case 51:c="/cba/amm/an/";break;case 52:c="/cba/amm/ib/";break;case 53:c="/cba/amm/ces/";break;case 54:c=
"/cba/amm/gb/";break;case 56:c="/cba/amm/ce/";break;case 57:c="/cba/eco/of/";break;case 58:c="/cba/eco/mag/";break;case 59:c="/cba/eco/mn/";break;case 60:c="/cba/eco/rc/";break;case 62:c="/cba/eco/far/";break;case 49:a=a?a:"ws/genCss/";c="/cba/css/cs/";break;case 69:a=a?a:"ws/genOsp/";c="/cba/css/cm/";break;default:c="/modulo/non/definito/"}return c+(a?a:"ws/general/")}function getPermesso(a){return(a=getModulo(a))&&a.permesso?a.permesso:"S"}
function getPathServer(){return location.protocol+"//"+location.host}function getParametriGet(){if(oauthCodeInUrl())return null;var a=document.URL.split("?"),b=!1;1<a.length&&(b=a[a.length-1],b=b.replace("loginParams=",""),b=decodeURI(b),a=b.split("&"),b={username:localStorage&&"T"===localStorage.cartella_old?decodeURI(a[0].replace("/%5C/g","\\")):a[0],password:a[1],codEntePwd:a[2],idModulo:a[3],cdc:a[4],isSecondWinCss:a[5]||"F"});return b}
function oauthCodeInUrl(){return(new URLSearchParams(window.location.search)).has("code")}function JSON_to_Get(a){a=Ext.JSON.encode(a);var b=RegExp("{","gi");a=a.replace(b,"");b=RegExp("}","gi");a=a.replace(b,"");b=RegExp('"',"gi");a=a.replace(b,"");b=RegExp(":","gi");a=a.replace(b,"=");b=RegExp(",","gi");return a=a.replace(b,"&")}function renderCheckColumn(a,b){if(!0===b||"T"==b)a.tdCls="icon-selezionato"}
function editCombo(a,b,c,d,e,g,h,k,l){var m=c;"number"==typeof c&&(m=a.columns[c]);a="local";var n;l&&(a="remote",n=3);l=null;m.tpl?l=m.tpl:m.editor&&m.editor.tpl&&(l=m.editor.tpl);m.editor={xtype:"combobox",allowBlank:!d,store:b,displayField:"valore",valueField:"codice",queryMode:a,editable:e,forceSelection:!0,minChars:n,queryParam:"valore",tpl:l,listConfig:{minWidth:g?g:70,loadMask:!1},listeners:{select:function(a,b,c){h&&h(a.value,b,c)},change:function(a,b,c,d){k&&k(a,b,c,d)}}}}
function getLastIndexColumnVisible(a,b){for(var c=a.headerCt.getGridColumns(),d=-1,e=0;e<c.length;e++)if(c[e].isVisible()&&d++,c[e].dataIndex==b)return d}function getColGrid(a,b,c){a=a.headerCt.getGridColumns();for(c=0;c<a.length;c++)if(a[c].dataIndex==b)return a[c]}function traduci(a,b){return Localizer.getLocalizedString(a,b)}function eliminaStore(a){a&&(a=a.isStore?a:Ext.getStore(a))&&a.destroy()}
function espandiAlbero(a){StdSipcar.warn("espandiAlbero() deprecata. Usa expandAll() su callback");a.getStore().on("load",function(){a.expandAll()},a,{single:!0})}function loadStore(a,b,c,d){a=a.isStore?a:Ext.getStore(a);a.getProxy().extraParams=b;a.load({callback:function(a,b,h){h?(Ext.getCmp(d)&&Ext.getCmp(d).resetOriginalValue(),c&&c(a)):msgShowError("",b.getError())}})}function whenLoaded(a,b,c){if(a.loaded)Ext.callback(b,c);else a.on("load",b,c,{single:!0})}
function noCache(){return"?_dc="+FormattaData(new Date,"dmy")}function loadCss(a){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a+noCache();document.getElementsByTagName("head")[0].appendChild(b)}function formattaImporto(a,b){if(Ext.isNumber(a))return formatFloat(a)+decodeTipoQuota(b)}
function decodeTipoQuota(a,b){switch(a){case "P":return"%";case "I":return Ext.util.Format.currencySign;case "G":return Ext.util.Format.currencySign+(b?" Giorno":"");case "M":return Ext.util.Format.currencySign+(b?" Mese":"");case "N":return Ext.util.Format.currencySign+(b?" Mese in proporzione":"");case "T":return Ext.util.Format.currencySign+(b?" Mese MAX":"");case "Z":return"Solo pensione";default:return a}}
function posizionaRecordGrid(a,b,c,d){b&&0<b.length&&((b=trovaRecord(a.getStore(),d,c))?a.getSelectionModel().select([b]):a.getSelectionModel().select(0))}function getEstensioni(){return"pdf png jpg jpeg gif bmp txt doc xls htm html unknown".split(" ")}function getEstensioniImg(){return["png","jpg","jpeg","gif","bmp"]}
function getListCheckedTree(a,b,c,d,e,g){var h=[],k="",l=",";e&&(l=e);d&&(k=d);var m=0;d=a.getChecked().filter(function(a){var c=a.isLeaf();m=c||a.isRoot()?m:m+1;return(b&&c||!b&&!c)&&a.get("visible")});if(g&&d.length==a.getStore().getTotalCount()-m)return"";Ext.each(d,function(a){a=a.data[c];Ext.isDefined(a)&&""!=a&&null!=a&&h.push(k+a+k)});return e?Ext.Array.unique(h).toString().replace(/,/g,l):Ext.Array.unique(h).toString()}
function spostaRiga(a,b){var c=a.getSelectionModel().getSelection()[0];if(c){var d=a.getStore().indexOf(c);if(0>b){if(d--,0>d)return}else if(d++,d>=a.getStore().getTotalCount())return;a.getStore().remove(c);a.getStore().insert(d,c);a.getSelectionModel().select(d)}}function showHelp(a,b){Ext.create("winCBA",{name:"Help.view.Help",titolo:"HELP",iconCls:"icon-help16",maximized:b||!1,dimensione:1,configItem:{topicId:a}}).show()}
function getAnnoEsercizio(){var a;Ext.Ajax.request({url:"/cba/osp/co/ws/rette/fatt/head/annoEseRange",method:"GET",async:!1,success:function(b){a=Ext.JSON.decode(b.responseText).data}});return a}function getIdEsercizioByDate(a,b){var c;Ext.Ajax.request({url:"/cba/gen/ws/general/esercizioCont/idEsercizioByDate",params:{idOrganizzazione:a,data:b},method:"GET",async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c=a.data:msgShowError("",a.message)}});return c}
function getPersonContabili(a,b,c,d){var e,g;c?(e=getUrlGen()+"/ws/genOsp/prszn/contbl/getbyorg",g={idOrg:a,data:b}):(e=getUrlGen()+"/ws/genOsp/prszn/contbl/getbysrv",g={idServizio:a,data:b});var h={};(h.tipoContabilitaAbilitata=d)||Ext.Ajax.request({url:e,params:g,method:"GET",async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?h=a.data:(h.tipoContabilitaAbilitata=5,msgShowError("",a.message[0].testo+"<br>"+traduci("Uso impostazione Nessuna Contabilit 2.0")))}});h.vediRegistro=
2==h.tipoContabilitaAbilitata||4==h.tipoContabilitaAbilitata||5==h.tipoContabilitaAbilitata;h.vediRegistroMan=3==h.tipoContabilitaAbilitata;h.vediConto=1!=h.tipoContabilitaAbilitata;h.vediCda=2==h.tipoContabilitaAbilitata||4==h.tipoContabilitaAbilitata||5==h.tipoContabilitaAbilitata;h.vediCapitolo=1==h.tipoContabilitaAbilitata;h.vediArticolo=!1;h.vediEnteInterno=!1;1==h.tipoContabilitaAbilitata&&(d=getPersonFinanziaria(),h.vediArticolo=d[0],h.vediEnteInterno=d[1]);h.idEsercizio=4==h.tipoContabilitaAbilitata||
5==h.tipoContabilitaAbilitata?getIdEsercizioByDate(c?a:getIdOrg(),b):b.getFullYear();return h}function getConfigMenu(){return Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().cbaConfig}function IsolaCmp(a,b,c){var d=a.up("window")?a.up("window"):Sipcar.app.getController("Menu").getMenu();b?(d.mask(),a.getEl().setStyle("z-index","10000"),c&&c.fireEvent("click")):(d.unmask(),a.getEl().setStyle("z-index","auto"))}
function getIdOrg(){return Sipcar.app.getController("Menu").organizzazione.get("codice")}function getIdGruppo(){return getExtraFieldOrg("idGruppo")}function getDesOrg(){return Sipcar.app.getController("Menu").organizzazione.get("valore")}function getExtraFieldOrg(a){var b=Sipcar.app.getController("Menu").organizzazione.get("extra");return getExtraField(b,a,";",":")}
function getExtraField(a,b,c,d){if(a){a=a.split(c);var e=null;Ext.each(a,function(a){a=a.split(d);if(a[0]==b)return e=a[1],!1});return e}}function getObjectFromString(a,b,c){if(!a)return{};a=a.replace(new RegExp(c,"g"),":");a=a.split(b);var d={};Ext.each(a,function(a){a=a.split(":");d[a[0]]=a[1]});return d}function getHelpTopic(a){Ext.WindowManager.getActive().queryById("PnlTopic").currentController.selectNodeTree(a)}
function trovaButtonMenu(a){return Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().queryById(a)}function eseguiModulo(a,b,c,d){if(a=Sipcar.app.getController("Menu").getBtnMenuSipcar().menu.queryById("menuitem"+a))d&&(a.controlParam=d),a.handler(),b&&setTimeout(function(){var a=trovaButtonMenu(b);a&&(a.cbaConfig=c,a.handler(a))},3E3)}
function getModuliAbilitati(){Ext.Ajax.request({url:"/cba/gen/auth/profile/modenabled",method:"GET",async:!1,params:{codProfilo:CBA.parametriGenerali.codProfilo,codEnte:CBA.parametriGenerali.codEntePwd,idProfiloDePwd:Ext.isEmpty(CBA.parametriGenerali.idProfiloPwdDe)?-1:CBA.parametriGenerali.idProfiloPwdDe},success:function(a){var b=Ext.JSON.decode(a.responseText);if(b.success){var c;a=[];for(var d=b.data[0],e=b.data[1],d=d.split(""),e=e.split(""),g=0;100>g;g++)c=(b="S"==d[g])||"S"==e[g],isSecondWinCss()&&
g+1!=localStorage.getItem("moduloAttivo")&&(b=!1),a["modulo"+(g+1)]={abilitato:b,installato:c};Ext.apply(CBA,{moduli:a})}else msgShowError("",b.message)}});Ext.Ajax.request({url:"/cba/gen/auth/pentaho/enabled",method:"GET",async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?Ext.apply(CBA.moduli,{moduloAnalisiDati:{abilitato:a.data}}):msgShowError("",a.message)}})}
function setTaskField(a,b,c){var d;a.task||(d=new Ext.util.TaskRunner,a.task=d.newTask({run:function(){a.task.destroy();a.task=null;b()},interval:c?c:1E3}));a.task.start()}function arrotonda(a,b){b||(b=2);a||(a=0);var c=1*a.toPrecision(15),c=Math.round((c+1/Math.pow(10,b+3)*(0>c?-1:1))*Math.pow(10,b))/Math.pow(10,b);"-0"==c&&(c=0);return c}
function inCentesimi(a){a||(a=0);var b=(a.toFixed(2)+"").split(".");a=b[0][0];var c=parseInt(b[0]),b=parseFloat(parseFloat(b[1]/60));return"-"!=a?c+b:-(Math.abs(c)+b)}function inSessantesimi(a){a||(a=0);var b=(a.toFixed(2)+"").split(".");a=b[0][0];var c=parseInt(b[0]),b=parseFloat((60*parseFloat(b[1])/100/100).toFixed(2));return"-"!=a?c+b:-(Math.abs(c)+b)}
function getProgTabella(a,b,c,d){var e;switch(a){case "P":e="/cba/per/prz/ws/tabgen/fnz/max";break;case "U":e="";break;case "A":e="";break;case "E":e="";break;case "G":e=""}Ext.Ajax.request({method:"GET",params:{table:b,field:c},url:e,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?d&&(a=a.data,d(a?a:"")):msgShowError("",a.message)}})}
function trasformaInTime(a){a=parseFloat(a);a=(a+"").split(".");a[1]?(a[1]=a[1].substring(0,2),1==a[1].length&&(a[1]*=10)):a[1]=0;var b=new Date(1899,11,30);b.setHours(a[0]);b.setMinutes(a[1]);return b}
function sommaOre(a,b,c,d){var e=new Date(1899,11,30,0,0,0,0);a||(a=new Date(1899,11,30,0,0,0,0));b||(b=new Date(1899,11,30,0,0,0,0));a=Ext.isDate(a)?a.getTime():trasformaInTime(a);b=Ext.isDate(b)?b.getTime():trasformaInTime(b);a=inSessantesimi("+"==c?(a-e+(b-e))/1E3/60/60:(a-e-(b-e))/1E3/60/60);d&&(a=azzeraData(trasformaInTime(a)));return a}
function getIdEsercizioDefaultByIdOrg(a,b){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/esercizioCont/defaultByOrg",params:{idOrganizzazione:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b&&(a=a.data,b(a?a:0)):msgShowError("",a.message)}})}
function getAnnoBilancioScalare(a,b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/prszn/get/idBilancioScalare",params:{idOrganizzazione:a,idEsercizio:b},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c&&(a=a.data,c(a?a:0)):msgShowError("",a.message)}})}
function getVerificaContoEconomico(a){var b=!1;Ext.Ajax.request({method:"GET",async:!1,params:{idConto:a},url:"/cba/gen/ws/general/pianoDeiConti/isContoEconomico",success:function(a){b=Ext.JSON.decode(a.responseText).data}});return b}function ImpostaUrlStore(a,b,c,d,e){a&&(a=a.getProxy(),a.url=b,a.api.read&&(a.api.read=b),a.api.create&&(a.api.create=c),a.api.update&&(a.api.update=d),a.api.destroy&&(a.api.destroy=e))}
function ImpostaUrl(a){var b=getUrlGen();Ext.each(a,function(a){if(a){var c=a.getProxy();if(c.urlGen){var e=b+c.urlGen,g=e.substring(0,e.lastIndexOf("/")+1),h=g+"new",c=g+(c.urlUpdate?c.urlUpdate:"update"),k=g+"delete";Ext.Array.contains([44,51,52,53,54,56,57,58,59,60,62],CBA.moduli.moduloAttivo)&&(h=g+"insert");ImpostaUrlStore(a,e,h,c,k)}}})}
function getUrlGen(){var a;switch(CBA.moduli.moduloAttivo){case 43:a="/cba/osp/co";break;case 46:a="/cba/osp/den";break;case 48:a="/cba/osp/la";break;case 55:a="/cba/osp/far";break;case 64:a="/cba/osp/rap";break;case 49:a="/cba/css/cs";break;case 69:a="/cba/css/cm";break;case 44:a="/cba/amm/cp";break;case 51:a="/cba/amm/an";break;case 52:a="/cba/amm/ib";break;case 53:a="/cba/amm/ces";break;case 54:a="/cba/amm/gb";break;case 56:a="/cba/amm/ce";break;case 57:a="/cba/eco/of";break;case 58:a="/cba/eco/mag";
break;case 59:a="/cba/eco/mn";break;case 60:a="/cba/eco/rc";break;case 62:a="/cba/eco/far";break;case 45:a="/cba/per/prz";break;default:a="/cba/osp/co"}return a}
function getPrefissoGen(){var a;switch(CBA.moduli.moduloAttivo){case 43:a="CO";break;case 46:a="DEN";break;case 48:a="LA";break;case 55:a="FAR";break;case 64:a="RAP";break;case 44:a="CP";break;case 45:a="PER";break;case 52:a="IB";break;case 51:a="AN";break;case 53:a="CES";break;case 54:a="GB";break;case 56:a="CE";break;case 57:a="OF";break;case 58:case 62:a="MF";break;case 59:a="MN";break;case 60:a="RC";break;case 69:a="CM";break;default:a=""}return a}
function getTipiServizio(a){if(Ext.isEmpty(a))switch(CBA.moduli.moduloAttivo){case 43:a="R,G,S,M,D";break;case 46:a="R,S,M";break;case 48:a="L";break;case 50:a="A";break;case 55:a="R,S,M";break;case 64:a="B";break;default:a=""}return a}function firstFieldFocusable(a){setTimeout(function(){var b=!1;a.getFields().items.forEach(function(a){!b&&a.isFocusable()&&(a.selectText(),b=!0)})},500)}
function clonaStore(a){var b=Ext.create("Ext.data.Store",{model:a.model,groupField:a.groupField});Ext.each(a.getRange(),function(c){c=Ext.clone(c.copy().data);c=new a.model(c,c.id);b.add(c)});b.groupers=a.groupers;return b}function cell_renderer_stringa(a,b,c,d,e,g,h){b.style="text-align:left !important";return a}function cell_renderer_importo(a,b,c,d,e,g,h){b.style="text-align:right !important";return Ext.util.Format.number(a,"0.00,")}
function cell_renderer_numero(a,b,c,d,e,g,h){b.style="text-align:right !important";return a}function cell_renderer_destra(a,b,c,d,e,g,h){b.style="text-align:right !important";return a}function cell_renderer_sinistra(a,b,c,d,e,g,h){b.style="text-align:left !important";return a}function cell_renderer_centrata(a,b,c,d,e,g,h){b.style="text-align:center !important";return a}function cell_renderer_prezzo(a,b,c,d,e,g,h){b.style="text-align:right !important";return Ext.util.Format.number(a,"0.00000,")}
Ext.override(Ext.form.field.Text,{constructor:function(a){this.callParent([a]);Ext.isEmpty(this.emptyText)&&"remote"==this.queryMode&&(this.emptyText=this.minChars?traduci("INSERIRE")+" "+this.minChars+" "+traduci("CARATTERI_PER_CERCARE"):"");return this}});function getParteInteraFrazione(a){a=a.toString().split(".");var b=0;2==a.length&&(b=parseFloat("0."+a[1]));return[parseFloat(a[0]),b]}
function arrotondaImporto(a,b,c){var d=0>a?-1:1,e,g;e=a=Math.abs(a);g=e*d;if(0==c||0==getParteInteraFrazione(a/c)[1])return g;"+"==b?e=(getParteInteraFrazione(a/c)[0]+1)*c:"-"==b?e=getParteInteraFrazione(a/c)[0]*c:"="==b&&(e=.5<=getParteInteraFrazione(a/c)[1]?(getParteInteraFrazione(a/c)[0]+1)*c:getParteInteraFrazione(a/c)[0]*c);return e*d}
function addToolTipCol(a,b,c,d,e,g,h,k){var l=Ext.id();a.el.down("div").appendChild({id:l,tag:"span",cls:"icon-info",style:"position: absolute; top: 3px; right: 3px;"});creaToolTip(l,b,c,d,e,g,h,k)}
function LoginSysDocFattEle(){var a="";Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/sysdoc/login",async:!1,success:function(b){b=Ext.JSON.decode(b.responseText);Ext.isDefined(b)&&(b.success?b.data&&(a=b.data.tokenSessionId):b.message&&msgShowError("",b.message))}});return a}
function setBadgeText(a,b,c,d){var e=a.getEl(),g=e.dom.childNodes,h=!1;c=c&&""!=c?c.toUpperCase():"TOPRIGHT";d=d&&""!=d?d:"#CB0811";Ext.each(g,function(a){a.id&&""!=a.id&&-1!=a.id.indexOf("cba-badge-text")&&(h=a)});!h&&b&&""!=b&&(h=document.createElement("span"),h.id="cba-badge-text-"+Ext.id(),e.insertFirst(h));if(b&&""!=b){h.innerText=b;h.className=" cba-badge-notification ";h.style.fontSize=13-b.length+"px";switch(c){case "TOPLEFT":h.style.marginLeft="1px";h.style.marginTop="1px";break;case "TOPRIGHT":h.style.marginLeft=
a.getWidth()-h.offsetWidth-2+"px";h.style.marginTop="1px";break;case "BOTTOMRIGHT":h.style.marginLeft=a.getWidth()-h.offsetWidth-2+"px";h.style.marginTop=a.getHeight()-h.offsetHeight-2+"px";break;case "BOTTOMLEFT":h.style.marginLeft="1px",h.style.marginTop=a.getHeight()-h.offsetHeight-2+"px"}h.style.background=d}else h&&h.remove();return h}
function setBadgeImage(a,b,c,d,e){var g=a.getEl(),h=g.dom.childNodes,k=!1;c=c&&""!=c?c.toUpperCase():"TOPRIGHT";e=e?e:20;Ext.each(h,function(a){a.id&&""!=a.id&&-1!=a.id.indexOf("cba-badge-text")&&(k=a)});!k&&b&&""!=b&&(k=document.createElement("img"),k.id="cba-badge-img-"+Ext.id(),g.insertFirst(k));if(b&&""!=b)switch(k.src=b,d&&""!=d&&(k.className=d),k.style.zIndex=9999,k.height=e,k.width=e,k.style.position="absolute",c){case "TOPLEFT":k.style.marginLeft="-3px";k.style.marginTop="-3px";break;case "TOPRIGHT":k.style.marginLeft=
a.getWidth()-k.offsetWidth-2+"px";k.style.marginTop="0px";break;case "BOTTOMRIGHT":k.style.marginLeft=a.getWidth()-k.offsetWidth-2+"px";k.style.marginTop=a.getHeight()-k.offsetHeight-2+"px";break;case "BOTTOMLEFT":k.style.marginLeft="1px",k.style.marginTop=a.getHeight()-k.offsetHeight-2+"px"}else k&&k.remove();return k}
function imgTitleFieldset(a,b,c,d,e,g,h){if(a.titleCmp){var k=traduci(a.title),l=a.titleCmp;if(b||h){var m=c?" cursor: pointer; ":"";Ext.isDefined(a.iconCmp)&&a.iconCmp.destroy();a.iconCmp=Ext.create("Ext.Img",{src:b||null,imgCls:h||null,style:"padding-left:0.5em;"+m+'" ',renderTo:a.legend.getId(),listeners:{afterrender:function(a){if(c)a.getEl().on("click",c);d&&creaToolTip(a.getId(),d)}}});e&&(a.iconCmp.setHeight(e),a.iconCmp.setWidth(g));l.update(traduci(k));c&&(a.cssIcon=a.iconCmp)}else l.update(traduci(k))}return a.iconCmp}
function isRecordGridEditabled(a,b){if(Ext.isDefined(a.solaLettura)&&1==a.solaLettura)return!1;var c=a.getStore().max(b),d=a.getSelection()[0];return c==d.get(b)||1==d.phantom}function getStringFromGridSelection(a,b){var c=[],d=a.getSelectionModel().getSelection();Ext.each(d,function(a){c.push(a.get(b))});return c=c.toString()}
function controllaCF(a){var b,c;if(""==a)return"";a=a.toUpperCase();if(16!=a.length)return"La lunghezza del codice fiscale non corretta: il codice fiscale dovrebbe essere lungo esattamente 16 caratteri.";for(b=0;16>b;b++)if(-1=="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(a.charAt(b)))return"Il codice fiscale contiene un carattere non valido `"+a.charAt(b)+"'.\nI caratteri validi sono le lettere e le cifre.\n";c=0;for(b=1;13>=b;b+=2)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(b))));
for(b=0;14>=b;b+=2)c+="BAKPLCQDREVOSFTGUHMINJWZYX".indexOf("ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(b))));return c%26!=a.charCodeAt(15)-65?"Il codice fiscale non  corretto: il codice di controllo non corrisponde.\n":""}
function winRichiediDatiProtocolloMancanti(){return(new Promise(function(a,b){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/prot/listCodEnteInt",success:function(c){c=Ext.JSON.decode(c.responseText);c.success?a(c.data):b(c.message)}})})).then(function(a){return a?new Promise(function(b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/prot/getCodFiscUtente",success:function(d){d=Ext.JSON.decode(d.responseText);d.success?(d=d.data,null==d||1!=
ControllaCF(d)||1<a.length?b({create:!0,recListEnti:a,codFiscUtente:d}):b({create:!1})):c(d.message)}})}):Promise.resolve({create:!1})}).then(function(a){return a.create?(a=new winCBA({name:"Generali.fatturazioneElettronica.view.FattElettronicaDatiProtocollo",titolo:"PR_DATI_PER_PROTOCOLLO_MANCANTI",height:200,width:350,closable:!1,configItem:{permesso:"S",recListEnti:a.recListEnti,codFiscUtente:a.codFiscUtente}}),Promise.resolve(a)):Promise.resolve(!1)})}
function doLogout(){Ext.Ajax.request({url:"/cba/gen/auth/logout",async:!1,success:function(a){abort_and_redirect_to_login()}})}function isAmministratoreOrg(){var a=!1;"T"!==CBA.parametriGenerali.amministratore&&"T"===CBA.parametriGenerali.amministratoreOrg&&(a=!0);return a}
function validatePassword(a,b){var c=null;b||(b=CBA.parametriGenerali.nomeUtente);if(CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione)(isOperatoreCBA(b)?/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{14,}$/:/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{10,}$/).test(a)||(c=traduci("MSG_VALIDATEPWD_FAILED",[isOperatoreCBA(b)?"14":"10"]));else if(!a||8>a.length)c="ERROR_MIN_PWD_LENGTH";return c}
function loadCurrRicoveroFromCSS(a,b){StdSipcar.promiseGetRequest(getUrlGen()+"/ws/genOsp/ricoveri/get",a).then(function(a){a?(currRicovero=Ext.create("GeneraliOSP.fascicoloNoApp.model.Ricoveri",a).getData(),b&&b()):currRicovero=null})["catch"](function(a){msgShowError("",a)})}function isOperatoreCBA(a){var b=!1;a&&("CBA"===a.toUpperCase()||a.toUpperCase().startsWith("CBA_"))&&(b=!0);return b}
function setSrcImage(a,b){Ext.Ajax.request({url:b,method:"GET",binary:!0,success:function(b){b=new Blob([b.responseBytes],{type:"octet/stream"});b=window.URL.createObjectURL(b);a.setSrc(b)}})}
function clickHref(a){window.event.preventDefault();Ext.Ajax.request({url:a.href,method:"GET",binary:!0,success:function(b){b=new Blob([b.responseBytes],{type:"octet/stream"});var c=window.URL.createObjectURL(b);b=document.createElement("a");b.href=c;b.download=a.download;document.body.appendChild(b);b.click();b.remove();setTimeout(function(){window.URL.revokeObjectURL(c)},100)}})}
function parseJwt(a){a=a.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");a=decodeURIComponent(atob(a).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(a)}channel_cba.addEventListener("message",function(a){a.data.type==type_message_channel.REDIRECT_TO_LOGIN&&abort_and_redirect_to_login()});
function getPersonFinanziaria(){var a=[!1,!1];Ext.Ajax.request({url:"/cba/gen/ws/general/getPersonFina",async:!1,success:function(b){a=JSON.parse(b.responseText)}});return a}Ext.define("CbaUtils.override.all.Base",{override:"Ext.Base",initConfig:function(a){this.callParent([a]);this.cbaConfig=this.cbaConfig||{};return this}});
Ext.define("CbaUtils.override.all.ColumnDate",{override:"Ext.grid.column.Date",defaultRenderer:function(a){return Ext.Date.isEqual(a,new Date(1899,11,31,0,0,0))?"24:00":Ext.util.Format.date(a,this.format)}});Ext.define("CbaUtils.override.all.Component",{override:"Ext.Component",initComponent:function(){this.callParent(arguments);this.on("enable",function(a){a.isMasked()&&a.unmask()})}});Ext.define("CbaUtils.override.all.FieldDate",{override:"Ext.data.field.Date",dateReadFormat:"Y-m-d H:i:s"});
Ext.define("CbaUtils.override.all.LocalStore",{override:"Ext.data.LocalStore",getByInternalId:function(a){var b=this.getData(),c;this.hasInternalKeys&&this.byInternalId||(c={byInternalId:{property:"internalId",rootProperty:""}},this.hasInternalKeys=!0);b.filtered&&(c&&b.setExtraKeys(c),b=b.getSource());c&&b.setExtraKeys(c);return b.byInternalId.get(a)||null}});Ext.define("CbaUtils.override.all.Panel",{override:"Ext.panel.Panel",dockedItems:void 0});
Ext.define("CbaUtils.override.all.SchLockableGridEmptyText",{override:"Ext.grid.locking.Lockable",syncLockableLayout:function(){this.store.getCount()&&!this.afterLayoutListener&&(this.afterLayoutListener=Ext.on({afterlayout:this.doSyncLockableLayout,scope:this,single:!0}));!this.lockable||this.store.getCount()||!this.lockedGrid.getEmptyText()&&!this.normalGrid.getEmptyText()||this.afterLayoutListener||(this.afterLayoutListener=Ext.on({afterlayout:this.doSyncLockableLayout,scope:this,single:!0}))}});
Ext.define("CbaUtils.override.all.Store",{override:"Ext.data.Store",getByInternalId:function(a){var b=this.getData(),c;this.hasInternalKeys&&this.byInternalId||(c={byInternalId:{property:"internalId",rootProperty:""}},this.hasInternalKeys=!0);b.filtered&&(c&&b.setExtraKeys(c),b=b.getSource());c&&b.setExtraKeys(c);return b.byInternalId.get(a)||null}});
Ext.define("CbaUtils.override.all.ToolTip",{override:"Ext.tip.ToolTip",initComponent:function(){this.callParent();var a=[49];CBA.moduli&&CBA.moduli.moduloAttivo&&-1!=a.indexOf(CBA.moduli.moduloAttivo)&&(this.addCls("cbabubble-action"),this.addBodyCls("cbabubble-text-color-blue"));return this}});
Ext.define("CbaUtils.override.desktop.BufferedRenderer",{override:"Ext.grid.plugin.BufferedRenderer",onRangeFetched:function(a,b,c,d,e){var g=this.view,h=this.scroller,k=g.el,l=g.all,m=0,n,p=g.lockingPartner&&!e&&!this.doNotMirror&&g.lockingPartner.bufferedRenderer,q=this.variableRowHeight,t,v,u,w;if(!g.destroyed){if(a)e||(this.scrollTop=this.scroller.getPosition().y);else if(a=this.store.getRange(b,c),!a)return;t=Ext.fly(Ext.Element.getActiveElement());(v=k.contains(t))&&t.suspendFocusEvents();n=
b*this.rowHeight;if(b<l.startIndex&&c>l.endIndex){n=l.startIndex-b;g.clearViewEl(!0);u=g.doAdd(a,b);g.fireItemMutationEvent("itemadd",a,b,u,g);for(h=0;h<n;h++)m-=u[h].offsetHeight;m=this.bodyTop+m}else{if(w=this.teleported||b>l.endIndex||c<l.startIndex)g.clearViewEl(!0),this.teleported=!1;l.getCount()?c>l.endIndex?(u=Math.max(b-l.startIndex,0),q&&(m=l.item(l.startIndex+u,!0).offsetTop),u=l.scroll(Ext.Array.slice(a,l.endIndex+1-b),1,u),g.el.dom.scrollTop=this.scrollTop,m=q?this.bodyTop+m:n):(u=Math.max(l.endIndex-
c,0),m=l.startIndex,u=l.scroll(Ext.Array.slice(a,0,l.startIndex-b),-1,u),g.el.dom.scrollTop=this.scrollTop,q)?(m=this.bodyTop-l.item(m,!0).offsetTop,l.startIndex)?0>m&&(m=l.startIndex*this.rowHeight,h.scrollTo(null,this.position=this.scrollTop+=m),m=this.bodyTop+m):m&&(h.scrollTo(null,this.position=this.scrollTop-=m),m=0):m=n:(u=g.doAdd(a,b),g.fireItemMutationEvent("itemadd",a,b,u,g),m=n,w&&q&&(h=this.scrollTop<this.position?this.leadingBufferZone:this.trailingBufferZone,m=Math.max(this.scrollTop-
l.item(l.startIndex+h-1,!0).offsetTop,0)));this.position=this.scrollTop}v&&(t.resumeFocusEvents(),k.contains(t)||(k=g.actionableMode?g.actionPosition:g.lastFocused)&&k.column&&(g.renderingRows=!0,g.onFocusLeave({}),g.renderingRows=!1,k=k.column.focusable?k.column:k.column.el.findTabbableElements()[0],k||(k=g.el),k.focus()));m=Math.max(Math.floor(m),0);u&&p&&!p.disabled&&(p.scrollTop=p.position=this.scrollTop,p.view.ownerCt.isVisible()&&(a=p.onRangeFetched(a,b,c,d,!0),g.ownerGrid.syncRowHeight||g.ownerGrid.syncRowHeightOnNextLayout||
p.variableRowHeight!==q)&&(this.syncRowHeights(u,a),g.ownerGrid.syncRowHeightOnNextLayout=!1),p.bodyTop!==m&&p.setBodyTop(m,!0));g.positionBody&&!e&&this.setBodyTop(m,!0);this.variableRowHeight&&(delete this.rowHeight,this.refreshSize());g.getVisibleColumnManager().getColumns().length&&l.getCount()!==Math.min(this.store.getCount(),this.viewSize)&&Ext.raise("rendered block refreshed at "+l.getCount()+" rows while BufferedRenderer view size is "+this.viewSize);return u}}});
Ext.define("CbaUtils.override.desktop.Button",{override:"Ext.button.Button",enable:function(a,b){var c=this.href,d=this.hrefTarget,e;if(!b||!this.alreadyDisabled)return this.alreadyDisabled=!1,this.callParent(arguments),this.hasCls(this.disabledCls)?this.addCls(this._disabledCls):this.removeCls(this._disabledCls),this.rendered&&(e=this.el.dom,e.setAttribute("tabindex",this.tabIndex),c&&(e.href=c),d&&(e.target=d)),this},disable:function(a,b){var c;b&&(this.alreadyDisabled=this.hasCls(this._disabledCls));
this.callParent(arguments);this.addCls(this._disabledCls);this.removeCls(this.overCls);this.rendered&&(c=this.el.dom,c.removeAttribute("tabindex"),this.href&&c.removeAttribute("href"),this.hrefTarget&&c.removeAttribute("target"));return this}});
Ext.define("CbaUtils.override.desktop.CheckboxModel",{override:"Ext.selection.CheckboxModel",headerWidth:33,privates:{selectWithEventMulti:function(a,b,c){b.shiftKey||b.ctrlKey||!b.getTarget(this.checkSelector)?this.callParent([a,b,c]):c?this.doDeselect(a):this.doSelect(a,!0)}}});Ext.define("CbaUtils.override.desktop.Display",{override:"Ext.form.field.Display",cls:"cba-display-field"});
Ext.define("CbaUtils.override.desktop.Editing",{override:"Ext.grid.plugin.Editing",onEscKey:function(a){if(this.editing&&(a=Ext.getCmp(a.getTarget().getAttribute("data-componentid")),!(a&&a.isPickerField&&a.isExpanded)))return this.cancelEdit()}});
Ext.define("CbaUtils.override.desktop.FileField",{override:"Ext.form.field.File",multiple:!1,initComponent:function(){this.on("afterrender",function(){this.setMultiple()},this);this.callParent(arguments)},reset:function(){this.callParent(arguments);this.setMultiple()},setMultiple:function(a){a=a||this.fileInputEl;this.multiple&&a.dom.setAttribute("multiple","multiple")}});
Ext.define("CbaUtils.override.desktop.FormFieldDate",{override:"Ext.form.field.Date",formatText:"",setValue:function(a){this.callParent(arguments);this.lastValue=this.rawDateText;this.lastDate=this.rawDate;Ext.isDate(a)?("d/m/Y"==this.format&&(a=Ext.Date.clearTime(Ext.clone(a))),this.rawDate=a,this.rawDateText=this.formatDate(a)):(this.rawDate=this.rawToValue(a),this.rawDateText=this.formatDate(a),this.rawDate===a&&(this.rawDate=null,this.rawDateText=""))}});
Ext.define("CbaUtils.override.desktop.GridPanel",{override:"Ext.grid.Panel",cbaPaged:!1,cbaLocalFilter:!1,scrollDaFiltro:function(a,b){var c={firstResult:this.getStore().getCount(),maxResults:a-b};this.store.cbaConfig.parametri||(this.store.cbaConfig.parametri={});Ext.apply(this.store.cbaConfig.parametri,c);this.aggiornaStore()},aggiornaStore:function(){Ext.apply(this.cbaConfig.paged,{fromScroll:!0});var a=this.up("[isCbaControlledContainer]");if(a){a=a.getController();if(a.cbaConfig.fnAggiorna)return a.cbaConfig.fnAggiorna.apply(a);
if(Ext.isDefined(a.updatePortlet)&&Ext.isFunction(a.updatePortlet))return a.updatePortlet();if(Ext.isDefined(a.aggiornaStore)&&Ext.isFunction(a.aggiornaStore))return a.aggiornaStore()}else CBA.parametriGenerali.produzione||alert("Info sviluppo: \n CBA viewController not found!")},cbaScrollList:function(){var a,b=this.getStore();a=b.getCount();var c=b.data.getSource()?b.data.getSource().length:null,d=b.cbaConfig&&b.cbaConfig.parametri?b.cbaConfig.parametri:null,d=d&&d.maxResults?d.maxResults:this.cbaConfig.paged.maxResults,
e=this.cbaConfig.paged.descrizione||null,c=c?c/d:a/d;if(this.cbaLocalFilter){for(var g=a/d;1<g;)a-=d,g=a/d;if(0!=d-a)return this.scrollDaFiltro(d,a),!1}a={firstResult:b.getCount(),descrizione:e,maxResults:d};b.cbaConfig.parametri||(b.cbaConfig.parametri={});Ext.apply(b.cbaConfig.parametri,a);-1==c.toString().indexOf(".")&&this.aggiornaStore()},initComponent:function(){var a=this;this.callParent(arguments);if(a.cbaPaged){Ext.apply(a.cbaConfig,{paged:{maxResults:30,descrizione:null,fromScroll:!1}});
var b=a.getView().getScrollable();b.on("scrollend",function(b){b.getPosition().y>Math.abs(b.getMaxPosition().y-10)&&a.cbaScrollList()});a.on("resize",Ext.Function.createBuffered(function(c,d,e,g,h){c=c.getStore();if(!c||(d=c.getData())&&d.getSource()&&0==d.getSource()||0==c.getCount())return!1;e>h&&0==b.getMaxPosition().y&&a.cbaScrollList()},200,a));a.getStore().on("datachanged",Ext.Function.createBuffered(function(){var c=a.getStore(),d=c.cbaConfig&&c.cbaConfig.parametri?c.cbaConfig.parametri:null,
d=d&&d.maxResults?d.maxResults:a.cbaConfig.paged.maxResults;a.cbaLocalFilter&&c.data.length<=d&&0>=b.getMaxPosition().y&&a.cbaScrollList();c.data.length>=d&&0>=b.getMaxPosition().y&&a.cbaScrollList()},50,a))}}});Ext.define("CbaUtils.override.desktop.Menu",{override:"Ext.menu.Menu",autoFocus:!0,afterShow:function(){this.callParent(arguments);this.on("blur",this.hide,this)}});
Ext.define("CbaUtils.override.desktop.PickerTime",{override:"Ext.picker.Time",height:0,statics:{createStore:function(a,b){for(var c=Ext.Date,d=[],e=new Date(1899,11,30,0,0,0),g=new Date(1899,11,30,23,59,59);e<=g;)d.push({disp:c.dateFormat(e,a),date:e}),e=c.add(e,"mi",b);d.push({disp:"24:00",date:new Date(1899,11,30,23,59,59)});return new Ext.data.Store({model:Ext.picker.Time.prototype.modelType,data:d})}},updateList:function(){var a=new Date(1899,11,30,0,0,0),b=new Date(1899,11,30,23,59,59),c=this.getStore().getFilters(),
d=this.rangeFilter;c.beginUpdate();d&&c.remove(d);d=this.rangeFilter=new Ext.util.Filter({filterFn:function(c){c=c.get("date");return c>=a&&c<=b}});c.add(d);c.endUpdate()}});
Ext.define("CbaUtils.override.desktop.QuickTip",{override:"Ext.tip.QuickTip",initComponent:function(){this.callParent();var a=[49];this.on("show",function(b){CBA.moduli&&CBA.moduli.moduloAttivo&&-1!=a.indexOf(CBA.moduli.moduloAttivo)&&(b=b.getEl().dom.className,-1!=b.indexOf("error")||-1!=b.indexOf("invalid")?this.addCls("cbabubble-error"):this.addCls("cbabubble-action"),this.addBodyCls("cbabubble-text-color-blue"))});return this}});
Ext.define("CbaUtils.override.desktop.RadioGroup",{override:"Ext.form.RadioGroup",autoEl:"form"});Ext.define("CbaUtils.override.desktop.RowEditing",{override:"Ext.grid.plugin.RowEditing",onEnterKey:function(a){!this.grid.ownerGrid.actionableMode&&this.editing&&(a=Ext.getCmp(a.getTarget().getAttribute("data-componentid")),this.editor.getForm().isValid()&&(a&&a.isPickerField&&a.isExpanded||this.completeEdit()))}});
Ext.define("CbaUtils.override.desktop.RowEditor",{override:"Ext.grid.RowEditor",syncButtonPosition:function(a){a=this.getScrollDelta();var b=this.getFloatingButtons(),c=Math.max(0,this.scroller.getSize().y-this.scroller.getClientSize().y),c=a-(c-this.scroller.getPosition().y);b.show();0<c?(this._buttonsOnTop||(b.setButtonPosition("top"),this._buttonsOnTop=!0,this.layout.setAlign("bottom"),this.updateLayout()),a=0):!1!==this._buttonsOnTop?(b.setButtonPosition("bottom"),this._buttonsOnTop=!1,this.layout.setAlign("top"),
this.updateLayout()):b.setButtonPosition(b.position);return a}});Ext.define("CbaUtils.override.desktop.RowEditorButtons",{override:"Ext.grid.RowEditorButtons",setButtonPosition:function(a){var b=this.rowEditor,c=b.getHeight(),d=b.body,e="",g="",b=b.editingPlugin.grid.getStore();12>=c&&1==b.getCount()&&(c=31);this.removeClsWithUI(this.position);this.position=a;this.addClsWithUI(a);"top"===a?e=c-d.getBorderWidth("t")+"px":g=c-d.getBorderWidth("b")+"px";this.el.setStyle({top:g,bottom:e})}});
Ext.define("CbaUtils.override.desktop.RowModel",{override:"Ext.selection.RowModel",doSelect:function(a,b,c){if(!(this.view&&this.view.grid&&this.view.grid.editingPlugin&&this.view.grid.editingPlugin.editor&&this.view.grid.editingPlugin.editor.isVisible())){this.callParent(arguments);if(Ext.isNumber(a))if(a=this.store.getAt(a))a=[a];else return;if(!Ext.isArray(a)){var d=getCallerFunction();d&&-1==d.indexOf("ext-all")&&StdSipcar.warn("Passato un singolo record anziche un Array in "+getCallerFunction());
a=[a]}if(a&&a.length)try{this.view.grid.ensureVisible(a[0])}catch(e){StdSipcar.warn("Error in doSelect of CBA.selection.RowModel"+e)}}}});
Ext.define("CbaUtils.override.desktop.RowWrap",{override:"Ext.grid.feature.RowWrap",wrapTpl:['<tr data-boundView="{view.id}" data-recordId="{record.internalId}" data-recordIndex="{recordIndex}" class="{[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]} '+Ext.baseCSSPrefix+'grid-wrap-row">','<td class="'+Ext.baseCSSPrefix+"grid-rowwrap "+Ext.baseCSSPrefix+'grid-td" colSpan="{columns.length}">','<table class="'+Ext.baseCSSPrefix+"{view.id}-table "+Ext.baseCSSPrefix+'grid-table" border="0" cellspacing="0" cellpadding="0">',
"{[values.view.renderColumnSizer(out)]}","{%","values.itemClasses.length = 0;","this.nextTpl.applyOut(values, out, parent)","%}","</table>","</td>","</tr>",{priority:200}]});Ext.define("CbaUtils.override.desktop.TimeField",{override:"Ext.form.field.Time",initDate:"30/12/1899",initDateParts:[1899,11,30]});
Ext.define("CbaUtils.componenti.all.Avatar",{extend:"Ext.container.Container",alias:"widget.avatar",alternateClassName:"avatar",height:48,color:"#000000",label:"X",click:Ext.emptyFn,"float":"",style:"",tooltip:Ext.emptyFn,fontPercent:100,fontColor:"#FFF",shape:"circle",initComponent:function(){var a="canvas-"+this.id;this.width=this.height;Ext.isEmpty(this["float"])||(this.style="float:"+this["float"]+"; "+this.style);this.setHtml('<canvas id="'+a+'" width="'+this.height+'" height="'+this.height+
'" style="border-radius: '+("circle"==this.shape?50:15)+'%;"></canvas>');this.callParent(arguments);this.on("afterrender",function(b){var c=Ext.get(a);b.createAvatar(c,b.color,b.label,b.fontPercent,b.fontColor);c.setStyle("cursor",b.click.$emptyFn?"auto":"pointer");Ext.isEmpty(b.extraCls)||b.addCls(b.extraCls);b.tooltip(b);b.getEl().on("click",function(){b.click()})})},createAvatar:function(a,b,c,d,e){var g=a.dom.getContext("2d"),h=a.getWidth(),k=a.getHeight();g.fillStyle=b;g.fillRect(0,0,h,k);g.font=
d+"% helvetica";g.textAlign="center";g.fillStyle=e;g.fillText(c,h/2,k/1.5,h-5);a.label=c}});
Ext.define("CbaUtils.componenti.all.CbaMultipleChoice",{extend:"Ext.form.FieldSet",alias:"widget.cbaMultipleChoice",alternateClassName:"cbaMultipleChoice",layout:{type:"hbox",align:"stretch",pack:"center"},initComponent:function(){var a=this,b;this.items=[];Ext.each(a.cbaConfig.itemsCfg,function(c){b=c.itemId?c.itemId:null;var d=Ext.create("Ext.Container",{layout:{type:"hbox"}}),g=[{xtype:"container",width:c.width||32,height:c.height||32,margin:c.margin||5,html:c.html,cls:c.cls?c.cls+" disable-select-text-highlight":
"choice-round-unchecked disable-select-text-highlight",style:c.style,flex:c.flex,listeners:{afterrender:function(a){c.toolTip&&creaToolTip(a.getId(),c.toolTip)}},items:[{xtype:"checkbox",itemId:b,reference:b,name:c.name,hidden:!0,value:c.value,isFormField:a.cbaConfig.esclusivo?!1:c.isFormField,id:Ext.id(),inputValue:c.inputValue||!0,uncheckedValue:c.uncheckedValue||!1,cbaConfig:{checkedClsPerson:c.checkedClsPerson,extra:c.extra},nascondiCampo:function(a){this.up().setVisible(a)}}]}];d.add(g);Ext.isEmpty(c.label)&&
Ext.isEmpty(c.labelHtml)||d.add({xtype:"label",text:c.label,html:c.labelHtml,height:c.labelHeight,margin:c.labelMargin||"7 0 0 7"});a.items.push(d)});var c=a.cbaConfig.itemsCfg[0];a.cbaConfig.esclusivo&&c.isFormField&&(c=Ext.create("Ext.container.Container",{itemId:"FakeCheck",hidden:!0,items:[{xtype:"textfield",name:c.name,isFormField:!0,width:32,value:null,listeners:{change:function(b,c,g,h){if(b.cbaConfig.suspendChange)return!1;b.cbaConfig.changeFromCheck||(b.cbaConfig.changeFromText=!0,h=b.up("cbaMultipleChoice").query("checkbox"),
Ext.each(h,function(a){c&&""!=c?a.setValue(a.inputValue==c):a.setValue(!1)}),b.cbaConfig.changeFromText=!1);a.fireEvent("choicechange",b,c,g)}}}]}),a.items.push(c),a.cbaConfig.fakeCheckbox=c.down("textfield"));this.callParent(arguments)},listeners:{afterrender:function(a){var b=this,c=a.cbaConfig.esclusivo,d,e=a.query("checkbox");Ext.each(e,function(g){d=g.up("container");d.getEl().on("click",function(){if(g.isDisabled()||g.readOnly)return!1;if(c){if(g.getValue()&&!g.up("cbaMultipleChoice").cbaConfig.deselezionabile)return!1;
Ext.each(e,function(a){a.getId()!=g.getId()&&(a.cbaConfig.onResetValue=!0,a.setValue(!1),a.cbaConfig.onResetValue=!1)})}g.setValue(!g.getValue())});g.on("change",function(c,d){if(c.cbaConfig.onResetValue)return!1;var h=c.cbaConfig.checkedClsPerson,h=h?h:"choice-checked";d?c.up("container").addCls(h):c.up("container").removeCls(h);if(a.cbaConfig.esclusivo){var k=null;Ext.each(e,function(a){a.getValue()&&a.inputValue==c.inputValue&&(k=a.inputValue);a.getId()!=c.getId()&&(a.up("container").removeCls(a.cbaConfig.checkedClsPerson||
"choice-checked"),a.cbaConfig.onResetValue=!0,a.setValue(!1),a.cbaConfig.onResetValue=!1)});c.cbaConfig.onResetValue||!a.cbaConfig.fakeCheckbox||a.cbaConfig.fakeCheckbox.cbaConfig.changeFromText||(a.cbaConfig.fakeCheckbox.cbaConfig.changeFromCheck=!0,a.cbaConfig.fakeCheckbox.setValue(k),a.cbaConfig.fakeCheckbox.cbaConfig.changeFromCheck=!1)}else b.fireEvent("itemselect",a,d,g.inputValue)});var h=g.getValue();h&&(g.cbaConfig.onResetValue=!0,g.setValue(!h),g.cbaConfig.onResetValue=!1,g.setValue(h))})}},
setValueExclusive:function(a){var b=this.cbaConfig.fakeCheckbox;this.cbaConfig.esclusivo&&b&&(b=this.query("checkbox"),Ext.each(b,function(b){a?a==b.inputValue?b.setValue(a):b.getValue()?(b.cbaConfig.onResetValue=!0,b.setValue(!1),b.cbaConfig.onResetValue=!1):b.setValue(!1):b.setValue(!1)}))},getValueExclusive:function(){return this.cbaConfig.esclusivo&&this.cbaConfig.fakeCheckbox?this.cbaConfig.fakeCheckbox.getValue():null},isCompiled:function(){var a=!1,b=this.query("checkbox");b&&Ext.each(b,function(b){b.getValue()&&
(a=!0)});return a}});
Ext.define("CbaUtils.componenti.all.CbaSearchfield",{extend:"Ext.container.Container",alias:"widget.cbaSearchfield",alternateClassName:"cbaSearchfield",layout:{type:"hbox",align:"stretch"},initComponent:function(){var a=this,b=this.cbaConfig;this.items=[{xtype:"image",itemId:"Lens",reference:"Lens",src:"/cba/generali/images/svg/others/search-material.svg",width:24,height:24,cls:"x-classic-search-field-lens"},{xtype:"textfield",itemId:"SearchOperatori",reference:"SearchOperatori",width:b.reducedWidth||
125,emptyText:b.emptyText||"",cls:"transition-200 x-classic-text-field-no-left",isFormField:!1,listeners:{focus:function(a){a.focused=!0;a.setWidth(b.expandedWidth||"100%");a.up().down("#Lens").addCls("x-classic-search-field-lens-focus");a.up().down("#ClearIcon").addCls("x-classic-search-field-clear-focus")},blur:function(a){setTimeout(function(){if(!a.destroyed){var c=a.up().down("#ClearIcon");(a.focused=c.clicked)?(c.clicked=!1,a.removeCls("transition-200"),a.focus(),setTimeout(function(){a.setWidth(b.expandedWidth||
"100%");a.addCls("transition-200")},20)):(a.up().down("#Lens").removeCls("x-classic-search-field-lens-focus"),c.removeCls("x-classic-search-field-clear-focus"));!c.clicked&&Ext.isEmpty(a.getValue())&&a.setWidth(b.reducedWidth||125)}},100)},afterrender:function(b){b.on("change",Ext.Function.createBuffered(function(b,c,g){b.up().down("#ClearIcon").setHidden(Ext.isEmpty(c));a.fireEvent("change",b,c,g)},200))}}},{xtype:"image",itemId:"ClearIcon",reference:"ClearIcon",src:"/cba/generali/images/svg/others/clear-icon.svg",
width:24,height:24,cls:"transition-200 x-classic-search-field-clear",hidden:!0,style:{cursor:"pointer"},listeners:{hide:function(a){return a.up().down("#SearchOperatori").removeCls("x-classic-text-field-no-right")},show:function(a){return a.up().down("#SearchOperatori").addCls("x-classic-text-field-no-right")},afterrender:function(a){a.getEl().on("click",function(){a.clicked=!0;var c=a.up().down("#SearchOperatori"),e=c.focused;c.setValue();e||(c.setWidth(b.reducedWidth||125),a.clicked=!1)})}}}];this.callParent(arguments)}});
Ext.define("CbaUtils.componenti.all.PanelAttivaFunzioniCBA",{extend:"Generali.standard.ControlledContainer",alias:"widget.panelAttivaFunzioniCBA",alternateClassName:"panelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE",nomeFunzioneDaAttivare:"nome funzione",codiceFunzione:"FN_TO_ACTIVATE",initComponent:function(){var a=this;a.initCmpSblocco();Ext.isEmpty(a.codiceFunzione)?msgShowError("","codice Funzione da abilitare non definito"):(StdSipcar.isValidID(a.idOrganizzazione)||(a.idOrganizzazione=
StdSipcar.coalesce(a.cbaConfig.idOrganizzazione,getIdOrg())),a.on("beforerender",function(){Ext.Ajax.request({method:"GET",url:getUrlGen()+"/auth/extraFn/isEnabled",params:{codiceFunzione:a.codiceFunzione,idOrganizzazione:a.idOrganizzazione},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.sbloccaVideata(a,b.data):msgShowError("",b.message)}})}));a.callParent(arguments)},initCmpSblocco:function(){var a=this,b=a.items;a.items=[];a.items=[{xtype:"container",border:0,layout:{align:"stretch",
type:"vbox"},title:"",items:[{xtype:"panel",cls:"pannelloBiancoBordato",itemId:"PnlCommerciale",reference:"PnlCommerciale",margin:3,layout:{align:"stretch",type:"vbox"},hidden:!0,height:120,border:0,items:[{xtype:"label",margin:"30 15 0 15",cls:"cbaLabelDatiUtente",text:traduci(a.messaggioAttivazione),style:"text-align:center"},{xtype:"label",margin:"30 15 0 15",cls:"cbaLabelDatiUtente",text:traduci("MSG_INFOCOMMERCIALE"),style:"text-align:center"}]},{xtype:"button",scale:"large",cls:"cbaLabel",itemId:"BtnAttiva",
reference:"BtnAttiva",hidden:!0,iconCls:"icon-elabora32",text:traduci("ATTIVA_FUNZIONE")+" "+traduci(a.nomeFunzioneDaAttivare),handler:function(){Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(b){b?(b=new Date,b=b.getTime()-(new Date(b.getFullYear(),b.getMonth(),1)).getTime(),Ext.Ajax.request({method:"POST",timeout:12E5,url:getUrlGen()+"/auth/extraFn/enable",params:{codiceFunzione:a.codiceFunzione,crc:b,idOrganizzazione:a.idOrganizzazione},success:function(b){b=Ext.JSON.decode(b.responseText);
b.success?(msgShowText("","ENTE_ABILITATO"),a.sbloccaVideata(a,!0)):msgShowError("",b.message)}})):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()}},{xtype:"container",itemId:"CntDati",reference:"CntDati",flex:1,layout:"fit",hidden:!0,items:b}]}]},sbloccaVideata:function(a,b){b?(a.down("#PnlCommerciale").setVisible(!1),a.down("#BtnAttiva").setVisible(!1),a.down("#CntDati").setVisible(!0),a.controller.loadData()):(a.down("#PnlCommerciale").setVisible(!0),a.down("#BtnAttiva").setVisible(!0))}});
Ext.define("CbaUtils.componenti.all.Rating",{extend:"Ext.container.Container",alias:"widget.rating",alternateClassName:"rating",maxStar:5,initComponent:function(){this.starSelezionate=0;for(var a=[],b=0;b<=this.maxStar;b++)a.push({xtype:"image",height:16,width:16,margin:0==b?"0 10 0 0":0,itemId:"Star"+b,reference:"Star"+b,valore:b,style:"cursor:pointer",cls:"icon-blackstar",listeners:{render:this.renderStar}});Ext.applyIf(this,{items:a});this.callParent(arguments)},renderStar:function(a){var b=a.up("rating");
"Star0"==a.getItemId()&&creaToolTip(a.getId(),"AZZERA_RATING","");a.el.on("click",function(){b.selezionaStar(a)})},cancellaStar:function(){for(var a=1;a<=this.maxStar;a++){var b=this.down("#Star"+a);b.removeCls("icon-fullstar");b.addCls("icon-blackstar")}},selezionaStar:function(a){var b=a.up("rating");b.starSelezionate=a.valore;b.cancellaStar();for(a=1;a<=b.starSelezionate;a++){var c=b.down("#Star"+a);c.removeCls("icon-blackstar");c.addCls("icon-fullstar")}b.clickStar&&b.clickStar()},getValue:function(){return this.starSelezionate},
setValue:function(a){Ext.isEmpty(a)&&(a=0);a=this.down("#Star"+a);this.selezionaStar(a)}});Ext.define("CbaUtils.componenti.desktop.Anno",{extend:"Ext.form.field.Number",alias:"widget.anno",alternateClassName:"anno",useThousandSeparator:!1,editable:!1,allowDecimals:!1,fieldStyle:"text-align:right",labelClsExtra:"cbaLabel",fieldLabel:"ANNO",hideTrigger:!1,name:"anno",width:120,labelWidth:50});
Ext.define("CbaUtils.componenti.desktop.ButtonStampa",{extend:"Ext.button.Split",alias:"widget.buttonStampa",alternateClassName:"buttonStampa",iconCls:"icon-stampa32",scale:"large",text:traduci("STAMPA"),hidden:!0,initComponent:function(){var a=this;a.menu={xtype:"menu",itemId:"BtnStampa_menu",showSeparator:!1,items:[{xtype:"menuitem",itemId:"BtnStampa_Pdf",iconCls:"icon-pdf16",text:traduci("STAMPA_PDF"),cbaConfig:{formato:"pdf"},handler:function(b){a.clickButton(b)}},{xtype:"menuitem",itemId:"BtnStampa_Xls",
iconCls:"icon-xls16",text:traduci("ESPORTA_XLS"),cbaConfig:{formato:"excel"},handler:function(b){a.clickButton(b)}},{xtype:"menuitem",itemId:"BtnStampa_Csv",iconCls:"icon-csv16",text:traduci("ESPORTA_CSV"),cbaConfig:{formato:"csv"},handler:function(b){a.clickButton(b)}},{xtype:"menuitem",itemId:"BtnStampa_Xml",iconCls:"icon-xml16",text:traduci("ESPORTA_XML"),cbaConfig:{formato:"xml"},handler:function(b){a.clickButton(b)}},{xtype:"menuitem",itemId:"BtnStampa_Txt",iconCls:"icon-txt16",text:traduci("ESPORTA_TXT"),
cbaConfig:{formato:"text"},handler:function(b){a.clickButton(b)}}]};a.callParent(arguments);a.gestisciItemsVisibili(a.cbaConfig);Ext.Object.isEmpty(a.cbaConfig)||a.show()},listeners:{render:function(a){22>=a.getHeight()&&a.setIconCls("icon-stampa")},click:function(a){this.cbaConfig.click&&this.cbaConfig.click();var b=Ext.clone(this.cbaConfig);b.params||(b.params={});var c="pdf";a.cbaConfig.formato?c=a.cbaConfig.formato:b.params.format&&(c=b.params.format,this.gestisciItemsVisibili(b));Ext.apply(b.params,
{format:c});"pdf"!=c&&Ext.apply(b.params,{reportDaEsportare:!0});this.cbaConfig.stampa_callback?(delete b.stampa_callback,this.cbaConfig.stampa_callback(b)):this.lanciaStampa(a,b);this.cbaConfig.afterStampa&&this.cbaConfig.afterStampa()}},clickButton:function(a){this.fireEvent("click",a)},gestisciItemsVisibili:function(a){var b=!1;a&&a.hideMenu&&(b=a.hideMenu);b?this.setArrowVisible(!1):(this.menu.down("#BtnStampa_Xls").setVisible(a&&a.hideExcel?!a.hideExcel:!0),this.menu.down("#BtnStampa_Csv").setVisible(a&&
a.hideCsv?!a.hideCsv:!0),this.menu.down("#BtnStampa_Xml").setVisible(a&&a.hideXml?!a.hideXml:!0),this.menu.down("#BtnStampa_Txt").setVisible(a&&a.hideTxt?!a.hideTxt:!0));this.menu.setHeight(b?0:"")},lanciaStampa:function(a,b){if(!b.params.sospendiStampa){var c;c=this.up("window");if(this.cbaConfig.renderTo||c&&c.down("#PageAnteprima"))c=this.up("tabpanel"),c.setActiveTab(c.down("#PageAnteprima")),c.down("#BtnIndietro").setDisabled(!1),c.down("#BtnAvanti").setDisabled(!0);else{c=Ext.create("winCBA",
{name:[{xtype:"stampaCBA"}],callBackRenderWin:this.cbaConfig.hideBtnStampaOnSecondaryWin?function(){var a=this.down("stampaCBA");a&&(a=a.tabBar)&&(a=a.queryById("BtnStampa"))&&a.hide()}:!1,titolo:b.titolo,dimensione:1}).show();var d=c.down("#BtnStampa");d.cbaConfig=this.cbaConfig;d.gestisciItemsVisibili(d.cbaConfig);c=c.down("tabpanel")}Ext.apply(b,{renderTo:c.down("#PageAnteprima")});var e;this.cbaConfig.winElaborazione&&(e=newIdElab(),Ext.apply(b.params,{idAvanzamentoElaborazione:e}));stampaEsporta(a,
b);this.cbaConfig.winElaborazione&&Ext.create("winElaborazione",{idElaborazione:e}).start()}}});
Ext.define("CbaUtils.componenti.desktop.CBAFormio",{extend:"Ext.container.Container",alias:"widget.CBAFormio",alternateClassName:"CBAFormio",layout:"fit",flex:1,style:"width: 100%; height: 100%",reference:"CBAFormio",builder:!1,_schema:null,_values:null,_isDirty:!1,_formioFormInstance:null,_originalValueFields:{},initComponent:function(){var a=this;this.callParent(arguments);this.on("afterrender",function(){a.builder&&a.makeFormioForm()});this.on("destroy",function(){var b=document.getElementById("cbaFormioIframe_"+
a.id);b&&b.remove()})},getIframe:function(){return document.getElementById("cbaFormioIframe_"+this.id)},getIframeHtml:function(){return this.getIframe().contentDocument.documentElement.innerHTML},getPrintDiv:function(){return this.getIframe().contentDocument.documentElement.querySelectorAll("#div-formio-print")[0]},getSchema:function(){return this._schema},getFormioDirty:function(){return this._isDirty},getOriginalValueFields:function(){return this._originalValueFields},getFormioFormInstance:function(){return this._formioFormInstance},
geFormModel:function(){return this.getFormioFormInstance().schema.components},getValues:function(){return this._values.data},print:function(){this.getIframe().contentWindow.print();this.getPrintDiv().innerHTML=""},calcOriginalFields:function(a){this._originalValueFields={};for(var b in a)this._originalValueFields[b]=a[b]},setValues:function(a,b){b=void 0===b?!1:b;var c=this.getFormioFormInstance();c&&c.setValue({data:a},{noEmit:b})},clearFormio:function(){var a=document.getElementById("cbaFormioIframe_"+
this.id);null!=a&&a.remove()},readOnly:function(a){a=void 0===a?!1:a;var b=this.getFormioFormInstance();b.options.readOnly=a;b.rebuild();this.setAutoComplete(!1)},setNuovoRecord:function(){this.readOnly(!1);this.resetForm()},resetForm:function(){var a=this.getValues(),b;for(b in a);this.getFormioFormInstance().resetValue()},buildDataForm:function(a,b){b=void 0===b?{}:b;var c=this,d;for(d in b){var e=b[d];"key"==d&&1==b.input?a[b[d]]="":Array.isArray(e)?e.forEach(function(b){c.buildDataForm(a,b)}):
"object"===typeof e&&this.buildDataForm(a,e)}},onAfterrenderFormioForm:function(a,b){var c=void 0===b.detail?null:b.detail;this.suspendChange=!0;this._formioFormInstance=c;this._values=c.getValue();a(c);this.attachEvent(c);this.setAutoComplete(!1)},setAutoComplete:function(a){a=void 0===a?!1:a;var b=this.getFormioFormInstance();b&&(b=b.getElement().querySelectorAll("input[type=text]"))&&0<b.length&&b.forEach(function(b){b.setAttribute("autocomplete",a?"on":"off")})},loadForm:function(a,b){b=void 0===
b?function(){return null}:b;var c=this;this.clearFormio();this.setHtml('<iframe name="cbaFormioIframe_'+this.id+'" frameBorder="0" id="cbaFormioIframe_'+this.id+'" width="100%" height="100%">');iframe=document.getElementById("cbaFormioIframe_"+this.id);window.getIframe=function(){return iframe};this.builder||(window.getFormioSchema=function(){return a},this._schema=a);window.getBuilderMode=function(){return c.builder};iframe.setAttribute("src","/cba/iframe/formio/formio.html");this.builder||iframe.addEventListener("afterrenderformioform",
this.onAfterrenderFormioForm.bind(this,b))},makeFormioForm:function(a,b){b=void 0===b?function(){return null}:b;var c=this;if(this.rendered)this.loadForm(a,b);else this.on("afterrender",function(){c.loadForm(a,b)})},getError:function(){var a=this.getFormioFormInstance();a.checkValidity(this.getValues(),!0);var b=[],c="";a.errors.forEach(function(a){c=a.component.label+" "+traduci("CAMPO_OBBLIGATORIO");msgAddError(b,c)});return b},attachEvent:function(a){var b=this;a.on("change",function(a){if(b.suspendChange)return b.suspendChange=
!1;if(a&&a.changed&&(a=a.changed)&&(a=a.instance)&&!a.hasInput)return!1;b.fireEvent("dirtychangecbaformio",b.getFormioFormInstance(),!0)});return a}});
Ext.define("CbaUtils.componenti.desktop.CBARowEditing",{extend:"Ext.grid.plugin.RowEditing",alias:"plugin.rowEditing",alternateClassName:"CBARowEditing",initEditor:function(){for(var a=this.view,b=["saveBtnText","cancelBtnText","errorsText","dirtyText"],c=b.length,d={autoCancel:this.autoCancel,errorSummary:this.errorSummary,fields:this.grid.headerCt.getGridColumns(),hidden:!0,view:a,editingPlugin:this},e,a=0;a<c;a++)e=b[a],Ext.isDefined(this[e])&&(d[e]=this[e]);Ext.apply(d,{cbaConfig:this.cbaConfig||
{}});return Ext.create("CbaUtils.componenti.desktop.CBARowEditor",d)},listeners:{}});Ext.define("CbaUtils.componenti.desktop.CBARowEditor",{extend:"Ext.grid.RowEditor",alternateClassName:"CBARowEditor",initComponent:function(){this.callParent(arguments)},getFloatingButtons:function(){var a=this.floatingButtons;a||(this.floatingButtons=a=new CbaUtils.componenti.desktop.CBARowEditorButtons({rowEditor:this,cbaConfig:this.cbaConfig}));return a}});
Ext.define("CbaUtils.componenti.desktop.CBARowEditorButtons",{extend:"Ext.grid.RowEditorButtons",alternateClassName:"CBARowEditorButtons",constructor:function(a){var b=a.rowEditor,c=Ext.baseCSSPrefix,d=b.editingPlugin,e=[{cls:c+"row-editor-update-button",itemId:"update",handler:d.completeEdit,text:b.saveBtnText,disabled:b.updateButtonDisabled},{cls:c+"row-editor-cancel-button",itemId:"cancel",handler:d.cancelEdit,text:b.cancelBtnText}];a.cbaConfig&&a.cbaConfig.customBtn&&e.push(a.cbaConfig.customBtn);
a=Ext.apply({baseCls:c+"grid-row-editor-buttons",defaults:{xtype:"button",ui:b.buttonUI,scope:d,flex:1,minWidth:Ext.panel.Panel.prototype.minButtonWidth},items:e},a);this.callParent([a]);this.addClsWithUI(this.position)}});
Ext.define("CbaUtils.componenti.desktop.CBASecureLogin",{extend:"Ext.container.Container",alias:"widget.CBASecureLogin",alternateClassName:"CBASecureLogin",uese:["CbaUtils.componenti.desktop.CBASecureLogin_Form","CbaUtils.componenti.desktop.CBASecureLogin_ChangePassword"],initComponent:function(){var a=this;this.onClickBtnExit=this.onClickBtnExit.bind(this);this.removeToken=!1;var b=this.cbaConfig,c=void 0===b.fnOnSuccess?function(){return null}:b.fnOnSuccess;this.items=[{xtype:"container",layout:{type:"vbox",
pack:"center"},height:50,style:{backgroundColor:"#2f5f8f",borderBottom:"2px solid orange"},items:[{xtype:"label",margin:"0 0 0 8",cls:"cbaGrassetto",html:traduci("ACCESSO_RISERVATO"),style:{fontSize:"18px",color:"#fff !important",padding:8}},{xtype:"label",margin:"4 0 0 8",cls:"cbaGrassetto",html:traduci("INFO_SECURITY_LOGIN"),style:{fontSize:"9px",color:"#fff !important"}}]},{xtype:"form",margin:"3 0 0 0",itemId:"Form",reference:"Form",cls:"cbaCssForm",layout:"card",border:0,bodyPadding:6,flex:1,
style:{border:"none !important"},items:[{xtype:"CBASecureLoginForm",itemId:"CardLoginForm",reference:"CardLoginForm",callBack_afterlogin:function(b,e,g){e=void 0===e?"":e;g=void 0===g?"":g;b?(a.getForm().setActiveItem(a.getCardChangePassword()),a.getCardChangePassword().getForm().isValid(),a.setOldPassword(e),a.setEmail(g),a.getCardChangePassword().token_first_access=localStorage.getItem("access_token_dm7"),localStorage.removeItem("access_token_dm7")):(c(),a.onClickBtnExit())}},{xtype:"CBASecureLoginChangePassword",
itemId:"CardChangePassword",reference:"CardChangePassword",callback_afterChangePassword:function(){clearForm(a.getForm());a.getForm().setActiveItem(a.getCardLogin())}}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"button",scale:"medium",iconCls:"icon-esci",handler:this.onClickBtnExit}]}]}];this.callParent(arguments);this.getForm().getForm().isValid()},getCardChangePassword:function(){return this.down("#CardChangePassword")},getCardLogin:function(){return this.down("#CardLoginForm")},
getForm:function(){return this.down("#Form")},setEmail:function(a){this.getCardChangePassword().setEmail(a)},setOldPassword:function(a){a=void 0===a?"":a;this.getCardChangePassword().setOldPassword(a)},onClickBtnExit:function(){this.up("window").close()}});
Ext.define("CbaUtils.componenti.desktop.CBASecureLogin_ChangePassword",{extend:"Ext.container.Container",alias:"widget.CBASecureLoginChangePassword",alternateClassName:"CBASecureLoginChangePassword",layout:{type:"vbox",align:"stretch"},initComponent:function(){this.items=[{xtype:"form",margin:"8 0 0 0",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"OldPassword",emptyText:traduci("VECCHIA_PASSWORD"),
margin:"5 0 0 0",allowBlank:!1,editable:!1,inputType:"password",name:"old_password"},{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"Email",emptyText:"Email",margin:"20 0 0 0",allowBlank:!1,name:"email"},{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"NewPassword",emptyText:traduci("NUOVA_PASSWORD"),margin:"20 0 0 0",allowBlank:!1,inputType:"password",name:"new_password"},{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"NewPasswordConf",
emptyText:traduci("CONFERMA_NUOVA_PASSWORD"),margin:"20 0 0 0",allowBlank:!1,inputType:"password",name:"new_password_conf"}],dockedItems:[{xtype:"toolbar",style:{border:"none"},dock:"bottom",items:[{xtype:"tbfill"},{xtype:"container",layout:{type:"vbox",align:"middle",pack:"center"},items:[{xtype:"button",margin:"30 0 0 0",text:traduci("LOGIN"),width:75,height:35,handler:this.onClickBtnChangePassword.bind(this),style:{background:"#127DA7",color:"#fff !important",borderRadius:"8px",fontWeight:"bold !important",
padding:".3em .3em !important"}}]},{xtype:"tbfill"}]}]}];this.callParent(arguments)},getForm:function(){return this.down("#Form")},getEmail:function(){return this.down("#Email").getValue()},setEmail:function(a){return this.down("#Email").setValue(a)},getOldPassword:function(){return this.down("#OldPassword").getValue()},getNewPassword:function(){return this.down("#NewPassword").getValue()},getNewPasswordConf:function(){return this.down("#NewPasswordConf").getValue()},setOldPassword:function(a){a=
void 0===a?"":a;this.down("#OldPassword").setValue(a)},setNewPassword:function(a){a=void 0===a?"":a;this.down("#NewPassword").setValue(a)},setNewPasswordConf:function(a){a=void 0===a?"":a;this.down("#NewPasswordConf").setValue(a)},checkIsValidCredential:function(){return this.getForm().isValid()},doChangePassword:function(){var a=this.getForm().getForm().getFieldValues();Object.assign(a,{user_id:localStorage.getItem("user_id")});var b=this.callback_afterChangePassword;if(!this.checkIsValidCredential())return!1;
if(!this.token_first_access)throw"Nessun token !!!";Ext.Ajax.request({method:"POST",async:!1,url:getUrlGen()+"/ws/user/firstAccessPassword",headers:{dm7auth:this.token_first_access},params:a,success:function(a){a=Ext.JSON.decode(a.responseText);var c=a.msg;if(a.success)return Messaggio("ATTENZIONE",c,"OK","INFO",function(){b()}),!1;msgShowError("ATTENZIONE",message)},failure:function(a,b){msgShowError("ATTENZIONE",message)}})},onClickBtnChangePassword:function(){this.doChangePassword()}});
Ext.define("CbaUtils.componenti.desktop.CBASecureLogin_Form",{extend:"Ext.container.Container",alias:"widget.CBASecureLoginForm",alternateClassName:"CBASecureLoginForm",layout:{type:"vbox",align:"stretch"},pathToLogin:"",initComponent:function(){this.onClickBtnLogin=this.onClickBtnLogin.bind(this);this.items=[{xtype:"panel",margin:"8 0 0 0",itemId:"CntLogin",reference:"CntLogin",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"Username",
reference:"Username",emptyText:traduci("USERNAME"),margin:"6 0 0 0",allowBlank:!1,name:"uesername"},{xtype:"textfield",cls:"css-textarea-radius field-height-40",itemId:"Password",reference:"Password",emptyText:traduci("PASSWORD"),margin:"20 0 0 0",name:"password",allowBlank:!1,inputType:"password"}],dockedItems:[{xtype:"toolbar",style:{border:"none"},dock:"bottom",items:[{xtype:"tbfill"},{xtype:"container",layout:{type:"vbox"},items:[{xtype:"button",text:traduci("LOGIN"),width:75,height:35,handler:this.onClickBtnLogin,
style:{background:"#127DA7",color:"#fff !important",borderRadius:"8px",fontWeight:"bold !important",padding:".3em .3em !important"}}]},{xtype:"tbfill"}]}]}];this.callParent(arguments)},getUsername:function(){return this.down("#Username").getValue()},getPassword:function(){return this.down("#Password").getValue()},checkIsValidCredential:function(a,b){return!(Ext.isEmpty(a)||Ext.isEmpty(b))},doLogin:function(){var a=this,b=this.getUsername(),c=this.getPassword(),d=this.callBack_afterlogin;if(!this.checkIsValidCredential(b,
c))return msgShowError("ATTENZIONE","MSG_CAMPI_OBBLIGATORI"),!1;Ext.Ajax.request({method:"GET",async:!1,url:getUrlGen()+"/auth/dm7/login",params:{username:b,password:c},success:function(b){b=Ext.JSON.decode(b.responseText);var c=b.data,e=b.msg;b.success?Ext.isEmpty(c)||(localStorage.setItem("access_token_dm7",c.access_token),localStorage.setItem("user_id",c.user_id),(isChangePassword=1==c.change_password)?Messaggio("ATTENZIONE",e,"OK","WARNING"):(new cbaNotification({timeToHide:1500})).showNotification("ATTENZIONE",
e),d(isChangePassword,a.getPassword(),c.email)):(b=Ext.JSON.decode(b.msg),msgShowError("ATTENZIONE",b.msg))},failure:function(a,b){msgShowError("ATTENZIONE",error)}})},onClickBtnLogin:function(){this.doLogin(this.pathToLogin)}});
Ext.define("CbaUtils.componenti.desktop.CBAShortcutGrid",{extend:"Ext.grid.Panel",alias:"widget.CBAShortcutGrid",alternateClassName:"CBAShortcutGrid",initComponent:function(){var a=this,b=this.ownerGrid;a.pluginEditing=!1;b.plugins&&Ext.each(b.plugins,function(b){if("Ext.grid.plugin.RowEditing"==b.$className||"Ext.grid.plugin.CellEditing"==b.$className)a.pluginEditing=b});this.callParent(arguments)},listeners:{cellclick:function(a,b,c,d,e,g,h){var k=this;a=b.getElementsByTagName("img");Ext.each(a,
function(a){if(-1!=a.id.indexOf("tiphamburger")&&!(k.pluginEditing&&k.pluginEditing.editor&&k.pluginEditing.editor.isVisible())){var b=a.getBoundingClientRect();(new Ext.util.Region(b.top,b.left+a.width,b.top+a.height,b.left)).isOutOfBound(Ext.util.Point.fromEvent(h))||(k.menuShortcut?(k.menuShortcut.record=d,k.menuShortcut.showAt(b.left,b.top+a.height)):alert("collegare alla grid il menu"))}})},itemmouseenter:function(a,b,c,d,e,g){var h=this;a=c.getElementsByTagName("img");Ext.each(a,function(a){-1!=
a.id.indexOf("tiphamburger")&&(a.src=h.srcShortcutOn)})},itemmouseleave:function(a,b,c,d,e,g){var h=this;a=c.getElementsByTagName("img");Ext.each(a,function(a){-1!=a.id.indexOf("tiphamburger")&&(a.src=h.srcShortcutOff)})}},srcShortcutOn:"/cba/generali/images/shortcut.svg",srcShortcutOff:"/cba/generali/images/shortcut-none.png",marginLeftShortcutOff:10,rendererShortcutColumn:function(a,b){if(this.controller&&this.controller.cbaConfig&&"L"==this.controller.cbaConfig.permesso&&(void 0===b||!b))return"";
a&&(this.srcShortcutOn=a);return"<img id='tiphamburger"+Ext.id()+"' src="+this.srcShortcutOff+" height=13px; width=13px; style='margin-left:"+this.marginLeftShortcutOff+"px !important; cursor:pointer !important;'/>"}});
Ext.define("CbaUtils.componenti.desktop.CbaFieldWarning",{extend:"Ext.form.field.Display",alias:"widget.cbaFieldWarning",alternateClassName:"cbaFieldWarning",labelWidth:150,labelClsExtra:"cbaLabelDati",setWarned:function(a,b,c){a=!1!==a;this[a?"addCls":"removeCls"]("warning");this.removeCls("cba-readonly");a?this.setValue(this.warnedText||b||traduci("DATO_OBBL_MANCANTE")):c?(this.setValue(c),this.addCls("cba-readonly")):this.setValue("");this.rendered&&this.updateLayout()}});
Ext.define("CbaUtils.componenti.desktop.CbaIconBtnTip",{extend:"Ext.panel.Panel",alias:"CbaIconBtnTip",alternateClassName:"CbaIconBtnTip",minWidth:40,maxWidth:500,shadow:"sides",defaultAlign:"tl-bl?",constrainPosition:!0,autoRender:!0,hidden:!0,baseCls:Ext.baseCSSPrefix+"tip",focusOnToFront:!1,closeAction:"hide",alwaysFramed:!0,frameHeader:!1,initComponent:function(){this.floating=Ext.apply({},{shadow:this.shadow,constrain:this.constrainPosition},this.self.prototype.floating);this.callParent(arguments);
this.constrain=this.constrain||this.constrainPosition},showAt:function(a){this.callParent(arguments);this.isVisible()&&(this.setPagePosition(a[0],a[1]),(this.constrainPosition||this.constrain)&&this.doConstrain(),this.toFront(!0))},ghost:void 0,unghost:void 0});
Ext.define("CbaUtils.componenti.desktop.CbaNotification",{extend:"Ext.container.Container",alias:"widget.cbaNotification",alternateClassName:"cbaNotification",modal:!1,bringParentToFront:!1,alignOnScroll:!1,layout:"fit",floating:!0,constrain:!0,hideMode:"visibility",defaultAlign:"br-br",padding:8,width:460,shadow:!1,animatedCls:"animated bounce",timeToHide:null,closable:!0,iconMsg:"",title:"ATTENZIONE",callback_onClose:Ext.emptyFn,viewRif:Ext.getBody(),message:"",hideMsgInfo:!1,extraItems:[],style:{background:"#fff",
boxShadow:"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)",lineHeight:1.7},initComponent:function(){var a=this;this.closable&&(CBA.parametriGenerali.superWin=!0);this.items=[{xtype:"container",items:[{xtype:"image",cls:"zoom",src:"/cba/generali/images/svg/others/x.svg",height:16,width:16,hidden:!Ext.isEmpty(this.timeToHide),style:{position:"absolute",top:0,right:0,cursor:"pointer"},listeners:{afterrender:function(b){return b.getEl().on("click",a.closeNotification,a)}}}]},{xtype:"label",
itemId:"LabelTitle",reference:"LabelTitle",cls:49==CBA.moduli.moduloAttivo?"cbaCssLabel":"cbaLabel",style:{fontSize:"18px",fontWeigth:"bold"}},{xtype:"container",margin:"6 0 0 0",items:[{xtype:"label",margin:"0 5 0 0",width:32,height:32,cls:this.iconMsg,hidden:Ext.isEmpty(this.iconMsg),style:{"float":"left"}},{xtype:"label",margin:"0 0 0 10",itemId:"LabelInfo",reference:"LabelInfo",hidden:this.hideMsgInfo}]},{xtype:"container",itemId:"Container",reference:"Container",items:this.extraItems}];this.callParent(arguments)},
getLabelTitle:function(){return this.down("#LabelTitle")},getLabelMessage:function(){return this.down("#LabelInfo")},closeNotification:function(){var a=this;this.removeCls(this.animatedCls);this.addCls("animated bounceOutRight");this.callback_onClose();this.isDestroyed||Ext.defer(function(){a.removeCls("animated bounceOutRight");a.destroy()},300)},showNotification:function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;var c=this,d=this.getLabelMessage(),e=this.getLabelTitle();this.addCls(this.animatedCls);
a=a||this.title;b=b||this.message;e.setHtml(traduci(a));d.setHtml(traduci(b));this.showBy(this.viewRif,!1,[-10,-20]);this.timeToHide&&Ext.defer(function(){c.closeNotification()},this.timeToHide)},addExtraItems:function(a){a=void 0===a?[]:a;0<a.length&&this.down("#Container").add(a)}});
Ext.define("CbaUtils.componenti.desktop.Cda",{extend:"Ext.container.Container",alias:"widget.cda",alternateClassName:"cda",defaults:{margin:"0 5 0 0"},layout:{type:"hbox"},initComponent:function(){var a="";this.extraFieldName&&(a=this.extraFieldName);var b={xtype:"container"};this.showDesCda&&(b={xtype:"displayfield",fieldLabel:"CDA",labelWidth:this.labelWidth?this.labelWidth:100,margin:"0 5 0 0",labelClsExtra:"cbaLabel",hidden:!(this.cbaConfig&&4==this.cbaConfig.tipoContabilita),value:traduci("NESSUNA_SELEZIONE"),
name:a+"descrizioneCodice",listeners:{render:this.renderCda}});this.items=[{xtype:"textfield",fieldLabel:"CDA",labelClsExtra:"cbaLabel",name:a+"cda",hidden:Ext.isDefined(this.hideCodice)&&!0===this.hideCodice?!0:!1,width:200,labelWidth:this.labelWidth?this.labelWidth:100,enableKeyEvents:!0,listeners:{render:this.renderCda}},b,{xtype:"button",text:"...",listeners:{click:this.clickBtnModifica,render:this.renderBtnModifica}},{xtype:"textfield",name:a+"annoCda",hidden:!0},{xtype:"textfield",readOnly:!0,
labelClsExtra:"cbaLabel",fieldLabel:"anno",labelWidth:45,width:100,hidden:Ext.isDefined(this.hideAnno)&&!0===this.hideAnno?!0:!1,name:a+"desAnnoCda",inputWrapCls:"x-tagfield-input",fieldCls:"x-tagfield-input"},{xtype:"numberfield",name:a+"cda1",hidden:!0},{xtype:"numberfield",name:"tipoContabilita",hidden:!0}];this.callParent(arguments)},getValue:function(){return this.down().getValue()},renderCda:function(a){var b=a.up();cdaRender(a,b)},clickBtnModifica:function(a){var b=a.up();cdaDoubleClick(a,
b.annoData)},renderBtnModifica:function(a){creaToolTip(a.getId(),"MODIFICA_CDA","")}});Ext.define("CbaUtils.componenti.desktop.CdaGrid",{extend:"Ext.form.field.Text",alias:"widget.cdaGrid",alternateClassName:"cdaGrid",name:"cda",enableKeyEvents:!0,initComponent:function(){this.listeners={render:this.renderCdaGrid};this.callParent(arguments)},renderCdaGrid:function(a){cdaRender(a,a,!0)}});
Ext.define("CbaUtils.componenti.desktop.CellDragDrop",{extend:"Ext.plugin.Abstract",alias:"plugin.celldragdrop",uses:["Ext.view.DragZone"],enforceType:!1,applyEmptyText:!1,emptyText:"",dropBackgroundColor:"green",noDropBackgroundColor:"red",dragText:"{0} selected row{1}",ddGroup:"GridDD",enableDrop:!0,enableDrag:!0,containerScroll:!1,init:function(a){a.on("render",this.onViewRender,this,{single:!0})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},enable:function(){this.dragZone&&this.dragZone.unlock();
this.dropZone&&this.dropZone.unlock();this.callParent()},disable:function(){this.dragZone&&this.dragZone.lock();this.dropZone&&this.dropZone.lock();this.callParent()},onViewRender:function(a){var b=this,c;b.enableDrag&&(b.containerScroll&&(c=a.getEl()),b.dragZone=new Ext.view.DragZone({view:a,ddGroup:b.dragGroup||b.ddGroup,dragText:b.dragText,containerScroll:b.containerScroll,scrollEl:c,getDragData:function(a){var b=this.view,c=a.getTarget(b.getItemSelector()),d=b.getRecord(c),k=a.getTarget(b.getCellSelector());
if(c)return c=document.createElement("div"),c.className="x-form-text",c.appendChild(document.createTextNode(k.textContent||k.innerText)),b=b.getHeaderByCell(k),{event:new Ext.EventObjectImpl(a),ddel:c,item:a.target,columnName:b.dataIndex,record:d}},onInitDrag:function(a,b){var c=this.dragData,d=this.view.getSelectionModel(),e=c.record,c=c.ddel;d.isSelected(e)||d.select([e],!0);Ext.fly(this.ddel).update(c.textContent||c.innerText);this.proxy.update(this.ddel);this.onStartDrag(a,b);return!0}}));b.enableDrop&&
(b.dropZone=new Ext.dd.DropZone(a.el,{view:a,ddGroup:b.dropGroup||b.ddGroup,containerScroll:!0,getTargetFromEvent:function(a){var b=this.view;a=a.getTarget(b.cellSelector);var c,d;if(a&&(c=b.findItemByChild(a),d=b.getHeaderByCell(a),c&&d&&d.cellDraggable))return{node:a,record:b.getRecord(c),columnName:d.dataIndex}},onNodeEnter:function(a,c,g,h){c=a.record.getField(a.columnName).type.toUpperCase();g=h.record.getField(h.columnName).type.toUpperCase();delete this.dropOK;if(a&&a.node!==h.item.parentNode){if(b.enforceType&&
c!==g)return this.dropOK=!1,b.noDropCls?Ext.fly(a.node).addCls(b.noDropCls):Ext.fly(a.node).applyStyles({backgroundColor:b.noDropBackgroundColor}),!1;this.dropOK=!0;b.dropCls?Ext.fly(a.node).addCls(b.dropCls):Ext.fly(a.node).applyStyles({backgroundColor:b.dropBackgroundColor})}},onNodeOver:function(a,b,c,h){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(a,c,g,h){(c=this.dropOK?b.dropCls:b.noDropCls)?Ext.fly(a.node).removeCls(c):Ext.fly(a.node).applyStyles({backgroundColor:""})},
onNodeDrop:function(a,c,g,h){if(this.dropOK)return a.record.set(a.columnName,h.record.get(h.columnName)),b.applyEmptyText&&h.record.set(h.columnName,b.emptyText),!0},onCellDrop:Ext.emptyFn}))}});
Ext.define("CbaUtils.componenti.desktop.CercaGrid",{extend:"Ext.form.field.Text",alias:"widget.cercaGrid",alternateClassName:"cercaGrid",width:150,gestisciDisable:!0,isFormField:!1,enableKeyEvents:!0,initComponent:function(){Ext.isEmpty(this.emptyText)&&(this.emptyText=this.minChars?"Inserire "+this.minChars+" caratteri":"",this.callParent(arguments));this.grid=this.up("gridpanel")||this.up("treepanel")||this.up("CBAShortcutGrid")},cbaConfig:{searchField:"",filtroPersonalizzato:void 0,filtraCondizione:void 0},
listeners:{afterrender:function(a){a.cbaConfig.noIcon||a.bodyEl.insertHtml("afterEnd",'<div style="height: 20px; width: 20px; display: table-cell" class="x-form-trigger icon-ricerca16"></div>');var b=this;if(b.grid)b.grid.on("disable",function(){a.gestisciDisable&&(b.grid.getStore().clearFilter(),a.setValue(""))})},keypress:function(a,b){if(this.grid.editingPlugin){var c=this.grid.editingPlugin.editor&&this.grid.editingPlugin.getEditor();c&&c.isVisible()&&b.preventDefault()}},change:Ext.Function.createBuffered(function(a){a.filtra()},
200,this)},filtra:function(){var a=this;if(!a.grid.isDisabled()){a.grid.getView();var b=a.grid.getStore(),c=a.getValue().toUpperCase();if(a.minChars&&c.length&&c.length<a.minChars)return!1;if("treepanel"==a.grid.getXType())Ext.suspendLayouts(),b.clearFilter(),b.filter({filterFn:function(b){if(b.isLeaf()){var d=!1,e=b.get(a.cbaConfig.searchField);Ext.isDefined(a.cbaConfig.filtraCondizione)?d=a.cbaConfig.filtraCondizione(b,c):!0===a.cbaConfig.ricercaIniziaPer?e&&0==e.toUpperCase().indexOf(c)&&(d=!0):
e&&0<=e.toUpperCase().indexOf(c)&&(d=!0);return d}return!0}}),Ext.resumeLayouts(!0);else if(Ext.isDefined(a.cbaConfig.filtroPersonalizzato))a.cbaConfig.filtroPersonalizzato(this,a.grid,b);else{b.clearFilter();a.cbaConfig.afterClearFilter&&a.cbaConfig.afterClearFilter(a.grid);var d=a.grid.getSelectionModel().getSelection(),e;if(a.getValue()||Ext.isDefined(a.cbaConfig.filtraCondizione))b.filter({filterFn:function(b){var g=!1,k=b.get(a.cbaConfig.searchField);Ext.isDefined(a.cbaConfig.filtraCondizione)?
g=a.cbaConfig.filtraCondizione(b,c):!0===a.cbaConfig.ricercaIniziaPer?k&&0==k.toUpperCase().indexOf(c)&&(g=!0):k&&0<=k.toUpperCase().indexOf(c)&&(g=!0);!e&&g&&(e=b);"Ext.selection.CheckboxModel"!=a.grid.selModel.$className||g||Ext.each(d,function(a){if(b.getId()==a.getId())return g=!0});return g}}),"Ext.selection.CheckboxModel"==a.grid.selModel.$className?e&&a.grid.ensureVisible(e,{select:!1,focus:!1}):1==a.grid.getStore().getCount()?(a.grid.getSelectionModel().select(0),a.grid.ensureVisible(0,{select:!1,
focus:!1})):a.grid.getSelectionModel().deselectAll()}}}});
Ext.define("CbaUtils.componenti.desktop.Classificazione",{extend:"Ext.form.FieldSet",alias:"widget.classificazione",alternateClassName:"classificazione",title:"CLASSIFICAZIONE",fieldLabel:"",labelWidth:100,initComponent:function(){this.items=[{xtype:"radiogroup",columns:3,vertical:!0,fieldLabel:this.fieldLabel,labelWidth:this.labelWidth,items:[{boxLabel:"RETTA",formId:this.formId,cls:"cbaLabel",name:"classificazione",inputValue:"1",checked:!0},{boxLabel:"INTERNA",formId:this.formId,cls:"cbaLabel",
name:"classificazione",inputValue:"3"},{boxLabel:"REGIONALE",formId:this.formId,cls:"cbaLabel",name:"classificazione",inputValue:"5"}]}];this.callParent(arguments)},getValue:function(){return this.down("radiogroup").getValue().classificazione},setValue:function(a){this.down("radiogroup").setValue({classificazione:a})},getSelectedLabel:function(){return this.down("radiogroup").getChecked()[0].boxLabel}});
Ext.define("CbaUtils.componenti.desktop.ComboModifica",{extend:"Ext.form.field.ComboBox",alias:"widget.comboModifica",alternateClassName:"comboModifica",triggers:{change:{cls:"icon-edit16",handler:function(a){this.cbaConfig.modificaClick&&this.cbaConfig.modificaClick(a)}}},listeners:{afterrender:function(){this.triggerEl.elements[1].dom.setAttribute("data-qtip",traduci("MODIFICA"));this.hideArrow&&this.triggerEl.elements[0].hide()}}});
Ext.define("CbaUtils.componenti.desktop.InputBoxCBA",{extend:"Ext.window.Window",alias:"inputBoxCBA",alternateClassName:"inputBoxCBA",modal:!0,resizable:!1,stateful:!1,plain:!0,closable:!1,constrain:!0,buttonCls:"cba-button-25",layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;a.title=traduci(a.cbaConfig.titoloFinestra);a.width=a.cbaConfig.width?a.cbaConfig.width:300;a.height=a.cbaConfig.height?a.cbaConfig.height:150;a.closeOnConferma=a.cbaConfig.hasOwnProperty("closeOnConferma")?
a.cbaConfig.closeOnConferma:!0;a.dockedItems=[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"button",cls:this.buttonCls,iconCls:"icon-conferma",text:traduci("CONFERMA"),handler:function(){a.cbaConfig.callBack&&a.cbaConfig.callBack(a);!0===a.closeOnConferma&&a.close()}},{xtype:"button",cls:this.buttonCls,iconCls:"icon-annulla",text:traduci("ANNULLA"),handler:function(){a.cbaConfig.callBackAnnulla&&a.cbaConfig.callBackAnnulla(a);a.close()}},{xtype:"tbfill"}]}];a.items=[{xtype:"container",
itemId:"CntItems",reference:"CntItems",cls:a.cbaConfig.cls,flex:1,layout:{type:"vbox",align:"center"},items:[{xtype:"label",html:traduci(a.cbaConfig.testoDomanda),margin:10,hidden:a.cbaConfig.testoDomanda?!1:!0}]}];a.callParent(arguments);a.down("#CntItems").add(a.cbaConfig.items)},render:function(){this.callParent(arguments);var a=this.query("field[hidden=false]")[0];a&&a.focus(!0,200)}});
Ext.define("CbaUtils.componenti.desktop.MasterDetailFormPlugin",{extend:"Ext.AbstractPlugin",alias:"plugin.masterdetail",alternateClassName:"MasterDetailFormPlugin",mixins:{observable:"Ext.util.Observable"},constructor:function(a){this.callParent(arguments);this.mixins.observable.constructor.call(this)},init:function(a){a.on("afterrender",this.installKeyNav,this,{single:!0})},installKeyNav:function(a){var b=this,c=a.getForm().getFields();b.keyNav=new Ext.util.KeyNav(a.el,{tab:function(d){var e,g,
h;for(e=c.getCount()-1;0<=e;e--)if(g=c.getAt(e),!g.isXType("displayfield")&&!g.isHidden()&&!g.isDisabled()){h=g.getName();break}e=h;return d.getTarget().name!==e||d.shiftKey?!0:(e=b.handleTabOnLastField(a),!1===e&&d.preventDefault(),e)},scope:b})},handleTabOnLastField:function(a){return this.fireEvent("TabOnLastField",a)}});
Ext.define("CbaUtils.componenti.desktop.Mese",{extend:"Ext.form.field.ComboBox",alias:"widget.mese",alternateClassName:"mese",fieldLabel:"MESE",labelClsExtra:"cbaLabel",name:"mese",editable:!1,queryMode:"local",labelWidth:50,valueField:"codice",displayField:"valore",shortMese:!1,initComponent:function(){this.shortMese&&(this.displayTpl=Ext.create("Ext.XTemplate",'<tpl for=".">',"{extra}","</tpl>"));this.callParent(arguments)}});
Ext.define("CbaUtils.componenti.desktop.PasswordCBA",{extend:"CbaUtils.componenti.desktop.InputBoxCBA",alias:"widget.passwordCBA",alternateClassName:"passwordCBA",avvisaPasswordCorretta:!0,cbaConfig:{titoloFinestra:"INSERIRE_PWD_SBLOCCO",closeOnConferma:!1,height:200,width:330,cls:"icon-sbloccoPwd",items:[{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",layout:{align:"center",type:"hbox",pack:"end"},items:[{xtype:"fieldset",height:40,margin:"10 0 0 0",width:200,layout:{align:"center",
pack:"center",type:"vbox"},title:"PWD_CODICE_SBLOCCO",style:"color: white!important; font-size: 16px",border:1,items:[{xtype:"label",itemId:"RandomKey"}]}]},{xtype:"container",margin:"30 0 0 0",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"label",cls:"cbaLabel",text:"INSERIRE_PWD_SBLOCCO"},{xtype:"textfield",itemId:"Password",width:240,hideLabel:!0,listeners:{specialkey:function(a,b){b.getKey()==b.ENTER&&this.up("passwordCBA").conferma()}}}]}]}],callBack:function(a){a.conferma()},
callBackAnnulla:function(a){a.callBackSbloccoPwd(!1)}},listeners:{beforerender:function(a){Localizer.localize(a)},afterrender:function(a){a.getRandomKey();setTimeout(function(){a.down("#Password").focus()},500)}},getRandomKey:function(){var a=this;Ext.Ajax.request({url:"/cba/gen/auth/pwdCba/getRandomKey",method:"GET",success:function(b){a.down("#RandomKey").setText(b.responseText)}})},conferma:function(){var a=this;Ext.Ajax.request({url:"/cba/gen/auth/pwdCba/checkPwd",params:{code:a.down("#RandomKey").text,
pwd:a.down("#Password").getValue()},method:"GET",success:function(b){"true"==b.responseText?(a.avvisaPasswordCorretta&&msgShowText("PWD_CODICE_SBLOCCO","PWD_PASSWORD_OK"),a.callBackSbloccoPwd(!0),a.destroy()):msgShowError("PWD_CODICE_SBLOCCO","PWD_PASSWORD_ERRATA")}})}});
Ext.define("CbaUtils.componenti.desktop.RangePeriodo",{extend:"Ext.container.Container",alias:"widget.rangePeriodo",layout:{type:"hbox",align:"middle",pack:"center"},rangeDays:7,initComponent:function(){this.items=[{xtype:"segmentedbutton",margin:"5 0 5 0",itemId:"SgmBtnPeriodo",reference:"SgmBtnPeriodo",allowMultiple:!1,items:[{text:"1",value:1},{text:"7",value:7,pressed:!0},{text:"15",value:15},{text:"mese",value:31},{text:"90",value:93}],listeners:{toggle:this.toggleSgmBtnPeriodo.bind(this)}},
{xtype:"button",margin:"0 0 0 5",itemId:"BtnIndietroDay",reference:"BtnIndietroDay",cls:"btnLarge",iconCls:"icon-indietro",scale:"medium",tooltip:"INDIETRO",tDay:-1,listeners:{click:this._prev_next.bind(this)}},{xtype:"datefield",itemId:"Data",reference:"Data",labelClsExtra:"cbaLabel",width:110,margin:"0 5 0 5",format:"d/m/Y",emptyText:"GG/MM/AAAA",value:new Date,listeners:{change:this.changeData.bind(this)}},{xtype:"mese",fieldLabel:"",margin:"0 5 0 5",hidden:!0,itemId:"Mese",reference:"Mese",value:(new Date).getMonth()+
1,store:Ext.create("Generali.store.Mesi"),width:100,listeners:{change:this.changeMese.bind(this)}},{xtype:"label",margin:"8 5 0 5",itemId:"Anno",reference:"Anno",hidden:!0,html:"ANNO"},{xtype:"button",cls:"btnLarge",itemId:"BtnAvantiDay",reference:"BtnAvantiDay",iconCls:"icon-avanti",scale:"medium",tooltip:"AVANTI",tDay:1,listeners:{click:this._prev_next.bind(this)}}];this.callParent(arguments)},_is_mese:function(a){return 27<this.rangeDays&&35>this.rangeDays},toggleSgmBtnPeriodo:function(a,b,c){var d=
b.getValue();a=this.down("#Mese");b=a.getValue();c=this.down("#Anno");var e=this.down("#Data");this.rangeDays=d;d=this._is_mese();e.setHidden(d);a.setHidden(!d);a.suspendEvent("change");a.setValue(b);a.resumeEvent("change");c.setHidden(!d);c.setHtml(e.getValue().getFullYear());this._changePerido()},changeData:function(a,b){isValidDate(a)&&this._changePerido()},changeMese:function(a,b){var c=this.down("#Data"),d=this.down("#Anno");c.suspendEvent("change");c.setValue(creaData(1,b,c.getValue().getFullYear()));
c.resumeEvent("change");d.setHtml(c.getValue().getFullYear());this.rangeDays=giornoFineMese(c.getValue()).getDate();this._changePerido()},_prev_next:function(a){var b=this.down("#Data"),c=this.down("#Mese"),d=this.down("#Anno"),e=b.value?new Date(b.value):new Date,g=Ext.Date.add(e,Ext.Date.DAY,a.tDay*this.rangeDays);28<=this.rangeDays&&35>this.rangeDays&&(g=creaData(1,e.getMonth()+1+a.tDay,e.getFullYear()),this.rangeDays=giornoFineMese(g).getDate());b.suspendEvent("change");b.setValue(g);b.resumeEvent("change");
c.suspendEvent("change");c.setValue(b.getValue().getMonth()+1);c.resumeEvent("change");d.setHtml(b.getValue().getFullYear());this._changePerido()},_changePerido:function(){var a=this.down("#Data").getValue(),b;this._is_mese()?(b=moment(a).startOf("month").toDate(),a=moment(a).endOf("month").toDate()):(b=a,a=Ext.Date.add(a,Ext.Date.DAY,this.rangeDays-1));this.changePeriodo(b,a)},changePeriodo:Ext.emptyFn});
Ext.define("CbaUtils.componenti.desktop.RowEditingAutoInsert",{extend:"Ext.grid.plugin.RowEditing",alternateClassName:"RowEditingAutoInsert",newRecordMethodName:"clickBtnNuovo",activeOnNewRecordsOnly:!0,initEditor:function(){return new RowEditorAutoInsert(this.initEditorConfig())},initEditorConfig:function(){var a=this.callParent();a.newRecordMethodName=this.newRecordMethodName;a.activeOnNewRecordsOnly=this.activeOnNewRecordsOnly;return a}});
Ext.define("CbaUtils.componenti.desktop.RowEditorAutoInsert",{extend:"Ext.grid.RowEditor",alternateClassName:"RowEditorAutoInsert",newRecordMethodName:"clickBtnNuovo",activeOnNewRecordsOnly:!0,afterRender:function(){var a=this,b,c,d;a.callParent(arguments);b=a.getForm().getFields();for(var e=b.getCount()-1;0<=e;e--)if(c=b.getAt(e),c.isVisible()&&!c.isXType("displayfield")){d=c.getId();break}a.keyNav.map.addBinding({key:Ext.event.Event.TAB,handler:function(b,c){c.getTarget().getAttribute("data-componentid")===
d&&(a.editingPlugin.on("edit",a.handleTabOnLastField,a,{single:!0}),a.editingPlugin.completeEdit(),c.preventDefault())}})},handleTabOnLastField:function(a,b){var c=b.record,d,e,g,h;e=c.store;d=e.indexOf(c);if(d==e.count()-1){if(!this.activeOnNewRecordsOnly||c.phantom)c=this.view.up().controller,Ext.isFunction(c[this.newRecordMethodName])||Ext.Error.raise('Il controller "'+c.$className+'" associato alla grid NON implementa il metodo "'+this.newRecordMethodName+'"!'),c[this.newRecordMethodName]()}else d<
e.count()-1&&(g=this.editingPlugin.grid,h=g.getSelectionModel(),c=e.getAt(d+1),h.select([c]),g.getPlugin().startEdit(c,0))}});
Ext.define("CbaUtils.componenti.desktop.SearchFlash",{extend:"Ext.container.Container",alternateClassName:"searchFlash",alias:"widget.searchFlash",layout:{type:"hbox",align:"center"},initComponent:function(){this.items=[{xtype:"combo",itemId:"CbSearchFlash",width:200,queryMode:"local",valueField:"id",displayField:"descrizione",minChars:2,hideTrigger:!0,store:Ext.create("Ext.data.ArrayStore",{fields:["idModulo","id","descrizione"]}),floating:!0,emptyText:"_",margin:"0 2 0 0",hidden:!0,listeners:{select:this.selectCbSearchFlash,
expand:this.expandCbSearchFlash,afterrender:this.afterrenderCbSearchFlash,blur:this.blurCbSearchFlash}},{xtype:"button",itemId:"BtnSearchFlash",scale:"medium",cls:"x-btn x-unselectable x-box-item x-toolbar-item x-btn-default-toolbar-medium",iconCls:"icon-search-flash",style:"cursor: pointer",margin:"0 0 0 0",tooltip:"RICERCA_RAPIDA",listeners:{click:this.clickBtnSearchFlash}}];this.callParent(arguments)},blurCbSearchFlash:function(a){a.hide()},afterrenderCbSearchFlash:function(a){a.setPosition(-202,
0);a.setEmptyText(traduci("DIGITA_VOCE_MENU"))},clickBtnSearchFlash:function(){var a=this.up("searchFlash").down("#CbSearchFlash");a.show();a.focus()},selectCbSearchFlash:function(a,b){a.hide();a.clearValue();b&&!Ext.isArray(b)&&trovaButtonMenu(b.get("idButton")).handler()},expandCbSearchFlash:function(a){a.getStore().filter(function(a){return a.get("idModulo")==CBA.moduli.moduloAttivo})}});
Ext.define("CbaUtils.componenti.desktop.SelPeriodo",{extend:"Ext.form.FieldSet",alias:"widget.selPeriodo",alternateClassName:"selPeriodo",nonDisabilitare:!0,puoiCambiarePeriodo:!0,layout:{type:"vbox",pack:"center",align:"middle"},initComponent:function(){var a=this,b=parseInt(dataAttuale("m")),c=parseInt(dataAttuale("Y")),d=a.usePrexifReference?a.getItemId():"";a.items=[{xtype:"container",layout:{type:"hbox",pack:"center",align:"middle"},items:[{xtype:"image",src:"/cba/generali/images/svg/others/left-arrow.svg",
style:"cursor: pointer",height:16,width:16,margin:"4 2 2 0",listeners:{afterrender:function(b){b.getEl().on("click",Ext.bind(a.setMeseAnno,a,[-1]))}}},{xtype:"mese",margin:"0 3 2 0",fieldLabel:"",itemId:"Mese",reference:"Mese"+d,name:"mese",width:110,store:Ext.create("Generali.store.Mesi"),value:b,puoiCancellare:!1,listeners:{change:function(b,c,d){a.oldMese=d;a.cambiaPeriodo()}}},{xtype:"anno",itemId:"Anno",reference:"Anno"+d,fieldLabel:"",name:"anno",width:67,value:c,listeners:{change:function(b,
c,d){a.oldAnno=d;a.cambiaPeriodo()}}},{xtype:"image",src:"/cba/generali/images/svg/others/right-arrow.svg",style:"cursor: pointer",height:16,width:16,margin:"4 0 2 2",listeners:{afterrender:function(b){b.getEl().on("click",Ext.bind(a.setMeseAnno,a,[1]))}}}]}];a.callParent(arguments)},getDate:function(){var a=this.down("#Mese").getValue(),b=this.down("#Anno").getValue();return[creaData(1,a,b),dataFineMese(a,b)]},setMeseAnno:function(a){var b=this.down("#Mese"),c=this.down("#Anno"),d=b.getValue(),e=
c.getValue();this.oldAnno=e;this.oldMese=d;this.puoiCambiarePeriodo=!1;-1==a?1==d?(b.setValue(12),c.setValue(e-1)):b.setValue(d-1):1==a&&(12==d?(b.setValue(1),c.setValue(e+1)):b.setValue(d+1));this.puoiCambiarePeriodo=!0;this.cambiaPeriodo()},setMeseAnnoDefault:function(a,b){this.puoiCambiarePeriodo=!1;this.down("#Mese").setValue(a);this.down("#Anno").setValue(b);this.puoiCambiarePeriodo=!0},listeners:{afterrender:function(a){Ext.isDefined(a.savePeriodo)&&imgTitleFieldset(a,"/cba/generali/images/svg/others/save.svg",
Ext.bind(a.savePeriodo,a,[!1]),a.tooltip,20,20)}},cambiaPeriodo:function(){this.puoiCambiarePeriodo&&this.changePeriodo&&this.changePeriodo(this.down("#Anno").getValue(),this.down("#Mese").getValue())}});
Ext.define("CbaUtils.componenti.desktop.StampaCBA",{extend:"Ext.tab.Panel",alias:"widget.stampaCBA",alternateClassName:"stampaCBA",uses:["Generali.standard.stampe.Button"],initComponent:function(){var a=this;a.cambiaTab=!0;a.callParent(arguments);a.showAnteprima=Ext.isDefined(a.showAnteprima)?a.showAnteprima:!0;a.showAnteprima&&a.add({xtype:"panel",itemId:"PageAnteprima",reference:"PageAnteprima",tabConfig:{title:"ANTEPRIMA",height:44},layout:{type:"hbox",align:"stretch"},bodyPadding:5,items:[{xtype:"container",
itemId:"CntAnteprima",layout:"fit",flex:1},{xtype:"container",itemId:"CntDownload",scrollable:!0,layout:{type:"vbox",align:"center"},hidden:!0,width:250}]});a.getTabBar().add([{xtype:"tbfill"},{xtype:"toolbar",itemId:"tbStampa",reference:"tbStampa",border:0,style:"background-color: transparent",items:[{xtype:"container",itemId:"CntProgressBar",reference:"CntProgressBar",hidden:!0},{xtype:"button",itemId:"BtnIndietro",reference:"BtnIndietro",iconCls:"icon-indietro",scale:"large",hidden:!0,text:"INDIETRO",
disabled:!0,handler:function(){a.cambiaTab=!0;a.navigaTab("prev")}},{xtype:"button",itemId:"BtnAvanti",reference:"BtnAvanti",iconCls:"icon-avanti",scale:"large",hidden:!0,text:"AVANTI",handler:function(){a.cambiaTab=!0;a.navigaTab("next")}},{xtype:a.useNewButtonStampa?"newButtonStampa":"buttonStampa",itemId:"BtnStampa",reference:"BtnStampa"},{xtype:"button",text:"ARCHIVIA",iconCls:"icon-zip",scale:"large",hidden:!0,itemId:"BtnArchiviaDocumentale",reference:"BtnArchiviaDocumentale",href:""},{xtype:"button",
text:"PUBBLICA",iconCls:"icon-pubblica",scale:"large",hidden:!0,itemId:"BtnPubblicaPortale",reference:"BtnPubblicaPortale",href:""},{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-elabora32",scale:"large",hidden:!0,text:"ELABORA"},{xtype:"button",text:"DOWNLOAD",iconCls:"icon-zip",scale:"large",hidden:!0,itemId:"BtnDownload",reference:"BtnDownload",href:""},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-esci32",scale:"large",text:"ESCI",listeners:{click:function(){a.up("window").close()},
render:function(b){b.setVisible(a.up("window"))}}}]}])},listeners:{tabchange:function(a){a.suspenTabChange||this.navigaTab()},beforetabchange:function(a,b,c){return a.cambiaTab},beforerender:function(a){a.up("window")&&Localizer.localize(a)},afterrender:function(a){var b=this;a.items.each(function(a){if(a==b.down("#PageAnteprima"))a.tab.on("click",function(){if(!0===b.disabilitaClickPageAnteprima)b.cambiaTab=!1;else{var a=b.down("#BtnStampa");a.isVisible()&&a.fireEvent("click",a)}});else a.tab.on("click",
function(){Ext.isDefined(b.disableClickTab)&&!0===b.disableClickTab?b.cambiaTab=!1:b.cambiaTab=!0})})}},navigaTab:function(a){this.getLayout();var b=[];this.items.each(function(a){a.tab.isVisible()&&b.push(a)});if(Ext.isDefined(this.erroriStampa)&&this.erroriStampa(a))return!1;var c=b.indexOf(this.getActiveTab());-1==c&&(c=0);this.suspenTabChange=!0;if(a&&("next"==a?c++:c--,this.setActiveTab(b[c]),c==b.length-1)){var d=this.down("#BtnStampa");this.showAnteprima&&d.isVisible()&&d.fireEvent("click",
d)}this.suspenTabChange=!1;this.cbaConfig.naviga&&this.cbaConfig.naviga(a);a=!0;Ext.isDefined(this.cbaConfig.abilitaAvantiIndietroAuto)&&(a=this.cbaConfig.abilitaAvantiIndietroAuto);a&&(-1==c&&(c=0),this.down("#BtnIndietro").setDisabled(0==c),this.down("#BtnAvanti").setDisabled(c==b.length-1))}});
Ext.define("CbaUtils.componenti.desktop.TabPeriodo",{extend:"Ext.tab.Panel",alias:"widget.tabPeriodo",alternateClassName:"tabPeriodo",hideTabMese:!1,hideTabPeriodo:!1,hideMeseAl:!1,titleTabMese:"MESE",shortMese:!1,nonDisabilitare:!0,showTrimestri:!1,initComponent:function(){var a=parseInt(dataAttuale("m")),b=parseInt(dataAttuale("Y"));this.items=[{xtype:"panel",hidden:this.hideTabMese,title:this.titleTabMese,isTabMese:!0,padding:3,layout:{type:this.shortMese?"hbox":"vbox"},items:[{xtype:"mese",itemId:"Mese",
reference:"Mese",name:"meseDal",shortMese:this.shortMese,labelWidth:80,fieldLabel:this.hideMeseAl?"MESE":"MESE_DAL",labelAlign:this.shortMese?"top":"left",width:this.shortMese?65:200,margin:this.shortMese?"0 5 0 0":"0 0 5 0",store:Ext.create("Generali.store.Mesi"),hidden:this.showTrimestri,value:a,puoiCancellare:!1,listeners:{change:this.changeMese}},{xtype:"mese",itemId:"MeseAl",reference:"MeseAl",name:"meseAl",shortMese:this.shortMese,labelWidth:80,fieldLabel:"MESE_AL",labelAlign:this.shortMese?
"top":"left",width:this.shortMese?65:200,margin:this.shortMese?"0 5 0 0":"0 0 5 0",store:Ext.create("Generali.store.Mesi"),hidden:this.hideMeseAl||this.showTrimestri,value:a,puoiCancellare:!1,listeners:{change:this.changeMeseAl}},{xtype:"combobox",itemId:"Trimestre",reference:"Trimestre",width:230,labelWidth:80,fieldLabel:traduci("TRIMESTRE"),labelClsExtra:"cbaLabel",name:"trimestre",displayField:"valore",queryMode:"local",queryParam:"valore",store:Ext.create("Generali.store.Trimestri"),valueField:"codice",
hidden:!this.showTrimestri,listeners:{change:this.changeTrimestre}},{xtype:"anno",labelAlign:this.shortMese?"top":"left",itemId:"Anno",reference:"Anno",width:this.shortMese?65:150,labelWidth:80,value:b,listeners:{change:this.changeAnno}}]},{xtype:"panel",hidden:this.hideTabPeriodo,title:"PERIODO",padding:5,layout:{type:"vbox"},items:[{xtype:"datefield",itemId:"DataDal",reference:"DataDal",name:"dataDal",value:creaData(1,a,b),width:160,fieldLabel:"DAL",labelClsExtra:"cbaLabel",labelWidth:50,listeners:{blur:this.blurDataDal},
validator:function(a){a=this.getValue();var b=this.up().down("#DataAl").getValue();return Ext.isDate(a)&&Ext.isDate(b)?(a=Ext.Date.clearTime(a),b=Ext.Date.clearTime(b),a.getTime()<=b.getTime()?!0:traduci("MSG_DATADAL_MAGGIORE_DATAAL")):!0}},{xtype:"datefield",itemId:"DataAl",reference:"DataAl",name:"dataAl",value:dataFineMese(a,b),width:160,fieldLabel:"AL",labelClsExtra:"cbaLabel",labelWidth:50,listeners:{blur:this.blurDataAl},validator:function(a){a=this.getValue();var b=this.up().down("#DataDal").getValue();
return Ext.isDate(b)&&Ext.isDate(a)?(b=Ext.Date.clearTime(b),a=Ext.Date.clearTime(a),b.getTime()<=a.getTime()?!0:traduci("MSG_DATADAL_MAGGIORE_DATAAL")):!0}}]}];this.listeners={tabchange:this.tabchange};this.callParent(arguments)},showOnlyYear:function(){this.down("#Mese").hide();this.down("#MeseAl").hide();var a=this.query("tab");a[0].setText(traduci("PERIODO"));a[0].show();a[1].hide()},showOnlyPeriodo:function(){var a=this.query("tab");a[0].hide();a[1].show();this.setActiveTab(1)},showOnlyMesi:function(){var a=
this.query("tab");a[0].show();a[1].hide();this.setActiveTab(0);a[0].setText(traduci("PERIODO"))},showOnlyMeseAnno:function(){this.showOnlyMesi();var a=this.down("#Mese");a.on("render",function(){a.setFieldLabel(traduci("MESE"))});this.down("#MeseAl").hide();this.hideMeseAl=!0},aggiornaPeriodo:function(){var a=this.down("#Anno").getValue(),b=this.down("#Mese").getValue(),c=this.down("#MeseAl").getValue();this.hideMeseAl&&(c=b);this.down("#DataDal").reset();this.down("#DataAl").reset();this.onlyYear?
(this.down("#DataDal").setValue(creaData(1,1,a)),this.down("#DataAl").setValue(dataFineMese(12,a))):(this.showTrimestri&&(b=3*(this.down("#Trimestre").getValue()-1)+1,c=b+2),this.down("#DataDal").setValue(creaData(1,b,a)),this.down("#DataAl").setValue(dataFineMese(c,a)));this.down("#DataDal").validate();this.down("#DataAl").validate()},tabchange:function(){this.aggiornaPeriodo()},changeMese:function(){var a=this.up("tabPeriodo"),b=a.down("#MeseAl");!a.cbaConfig.hideMeseAl&&this.getValue()>b.getValue()&&
b.setValue(this.getValue());a.aggiornaPeriodo();a.afterChangeMese&&a.afterChangeMese()},changeMeseAl:function(){var a=this.up("tabPeriodo"),b=a.down("#Mese");!a.cbaConfig.hideMeseAl&&this.getValue()<b.getValue()&&b.setValue(this.getValue());a.aggiornaPeriodo();a.afterChangeMeseAl&&a.afterChangeMeseAl()},changeAnno:function(){var a=this.up("tabPeriodo");a.aggiornaPeriodo();a.afterChangeAnno&&a.afterChangeAnno()},changeTrimestre:function(){var a=this.up("tabPeriodo");a.aggiornaPeriodo();a.afterChangeTrimestre&&
a.afterChangeTrimestre()},blurDataDal:function(a){var b=this.up("tabPeriodo"),c=b.down("#DataAl");!b.cbaConfig.hideMeseAl&&c.getValue()<this.getValue()&&(c.setValue(this.getValue()),a.validateValue(a.getValue()))},blurDataAl:function(a){var b=this.up("tabPeriodo"),c=b.down("#DataDal");!b.cbaConfig.hideMeseAl&&c.getValue()>this.getValue()&&(c.setValue(this.getValue()),a.validateValue(a.getValue()))}});
Ext.define("CbaUtils.componenti.desktop.TextModifica",{extend:"Ext.form.field.Text",alias:"widget.textModifica",alternateClassName:"textModifica",triggers:{change:{cls:"icon-edit16",handler:function(a){this.cbaConfig.modificaClick&&this.cbaConfig.modificaClick()}}},listeners:{afterrender:function(){this.triggerEl.elements[0].dom.setAttribute("data-qtip",traduci("MODIFICA"))}}});
Ext.define("CbaUtils.componenti.desktop.Timefield24",{extend:"Ext.form.field.Time",alias:"widget.timefield24",alternateClassName:"timefield24",formatText:"",initDate:"30/12/1899",initDateParts:[1899,11,30],getValue:function(){var a=this.callParent();a&&(a=59==a.getSeconds()?new Date(1899,11,31,0,0,0):new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds()));return a},getErrors:function(a){var b=Ext.String.format,c=this.callParent([a]),d=this.minValue,e=this.maxValue;!c.length&&(a=this.parseDate(a))&&
(d&&a<d&&c.push(b(this.minText,this.formatDate(d))),e&&a>e&&c.push(b(this.maxText,this.formatDate(e))));return c},setValue:function(a){if(!this.creatingPicker)return this.getPicker(),Ext.isDate(a)&&(a=Ext.Date.isEqual(a,new Date(1899,11,31,0,0,0))?new Date(1899,11,30,23,59,59):this.getInitDate(a.getHours(),a.getMinutes(),a.getSeconds())),this.callParent([a])},safeParse:function(a,b){var c=Ext.Date,d=null;c.formatContainsDateInfo(b)?d=c.parse(a,b):(c="24"==a.substring(0,2)?new Date(1899,11,30,23,59,
59):c.parse(this.initDate+" "+a,this.initDateFormat+" "+b))&&(d=c);return d}});
Ext.define("CbaUtils.componenti.desktop.TipoComune",{extend:"Ext.form.FieldSet",alias:"widget.tipocomune",alternateClassName:"tipoComune",title:"COMUNE",fieldLabel:"",labelWidth:100,initComponent:function(){this.items=[{xtype:"radiogroup",columns:2,vertical:!0,fieldLabel:this.fieldLabel,labelWidth:this.labelWidth,items:[{boxLabel:"RESIDENZA_INGRESSO_BREVE",formId:this.formId,cls:"cbaLabel",name:"tipoComune",inputValue:"11",checked:!0},{boxLabel:"RESIDENZA_ULTIMA",formId:this.formId,cls:"cbaLabel",
name:"tipoComune",inputValue:"12"}]}];this.callParent(arguments)},getValue:function(){return this.down("radiogroup").getValue().tipoComune},setValue:function(a){this.down("radiogroup").setValue({tipoComune:a})},getSelectedLabel:function(){return this.down("radiogroup").getChecked()[0].boxLabel}});
Ext.define("CbaUtils.componenti.desktop.WinCBA",{extend:"Ext.window.Window",alias:"winCBA",alternateClassName:"winCBA",closable:this.closable?this.closable:!1,plain:!0,layout:"fit",modal:!0,maximizable:!0,stateful:!1,iconCls:this.iconCls,autoScroll:!1,constrain:!0,initComponent:function(){var a=setWindow(this.dimensione),b=a[0],a=a[1];Ext.isEmpty(this.altezzaWin)||(b=this.altezzaWin);Ext.isEmpty(this.larghezzaWin)||(a=this.larghezzaWin);b>document.body.getClientRects()[0].height&&(b=document.body.getClientRects()[0].height,
a-=29);a>document.body.getClientRects()[0].width&&(a=document.body.getClientRects()[0].width);this.height=b;this.width=a;this.title=traduci(this.titolo);b="";"L"==this.permesso&&(b=Localizer.getLocalizedString("SOLA_LETTURA"),this.iconCls="icon-solalettura",this.title=this.title+" - "+b);this.nominativo&&(this.title='<table width="100%"><tr>',this.title+='<td width="33%" align="left">'+b+"</td>",this.title+='<td width="34%" align="center">'+traduci(this.titolo)+"</td>",this.title+='<td width="33%" align="right">'+
this.nominativo+"</td>",this.title+="</tr></table>");Ext.isString(this.name)?this.items=[Ext.create(this.name,{cbaConfig:this.configItem})]:this.items=this.name;this.callParent(arguments)},render:function(){this.callParent(arguments);var a=!1;this.down("form")?a=this.down("form"):this.isContainer&&(a=this);if(a){var b=a.query("field[hidden=false]")[0];b&&setTimeout(function(){b.focus()},500)}(a=this.items.items[0].controller)&&a.callBackRenderWin&&a.callBackRenderWin();this.callBackRenderWin&&this.callBackRenderWin()}});
Ext.define("CbaUtils.componenti.desktop.WinElaborazione",{extend:"Ext.window.Window",alias:"widget.winElaborazione",alternateClassName:"winElaborazione",title:"ELABORAZIONE",height:120,width:500,closable:!1,stateful:!1,plain:!0,modal:!0,urlGen:null,layout:{align:"stretch",padding:3,type:"vbox"},initComponent:function(){var a=this;a.items=[{xtype:"label",itemId:"lbElaborazione",reference:"lbElaborazione",margin:"0 0 5 0",cls:"cbaLabel",hidden:!0},{xtype:"progressbar",itemId:"myPBar",reference:"myPBar",
hidden:!0},{xtype:"label",itemId:"lbOperazione",reference:"lbOperazione",hidden:!0},{xtype:"container",layout:{pack:"center",type:"hbox"},margin:"5 0 0 0",items:[{xtype:"button",itemId:"btnElab",reference:"btnElab",iconCls:"icon-elimina",cls:"cba-button-25",width:100,text:"ANNULLA",handler:function(){a.task&&(a.task.destroy(),Ext.Ajax.request({method:"GET",url:a.getPathUrlGen()+"statoElab/cancel",params:{idElaborazione:a.idElaborazione}}),a.afterAnnulla&&a.afterAnnulla(),a.close())}}]}];a.on("beforerender",
a.localize);this.callParent(arguments)},localize:function(a){Localizer.localize(a)},getPathUrlGen:function(){return this.urlGen?this.urlGen:getPathGeneralModulo()},start:function(){var a=this;a.show();var b=a.queryById("myPBar"),c=a.queryById("lbElaborazione"),d=a.queryById("lbOperazione");b.reset();var e=0,g=0,h=0,k=0,l=new Ext.util.TaskRunner;a.task=l.newTask({run:function(){Ext.Ajax.request({method:"GET",url:a.getPathUrlGen()+"statoElab/get",params:{idElaborazione:a.idElaborazione},success:function(l){c.isHidden()&&
(c.show(),b.show());""!=l.responseText&&(l=Ext.JSON.decode(l.responseText),l.success&&((record=l.data)?(e=record.massimo?record.massimo:0,k=0,g=record.posizione?record.posizione:0,h=0<e?g/e:0,record.desAvanzamento&&c.update(record.desAvanzamento),b.updateProgress(h),b.updateText(Math.round(100*h)+"%"),d.update(traduci("OPERAZIONE_NUMERO")+": "+g),g==e&&"T"==record.chiudiPopup&&(a.task&&a.task.destroy(),a.isDestroyed||a.close(),a.callback_ok&&a.callback_ok())):(k++,20==k&&(a.task.destroy(),a.close(),
msgShowWarning("ATTENZIONE","MSG_MANCATA_RISPOSTA_SERVER")))))}})},interval:1E3});a.task.start()}});
Ext.define("CbaUtils.componenti.desktop.WinElaborazioneNoPopup",{extend:"Ext.Container",alias:"widget.winElaborazioneNoPopup",alternateClassName:"winElaborazioneNoPopup",width:510,layout:{align:"fit",type:"hbox"},initComponent:function(){var a=this;a.items=[{xtype:"container",hidden:!1,layout:{type:"vbox"},items:[{xtype:"label",itemId:"lbElaborazione",reference:"lbElaborazione",cls:"cbaLabel",hidden:!0},{xtype:"progressbar",itemId:"myPBar",reference:"myPBar",width:400,hidden:!0},{xtype:"label",itemId:"lbOperazione",
reference:"lbOperazione",height:10,hidden:!0}]},{xtype:"button",itemId:"btnElab",reference:"btnElab",iconCls:"icon-elimina",margin:"10 5 0 5",cls:"cba-button-25",text:"ANNULLA",scale:"small",hidden:!0,handler:function(){a.annulla()}}];a.on("beforerender",a.localize);this.callParent(arguments)},localize:function(a){Localizer.localize(a)},annulla:function(){this.task&&(this.task.destroy(),Ext.Ajax.request({method:"GET",url:getPathGeneralModulo()+"statoElab/cancel",params:{idElaborazione:this.idElaborazione}}),
this.afterAnnulla&&(this.riabilitaPusalnti(),this.afterAnnulla()),this.destroy())},errore:function(a){a=a.desAvanzamento.split("-9999",a.desAvanzamento.length);messaggi=[];a=a[1];Ext.apply(a,{tipo:2});msgAddError(messaggi,a);this.annulla();return msgShow(traduci("SERVIZI"),messaggi)},start:function(){var a=this;a.show();var b=a.queryById("myPBar"),c=a.queryById("lbElaborazione"),d=a.queryById("lbOperazione"),e=a.queryById("btnElab");b.reset();var g=0,h=0,k=0,l=0,m=new Ext.util.TaskRunner,n=a.up().up();
n.queryById("BtnPubblicaPortale")&&n.queryById("BtnArchiviaDocumentale")&&(n.queryById("BtnPubblicaPortale").setDisabled(!0),n.queryById("BtnArchiviaDocumentale").setDisabled(!0));a.task=m.newTask({run:function(){Ext.Ajax.request({method:"GET",url:getPathGeneralModulo()+"statoElab/get",params:{idElaborazione:a.idElaborazione},success:function(m){c.isHidden()&&(c.show(),e.show(),b.show());if(""!=m.responseText&&(m=Ext.JSON.decode(m.responseText),m.success))if(record=m.data){g=record.massimo?record.massimo:
0;l=0;h=record.posizione?record.posizione:0;k=0<g?h/g:0;if(record.desAvanzamento){if(record.desAvanzamento.includes("-9999"))return a.errore(record),!1;c.update(record.desAvanzamento)}b.updateProgress(k);b.updateText(Math.round(100*k)+"%");d.update(traduci("OPERAZIONE_NUMERO")+": "+h);h==g&&"T"==record.chiudiPopup&&(a.riabilitaPusalnti(),a.task&&(a.task.destroy(),e.setVisible(!1),a.setWidth(400)))}else l++,20==l&&(a.riabilitaPusalnti(),a.task.destroy(),a.destroy(),msgShowWarning("ATTENZIONE","MSG_MANCATA_RISPOSTA_SERVER"))}})},
interval:1E3});a.task.start()},riabilitaPusalnti:function(){var a=null;Ext.isEmpty(this.up())||(a=this.up().up());a&&a.queryById("BtnPubblicaPortale")&&a.queryById("BtnPubblicaPortale").isVisible()&&a.queryById("BtnPubblicaPortale").setDisabled(!1);a&&a.queryById("BtnArchiviaDocumentale")&&this.up().up().up().up().up().up().cbaConfig.idStampaDocumentale&&a.queryById("BtnArchiviaDocumentale").setDisabled(!1)}});
Ext.define("Generali.RobyOne.controller.Categorie",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"FsAreaAmm",selector:this.selContainer+"#FsAreaAmm"},{ref:"FsAreaPer",selector:this.selContainer+"#FsAreaPer"},{ref:"ckbAreaUtenti",selector:this.selContainer+"#ckbAreaUtenti"},{ref:"cmbAreaUtenti",selector:this.selContainer+"#cmbAreaUtenti"},{ref:"ckbAreaAmm",
selector:this.selContainer+"#ckbAreaAmm"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"BtnTestConnecction",selector:this.selContainer+"#BtnTestConnecction"},{ref:"CntTestConn",selector:this.selContainer+"#CntTestConn"},{ref:"GridCategorie",selector:this.selContainer+"#GridCategorie"},{ref:"BtnSyncCat",selector:this.selContainer+"#BtnSyncCat"},{ref:"CntRaccordo",selector:this.selContainer+"#CntRaccordo"}]);this.control(this.selContainer+"#BtnSyncCat",{click:this.clickBtnSyncCat});
this.control(this.selContainer+"#BtnTestConnecction",{click:this.clickBtnTestConnecction});this.control(this.selContainer+"#GridCategorie",{select:this.selectGrid,beforeedit:this.beforeeditGridGest,edit:this.editGridGest,canceledit:this.canceleditGridGest,validateedit:this.validateeditGridGest})},clickBtnTestConnecction:function(){this.cbaConfig.ctrlMainRobyOne.testConnection(this.idOrganizzazione,this,this.callBackTestConnecction)},callBackTestConnecction:function(a,b){var c=a.getCntTestConn(),d=
c.down("#IconOK"),c=c.down("#IconNO");b.success?(d.setHidden(!1),c.setHidden(!0)):(d.setHidden(!0),c.setHidden(!1))},selectGrid:function(a,b,c,d){(a=b?b.get("id"):null)&&this.fireEvent("CodiceCategoriaSelezionato",a)},forceSyncCategoria:function(a){var b=this,c=traduci("ROBYONE_MSG_SYNC_CATEGORIA"),d={},d={idOrganizzazione:a.get("idOrganizzazione"),lstIdCatRobyOne:a.get("id"),reSyncAnag:"T"};Messaggio("ATTENZIONE",c,"YESNO","QUESTION",!1,function(){b.ctrlMainRobyOne.forceSync(d)})},loadCategorie:function(a){var b=
this.getGridCategorie().getStore(),c=this.ctrlMainRobyOne.getIdRobyOneConfigSelected(),d=this.getCntRaccordo().down("grid")?this.getCntRaccordo().down("grid").getStore():null;d&&svuotaStore(d);svuotaStore(b);this.cbaConfig.ctrlMainRobyOne.impostaUrlByModAttivo(b,"tabelle/codificaExt/");b.load({params:{idOrganizzazione:this.idOrganizzazione,idSubOrgExt:c,sistemaExt:"R1",tipoDatoExt:"R1CAT"}});this.caricaCmbCategorie(a,c)},caricaCmbCategorie:function(a,b){var c=this,d=c.getForm();c.storeCategorieRobyOne?
svuotaStore(c.storeCategorieRobyOne):c.storeCategorieRobyOne=Ext.create("Generali.RobyOne.store.CategorieRobyOne",{autoload:!1});c.storeCategorieRobyOne.load({params:{idOrganizzazione:c.idOrganizzazione,idRobyOneConfig:b,fromDb:"T"},callback:function(b,g,h){if(h){if(!Ext.isEmpty(b)){b=d.queryById("cmbAreaUtenti");b.bindStore(c.storeCategorieRobyOne);g=d.queryById("cmbAreaAmmFor");g.bindStore(c.storeCategorieRobyOne);h=d.queryById("cmbAreaAmmCli");h.bindStore(c.storeCategorieRobyOne);var e=d.queryById("cmbAreaPer");
e.bindStore(c.storeCategorieRobyOne);a&&(a.get("catUtenti")&&b.setValue(a.get("catUtenti")),a.get("catFornitori")&&g.setValue(a.get("catFornitori")),a.get("catClienti")&&h.setValue(a.get("catClienti")),a.get("catPersonale")&&e.setValue(a.get("catPersonale")))}}else msgShowError("",g.getError())}})},eliminaCategoria:function(a){var b=this,c=b.getGridCategorie();a&&controller_eliminaRecord(c.getStore(),{id:a?a.get("id"):""},function(){b.loadCategorie()})},clickBtnSyncCat:function(){this.cbaConfig.ctrlMainRobyOne.updateCategories();
this.loadCategorie()},changeCbxAreaUtenti:function(a,b,c,d){a=this.getForm().queryById("cmbAreaUtenti");this.changeCombo(a,b)},changeCbxAreaAmm:function(a,b,c,d){a=this.getForm().queryById("cmbAreaAmmFor");c=this.getForm().queryById("cmbAreaAmmCli");this.changeCombo(a,b);this.changeCombo(c,b)},changeCbxAreaPer:function(){var a=this.getForm().queryById("cmbAreaPer");this.changeCombo(a,newValue)},changeCombo:function(a,b){b?(a.setDisabled(!1),a.allowBlank=!1,a.isValid()):(a.setDisabled(!0),a.allowBlank=
!0,a.setValue())},salvaForm:function(a){a=this.getForm();var b=a.getForm().getFieldValues();b.ckbAreaUtenti||(b.catUtenti=null);b.ckbAreaAmm||(b.catClienti=null,b.catFornitori=null);b.ckbAreaPer||(b.catPersonale=null);delete b.ckbAreaUtenti;delete b.ckbAreaAmm;delete b.ckbAreaPer;b.escludiClientiUtenti=b.escludiClientiUtenti?"T":"F";b.syncPersoneGiuridiche=b.syncPersoneGiuridiche?"T":"F";b.abilitaRaccordi=!0;b.abilitaRaccordi=b.abilitaRaccordi?"T":"F";a.controller=this;(a=controller_salvaRecord(a,
b,!1,null,null,!1,"id"))&&this.ctrlMainRobyOne.aggiornaStore(a.id)},aggiornaStore:function(a){var b=this;form=b.getForm();store=form.store;parametri={idOrganizzazione:b.idOrganizzazione};a&&Ext.apply(parametri,{id:a});var c=b.getCntTestConn();a=c.down("#IconOK");c=c.down("#IconNO");a.setHidden(!0);c.setHidden(!0);store.load({params:parametri,callback:function(a,c,g){g?Ext.isEmpty(a)?clearForm(form):(a=a[0],"F"==a.get("abilitaRaccordi")&&(c=traduci("CONTATTARE_ASSISTENZA_ERRORE")+" (0464 491620)",
Messaggio("ATTENZIONE",c,"OK","WARNING",null)),form.loadRecord(a),b.loadCategorie(a)):msgShowError("",c.getError())}})},nuovoRobyOneId:function(a){var b=this.getGridCategorie().getStore();clearForm(a);if(this.storeCategorieRobyOne){svuotaStore(this.storeCategorieRobyOne);var c=a.queryById("cmbAreaUtenti");c&&svuotaStore(c.getStore());(c=a.queryById("cmbAreaAmmFor"))&&svuotaStore(c.getStore());(c=a.queryById("cmbAreaAmmCli"))&&svuotaStore(c.getStore());(a=a.queryById("cmbAreaPer"))&&svuotaStore(a.getStore())}svuotaStore(b);
(b=this.getCntRaccordo().down("grid")?this.getCntRaccordo().down("grid").getStore():null)&&svuotaStore(b)},eliminaRobyOneId:function(){var a=this,b=a.getForm(),c=b.getForm().findField("id").getValue();if(!Ext.isEmpty(c)){var d={msg:traduci("ROBYONE_MSG_ELIMINA_ACCOUNT"),type:"strongStr"};controller_eliminaRecord(b.store,{id:c},function(){a.ctrlMainRobyOne.aggiornaStore()},null,d,"ATTENZIONE")}},gestioneForm:function(){var a=this,b=a.getForm(),c=a.getBoxBottoni();a.personContabili=getPersonContabili(a.idOrganizzazione,
new Date,!0,null);b.boxBottoni=c;var d=4!=a.personContabili.tipoContabilitaAbilitata,e=!CBA.moduli.modulo45.installato,g=a.getFsAreaAmm(),h=a.getFsAreaPer();containerSolaLettura(g,d);containerSolaLettura(h,e);d=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm()},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){a.nuovoRobyOneId(b)},elimina_callback:function(){a.eliminaRobyOneId()},verificaCampiForm_callback:function(){return!0}}});
inserisciBottoni(c,d);c.queryById("btnEsci").setVisible(!1);c.queryById("btnConferma").setDisabled(!0);c.queryById("btnAnnulla").setDisabled(!0);clearForm(b);b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},onLaunch:function(){var a=this,b={idOrganizzazione:a.cbaConfig.idOrganizzazione,ctrlMainRobyOne:a.cbaConfig.ctrlMainRobyOne};a.ctrlMainRobyOne=a.cbaConfig.ctrlMainRobyOne;a.idOrganizzazione=a.cbaConfig.idOrganizzazione?a.cbaConfig.idOrganizzazione:getIdOrg();a.gestioneForm();
a.getGridCategorie().controller=a;var c=a.getCntRaccordo().add(Ext.create(a.getCntRaccordo().cbaConfig.url,{cbaConfig:b}));a.on("CodiceCategoriaSelezionato",function(b){c.controller.caricaDati(a.getGridCategorie(),b)})},destroy:function(){eliminaStore(this.storeCategorieRobyOne);this.callParent()}});
Ext.define("Generali.RobyOne.controller.CategorieRaccordo",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCategorieRaccordo",selector:this.selContainer+"#GridCategorieRaccordo"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"}]);this.control(this.selContainer+"#GridCategorieRaccordo",{beforeedit:this.beforeeditGrid,edit:this.editGrid,
canceledit:this.canceleditGrid,validateedit:this.validateeditGrid});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina})},forceSyncRaccordo:function(a){var b=this,c=traduci("ROBYONE_MSG_SYNC_RACCORDO"),d={},d={idOrganizzazione:a.get("idOrganizzazione"),tipoDatoRaccordo:a.get("tipoDatoRaccordo"),lstIdSipcar:a.get("idCodiceSipcar"),reSyncAnag:"T"};Messaggio("ATTENZIONE",c,"YESNO","QUESTION",!1,function(){b.ctrlMainRobyOne.forceSync(d)})},
clickBtnNuovo:function(a){controller_nuovoRecordGrid({idOrganizzazione:this.idOrganizzazione,idCodiceExt:this.idCodiceExt},this.getGridCategorieRaccordo())},clickBtnElimina:function(a){var b=this;a=b.getGridCategorieRaccordo();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGrid:function(a,b,c){a.getEditor().getForm();b.record.get("tipoDatoRaccordo");if(!0===a.editing)return!1;this.loadStoreColDescrizione(b.record);
this.abilitaBottoniGrid(!1)},loadStoreColDescrizione:function(a){if(a||a.tipoDatoRaccordo||a.get("tipoDatoRaccordo")){var b=a.fromView?this.idCodiceExt:a.get("idCodiceExt");a=a.fromView?a.tipoDatoRaccordo:a.get("tipoDatoRaccordo");var c=this.getColumnByIndex("idCodiceSipcar").getEditor().store;svuotaStore(c);c.load({params:{idOrganizzazione:this.idOrganizzazione,tipoDatoExt:"R1CAT",sistemaExt:"R1",codiceExt:b,tipoDatoRaccordo:a}})}},editGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm(),
e=this.getColumnByIndex("tipoDatoRaccordo");d.controller=this;d.store=b.view.getStore();this.cbaConfig.ctrlMainRobyOne.impostaUrlByModAttivo(d.store,"tabelle/raccordoCodiciExt/");c.idOrganizzazione=this.idOrganizzazione;c.tipoDatoRaccordo=e.field.value;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGrid:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGrid:function(a,b,c){return msgShow("",
[])},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a);this.grigliaPrincipale.setDisabled(!a)},caricaDati:function(a,b){this.grigliaPrincipale=a;b&&(this.idCodiceExt=b);this.aggiornaStore()},aggiornaStore:function(a){var b=this,c=b.getGridCategorieRaccordo(),d=c.getStore();b.cbaConfig.ctrlMainRobyOne.impostaUrlByModAttivo(d,"tabelle/raccordoCodiciExt/");b.storeRac=d;svuotaStore(d);d.load({params:{idOrganizzazione:b.idOrganizzazione,sistemaExt:"R1",
tipoDatoExt:"R1CAT",idCodiceExt:b.idCodiceExt},callback:function(e,g,h){h?(e=0,b.getBtnElimina().setDisabled(!1),b.getBtnNuovo().setDisabled(!1),a&&(e=trovaRecord(d,"id",a)),c.getSelectionModel().select(e?[e]:0)):msgShowError("",g.getError())}})},getColumnByIndex:function(a){return col=this.getGridCategorieRaccordo().columns.find(function(b){return b.dataIndex==a})},onLaunch:function(){this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();this.getGridCategorieRaccordo().controller=
this;this.ctrlMainRobyOne=this.cbaConfig.ctrlMainRobyOne;var a=Ext.create("Generali.RobyOne.store.TipoRacc");this.ctrlMainRobyOne.impostaUrlByModAttivo(a,"tabelle/raccordoCodiciExt/cboxTipoRacc",!0);svuotaStore(a);a.load({params:{tipoCodifica:"R1CAT",sistemaCodifica:"R1"}});this.storeTipoRacc=a;this.getColumnByIndex("tipoDatoRaccordo").editor.store=this.storeTipoRacc;a=Ext.create("Generali.RobyOne.store.SipcarValue");this.ctrlMainRobyOne.impostaUrlByModAttivo(a,"tabelle/raccordoCodiciExt/cboxCodiciSipcar",
!0);this.storeSipcarValue=a;this.getColumnByIndex("idCodiceSipcar").editor.store=this.storeSipcarValue}});
Ext.define("Generali.RobyOne.controller.Config",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"BtnTestConnecction",selector:this.selContainer+"#BtnTestConnecction"}]);this.control(this.selContainer+"#BtnTestConnecction",{click:this.onClickBtnTestConnecction})},onClickBtnTestConnecction:function(){var a="";Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/robyone/testConnnection",
params:{idOrganizzazione:this.idOrganizzazione},async:!1,success:function(b){b=Ext.JSON.decode(b.responseText);Ext.isDefined(b)&&(b.success?b.data&&(a=b.data.tokenSessionId):b.message&&msgShowError("",b.message))}});return a},loadData:function(){},onLaunch:function(){this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg()}});
Ext.define("Generali.RobyOne.controller.Console",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CbOrg",selector:this.selContainer+"#CbOrg"},{ref:"CbArea",selector:this.selContainer+"#CbArea"},{ref:"StatoSincronizzato",selector:this.selContainer+"#StatoSincronizzato"},{ref:"StatoNonSincronizzato",selector:this.selContainer+"#StatoNonSincronizzato"},{ref:"StatoErrato",selector:this.selContainer+"#StatoErrato"},
{ref:"CbCategoriaR1",selector:this.selContainer+"#CbCategoriaR1"},{ref:"BtnCerca",selector:this.selContainer+"#BtnCerca"},{ref:"BtnForceSync",selector:this.selContainer+"#BtnForceSync"},{ref:"GridPerson",selector:this.selContainer+"#GridPerson"}]);this.control(this.selContainer+"#CbOrg",{change:this.changeCbOrg});this.control(this.selContainer+"#BtnCerca",{click:this.onClickCerca});this.control(this.selContainer+"#BtnForceSync",{click:this.onClickForceSync})},changeCbOrg:function(a,b){var c=this.getCbArea(),
d=c.getStore(),e=this.getCbCategoriaR1(),g=e.getStore();this.cbaConfig.ctrlMainRobyOne.idOrganizzazione=b;d.load({params:{idOrganizzazione:b},callback:function(a,b,d){d?null!=a&&1==a.length&&setValue(c,a[0].get("codice")):msgShowError(c.getFieldLabel(),b.getError())}});this.ctrlMainRobyOne.impostaUrlByModAttivo(g,"tabelle/codificaExt/cbox",!0);g.load({params:{idOrganizzazione:b,sistemaExt:"R1",tipoDatoExt:"R1CAT"},callback:function(a,b,c){c?null!=a&&1==a.length&&setValue(e,a[0].get("codice")):msgShowError(e.getFieldLabel(),
b.getError())}});this.storeCbCat=g},getSuffixArea:function(){var a="",b=this.getCbArea(),c=b.getValue();store=b.getStore();(recCb=trovaRecord(store,"codice",c))&&(a=" "+traduci("AREA")+" "+recCb.get("valore"));return a},loadCbStore:function(){var a=this,b=a.getCbOrg();b.getStore().load({params:{codEnte:CBA.parametriGenerali.codEntePwd,codProfilo:CBA.parametriGenerali.codProfilo},callback:function(c,d,e){e?null!=c&&1==c.length?setValue(b,c[0].get("codice")):setValue(b,a.idOrganizzazione):msgShowError(b.getFieldLabel(),
d.getError())}})},onClickForceSync:function(){var a=this.paramConsoleRicerca;Ext.isEmpty(a)||Ext.isEmpty(a.lstAree)?Messaggio("ATTENZIONE",traduci("SELEZIONARE")+" "+traduci("Area"),"OK","WARNING"):this.ctrlMainRobyOne.forceSync(a,this,this.callBackForceSync)},callBackForceSync:function(a,b){a.onClickCerca()},onClickCerca:function(){var a=this.getGridPerson();titleGrid=traduci("GRIGLIA_SOGGETTI");txtButton=traduci("SINCRONIZZA");btnForceSync=this.getBtnForceSync();suffix="";btnForceSync.setDisabled(!1);
if(suffix=this.getSuffixArea())txtButton+=suffix,titleGrid+=suffix;btnForceSync.setTooltip(txtButton);a.setTitle(titleGrid);this.aggiornaStore()},leggiParametri:function(){var a={},b=this.getCbOrg().getValue(),c=this.getCbArea().getValue(),d=null!=this.getCbCategoriaR1().getSelectedRecord()?this.getCbCategoriaR1().getSelectedRecord().get("extra"):null,e=this.ctrlMainRobyOne.getIdRobyOneConfigSelected();Ext.apply(a,{idOrganizzazione:b?b:this.idOrganizzazione});e&&Ext.apply(a,{idRobyOneConfig:e});c&&
Ext.apply(a,{lstAree:c});d&&Ext.apply(a,{lstCategories:d});b="";c=this.getStatoSincronizzato().getValue();d=this.getStatoNonSincronizzato().getValue();e=this.getStatoErrato().getValue();c&&(b="T,");d&&(b+="F,");e&&(b+="E,");""!=b&&Ext.apply(a,{lstStati:b});this.paramConsoleRicerca=a},aggiornaStore:function(a){a={};var b=this.getGridPerson().getStore();this.leggiParametri();Ext.apply(a,this.paramConsoleRicerca);b.load({params:a,callback:function(a,b,e){(a=null!=b.getResponse()?Ext.JSON.decode(b.getResponse().responseText):
null)&&a.success&&0<a.data.length?msgShow("",a.message):msgShowError("",a.message)}})},caricaRecord:function(a){},onLaunch:function(){var a=this.getGridPerson();this.ctrlMainRobyOne=this.cbaConfig.ctrlMainRobyOne;a.controller=this;this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();this.loadCbStore();this.addShortCut()},forceSyncIdAnagrafica:function(a){var b=a.get("externalId");null!=a.get("idString")&&"P"==a.get("tipoSipcar")&&(b=a.get("idString"));a=
{tipoSipcar:a.get("tipoSipcar"),lstIdSipcar:b,reSyncAnag:"T"};this.ctrlMainRobyOne.forceSync(a,this,this.callBackForceSync)},addShortCut:function(){var a=this,b=Ext.create("Ext.menu.Menu",{items:[{text:traduci("SINCRONIZZA"),handler:function(b){b=this.up("menu").record;a.forceSyncIdAnagrafica(b)}},{text:traduci("CRONOLOGIA"),disabled:!0,handler:function(){this.up("menu")}}]});a.getGridPerson().menuShortcut=b}});
Ext.define("Generali.RobyOne.controller.MainRobyOne",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridRobyOneId",selector:this.selContainer+"#GridRobyOneId"},{ref:"TabMain",selector:this.selContainer+"#TabMain"},{ref:"TabConsole",selector:this.selContainer+"#TabConsole"},{ref:"TabConfig",selector:this.selContainer+"#TabConfig"}]);this.control(this.selContainer+"#TabMain",{tabchange:this.tabchangeTabMain});
this.control(this.selContainer+"#GridRobyOneId",{select:this.selectGridRobyOneId})},selectGridRobyOneId:function(){this.caricaDati()},tabchangeTabMain:function(a,b,c,d){a={};a.idOrganizzazione=this.cbaConfig.idOrganizzazione;a.permesso=this.cbaConfig.permesso;a.ctrlMainRobyOne=this;0==b.items.getCount()&&b.add(Ext.create(b.cbaConfig.url,{cbaConfig:a}));(b=b.down("grid"))&&!b.getSelectionModel().getSelection()[0]&&0<b.getStore().getCount()&&b.getSelectionModel().select(0);this.caricaDati()},caricaDati:function(){var a=
this.getIdRobyOneConfigSelected();if(a){var b=this.getTabMain().getActiveTab();b&&b.down()&&b.down().controller&&b.down().controller.aggiornaStore(a)}},loadData:function(){this.tabchangeTabMain(this.getTabMain(),this.getTabConfig());this.getTabMain().setActiveTab(1)},aggiornaStore:function(a){var b=this.getGridRobyOneId(),c=b.getStore();c.load({params:{idOrganizzazione:this.idOrganizzazione},callback:function(d,e,g){if(g)if(b.getSelectionModel().deselectAll(),0<d.length){var h;a&&(h=trovaRecord(c,
"id",a));Ext.isEmpty(h)&&(h=d[0]);b.getSelectionModel().select([h])}else msgShowError("","Impostare almeno un robyOneId");else msgShowError("",e.getError())}})},onLaunch:function(){this.getGridRobyOneId();this.idOrganizzazione=getIdOrg();this.aggiornaStore()},getIdRobyOneConfigSelected:function(){var a=null;(record=this.getGridRobyOneId().getSelectionModel().getSelected())&&0<record.items.length&&(a=record.items[0].id);return a},updateCategories:function(){var a=this.getIdRobyOneConfigSelected(),
b={idOrganizzazione:this.idOrganizzazione};a&&Ext.apply(b,{idRobyOneConfig:a});Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/robyone/categories/sync",params:b,async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);if(Ext.isDefined(a))if(a.success){if(a.data){var b="",c="";if(a.message)for(b=a.message[0].testo,1<a.message.length&&(b+="<BR> Elenco categorie aggiornate:"),i=1;i<a.message.length;i++)c+=(""!=c?"<BR>":"")+a.message[i].testo;Messaggio(b,c,"OK","INFO")}}else a.message&&
msgShowError("",a.message)}})},impostaUrlByModAttivo:function(a,b,c){null==b&&(b="tabelle/raccordoCodiciExt/");var d=CBA.moduli.moduloAttivo;b=(43==d||50==d||48==d?"/cba/osp/co/ws/genAmmIntgr/":"/cba/amm/cp/ws/integrazioni/")+b;c?a.getProxy().url=b:(a.getProxy().url=b+"list",a.getProxy().api={read:b+"list",create:b+"insert",update:b+"update",destroy:b+"delete"})},forceSync:function(a,b,c){var d={};Ext.isEmpty(a)?Messaggio("ATTENZIONE","Parametri errati!","OK","WARNING"):(a.idOrganizzazione&&Ext.apply(d,
{idOrganizzazione:a.idOrganizzazione}),a.lstAree&&Ext.apply(d,{lstAree:a.lstAree}),a.tipoDatoRaccordo&&Ext.apply(d,{tipoDatoRaccordo:a.tipoDatoRaccordo}),a.lstIdSipcar&&Ext.apply(d,{lstIdSipcar:a.lstIdSipcar}),a.lstIdCatRobyOne&&Ext.apply(d,{lstIdCatRobyOne:a.lstIdCatRobyOne}),a.reSyncAnag&&Ext.apply(d,{reSyncAnag:a.reSyncAnag}),a.tipoSipcar&&Ext.apply(d,{tipoSipcar:a.tipoSipcar}),Ext.Ajax.request({method:"GET",timeout:3E4,url:"/cba/gen/ws/general/robyone/forceSync",params:d,success:function(a){a=
Ext.JSON.decode(a.responseText);a.success?(msgShow("",a.message),c&&c(b,a)):msgShowError("",a.message)}}))},testConnection:function(a,b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/robyone/testConnnection",params:{idOrganizzazione:a?a:getIdOrg(),idRobyOneConfig:this.getIdRobyOneConfigSelected()},success:function(a){a=Ext.JSON.decode(a.responseText);c&&c(b,a)}})}});Ext.define("Generali.RobyOne.store.Aree",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/robyone/aree/cbox"}});
Ext.define("Generali.RobyOne.store.CategorieRobyOne",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/robyone/categories/cbox"}});
Ext.define("Generali.RobyOne.store.PersonConsole",{extend:"Generali.data.StoreJson",fields:[{name:"categories",convert:function(a){var b=[];Ext.isEmpty(a)||Ext.each(a,function(a){b.push(a.categoryId)});return b}}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/robyone/subject/list",api:{read:"/cba/gen/ws/general/robyone/subject/list"}}},a)])},autoDestroy:!0});
Ext.define("Generali.RobyOne.store.RobyOneConfig",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"catUtenti",type:"int"},{name:"catClienti",type:"int"},{name:"catFornitori",type:"int"},{name:"catPersonale",type:"int"},{name:"escludiClientiUtenti",convert:function(a){return"T"==a?!0:!1}},{name:"syncPersoneGiuridiche",convert:function(a){return"T"==a?!0:!1}},{name:"ckbAreaUtenti",convert:function(a,b){var c=b.get("catUtenti");return c&&!isNaN(c)?!0:!1}},{name:"ckbAreaAmm",
convert:function(a,b){var c=!1,d=b.get("catFornitori"),e=b.get("catClienti");d&&!isNaN(d)&&(c=!0);e&&!isNaN(e)&&(c=!0);return c}},{name:"robyOneId"},{name:"robyOneIdDesc"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/robyone/config/list",api:{read:"/cba/gen/ws/general/robyone/config/list",create:"/cba/gen/ws/general/robyone/config/update",update:"/cba/gen/ws/general/robyone/config/update",destroy:"/cba/gen/ws/general/robyone/config/delete"}}},a)])},
autoDestroy:!0});Ext.define("Generali.RobyOne.store.SipcarValue",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/osp/co/ws/genAmmIntgr/tabelle/raccordoCodiciExt/cboxCodiciSipcar"}});Ext.define("Generali.RobyOne.store.TipoRacc",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/cboxTipoRacc"}});
Ext.define("Generali.RobyOne.view.Categorie",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",margin:5,title:"Impostazioni Generali",layout:"vbox",items:[{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",region:"top",margin:"5 0 0 0",itemId:"BoxBottoni",reference:"BoxBottoni",title:""},{xtype:"container",itemId:"CntTestConn",
reference:"CntTestConn",layout:"hbox",margin:"7 0 0 10",items:[{xtype:"button",itemId:"BtnTestConnecction",reference:"BtnTestConnecction",width:150,height:20,iconCls:"icon-refresh",scale:"small",text:"TEST CONNESSIONE"},{xtype:"container",margin:"0 0 0 5",layout:"hbox",itemId:"IconOK",reference:"IconOK",hidden:!0,items:[{xtype:"image",width:20,height:20,cls:"icon-conferma"},{xtype:"label",text:"TEST_RIUSCITO",margin:"5 0 0 5",cls:"cbaLabel"}]},{xtype:"container",layout:"hbox",margin:"0 0 0 5",itemId:"IconNO",
reference:"IconNO",hidden:!0,items:[{xtype:"image",width:20,height:20,cls:"icon-elimina"},{xtype:"label",text:"TEST_NON_RIUSCITO",margin:"5 0 0 5",cls:"cbaLabel"}]}]}]},{xtype:"form",itemId:"Form",reference:"Form",margin:5,layout:{type:"vbox",align:"stretch"},border:0,store:Ext.create("Generali.RobyOne.store.RobyOneConfig",{autoload:!1}),trackResetOnLoad:!0,items:[{xtype:"numberfield",hidden:!0,name:"id"},{xtype:"numberfield",hidden:!0,name:"idOrganizzazione"},{xtype:"numberfield",hidden:!0,name:"idServizi"},
{xtype:"textfield",hidden:!0,name:"linkServiziCategoria"},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"DESCRIZIONE",name:"robyOneIdDescr",dataIndex:"robyOneIdDescr"},{xtype:"textfield",fieldLabel:"ROBYONEID",name:"robyOneId",dataIndex:"robyOneId"}]},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"fieldset",title:"Area Utenti",margin:"5 5 5 5",flex:1,layout:{type:"vbox"},items:[{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",
boxLabel:"Escludi duplicati Utenti/Clienti",inputValue:"T",uncheckedValue:"F",dataIndex:"escludiClientiUtenti",name:"escludiClientiUtenti",allowBlank:!0},{xtype:"checkboxfield",fieldLabel:"",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",itemId:"ckbAreaUtenti",reference:"ckbAreaUtenti",boxLabel:"Categoria default per servizi non specificati",allowBlank:!0,name:"ckbAreaUtenti"},{xtype:"combobox",itemId:"cmbAreaUtenti",reference:"cmbAreaUtenti",emptyText:"Seleziona Categoria Robyone",labelClsExtra:"cbaLabel",
displayField:"valore",valueField:"codice",allowBlank:!0,name:"catUtenti"}]},{xtype:"fieldset",margin:"5 5 5 5",title:"Area Amministrazione",itemId:"FsAreaAmm",reference:"FsAreaAmm",collapsible:!0,flex:1,layout:{type:"vbox"},items:[{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",boxLabel:"Sincronizza persone giuridiche",inputValue:"T",uncheckedValue:"F",dataIndex:"syncPersoneGiuridiche",name:"syncPersoneGiuridiche",allowBlank:!0},{xtype:"checkboxfield",itemId:"ckbAreaAmm",reference:"ckbAreaAmm",
cls:"cbaLabel",fieldLabel:"",boxLabel:"Categoria default per raccordi non specificati",inputValue:"T",uncheckedValue:"F",name:"ckbAreaAmm"},{xtype:"combobox",itemId:"cmbAreaAmmFor",reference:"cmbAreaAmmFor",emptyText:"Seleziona Categoria Robyone",labelClsExtra:"cbaLabel",fieldLabel:"Fornitori",displayField:"valore",valueField:"codice",allowBlank:!0,name:"catFornitori"},{xtype:"combobox",itemId:"cmbAreaAmmCli",reference:"cmbAreaAmmCli",emptyText:"Seleziona Categoria Robyone",labelClsExtra:"cbaLabel",
fieldLabel:"Clienti",displayField:"valore",valueField:"codice",allowBlank:!0,name:"catClienti"}]},{xtype:"fieldset",margin:"5 5 5 5",title:"Area Personale",itemId:"FsAreaPer",reference:"FsAreaPer",collapsible:!0,flex:1,layout:{type:"vbox"},items:[{xtype:"checkboxfield",itemId:"ckbAreaPer",reference:"ckbAreaPer",cls:"cbaLabel",fieldLabel:"",boxLabel:"Categoria default per qualifiche non specificate",inputValue:"T",uncheckedValue:"F",name:"ckbAreaPer"},{xtype:"combobox",itemId:"cmbAreaPer",reference:"cmbAreaPer",
emptyText:"Seleziona Categoria Robyone",labelClsExtra:"cbaLabel",fieldLabel:"Qualifica",displayField:"valore",valueField:"codice",allowBlank:!0,name:"catPersonale"}]}]}]}]},{xtype:"container",margin:"5 5 5 5",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"CBAShortcutGrid",viewConfig:{loadMask:!1,enableTextSelection:!0},hideTitle:!0,scrollable:!0,itemId:"GridCategorie",reference:"GridCategorie",store:Ext.create("Generali.person_fe.store.CodificaEsterna",{autoload:!1}),flex:1,columns:[{xtype:"gridcolumn",
text:"ID",width:80,dataIndex:"codice",sortable:!0},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:2,dataIndex:"descrizione",sortable:!0,renderer:function(a,c,d){return"T"==d.get("ivaConImposta")?a.strike():a}},{xtype:"actioncolumn",width:25,align:"center",items:[{iconCls:"icon-refresh",tooltip:traduci("SINCRONIZZA")+" "+traduci("ROBYONE_RACCORDI")+" "+traduci("CATEGORIA_ROBYONE"),handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.forceSyncCategoria(b)}}]},{xtype:"actioncolumn",width:25,align:"center",
items:[{iconCls:"icon-eliminaGriglia",tooltip:traduci("ELIMINA"),handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.eliminaCategoria(b)}}]},{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"sistemaExt",hidden:!0},{xtype:"gridcolumn",dataIndex:"tipoDatoExt",hidden:!0},{xtype:"gridcolumn",dataIndex:"ivaConImposta",hidden:!0}],dockedItems:[{xtype:"toolbar",dock:"top",cls:"baseBgColor",height:36,items:[{xtype:"tbfill"},{xtype:"label",html:traduci("CATEGORIA_ROBYONE"),
cls:"cbaLabel"},{xtype:"tbfill"},{xtype:"button",itemId:"BtnSyncCat",reference:"BtnSyncCat",iconCls:"icon-refresh",text:"AGGIORNA"}]}]},{xtype:"splitter"},{xtype:"container",flex:1,itemId:"CntRaccordo",reference:"CntRaccordo",layout:"fit",cbaConfig:{url:"Generali.RobyOne.view.CategorieRaccordo"}}]}]}]});a.callParent(arguments)}});
Ext.define("Generali.RobyOne.view.CategorieRaccordo",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",itemId:"GridCategorieRaccordo",reference:"GridCategorieRaccordo",flex:1,store:Ext.create("Generali.person_fe.store.RaccordoCodificaEsterna",{autoLoad:!1}),viewConfig:{loadMask:!1,enableTextSelection:!0},columns:[{xtype:"numbercolumn",text:"id",dataIndex:"id",hidden:!0},{xtype:"numbercolumn",text:"idCodiceExt",dataIndex:"idCodiceExt",
hidden:!0},{xtype:"gridcolumn",text:"Tipo",flex:2,dataIndex:"tipoDatoRaccordo",sortable:!0,renderer:function(a,c,d){return(a=(a=trovaRecord(this.controller.storeTipoRacc,"codice",d.get("tipoDatoRaccordo")))?a.get("valore"):null)?a:d.get("tipoDatoRaccordo")},editor:{xtype:"combobox",displayField:"valore",allowBlank:!1,queryMode:"local",valueField:"codice",minChars:0,listeners:{change:function(b,c,d){c&&a.controller.loadStoreColDescrizione({fromView:!0,tipoDatoRaccordo:c})}}}},{xtype:"gridcolumn",text:"DESCRIZIONE",
dataIndex:"idCodiceSipcar",name:"idCodiceSipcar",flex:3,sortable:!1,renderer:function(a,c,d){c=d.get("desCodiceSipcar");if(Ext.isEmpty(c)){var b=this.controller.storeSipcarValue;b.data&&0!=b.data.length||this.controller.loadStoreColDescrizione(d);(a=trovaRecord(b,"codice",a))&&(c=a.get("valore"))}return c},editor:{xtype:"combobox",displayField:"valore",valueField:"codice",queryMode:"local",minChars:0,allowBlank:!1}},{xtype:"actioncolumn",width:25,align:"center",items:[{iconCls:"icon-refresh",tooltip:traduci("SINCRONIZZA")+
" "+traduci("ROBYONE_RACCORDO"),handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.forceSyncRaccordo(b)}}]}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",cls:"baseBgColor",height:36,items:[{xtype:"tbfill"},{xtype:"label",html:traduci("ROBYONE_RACCORDO"),cls:"cbaLabel"},{xtype:"tbfill"},{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo",disabled:!0},{xtype:"button",
itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina",disabled:!0}]}]}]});a.callParent(arguments)}});
Ext.define("Generali.RobyOne.view.Config",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"form",region:"center",flex:1,border:0,itemId:"FormConfig",reference:"FormConfig",layout:{type:"vbox"},autoScroll:!0,defaults:{margin:0},bodyPadding:10,title:"",trackResetOnLoad:!0,items:[{xtype:"container",layout:"hbox",margin:"10 0 0 0",items:[{xtype:"textfield",fieldLabel:"ATTIVAZIONE",
name:"userName",labelClsExtra:"cbaLabel",width:320,maxLength:100,enforceMaxLength:!0,emptyText:"ID attivazione mancante"},{xtype:"button",itemId:"BtnEnableEditId",reference:"BtnEnableEditId",margin:"0 0 0 5",cls:"cba-button-25",iconCls:"icon-locked",tooltip:"SBLOCCA",width:25},{xtype:"button",margin:"0 0 0 5",itemId:"BtnTestConnecction",reference:"BtnTestConnecction",width:100,iconCls:"icon-refresh",scale:"small",text:"TEST CONNESSIONE"},{xtype:"container",layout:"vbox",hidden:!0,items:[{xtype:"image",
itemId:"IconEmpty",reference:"IconEmpty",width:20,height:20},{xtype:"container",layout:"hbox",items:[{xtype:"image",itemId:"IconOK",reference:"IconOK",width:20,height:20,cls:"icon-conferma"},{xtype:"label",itemId:"LblIconOK",reference:"LblIconOK",text:"TEST_RIUSCITO",margin:"5 0 0 5",cls:"cbaLabel"}]},{xtype:"container",layout:"hbox",items:[{xtype:"image",itemId:"IconNO",reference:"IconNO",width:20,height:20,cls:"icon-elimina"},{xtype:"label",itemId:"LblIconNO",reference:"LblIconNO",text:"TEST_NON_RIUSCITO",
margin:"5 0 0 5",cls:"cbaLabel"}]}]}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",hidden:!0}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.RobyOne.view.Console",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",items:[{xtype:"container",layout:{type:"hbox"},items:[{xtype:"fieldset",collapsible:!0,padding:5,margin:5,layout:{type:"vbox"},items:[{width:600,xtype:"combobox",itemId:"CbOrg",reference:"CbOrg",store:Ext.create("Sipcar.store.CboxOrganizzazioni"),fieldLabel:"Organizzazione",
labelClsExtra:"cbaLabel",labelWidth:200,queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,disabled:!0},{width:600,xtype:"combobox",itemId:"CbArea",reference:"CbArea",store:Ext.create("Generali.RobyOne.store.Aree"),fieldLabel:traduci("AREA"),labelClsExtra:"cbaLabel",labelWidth:200,queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!0},{width:600,xtype:"combobox",itemId:"CbCategoriaR1",reference:"CbCategoriaR1",store:Ext.create("Generali.person_fe.store.cboxCodificaEsterna",
{autoLoad:!1}),fieldLabel:"Categoria Robyone",labelClsExtra:"cbaLabel",labelWidth:200,queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!0},{xtype:"container",itemId:"StatoSync",reference:"StatoSync",layout:{type:"hbox"},items:[{xtype:"checkboxfield",margin:"0 0 0 5",itemId:"StatoSincronizzato",reference:"StatoSincronizzato",cls:"cbaLabel",fieldLabel:"",boxLabel:"SINCRONIZZATO",checked:!0,inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",margin:"0 0 0 5",itemId:"StatoNonSincronizzato",
reference:"StatoNonSincronizzato",cls:"cbaLabel",fieldLabel:"",boxLabel:"NON_SINCRONIZZATO",checked:!0,inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",margin:"0 0 0 5",itemId:"StatoErrato",reference:"StatoErrato",cls:"cbaLabel",fieldLabel:"",boxLabel:"In errore",checked:!0,inputValue:"T",uncheckedValue:"F"},{xtype:"button",cls:"btnLarge",label:"CERCA",align:"left",itemId:"BtnCerca",reference:"BtnCerca",margin:"0 0 0 220",iconCls:"icon-ricerca",scale:"large"}]}]}]}]},{xtype:"CBAShortcutGrid",
viewConfig:{loadMask:!1,enableTextSelection:!0},title:"GRIGLIA_SOGGETTI",scrollable:!0,itemId:"GridPerson",reference:"GridPerson",store:Ext.create("Generali.RobyOne.store.PersonConsole",{autoLoad:!1}),flex:1,columns:[{xtype:"gridcolumn",flex:2,text:"NOMINATIVO",dataIndex:"nominativo",align:"left",renderer:function(a,b,c,d,e,g,h){return a+" "+this.rendererShortcutColumn()}},{xtype:"gridcolumn",flex:1,itemId:"PivaCf",reference:"PivaCf",text:"CF/PIVA",dataIndex:"fiscalCode",align:"center",renderer:function(a,
b,c,d,e,g,h){"A"==c.get("tipoSipcar")&&(b=c.get("vatNumber"),null!=b&&b!=a&&(a=a+" / "+b));return a}},{xtype:"gridcolumn",flex:2,text:"CATEGORIA_SICPAR2",dataIndex:"lstDescIdSipcar",align:"center"},{xtype:"gridcolumn",flex:2,text:"CATEGORIA_ROBYONE",dataIndex:"categories",align:"center",renderer:function(a,b,c){var d=this.controller.storeCbCat,e="";Ext.each(a,function(a){a=trovaRecord(d,"extra",a);e+=a.get("valore")+"<BR>"});return e}},{xtype:"datecolumn",text:"DATA_SINCRONIZZAZIONE",flex:1,dataIndex:"dataOraSync",
format:"d/m/Y",align:"center",renderer:function(a,b,c){b=null;a&&(b=Ext.Date.format(new Date(a),"d/m/Y H:i:s"));return b}},{xtype:"gridcolumn",text:"STATO",flex:1,dataIndex:"stato",align:"center",renderer:function(a,b,c){a?(a=a.trim(),0<=a.indexOf("ERROR")?b.style="color:red; text-align:center !important":a="T"==a?traduci("SINCRONIZZATO"):"X"==a?traduci("IN_ELABORAZIONE"):traduci("NON_SINCRONIZZATO"),a=a.replace(",","<BR>")):a=traduci("NON_SINCRONIZZATO");return a}}],dockedItems:[{xtype:"toolbar",
dock:"top",items:[{xtype:"cercaGrid",label:"",width:250,labelWidth:0,emptyText:"Nominativo",cbaConfig:{searchField:"nominativo",ricercaIniziaPer:!0}},{xtype:"tbfill"},{xtype:"label",itemId:"LblSinc",reference:"LblSinc",text:"Ultima sincronizzazione il 10/01/2019 ore 10.00",hidden:!0},{xtype:"button",itemId:"BtnForceSync",reference:"BtnForceSync",nonDisabilitare:!0,width:100,iconCls:"icon-refresh",scale:"small",text:"SINCRONIZZA",disabled:!0},{xtype:"button",itemId:"BtnLog",reference:"BtnLog",nonDisabilitare:!0,
width:100,iconCls:"icon-download",scale:"small",text:"LOG",hidden:!0,disabled:!0},{xtype:"button",itemId:"BtnEsporta",reference:"BtnEsporta",nonDisabilitare:!0,width:100,iconCls:"icon-stampa32",scale:"small",text:"ESPORTA",hidden:!0}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.RobyOne.view.MainRobyOne",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"ROBYONE_MSG_ATTIVAZIONE",nomeFunzioneDaAttivare:"ROBYONE_ONEDATA",codiceFunzione:"GE_ROBYONECONSOLE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",border:0,itemId:"CntServizioDisattivato",reference:"CntServizioDisattivato",layout:{align:"stretch",type:"vbox"},title:"",hidden:!0,items:[{xtype:"panel",cls:"pannelloBiancoBordato",margin:3,layout:{align:"stretch",
type:"vbox"},height:120,border:0,items:[{xtype:"label",margin:"30 15 0 15",cls:"cbaLabelDatiUtente",html:traduci("ROBYONE_MSG_ATTIVAZIONE"),style:"text-align:center"}]}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",border:0,itemId:"GridRobyOneId",reference:"GridRobyOneId",title:"ACCOUNT",width:200,collapsible:!0,collapseDirection:"left",viewConfig:{loadMask:!1},store:Ext.create("Generali.RobyOne.store.RobyOneConfig",{autoload:!1}),columns:[{xtype:"gridcolumn",
dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"robyOneIdDescr",text:"DESCRIZIONE",flex:1},{xtype:"gridcolumn",dataIndex:"robyOneId",text:"ROBYONE_ID",flex:1,hidden:!0}]},{xtype:"tabpanel",border:0,itemId:"TabMain",reference:"TabMain",flex:1,activeTab:0,items:[{itemId:"TabConsole",reference:"TabConsole",title:"Console OneData ",layout:"fit",cbaConfig:{url:"Generali.RobyOne.view.Console"}},{itemId:"TabConfig",reference:"TabConfig",title:"Configurazione/Raccordi Categorie",layout:"fit",cbaConfig:{url:"Generali.RobyOne.view.Categorie"}}]}]}]});
this.callParent(arguments)}});var StdSipcar=function(){};StdSipcar.isValidID=function(a){a=parseInt(a);return!(!a||0>=a)};StdSipcar.coalesce=function(){for(var a=arguments.length,b=0;b<a;b++){var c=arguments[b];if(null!==c&&void 0!==c)return c}return null};StdSipcar.pdStrLeft=function(a,b,c){if(!a||Ext.isEmpty(a))a="";"string"!==typeof a&&(a=a.toString());a=a.trim();var d=a.length;if(0>=b||b<d)return a;for(;d<b;d++)a=c+a.trim();return a.trim()};
StdSipcar.doSecureLogin=function(a){a=void 0===a?function(){return null}:a;return localStorage.getItem("access_token_dm7")?!0:(Ext.create("winCBA",{larghezzaWin:320,border:!1,header:!1,closable:!1,maximizable:!1,name:[{xtype:"CBASecureLogin",layout:{type:"vbox",align:"stretch"},flex:1,cbaConfig:{fnOnSuccess:a}}]}).show(),!1)};StdSipcar.intToHexColor=function(a){return Number.isInteger(a)?(a-=0,a=((a&255)<<16|a&65280|(a&16711680)>>>16).toString(16),a="#000000".substring(0,7-a.length)+a):"transparent"};
StdSipcar.infoIndirizzo=function(a){var b="",c=StdSipcar.coalesce(a.cap,"").toString(),d=StdSipcar.coalesce(a.indirizzo,"").toString(),e=StdSipcar.coalesce(a.civico,"").toString(),g=StdSipcar.coalesce(a.esponente,"").toString(),h=StdSipcar.coalesce(a.interno,"").toString(),k=StdSipcar.coalesce(a.descrizioneComune,"").toString();a=StdSipcar.coalesce(a.provincia,"").toString();Ext.isEmpty(c.trim())||(b+=c);var l="";Ext.isEmpty(d.trim())||(l+=d,Ext.isEmpty(e.trim())||(l+=(Ext.isEmpty(l.trim())?"":", ")+
e,Ext.isEmpty(g.trim())||(l+="/"+g),Ext.isEmpty(h.trim())||(l+=" int. "+h)));l=StdSipcar.coalesce(l,"");Ext.isEmpty(l.trim())||(b+=(Ext.isEmpty(c.trim())?"":" ")+l);Ext.isEmpty(k.trim())||(b+=(Ext.isEmpty(b.trim())?"":" ")+k,Ext.isEmpty(a.trim())||(b+=" ("+a+")"));return b};StdSipcar.modAggIsEnable=function(a,b,c){Ext.Ajax.request({method:"GET",url:getUrlGen()+"/auth/extraFn/isEnabled",params:{codiceFunzione:b,idOrganizzazione:a},success:function(a){c&&c(a)}})};
StdSipcar.forceSync=function(a,b,c){var d={};Ext.isEmpty(a)?Messaggio("ATTENZIONE","Parametri errati!","OK","WARNING"):(a.idOrganizzazione&&Ext.apply(d,{idOrganizzazione:a.idOrganizzazione}),a.lstAree&&Ext.apply(d,{lstAree:a.lstAree}),a.tipoDatoRaccordo&&Ext.apply(d,{tipoDatoRaccordo:a.tipoDatoRaccordo}),a.lstIdSipcar&&Ext.apply(d,{lstIdSipcar:a.lstIdSipcar}),a.lstIdCatRobyOne&&Ext.apply(d,{lstIdCatRobyOne:a.lstIdCatRobyOne}),a.reSyncAnag&&Ext.apply(d,{reSyncAnag:a.reSyncAnag}),a.tipoSipcar&&Ext.apply(d,
{tipoSipcar:a.tipoSipcar}),Ext.Ajax.request({method:"GET",timeout:3E4,url:"/cba/gen/ws/general/robyone/forceSync",params:d,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgShow("",a.message),c&&c(b,a)):msgShowError("",a.message)}}))};StdSipcar.promiseGetRequest=function(a,b){a=void 0===a?"":a;b=void 0===b?{}:b;return new Promise(function(c,d){Ext.Ajax.request({method:"GET",url:a,params:b,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c(a.data):d(a.message)}})})};
StdSipcar.promisePostRequest=function(a,b,c){a=void 0===a?"":a;b=void 0===b?{}:b;return new Promise(function(d,e){Ext.Ajax.request({method:"POST",url:a,params:b,jsonData:c,timeout:36E5,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?d(a.data):e(a.message)}})})};StdSipcar.promiseLoadStore=function(a,b){return new Promise(function(c,d){a.load({params:b,callback:function(a,b,h){h?c(a):d(b.getError())}})})};
StdSipcar.sporcaForm=function(a,b){b=void 0===b?!0:b;Ext.isDefined(a.getForm)&&(a=a.getForm());if(b&&a.isDirty())return!1;var c=a.findField("id");if(Ext.isDefined(c)){var d=c.getValue();this.isValidID(d)&&(b?c.setValue("0"+d):c.setValue(parseInt(d)))}};StdSipcar.isModuloAttivo=function(a){var b;(a=CBA.moduli["modulo"+a])&&(b=a.abilitato&&(Ext.isDefined(a.installato)?a.installato:!0));return b};StdSipcar.getValidExtensions=function(){return".p7m,.pdf,.jpg,.png,.mp4,.txt,.jpeg"};
StdSipcar.rendererDescNotifica=function(a,b,c,d,e){e||(e=300);a=Ext.String.ellipsis(c.get("descrizione"),e);b=null;StdSipcar.isAreaPersonale(CBA.moduli.moduloAttivo)?b="dipendente":StdSipcar.isAreaUtenti(CBA.moduli.moduloAttivo)&&(b="nominativo");b&&c.get("commandParams")&&(e=Ext.urlDecode(c.get("commandParams")),Ext.isEmpty(e[b])||(a=e[b]+"<div style='margin-top:5px; margin-left:15px;'>"+a+"</div>"));b="<b>"+a+"</b>";"T"==c.get("letto")&&(b=a);d&&(b="<div>"+b+'</div><div style="float: right;">'+
StdSipcar.dateFromNow(Ext.Date.parse(c.get("ora"),"Y-m-d H:i:s"))+"</div>");return b};StdSipcar.openNotificheManuali=function(a,b){Ext.create("winCBA",{name:"Generali.notifiche.view.NotificheManuali",titolo:traduci("NOTIFICHE_MANUALI"),dimensione:7,closable:!0,configItem:{record:b,esci_callback:a}}).show()};
StdSipcar.createIfExists=function(a,b){a=void 0===a?"":a;b=void 0===b?{}:b;if(!Ext.isEmpty(a))return new Promise(function(c,d){Ext.ClassManager.get(a)?c(Ext.create(a,b)):Ext.Loader.loadScript({url:Ext.Loader.getPath(a),onLoad:function(){c(Ext.create(a,b))}})})};StdSipcar.isAreaPersonale=function(a){return[45].includes(a)};StdSipcar.isAreaUtenti=function(a){return[43,46,48,50,55,64].includes(a)};
StdSipcar.dateFromNow=function(a){var b=new Date;return a.getTime()>b.getTime()?(a=a.getTime()-b.getTime(),3E4>a?"ora":36E5>a?"tra "+Math.round(a/6E4)+" minuti":54E6>a?"tra "+Math.round(a/36E5)+" ore":31536E6>a?"tra "+Math.round(a/864E5)+" giorni":Math.round(a/31536E6)+" anni fa"):tempoTrascorsoText(a,b)};StdSipcar.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};
StdSipcar.parseFloat=function(a,b){a=void 0===a?0:a;b=void 0===b?2:b;return this.isNumeric(a)?arrotonda(parseFloat(a),b):0};StdSipcar.isZero=function(a){a=this.parseFloat(a);return 0==a};StdSipcar.isNoZero=function(a){return!this.isZero(a)};StdSipcar.isGreaterThanZero=function(a){a=this.parseFloat(a);return 0<a};StdSipcar.sum=function(a,b,c){b=void 0===b?0:b;c=void 0===c?2:c;a=this.parseFloat(void 0===a?0:a,c);b=this.parseFloat(b,c);return this.parseFloat(a+b,c)};
StdSipcar.subtract=function(a,b,c){b=void 0===b?0:b;c=void 0===c?2:c;a=this.parseFloat(void 0===a?0:a,c);b=this.parseFloat(b,c);return this.parseFloat(a-b,c)};StdSipcar.multiply=function(a,b,c){b=void 0===b?0:b;c=void 0===c?2:c;a=this.parseFloat(void 0===a?0:a,c);b=this.parseFloat(b,c);return this.parseFloat(a*b,c)};StdSipcar.divide=function(a,b,c){b=void 0===b?0:b;c=void 0===c?2:c;a=this.parseFloat(void 0===a?0:a,c);b=this.parseFloat(b,c);return this.parseFloat(a/b,c)};
StdSipcar.calcolaPercentuale=function(a,b,c){c=void 0===c?2:c;var d=0;this.isNumeric(a)&&this.isNumeric(b)&&(d=arrotonda(a/100*b,c));return d};StdSipcar.chainedStore=function(a){return Ext.create("Ext.data.ChainedStore",{source:a})};StdSipcar.warn=function(a){console.warn("%c"+a,"background: black; color: yellow")};StdSipcar.error=function(a){console.warn("%c"+a,"background: red; color: white")};CBA.StdSipcar=new StdSipcar;
Ext.define("Generali.abbinamentoContiAnni.controller.AlberoAbbConti",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:a+"#TreeRep"},{ref:"PnlDati",selector:a+"#PnlDati"},{ref:"BtnNuovo",selector:a+"#BtnNuovo"},{ref:"BtnElimina",selector:a+"#BtnElimina"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"LblSelettore",selector:a+"#LblSelettore"},{ref:"TxtCerca",
selector:a+"#TxtCerca"},{ref:"CBXSoloNonAbbinati",selector:a+"#CBXSoloNonAbbinati"},{ref:"CBAnno",selector:a+"#CBAnno"}]);this.control(a+"#TreeRep",{render:this.renderTreeRep,beforeitemcontextmenu:this.beforeitemcontextmenuTreeRep,beforeedit:this.beforeeditTreeRep,edit:this.editTreeRep,canceledit:this.canceleditTreeRep,validateedit:this.validateeditTreeRep,beforeselect:this.beforeselectTreeRep,select:this.selectTreeRep,itemdblclick:this.itemdblclickTreeRep});this.control(a+"#BtnNuovo",{click:this.clickBtnNuovo});
this.control(a+"#BtnElimina",{click:this.clickBtnElimina});this.control(a+"#BtnConferma",{click:this.clickBtnConferma});this.control(a+"#BtnEsci",{click:this.clickBtnEsci});this.control(a+"#CBXSoloNonAbbinati",{change:this.changeCBXSoloNonAbbinati});this.control(a+"#CBAnno",{afterrender:this.afterrenderCBAnno,change:this.changeCBAnno});this.control(a+"#TxtCerca",{change:Ext.Function.createBuffered(this.filtraTree,500,this)})},filtraTree:function(a){var b=this.getTreeRep(),c=b.getStore(),d=[];this.getLblSelettore().setVisible(!1);
c.clearFilter();Ext.isEmpty(a.getValue())?(c.each(function(a){a.set("cls","")}),b.getSelectionModel().select(0)):(c.each(function(b){if(b.isLeaf()){var c=!1,e=b.get("text");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);c?(b.set("cls","cba-dirty-record"),d.push(b)):b.set("cls","")}}),this.filtraPadri(c,d),this.getLblSelettore().setVisible(1<d.length),Ext.isEmpty(d)?b.getSelectionModel().select(0):(b.ensureVisible(d[0]),this.getLblSelettore().setText(d.length+" "+traduci("ELEMENTI_TROVATI"))));
a.focus()},filtraPadri:function(a,b){a.filter(function(a){for(var c=!1,e=0,g=b.length;e<g;e++)if(a.contains(b[e])){c=!0;break}else if(a.isLeaf()&&(c=a===b[e]))break;return c})},renderTreeRep:function(a){a.view.loadMask=!1},changeCBXSoloNonAbbinati:function(){this.aggiornaStore()},changeCBAnno:function(a,b,c,d){this.aggiornaStore()},itemdblclickTreeRep:function(a,b,c,d,e,g){this.selezionaEsci()},selezionaEsci:function(){var a=this.getBtnConferma();if(a.isVisible()){var b=this.getTreeRep().getSelectionModel().getSelection()[0];
b&&b.get("leaf")&&(this.cbaConfig.afterConferma&&this.cbaConfig.afterConferma(b.get("id")),a.up("window").close())}},clickBtnConferma:function(a){this.selezionaEsci()},clickBtnEsci:function(a){a.up("window").close()},beforeselectTreeRep:function(a,b){if(0!=b.get("id")){var c=0,d=this.getTreeRep().up("#CntPrincipale").down("#GridContiAnniSucc").controller.getGridContiAnniSucc().getStore();d.each(function(a){c+=a.get("percentualeRipartizione")});if(0<d.getCount())if(c&&100==c)this.getTreeRep().setDisabled(!1);
else return Messaggio("ATTENZIONE","SOMMA_PERCENTUALE_INFERIORE_100","OK","WARNING"),this.getTreeRep().setDisabled(!0),!1;return 0<b.get("id")}},selectTreeRep:function(a,b){var c=this.getTreeRep(),d=c.up("#CntPrincipale").down("#GridContiAnniSucc").controller,c=c.up("#CntPrincipale").down("#GridContiAnniPrec").controller;this.getBtnElimina().setDisabled(0===b.get("id")||"L"==this.cbaConfig.permesso);this.getBtnConferma().setDisabled(0===b.get("id")||!b.get("leaf"));d.idTestata=b.get("id");c.idTestata=
b.get("id");d.recordAlbero=b;c.recordAlbero=b;d.idEsercizioSorg=this.getCBAnno().getValue();this.setEsercizioPrevNext(d,d.getGridContiAnniSucc(),"S");this.setEsercizioPrevNext(c,c.getGridContiAnniPrec(),"P");0!=b.get("id")?(d.aggiornaStore(),c.aggiornaStore()):(svuotaStore(d.getGridContiAnniSucc().getStore()),svuotaStore(c.getGridContiAnniPrec().getStore()))},setEsercizioPrevNext:function(a,b,c){var d=this.getCBAnno().getValue(),e=this.getTreeRep().getSelectionModel().getSelection()[0];Ext.Ajax.request({method:"GET",
async:!1,params:{idEsercizio:d,direction:c},url:"/cba/gen/ws/general/esercizioCont/prevNext",success:function(c){c=Ext.JSON.decode(c.responseText);c.success?c.data?(a.idEsercizioSucc=c.data.id,b.setTitle(traduci("CONTI_COLLEGATI_ESERCIZIO",[c.data.descrizione])),b.setDisabled(!1),"GridContiAnniSucc"===b.getItemId()&&(e.isLeaf()?b.setDisabled(!1):b.setDisabled(!0))):(b.setDisabled(!0),c="GridContiAnniSucc"===b.getItemId()?traduci("NO_ESERCIZIO_SUCCESSIVO"):traduci("NO_ESERCIZIO_PRECEDENTE"),b.setTitle(c)):
msgShowError("",c.message)}})},beforeeditTreeRep:function(a,b,c){if(!0===a.editing||0===b.record.get("id"))return!1;this.abilitaBottoniGrid(!1)},editTreeRep:function(a,b,c){c={};var d=b.record.getData(),e=a.getEditor().getForm();e.controller=this;e.store=this.getTreeRep().getStore();Ext.apply(c,{id:d.id?d.id:null,idOrganizzazione:this.cbaConfig.idOrganizzazione,anno:this.getCBAnno().getValue(),idPadre:d.idPadre,descrizione:d.text});controller_salvaRecord(e,c,!1,!1)?this.abilitaBottoniGrid(!0):a.startEdit(b.record,
0)},canceleditTreeRep:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditTreeRep:function(a,b,c){return msgShow("",[])},beforeitemcontextmenuTreeRep:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a){var b=this,c=b.getTreeRep(),d=c.getStore();b.getTxtCerca().setValue("");c.getSelectionModel().deselectAll();d.load({params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.getCBAnno().getValue(),soloNonAbbinati:getBoolValue(b.getCBXSoloNonAbbinati().getValue())},
callback:function(d,g,h){h?((d=c.getRootNode().findChild("id",a,!0))?(g=d.getPath("id"),c.expandPath(g,"id"),c.getSelectionModel().select(0),c.getSelectionModel().select([d]),c.getPlugin().scrollTo(d.get("numRiga"),!0)):(c.expandAll(),c.getSelectionModel().select(0)),b.getTxtCerca().focus()):msgShowError("",g.getError())}})},clickBtnNuovo:function(){var a=this.getTreeRep(),b=a.getStore(),c=a.getSelectionModel().getLastSelected();b.clearFilter();c.set("leaf",!1);c.appendChild({leaf:!0,idPadre:c.get("id")});
a.getView().refresh();c.expand();a.getPlugin().startEdit(c.lastChild,0);this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},clickBtnElimina:function(){var a=this,b=a.getTreeRep(),c=b.getSelectionModel().getSelection()[0],d=c.hasChildNodes()?"MSG_ELIMINA_NODO":"";controller_eliminaRecord(b.getStore(),{id:c?c.get("id"):""},function(){a.aggiornaStore()},!1,d)},afterrenderCBAnno:function(a){var b=this,c=b.cbaConfig;getIdEsercizioDefaultByIdOrg(c.idOrganizzazione,
function(d){b.idEsercizioDefault=d;setCombo(a,b.idEsercizioDefault,null,{idOrganizzazione:c.idOrganizzazione});getAnnoBilancioScalare(c.idOrganizzazione,b.idEsercizioDefault,function(a){b.AnnobilancioScalare=a})})},onLaunch:function(){var a=this,b=a.controlleCntPrincipale.cbaConfig;a.getTreeRep().controller=a;Sipcar.app.getController("Menu").getCardApplicativo().down("#dettab"+CBA.moduli.moduloAttivo).down("tabpanel").getActiveTab().cbaConfig.puoiChiudere=function(){return a.chiudiVideata()};b.currentTab&&
(b.currentTab.cbaConfig.puoiChiudere=function(){return a.chiudiVideata()})},chiudiVideata:function(){var a=!0;if(!this.isDestroyed)var a=this.getTreeRep(),b=a.getSelectionModel().getSelection()[0],a=a.fireEvent("beforeselect",a,b);return a},destroy:function(){this.callParent()}});
Ext.define("Generali.abbinamentoContiAnni.controller.ContiAnniPrec",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridContiAnniPrec",selector:a.selContainer+"#GridContiAnniPrec"},{ref:"TxtCerca",selector:a.selContainer+"#TxtCerca"},{ref:"FsSolaLettura",selector:a.selContainer+"#FsSolaLettura"}]);a.control(a.selContainer+"#GridContiAnniPrec",{beforeedit:a.beforeeditGridContiAnniPrec,edit:a.editGridContiAnniPrec,
canceledit:a.canceleditGridContiAnniPrec,validateedit:a.validateeditGridContiAnniPrec});a.control(a.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(function(b){var c=a.getGridContiAnniPrec(),d=c.getStore();d.clearFilter();d.filter(function(a){var c=!1;(a=a.get("descrContoDestinazione"))&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&(c=!0);return c});b.focus();0<d.getCount()&&c.getSelectionModel().select(0);b.focus()},100,a)})},beforeeditGridContiAnniPrec:function(a,b,c){if(!0===
a.editing)return!1;this.storeConti.getProxy().extraParams={idOrganizzazione:getIdOrg(),idEsercizio:me.idEsercizioPrec};f=a.getEditor().getForm();f.findField("idContoDestinazione").bindStore(this.storeConti);this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){},editGridContiAnniPrec:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();delete c.descrContoSorgente;delete c.descrContoDestinazione;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?
this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridContiAnniPrec:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridContiAnniPrec:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=this,c=b.getGridContiAnniPrec(),d=c.getStore();b.getFsSolaLettura().setVisible(!1);d.load({params:{idConto:b.idTestata,targetDirection:"P"},callback:function(e,g,h){h?(g=null,b.getFsSolaLettura().setVisible(!Ext.isEmpty(e)),a&&(g=trovaRecord(d,
"id",a)),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(g?[g]:0)):msgShowError("",g.getError())}})},svuotaStore:function(){svuotaStore(this.getGridContiAnniPrec().getStore())},onLaunch:function(){this.getGridContiAnniPrec().controller=this;this.storeConti=Ext.create("Generali.pianodeiconti.store.DesSottoconto",{autoLoad:!1,autoDestroy:!1})},destroy:function(){eliminaStore(this.storeConti);this.callParent()}});
Ext.define("Generali.abbinamentoContiAnni.controller.ContiAnniSucc",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridContiAnniSucc",selector:a.selContainer+"#GridContiAnniSucc"},{ref:"BtnNuovo",selector:a.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:a.selContainer+"#BtnElimina"},{ref:"TxtCerca",selector:a.selContainer+"#TxtCerca"}]);a.control(a.selContainer+"#GridContiAnniSucc",{beforeedit:a.beforeeditGridContiAnniSucc,
edit:a.editGridContiAnniSucc,canceledit:a.canceleditGridContiAnniSucc,validateedit:a.validateeditGridContiAnniSucc});a.control(a.selContainer+"#BtnNuovo",{click:a.clickBtnNuovo});a.control(a.selContainer+"#BtnElimina",{click:a.clickBtnElimina});a.control(a.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(function(b){var c=a.getGridContiAnniSucc(),d=c.getStore();d.clearFilter();d.filter(function(a){var c=!1;(a=a.get("descrContoDestinazione"))&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&
(c=!0);return c});b.focus();0<d.getCount()&&c.getSelectionModel().select(0);b.focus()},100,a)})},clickBtnNuovo:function(a){a=this.getGridContiAnniSucc();var b=a.getStore(),c=100;0<b.getCount()&&b.each(function(a){c-=a.data.percentualeRipartizione});var d={id:null,idContoSorgente:this.idTestata,idEsercizioSorgente:this.cbaConfig.controllerAlbero.getCBAnno().getValue(),idEsercizioDestinazione:this.idEsercizioSucc,percentualeRipartizione:c};b.clearFilter();b.insert(0,d);a.getSelectionModel().select(0);
a.getPlugin().startEdit(0,0);this.abilitaBottoniGrid(!1)},clickBtnElimina:function(a){var b=this;a=b.getGridContiAnniSucc();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridContiAnniSucc:function(a,b,c){if(!0===a.editing)return!1;this.storeConti.getProxy().extraParams={idOrganizzazione:getIdOrg(),idEsercizio:this.idEsercizioSucc};f=a.getEditor().getForm();f.findField("idContoDestinazione").bindStore(this.storeConti);
this.storeConti.load();this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},editGridContiAnniSucc:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();delete c.descrContoSorgente;delete c.descrContoDestinazione;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridContiAnniSucc:function(a,b,c){this.abilitaBottoniGrid(!0);
this.aggiornaStore(b.record.get("id"))},validateeditGridContiAnniSucc:function(a,b,c){var d=0;this.getGridContiAnniSucc().getStore().each(function(a){d=a.data.id!=b.record.data.id?d+a.data.percentualeRipartizione:d+b.newValues.percentualeRipartizione});return 100<d?(Messaggio("ATTENZIONE","La somma percentuale supera il 100%","OK","WARNING"),!1):msgShow("",[])},aggiornaStore:function(a){var b=this.getGridContiAnniSucc(),c=b.getStore(),d=this.getGridContiAnniSucc().up("#CntPrincipale").down("#TreeRep");
c.load({params:{idConto:this.idTestata,targetDirection:"S"},callback:function(e,g,h){if(h){if(0<e.length){for(h=g=0;h<e.length;h++)g+=e[h].data.percentualeRipartizione;g&&100==g&&d.setDisabled(!1)}e=null;a&&(e=trovaRecord(c,"id",a));b.getSelectionModel().deselectAll();b.getSelectionModel().select(e?[e]:0)}else msgShowError("",g.getError())}})},svuotaStore:function(){svuotaStore(this.getGridContiAnniSucc().getStore())},onLaunch:function(){this.getGridContiAnniSucc().controller=this;this.storeConti=
Ext.create("Generali.pianodeiconti.store.DesSottoconto",{autoLoad:!1,autoDestroy:!1})},destroy:function(){eliminaStore(this.storeConti);this.callParent()}});
Ext.define("Generali.abbinamentoContiAnni.controller.PnlAbbConti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CntPrincipale",selector:this.selContainer+"#CntPrincipale"}])},onLaunch:function(){var a={};a.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();a=Ext.create("Generali.abbinamentoContiAnni.view.AlberoAbbConti",{cbaConfig:a,controlleCntPrincipale:this});
this.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:Ext.create("Generali.abbinamentoContiAnni.view.ContiAnniPrec",{cbaConfig:{controllerAlbero:a.down("#TreeRep").controller,controlleCntPrincipale:this}})});this.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1.5,items:a});this.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:Ext.create("Generali.abbinamentoContiAnni.view.ContiAnniSucc",{cbaConfig:{controllerAlbero:a.down("#TreeRep").controller,controlleCntPrincipale:this}})});
this.controllerAlbero=a.down("#TreeRep").controller}});
Ext.define("Generali.abbinamentoContiAnni.store.ContiAnniSucc",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idContoSorgente"},{name:"idEsercizioSorgente"},{name:"idContoDestinazione"},{name:"idEsercizioDestinazione"},{name:"percentualeRipartizione"},{name:"descrContoSorgente"},{name:"descrContoDestinazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/abbinaAnniDifferenti/listByConto",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/pianoDeiConti/abbinaAnniDifferenti/listByConto",
create:"/cba/gen/ws/general/pianoDeiConti/abbinaAnniDifferenti/insert",update:"/cba/gen/ws/general/pianoDeiConti/abbinaAnniDifferenti/update",destroy:"/cba/gen/ws/general/pianoDeiConti/abbinaAnniDifferenti/delete"}},autoDestroy:!0});
Ext.define("Generali.abbinamentoContiAnni.view.AlberoAbbConti",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",header:{title:{hidden:!0},layout:{pack:"center"},padding:6,items:[{xtype:"combobox",fieldLabel:traduci("ESERCIZIO"),labelClsExtra:"cbaLabel",editable:!1,labelWidth:60,itemId:"CBAnno",reference:"CBAnno",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont")}]},
plugins:[{ptype:"bufferedrenderer"}],viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){return a.get("cls")}},width:500,flex:1,itemId:"TreeRep",reference:"TreeRep",store:Ext.create("Generali.pianodeiconti.store.AlberoConti"),useArrows:!0,rootVisible:!1,columns:[{xtype:"treecolumn",dataIndex:"text",text:"PIANO_DEI_CONTI",flex:1,editor:{xtype:"textfield",allowBlank:!1}}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",hidden:!0},{xtype:"button",
itemId:"BtnElimina",reference:"BtnElimina",hidden:!0},{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",hidden:!0},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",hidden:!0},{xtype:"container",itemId:"CntSrc",reference:"CntSrc",width:540,flex:1,margin:"2 0 0 0",layout:{type:"hbox"},items:[{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:300,fieldLabel:"",emptyText:"CERCA"},{xtype:"checkboxfield",boxLabel:"SOLO_CONTI_NON_ABBINATI",inputValue:"T",uncheckedValue:"F",itemId:"CBXSoloNonAbbinati",
reference:"CBXSoloNonAbbinati",flex:1,margin:"0 0 0 10",labelWidth:this.larghezza_dicitura,labelClsExtra:"cbaLabel",cls:"cbaLabel"}]}]},{xtype:"label",border:0,dock:"top",hidden:!0,itemId:"LblSelettore",reference:"LblSelettore"}]}]});this.callParent(arguments)}});
Ext.define("Generali.abbinamentoContiAnni.view.ContiAnniPrec",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},title:"ESERCIZIO_PRECEDENTE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",height:200,itemId:"GridContiAnniPrec",reference:"GridContiAnniPrec",title:"CONTI_COLLEGATI_ESERCIZIO_PRECEDENTE",store:Ext.create("Generali.abbinamentoContiAnni.store.ContiAnniSucc"),flex:1,columns:[{xtype:"gridcolumn",text:"CONTO_COLLEGATO",flex:1,dataIndex:"idContoDestinazione",
editor:{xtype:"combobox",displayField:"valore",valueField:"codice",queryParam:"descrizione",allowBlank:!1,minChars:3},renderer:function(a,b,c,d,e,g,h){return c.get("descrContoSorgente")}},{xtype:"gridcolumn",text:"PERCENTUALE",width:80,dataIndex:"percentualeRipartizione",editor:{xtype:"numberfield",allowBlank:!1,maxLength:5,enforceMaxLength:!0},renderer:function(a,b,c,d,e,g,h){b.style="text-align:right !important";return formatFloat(a)}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",maxWidth:300,flex:1,fieldLabel:"",emptyText:"CERCA"},{xtype:"fieldset",cls:"bgYellow",itemId:"FsSolaLettura",reference:"FsSolaLettura",height:25,hidden:!0,items:[{xtype:"displayfield",labelWidth:400,labelClsExtra:"cbaLabel",renderer:function(a){return'<span style="color:red; font-weight: bold;">'+traduci("DATI_SOLA_LETTURA")+"</span>"}}]}]}],listeners:{beforeedit:{fn:function(){return!1}}}}]});
this.callParent(arguments)}});
Ext.define("Generali.abbinamentoContiAnni.view.ContiAnniSucc",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},title:"ESERCIZIO_SUCCESSIVO",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",height:200,itemId:"GridContiAnniSucc",reference:"GridContiAnniSucc",title:"CONTI_COLLEGATI_ESERCIZIO_SUCCESSIVO",store:Ext.create("Generali.abbinamentoContiAnni.store.ContiAnniSucc"),flex:1,columns:[{xtype:"gridcolumn",text:"CONTO_COLLEGATO",flex:1,dataIndex:"idContoDestinazione",
editor:{xtype:"combobox",displayField:"valore",valueField:"codice",queryParam:"descrizione",queryMode:"local",allowBlank:!1,minChars:3},renderer:function(a,b,c,d,e,g,h){return c.get("descrContoDestinazione")}},{xtype:"gridcolumn",text:"PERCENTUALE",width:80,dataIndex:"percentualeRipartizione",editor:{xtype:"numberfield",allowBlank:!1,maxLength:5,enforceMaxLength:!0},renderer:function(a,b,c,d,e,g,h){b.style="text-align:right !important";return formatFloat(a)}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",maxWidth:300,flex:1,fieldLabel:"",emptyText:"CERCA"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.abbinamentoContiAnni.view.PnlAbbConti",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"CntPrincipale",reference:"CntPrincipale",layout:{align:"stretch",type:"hbox"}}]});this.callParent(arguments)}});
Ext.define("Generali.aliquotaiva.controller.AliIva",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"GridAliquotaIva",selector:this.selContainer+"#GridAliquotaIva"},{ref:"TxAliquota",selector:this.selContainer+
"#TxAliquota"},{ref:"FsTipoEsenzione",selector:this.selContainer+"#FsTipoEsenzione"},{ref:"RgbTipoEsenzione",selector:this.selContainer+"#RgbTipoEsenzione"},{ref:"ChkIncludeInVentilazione",selector:this.selContainer+"#ChkIncludeInVentilazione"},{ref:"ChkArticolo36bis",selector:this.selContainer+"#ChkArticolo36bis"},{ref:"ChbAttivo",selector:this.selContainer+"#ChbAttivo"},{ref:"ChkEsclusoTotImponibile",selector:this.selContainer+"#ChkEsclusoTotImponibile"}]);this.control(this.selContainer+"#GridAliquotaIva",
{select:this.selectGridAliquotaIva});this.control(this.selContainer+"#TxAliquota",{blur:this.blurTxAliquota,change:this.changeTxAliquota});this.control(this.selContainer+"#RgbTipoEsenzione",{change:this.changeRgbTipoEsenzione})},blurTxAliquota:function(a,b,c){this.disabilitaTipoEsenzione(this.getTxAliquota().getValue())},changeTxAliquota:function(){this.disabilitaTipoEsenzione(this.getTxAliquota().getValue())},disabilitaTipoEsenzione:function(a){this.getFsTipoEsenzione().setDisabled(!isNaN(a));this.getChkEsclusoTotImponibile().setDisabled(!isNaN(a))},
changeRgbTipoEsenzione:function(a,b,c,d){this.getChkArticolo36bis().setDisabled(2!=b.tipoEsenzione)},selectGridAliquotaIva:function(a,b){clearForm(this.getForm());this.getForm().loadRecord(b);isNaN(this.getTxAliquota().getValue())?this.getFsTipoEsenzione().setDisabled(!1):this.getFsTipoEsenzione().setDisabled(!0)},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();
Ext.apply(c,{soggettoBollo:getBoolValue(c.soggettoBollo),esclusoVolumeAffari:getBoolValue(c.esclusoVolumeAffari),articolo36bis:getBoolValue(c.articolo36bis),attivo:getBoolValue(c.attivo),includeInVentilazione:getBoolValue(c.includeInVentilazione),esclusoTotImponibile:getBoolValue(c.esclusoTotImponibile)});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();
a.storeForm=b.store=a.getGridAliquotaIva().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);a.getGridAliquotaIva().setDisabled(!0)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},
esci_callback:function(){a.getForm().up("window").close();a.cbaConfig.callbackRiapriStore&&a.cbaConfig.callbackRiapriStore()}}});inserisciBottoni(b.boxBottoni,c);a.cbaConfig.mostraEsci||(c=b.boxBottoni.queryById("BtnStampa"),c.setVisible(!Ext.isEmpty(a.cbaConfig.url)),a.configurePrintButton(c,"preview"),b.boxBottoni.queryById("btnEsci").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridAliquotaIva().setDisabled(e)})},aggiornaStore:function(a){var b=
this,c=b.getForm(),d=c.getForm(),e=c.store;e.load({params:{},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(c):(a||(a=d.findField("id").getValue()),g=trovaRecord(e,"id",a),h=b.getGridAliquotaIva(),h.getSelectionModel().deselectAll(),h.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},stampa:function(){var a={},b=this.cbaConfig.winElaborazione;b&&"string"===typeof b&&(this.cbaConfig.winElaborazione=b===(!0).toString());Ext.apply(a,{codEnte:CBA.parametriGenerali.codEnte});
Ext.apply(this.parametriStampa,{url:this.cbaConfig.url,jsonData:this.cbaConfig.jsonData,titolo:this.cbaConfig.titolo,winElaborazione:this.cbaConfig.winElaborazione,params:{reportId:this.cbaConfig.idRecord}});b=this.parametriStampa;Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampa();this.callParent([a,b])},onLaunch:function(){!StdSipcar.isValidID(this.cbaConfig.idRecord)&&
StdSipcar.isValidID(this.cbaConfig.id)&&(this.cbaConfig.idRecord=this.cbaConfig.id);this.gestioneForm();this.aggiornaStore()},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.aliquotaiva.store.AliquotaIva",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codIvaInc"},{name:"codEnte"},{name:"desAliquota"},{name:"percentuale"},{name:"aliquota"},{name:"esclusoVolumeAffari"},{name:"tipoEsenzione"},{name:"soggettoBollo"},{name:"articolo36bis"},{name:"attivo"},{name:"includeInVentilazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/aliqiva/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/aliqiva/list",
create:"/cba/gen/ws/general/aliqiva/insert",update:"/cba/gen/ws/general/aliqiva/update",destroy:"/cba/gen/ws/general/aliqiva/delete"}},autoDestroy:!0});Ext.define("Generali.aliquotaiva.store.cboxAliquotaIva",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/aliqiva/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.aliquotaiva.store.cboxAliquotaIvaAbbr",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/aliqiva/cboxAbbr",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.aliquotaiva.view.AliIva",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"gridpanel",itemId:"GridAliquotaIva",reference:"GridAliquotaIva",width:170,store:Ext.create("Generali.aliquotaiva.store.AliquotaIva"),columns:[{xtype:"gridcolumn",dataIndex:"desAliquota",text:"DESCRIZIONE",
flex:1}],viewConfig:{loadMask:!1,getRowClass:function(a,b){if("T"!=a.get("attivo"))return"non_attivi"}}},{xtype:"form",flex:1,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",itemId:"TxAliquota",reference:"TxAliquota",width:200,fieldLabel:"ALIQUOTA_IVA",name:"aliquota",allowBlank:!1,maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:300,fieldLabel:"DESCRIZIONE",name:"desAliquota",allowBlank:!1,
maxLength:16,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"numberfield",fieldLabel:"ID",name:"id",hidden:!0},{xtype:"numberfield",fieldLabel:"ID",name:"codIvaInc",hidden:!0},{xtype:"checkboxfield",boxLabel:"ATTIVO",name:"attivo",itemId:"ChbAttivo",reference:"ChbAttivo",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel",width:105},{xtype:"fieldset",title:"TIPO",itemId:"FsTipoEsenzione",reference:"FsTipoEsenzione",layout:"hbox",items:[{xtype:"radiogroup",itemId:"RgbTipoEsenzione",reference:"RgbTipoEsenzione",
layout:{align:"stretchmax",type:"vbox"},items:[{xtype:"radiofield",boxLabel:"NON_IMPONIBILE",name:"tipoEsenzione",inputValue:"1",cls:"cbaLabel"},{xtype:"radiofield",boxLabel:"ESENTE",name:"tipoEsenzione",inputValue:"2",cls:"cbaLabel"},{xtype:"radiofield",boxLabel:"ESCLUSO",name:"tipoEsenzione",inputValue:"3",cls:"cbaLabel"}]}]},{xtype:"container",layout:{type:"hbox",align:"stretch"},defaults:{style:{flex:1,padding:"5px"}},items:[{xtype:"container",bodyStyle:"margin: 10px; padding: 5px 3px;",layout:{align:"stretch",
type:"vbox"},items:[{xtype:"fieldset",title:"PARAMETRI_PER_CONTABILITA_UTENTI",items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"SOGGETTO_A_BOLLO",inputValue:"T",uncheckedValue:"F",name:"soggettoBollo",cls:"cbaLabel"}]},{xtype:"fieldset",title:"CALCOLO_IVA_PRO.RATA",hidden:!0,items:[{xtype:"checkboxfield",width:235,fieldLabel:"",boxLabel:"ESCLUDERE_DA_VOLUME_AFFARI",inputValue:"T",uncheckedValue:"F",name:"esclusoVolumeAffari",cls:"cbaLabel"}]},{xtype:"fieldset",title:"CALCOLO_IVA_PRO.RATA",items:[{xtype:"checkboxfield",
width:235,fieldLabel:"",boxLabel:"ESCLUDERE_DA_TOT_IMPONIBILE",inputValue:"T",uncheckedValue:"F",itemId:"ChkEsclusoTotImponibile",reference:"ChkEsclusoTotImponibile",name:"esclusoTotImponibile",cls:"cbaLabel"}]}]},{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"fieldset",title:"VENTILAZIONE_IVA",items:[{itemId:"ChkIncludeInVentilazione",reference:"ChkIncludeInVentilazione",xtype:"checkboxfield",width:235,fieldLabel:"",boxLabel:"CONSIDERA_IN_VENTILAZIONE",inputValue:"T",uncheckedValue:"F",
name:"includeInVentilazione",cls:"cbaLabel"}]},{xtype:"fieldset",title:"COMUNICAZIONE_PERIODICA",items:[{itemId:"ChkArticolo36bis",reference:"ChkArticolo36bis",xtype:"checkboxfield",width:235,fieldLabel:"",boxLabel:"ART36BIS",inputValue:"T",uncheckedValue:"F",name:"articolo36bis",cls:"cbaLabel"}]}]}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.controller.Allegato",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridAllegati",selector:this.selContainer+"#GridAllegati"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"Data",selector:this.selContainer+"#Data"},{ref:"TxtDescrizione",selector:this.selContainer+"#TxtDescrizione"},{ref:"TxtFileName",
selector:this.selContainer+"#TxtFileName"},{ref:"CntAllegato",selector:this.selContainer+"#CntAllegato"},{ref:"CntAnteprima",selector:this.selContainer+"#CntAnteprima"},{ref:"FormAllegato",selector:this.selContainer+"#FormAllegato"},{ref:"AllegatoUpload",selector:this.selContainer+"#AllegatoUpload"},{ref:"BtnEliminaAllegato",selector:this.selContainer+"#BtnEliminaAllegato"},{ref:"BtnAllega",selector:this.selContainer+"#BtnAllega"}]);this.control(this.selContainer+"#BtnEliminaAllegato",{click:this.eliminaAllegato});
this.control(this.selContainer+"#AllegatoUpload",{change:this.onFilefieldChangeAllegatoUpload});this.control(this.selContainer+"#GridAllegati",{select:this.selectGridAllegati})},selectGridAllegati:function(a,b,c,d){a=this.getForm();clearForm(this.getForm());b&&(a.loadRecord(b),this.getAllegatoUpload().setVisible(b.get("id")),this.getBtnEliminaAllegato().setVisible(!Ext.isEmpty(b.get("fileName"))),this.creaAnteprima(b.get("id"),this.getCntAnteprima()))},verificaCampiForm:function(){var a=[];this.getForm().isValid()||
msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.idCliFor});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridAllegati().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){a.getCntAnteprima().removeAll();a.getAllegatoUpload().setVisible(!1);a.getBtnEliminaAllegato().setVisible(!1);controller_nuovoRecord(b);a.getData().setValue(dataAttuale())},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});
inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){var d=c.findField("id").getValue();(!d||0>=d)&&e&&validaForm(a.getForm());controller_abilitaBottoni(b)})},aggiornaStore:function(a){var b=this.getGridAllegati(),c=b.getStore();this.getCntAnteprima().removeAll();this.getAllegatoUpload().setVisible(!1);this.getBtnEliminaAllegato().setVisible(!1);clearForm(this.getForm());svuotaStore(c);(this.idCliFor||a)&&c.load({params:{idCliFor:this.idCliFor},
callback:function(d,e,g){if(g){var h;Ext.isEmpty(d)||a&&(h=trovaRecord(c,"id",a));b.getSelectionModel().select(h?[h]:0)}else msgShowError("",e.getError())}})},formattaUrlBlob:function(a,b,c){var d=this.getCntAnteprima(),e="pdf"==b?"application":"image";Ext.Ajax.request({method:"GET",binary:!0,url:a,success:function(g){var h=g.responseBytes;Ext.isEmpty(h)?(d.removeAll(),msgShowError("",h.message)):(g=new Blob([g.responseBytes],{type:e+"/"+b}),g=(window.URL||window.webkitURL).createObjectURL(g),h={},
Ext.apply(h,{itemId:"iframePdf",reference:"iframePdf",html:'<a href="'+a+'" download="'+c+'" onclick="clickHref(this);">'+traduci("DOWNLOAD")+" "+c+'</a>\n\t\t\t\t\t\t\t<iframe id="pdf" width="100%" height="100%" src="'+g+'"></iframe>'}),d.removeAll(),d.add(h))}})},creaAnteprima:function(a,b){if(!a)return!1;var c=this.getTxtFileName().getValue(),d="/cba/gen/ws/general/anaCliFor/allegati/file/download?id="+a,e=getPathServer()+d,g={};if(Ext.isEmpty(c))b.removeAll();else{var h=c.split(".").pop(),k="icon-"+
h;if("pdf"==h||-1!=Ext.Array.indexOf(getEstensioniImg(),h))if("pdf"==h){if(!(Ext.browser.is.IE||-1<Ext.browser.userAgent.indexOf("Edge"))&&1024<Ext.getBody().getViewSize().width)return this.formattaUrlBlob(d,h,c),!1;g=creaItemDownload(k,e,c,c)}else Ext.apply(g,{xtype:"container",scrollable:!0,flex:1,items:[{html:'<a href="'+e+'" download="'+c+'"  onclick="clickHref(this);">'+traduci("DOWNLOAD")+" "+c+"</a>"},{xtype:"image",listeners:{beforerender:function(a){setSrcImage(a,e)}}}]});else g=creaItemDownload(k,
e,c,c);b.removeAll();b.add(g)}},eliminaAllegato:function(a){var b=this,c=b.getForm().getForm().findField("id").getValue();Messaggio("ATTENZIONE","MSG_ELIMINA_ALLEGATO","YESNO","QUESTION",!1,function(){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/anaCliFor/allegati/file/delete?id="+c,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.aggiornaStore(c):msgShowError("",a.message)}})})},allegatoUpload:function(a,b){var c=this,d=c.getForm().getForm().findField("id").getValue();
c.getFormAllegato();var e=b.lastIndexOf("\\")||b.lastIndexOf("/");b=b.substring(e+1);if(""!==b){var e=a.fileInputEl.dom.files[0],g=new FormData;g.append("file",e);Ext.Ajax.request({url:"/cba/gen/ws/general/anaCliFor/allegati/file/upload?id="+d,method:"POST",rawData:g,headers:{"Content-Type":null},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgShow("TRASFERIMENTO_FILE",a.message),c.aggiornaStore(d)):msgShowError("",a.message)}})}},onFilefieldChangeAllegatoUpload:function(a,b,c){this.allegatoUpload(a,
b)},onLaunch:function(){this.getGridAllegati().controller=this;this.gestioneForm();this.aggiornaStore()},destroy:function(){delete this.storeForm;this.callParent()}});
Ext.define("Generali.anaCliFor.controller.AnaCliFor",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCliFo",selector:this.selContainer+"#GridCliFo"},{ref:"TabGenerale",selector:this.selContainer+"#TabGenerale"},{ref:"PnlAnagrafica",selector:this.selContainer+"#PnlAnagrafica"},{ref:"TxtCercaCliFor",selector:this.selContainer+"#TxtCercaCliFor"},{ref:"RgbFiltro",selector:this.selContainer+"#RgbFiltro"},
{ref:"CbxFiltroAttivo_F",selector:this.selContainer+"#CbxFiltroAttivo_F"},{ref:"CbxFiltroAttivo_T",selector:this.selContainer+"#CbxFiltroAttivo_T"},{ref:"BtnCerca",selector:this.selContainer+"#BtnCerca"},{ref:"BtnImport",selector:this.selContainer+"#BtnImport"},{ref:"PTGridCliFo",selector:this.selContainer+"#PTGridCliFo"},{ref:"PnlRicerca",selector:this.selContainer+"#PnlRicerca"},{ref:"ChbSaltuarioRic",selector:this.selContainer+"#ChbSaltuarioRic"},{ref:"RgbCliFor",selector:this.selContainer+"#RgbCliFor"},
{ref:"CbComune",selector:this.selContainer+"#CbComune"}]);this.control(this.selContainer+"#TxtCercaCliFor",{keypress:this.keypressTxtCercaCliFor,change:Ext.Function.createBuffered(this.EffettuaRicerca,500,this,[])});this.control(this.selContainer+"#GridCliFo",{select:this.selectGridCliFo});this.control(this.selContainer+"#RgbFiltro",{change:this.changeRgbFiltro});this.control(this.selContainer+"#BtnCerca",{click:this.clickBtnCerca});this.control(this.selContainer+"#BtnImport",{click:this.clickBtnImport})},
sbiancaCampiRicerca:function(){this.getCbxFiltroAttivo_T().setValue(!0);this.getCbxFiltroAttivo_F().setValue(!0);this.getTxtCercaCliFor().setValue("")},EffettuaRicerca:function(a){var b=this,c=b.getRgbFiltro().getValue().RgbFiltro,d="",e="",g=b.getGridCliFo(),h=g.getStore();if(!b.getCbxFiltroAttivo_T().checked&&!b.getCbxFiltroAttivo_F().checked)return Messaggio("CLIENTI_FORNITORI","SCELTA_PARAMETRI_ERRATA","OK","INFORMATION",!1),!1;b.getCbxFiltroAttivo_T().checked&&b.getCbxFiltroAttivo_F().checked&&
(d="");b.getCbxFiltroAttivo_T().checked&&!b.getCbxFiltroAttivo_F().checked&&(d="T");!b.getCbxFiltroAttivo_T().checked&&b.getCbxFiltroAttivo_F().checked&&(d="F");var k={};Ext.apply(k,{idOrganizzazione:b.cbaConfig.idOrganizzazione,attivo:d,cheContiene:"T",descrizione:"",codFiscale:"",partitaIva:""});delete h.getProxy().extraParams.comune;delete h.getProxy().extraParams.tipo;d=b.getRgbCliFor().getValue().tipoCliFor;"E"!=d&&Ext.apply(k,{tipo:d});b.getChbSaltuarioRic().checked&&(e="T");"RS"==c&&Ext.apply(k,
{descrizione:b.getTxtCercaCliFor().getValue()});"CF"==c&&Ext.apply(k,{codFiscale:b.getTxtCercaCliFor().getValue()});"PI"==c&&Ext.apply(k,{partitaIva:b.getTxtCercaCliFor().getValue()});"T"==e?Ext.apply(k,{saltuario:e}):h.getProxy().extraParams.saltuario&&delete h.getProxy().extraParams.saltuario;Ext.apply(k,{comune:b.getCbComune().getValue()});Ext.apply(h.getProxy().extraParams,k);h.loadPage(1,{callback:function(c,d,e){e?Ext.isEmpty(c)?(controller=b.getPnlAnagrafica().down("form")?b.getPnlAnagrafica().down("form").controller:
!1)&&controller.svuotaTestata():b.primoInserimento?(delete b.primoInserimento,(c=b.getRecRicerca(a))&&h.insert(0,c),g.getSelectionModel().select(0)):(c=trovaRecord(g.getStore(),"id",a),g.getSelectionModel().select(c?[c]:0)):msgShowError("",d.getError())}});b.getPTGridCliFo().bindStore(h)},getRecRicerca:function(a){var b;if(!a)return!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/anaCliFor/get",async:!1,params:{id:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b=a.data:
msgShowError("",a.message)}});return b},clickBtnCerca:function(a,b,c){a=0;Ext.isEmpty(this.getGridCliFo().getSelectionModel().getSelection())||(a=this.getGridCliFo().getSelectionModel().getSelection()[0].data.id);this.EffettuaRicerca(a)},clickBtnImport:function(a,b,c){Ext.create("winCBA",{name:"Generali.clientiFornitori.view.SbloccaImport",titolo:"IMPORT_ANACLIFOR_CSV",dimensione:3,altezzaWin:600,larghezzaWin:1010,configItem:{caricamentoEsterno:!0,cbaConfig:this.cbaConfig},closable:!0}).show()},changeRgbFiltro:function(a,
b,c,d){},selectGridCliFo:function(a,b,c,d){this.caricaDati();return!getFormDirty(this.getPnlAnagrafica())},keypressTxtCercaCliFor:function(a,b,c){13==b.getCharCode()&&(a=this.getBtnCerca(),a.fireEvent("click",a))},caricaDati:function(){var a=this.getGridCliFo().getSelectionModel().getSelection()[0],b=this.getPnlAnagrafica().down("form").controller;a?(b.idTestata=a.get("id"),b.aggiornaStore(),a=this.getPnlAnagrafica().down("#Paginatore"),a.show(),a.setActiveTab(a.down("#PnlIndirizzi"))):b.svuotaTestata()},
isGestrioneDurcAbilitata:function(a,b){var c={};StdSipcar.isValidID(a)&&Ext.apply(c,{idOrganizzazione:a});StdSipcar.isValidID(b)&&Ext.apply(c,{idEsercizio:b});return new Promise(function(a,b){Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/anaCliFor/durc/isGestioneDurcAbilitata",params:c,success:function(c){c=Ext.JSON.decode(c.responseText);c.success?a(c.data):b(c.message)}})})},onLaunch:function(){var a=this,b=a.getGridCliFo();StdSipcar.isValidID(a.cbaConfig.idOrganizzazione)||(a.cbaConfig.idOrganizzazione=
getIdOrg());a.getBtnImport().setVisible(44==CBA.moduli.moduloAttivo);a.isGestrioneDurcAbilitata().then(function(c){c=void 0===c?!1:c;a.getPnlAnagrafica().add(Ext.create("Generali.anaCliFor.view.Anagrafica",{cbaConfig:{permesso:a.cbaConfig.permesso,gridSelezione:b,idOrganizzazione:a.cbaConfig.idOrganizzazione,controllerGrigliaRicerca:a,gestioneDurc:c}}));a.getChbSaltuarioRic().setVisible(56==CBA.moduli.moduloAttivo);a.EffettuaRicerca()})["catch"](function(a){return msgShowError("",a)})},destroy:function(){this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Anagrafica",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"PF_ComuneNascita",selector:this.selContainer+"#PF_ComuneNascita"},{ref:"PF_NazioneNascita",selector:this.selContainer+"#PF_NazioneNascita"},{ref:"PF_Sesso",selector:this.selContainer+"#PF_Sesso"},
{ref:"Paginatore",selector:this.selContainer+"#Paginatore"},{ref:"PnlCategorie",selector:this.selContainer+"#PnlCategorie"},{ref:"PnlIndirizzi",selector:this.selContainer+"#PnlIndirizzi"},{ref:"PnlContatti",selector:this.selContainer+"#PnlContatti"},{ref:"PnlContab",selector:this.selContainer+"#PnlContab"},{ref:"PnlCondPag",selector:this.selContainer+"#PnlCondPag"},{ref:"PnlCupCig",selector:this.selContainer+"#PnlCupCig"},{ref:"PnlLavAutonomo",selector:this.selContainer+"#PnlLavAutonomo"},{ref:"PnlSpesometro",
selector:this.selContainer+"#PnlSpesometro"},{ref:"PnlPcc",selector:this.selContainer+"#PnlPcc"},{ref:"PnlDelegati",selector:this.selContainer+"#PnlDelegati"},{ref:"TxtRagioneSociale",selector:this.selContainer+"#TxtRagioneSociale"},{ref:"TxtCodFiscale",selector:this.selContainer+"#TxtCodFiscale"},{ref:"CbxIdCategoria",selector:this.selContainer+"#CbxIdCategoria"},{ref:"RgbTipoClifor",selector:this.selContainer+"#RgbTipoClifor"},{ref:"ChbPersona_Fisica",selector:this.selContainer+"#ChbPersona_Fisica"},
{ref:"ChbRitenuta",selector:this.selContainer+"#ChbRitenuta"},{ref:"PF_Cognome",selector:this.selContainer+"#PF_Cognome"},{ref:"PF_Nome",selector:this.selContainer+"#PF_Nome"},{ref:"CodIstatNascita",selector:this.selContainer+"#CodIstatNascita"},{ref:"TxtPartitaIva",selector:this.selContainer+"#TxtPartitaIva"},{ref:"PnlFattEle",selector:this.selContainer+"#PnlFattEle"},{ref:"CbxCodFiscNazione",selector:this.selContainer+"#CbxCodFiscNazione"},{ref:"LblSiglaNazione",selector:this.selContainer+"#LblSiglaNazione"},
{ref:"PF_DtNascita",selector:this.selContainer+"#PF_DtNascita"},{ref:"ChbTs730",selector:this.selContainer+"#ChbTs730"},{ref:"FsTipoSpese",selector:this.selContainer+"#FsTipoSpese"},{ref:"CntPersFis1",selector:this.selContainer+"#CntPersFis1"},{ref:"CntPersFis2",selector:this.selContainer+"#CntPersFis2"},{ref:"ChbSaltuario",selector:this.selContainer+"#ChbSaltuario"},{ref:"RgbSoggetto",selector:this.selContainer+"#RgbSoggetto"},{ref:"ChbIndTemp",selector:this.selContainer+"#ChbIndTemp"},{ref:"RgbTipoSpese",
selector:this.selContainer+"#RgbTipoSpese"},{ref:"RgbTipoSpese_4",selector:this.selContainer+"#RgbTipoSpese_4"},{ref:"CodIdEstero",selector:this.selContainer+"#CodIdEstero"},{ref:"PnlDurc",selector:this.selContainer+"#PnlDurc"},{ref:"ChbRegMinimi",selector:this.selContainer+"#ChbRegMinimi"},{ref:"TxtCodEntePagoPa",selector:this.selContainer+"#TxtCodEntePagoPa"}]);this.control(this.selContainer+"#ChbRitenuta",{change:this.changeChbRitenuta});this.control(this.selContainer+"#PF_ComuneNascita",{beforequery:this.beforequeryPF_ComuneNascita});
this.control(this.selContainer+"#RgbTipoClifor",{change:this.changeRgbTipoClifor});this.control(this.selContainer+"#RgbSoggetto",{change:this.changeRgbSoggetto});this.control(this.selContainer+"#CbxCodFiscNazione",{change:this.changeCbxCodFiscNazione});this.control(this.selContainer+"#ChbPersona_Fisica",{change:this.changeChbPersona_Fisica});this.control(this.selContainer+"#Paginatore",{tabchange:this.tabchangePaginatore,beforetabchange:this.beforetabchangepaginatore});this.control(this.selContainer+
"#Form",{dirtychange:this.dirtychangeForm});this.control(this.selContainer+"#TxtCodFiscale",{blur:this.changeChbPersona_Fisica,keydown:this.keydownTxtCodFiscale,change:this.changeTxtCodFiscale});this.control(this.selContainer+"#CodIdEstero",{keydown:this.keydownCodIdEstero})},visualizzaCodIdEstero:function(a,b,c){var d=this.getCodIdEstero();d.setVisible(a&&b&&c);d.isVisible()||setValue(d,null)},changeChbRitenuta:function(a,b,c,d){c=this.getCbxCodFiscNazione().getValue();a=this.getTxtCodFiscale().getValue();
c=c&&"0"!==c;a=Ext.isEmpty("string"===typeof a?a.trim():a);this.visualizzaCodIdEstero(a,c,b);b||setValue(this.getChbRegMinimi(),b);this.cbaConfig&&"L"!=this.cbaConfig.permesso&&this.getChbRegMinimi().setReadOnly(!b)},stopEventTxt:function(a,b){(noCodIdEstero=Ext.isEmpty("string"===typeof b?b.trim():b))||a.preventDefault()},keydownCodIdEstero:function(a,b,c){this.stopEventTxt(b,this.getTxtCodFiscale().getValue())},keydownTxtCodFiscale:function(a,b,c){this.stopEventTxt(b,this.getCodIdEstero().getValue())},
changeTxtCodFiscale:function(a,b,c,d){a=(a=this.getCbxCodFiscNazione().getValue())&&"0"!==a;c=this.getChbRitenuta().getValue();isEmpty=Ext.isEmpty("string"===typeof b?b.trim():b);this.visualizzaCodIdEstero(isEmpty,a,c)},noInfoFattElettronica:function(a,b){var c=!1,d={};Ext.isDefined(a)&&Ext.apply(d,{idCliFor:a});Ext.Array.contains(["PA","B2B"],b)&&Ext.apply(d,{tipoFattEle:b});Ext.Object.isEmpty(d)||Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/list",async:!1,
params:d,success:function(a){a=Ext.decode(a.responseText);var b=a.data;a.success&&(c=Ext.isEmpty(b))}});return c},setReadOnlySoggetto:function(a,b){var c,d=this.getForm().getForm().findField("id").getValue();if(b){switch(b){case "P":c="PA";break;case "R":c="B2B"}d&&0<d&&a.setReadOnly(!this.noInfoFattElettronica(d,c))}},changeCbxCodFiscNazione:function(a,b,c,d){var e=this;a=e.getCbxCodFiscNazione().getValue();var g=e.getForm();e.getTxtPartitaIva().regex=RegExp("");a?Ext.Ajax.request({method:"GET",
url:"/cba/gen/ws/general/nazioni/regole/list",params:{tipoRegola:1,codFiscNazione:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success&&a.data[0]&&(g.getForm().setValues({siglaNazionePartitaIva:a.data[0].siglaNazione}),e.getTxtPartitaIva().regex=new RegExp(a.data[0].patternRegola))}}):e.getTxtPartitaIva().regex=/^[0-9]{11}$/;e.getTxtPartitaIva().validate()},dirtychangeForm:function(a,b,c){this.cbaConfig.controllerGrigliaRicerca.getPnlRicerca().setDisabled(b)},GestioneCategorie:function(){var a=
this;Ext.create("winCBA",{name:"Generali.catCliFor.view.CatCliFor",titolo:traduci("TAB_CATEGORIE_CLIENTI_FORNITORI"),dimensione:1,configItem:{idOrganizzazione:a.cbaConfig.idOrganizzazione,permesso:a.cbaConfig.permesso,mostraEsci:!0,callbackRiapriStore:function(){a.getCbxIdCategoria().bindStore(a.StoreCategCliFor);a.StoreCategCliFor.load({params:{idOrganizzazione:a.cbaConfig.idOrganizzazione}})}},closable:!0}).show()},beforetabchangepaginatore:function(a,b,c,d){if(getFormDirty(c))return!1},tabchangePaginatore:function(a,
b,c,d){var e=this;d=this.getForm();a=d.getForm().findField("id").getValue();c=e.getRgbSoggetto().getValue().tipoSoggetto;d=d.getForm().findField("idOrganizzazione").getValue();if(0==b.items.getCount()||"PnlFattEle"==b.getItemId())b.removeAll(),b.add(Ext.create(b.cbaConfig.url,{cbaConfig:b.cbaConfig,tipoSoggetto:c,idOrganizzazione:d,idEsercizioDefault:e.idEsercizioDefault,controllerAnag:e}));if(b=b.down("gridpanel"))b.controller.idCliFor=a,b.controller.idOrganizzazione=d,b.controller.tipoCliFor=e.getRgbTipoClifor().getValue().tipoCliFor,
b.controller.aggiornaStore(),a=b.getStore(),0<a.getCount()&&!b.getSelectionModel().getSelection()[0]&&b.getSelectionModel().select(0),a.on("endupdate",function(){Ext.isDefined(this.setCampiObbligatori)&&this.setCampiObbligatori(e.getChbRitenuta().getValue())},b.controller,{single:!0})},clcNomeCognomeDaCF:function(a,b){b=void 0===b?!0:b;var c="";if(!Ext.isEmpty(a)){a=a.toUpperCase();for(var d=0;d<a.length;d++)switch(a.charAt(d)){case "A":case "E":case "I":case "O":case "U":break;default:"Z">=a.charAt(d)&&
"A"<a.charAt(d)&&(c+=a.charAt(d))}if(b&&3<c.length)c=c.substring(0,1)+c.substring(2,4);else{if(3>c.length){for(d=0;d<a.length;d++)switch(a.charAt(d)){case "A":case "E":case "I":case "O":case "U":c+=a.charAt(d)}if(3>c.length)for(d=c.length;3>=d;d++)c+="X"}c=c.substring(0,3)}}return c},getValoriCodiceFiscale:function(a){var b=a.toUpperCase(),c=b.substring(6,8),d=b.substring(9,11),b=b.substr(11,4),e=b.substring(1),g=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charAt(c);switch(d){case "L":d=
"0";break;case "M":d="1";break;case "N":d="2";break;case "P":d="3";break;case "Q":d="4";break;case "R":d="5";break;case "S":d="6";break;case "T":d="7";break;case "U":d="8";break;case "V":d="9"}b+=d}return b},c=g(c),d=g(d),b=b.substring(0,1)+g(e);a=a.substring(0,6)+c+a.substring(8,9)+d+b+a.substring(a.length-1);return getValoriCodiceFiscale(a)},confrontoCF:function(a,b){var c=this.getTxtCodFiscale().getValue();Ext.isObject(a);valid=!0;if(!Ext.isEmpty(a,!1)&&ControllaCF(c)&&16==c.length)switch("cognome"===
b||"nome"===b||this.valoriCF||(this.valoriCF=this.getValoriCodiceFiscale(c)),b){case "cognome":var c=c.slice(0,3),d=this.clcNomeCognomeDaCF(a,!1);valid=c.toUpperCase()==d.toUpperCase();break;case "nome":c=c.slice(3,6);d=this.clcNomeCognomeDaCF(a);valid=c.toUpperCase()==d.toUpperCase();break;case "sesso":valid=a.personaFisicaSesso==this.valoriCF.sesso;break;case "dataNascita":valid=this.verificaDataNascitaCF(a,this.valoriCF.dataNascita);break;case "comune":c=null;(d=this.getPF_ComuneNascita().getSelection())&&
(c=d.get("extra").split(",")[0]);valid=c==this.valoriCF.comuneNascita;break;case "nazione":valid=this.getPF_NazioneNascita().getValue()==this.valoriCF.nazioneNascita}return valid?valid:traduci("VERIFICARE_CF")},verificaDataNascitaCF:function(a,b){Ext.isDate(a)||(a=Ext.Date.parse(a,"d/m/Y"));if(!Ext.isDate(a)||!Ext.isDate(b))return!1;var c;(c=a.getDate()===b.getDate())&&(c=a.getMonth()===b.getMonth());if(c){c=a.getFullYear();var d=b.getFullYear();c=c.toString();d=d.toString();c=c.slice(c.length-2,
c.length);d=d.slice(d.length-2,d.length);c=c===d}return c},changeChbPersona_Fisica:function(a,b,c,d){var e=this;b=e.getChbPersona_Fisica().getValue();if(!e.changePersonaFisica)return!1;e.getCntPersFis1().setVisible(b);e.getCntPersFis2().setVisible(b);e.getPF_Cognome().allowBlank=!b;e.getPF_Cognome().validate();e.getPF_Nome().allowBlank=!b;e.getPF_Nome().validate();a=e.getForm();if(b){b=e.getTxtCodFiscale().getValue();if(!ControllaCF(b))return Messaggio("ATTENZIONE","MSG_CF_NON_VALIDO","OK","WARNING",
!1),!1;if(""==e.getPF_Cognome().getValue()&&""==e.getPF_Nome().getValue()&&(c=e.getTxtRagioneSociale().getValue().split(" "),d="",1<=c.length&&setValue(e.getPF_Cognome(),c[0]),2<=c.length)){d=c[1];for(var g=2;g<c.length;g++)d=d+c[g]+" ";setValue(e.getPF_Nome(),d)}16==b.length&&(e.valoriCF=e.getValoriCodiceFiscale(b),e.valoriCF.dataNascita=e.dataCf(b),setValue(a.getForm().findField("personaFisicaSesso"),e.valoriCF.sesso),setValue(a.getForm().findField("personaFisicaCodFiscNazioneNascita"),e.valoriCF.nazioneNascita),
Ext.isEmpty(a.getForm().findField("personaFisicaDtNascita").getValue())&&setValue(a.getForm().findField("personaFisicaDtNascita"),e.valoriCF.dataNascita),"Z"!=(e.valoriCF.comuneNascita?e.valoriCF.comuneNascita.substr(0,1):"")&&e.storeComuniTmp.load({params:{codFiscale:e.valoriCF.comuneNascita,dataControllo:e.valoriCF.dataNascita},callback:function(a,b,c){c?Ext.isEmpty(a)||e.getPF_ComuneNascita().select(a[0]):msgShowError("",b.getError())}}),setValue(a.getForm().findField("personaFisicaIstatComuneNascita"),
""))}else setValue(e.getPF_Cognome(),""),setValue(e.getPF_Nome(),""),e.getPF_Sesso().reset(),setValue(e.getPF_DtNascita(),""),setValue(e.getPF_ComuneNascita(),""),setValue(e.getPF_NazioneNascita(),"")},changeRgbSoggetto:function(a,b,c,d){"P"==b.tipoSoggetto&&"C"!=this.getRgbTipoClifor().getValue().tipoCliFor?(this.getTxtCodEntePagoPa().setVisible(!0),this.getTxtCodEntePagoPa().regex=/[0-9]{11}$/):this.getTxtCodEntePagoPa().setVisible(!1)},changeRgbTipoClifor:function(a,b,c,d){this.StoreCategCliFor.clearFilter();
"C"==b.tipoCliFor&&this.StoreCategCliFor.addFilter(this.FiltroCatClienti);"F"==b.tipoCliFor&&this.StoreCategCliFor.addFilter(this.FiltroCatFornitori);"C"!=b.tipoCliFor&&"P"===this.getRgbSoggetto().getValue().tipoSoggetto?(this.getTxtCodEntePagoPa().setVisible(!0),this.getTxtCodEntePagoPa().regex=/[0-9]{11}$/):this.getTxtCodEntePagoPa().setVisible(!1);this.getChbTs730().setVisible("F"!=b.tipoCliFor);this.getChbIndTemp().setVisible("C"!=b.tipoCliFor);this.getFsTipoSpese().setVisible("C"!=b.tipoCliFor);
"C"!=b.tipoCliFor?(this.getPnlLavAutonomo().tab.show(),this.getPnlPcc().tab.show(),this.getChbRitenuta().setVisible(!0),this.getChbRegMinimi().setVisible(!0)):(this.getPnlLavAutonomo().tab.active&&(a=this.getPaginatore(),a.setActiveTab(a.down("#PnlIndirizzi"))),this.getPnlLavAutonomo().tab.hide(),this.getChbRitenuta().setVisible(!1),this.getChbRegMinimi().setVisible(!1),this.getPnlPcc().tab.hide());"F"!=b.tipoCliFor?this.getPnlFattEle().tab.show():(this.getPnlFattEle().tab.hide(),this.getPnlPcc().tab.show());
this.getPnlDurc().tab.setVisible(this.cbaConfig.gestioneDurc&&"C"!=b.tipoCliFor)},beforequeryPF_ComuneNascita:function(a,b){if(!a.query)return!1},verificaCampiForm:function(){var a=[],b=this.getForm(),c=this.getTxtCodFiscale().getValue(),d=!0,e=this.getCbxCodFiscNazione().getValue(),e=e&&"0"!==e;!0!==ControllaCF(c)||16!==c.length||"R"!==this.getRgbSoggetto().getValue().tipoSoggetto||this.getChbPersona_Fisica().getValue()||e||(msgAddError(a,"MSG_OBBLIGO_PERSONA_FISICA"),d=!1);d&&!this.getTxtPartitaIva().isValid()&&
(msgAddError(a,"MSG_PARITAIVA_ERRATA"),d=!1);d&&!b.isValid()&&msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},posizionaRecordTestata:function(a){},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();this.isInInsert=Ext.isEmpty(c.id)||0>c.id;Ext.apply(c,{attivo:getBoolValue(c.attivo),personaFisica:getBoolValue(c.personaFisica),ritenuta:getBoolValue(c.ritenuta),idOrganizzazione:this.cbaConfig.idOrganizzazione,escludiDa730:getBoolValue(c.escludiDa730),escludiDaIndTemp:getBoolValue(c.escludiDaIndTemp),
flagSaltuario:getBoolValue(c.flagSaltuario),regimeMinimi:getBoolValue(c.regimeMinimi)});delete c.siglaNazionePartitaIva;this.cbaConfig.controllerGrigliaRicerca.primoInserimento=this.isInInsert;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"},!1,function(d){Messaggio("ATTENZIONE",d.message[0].testo,"YESNO","QUESTION",!1,function(){controller_salvaRecord(b,c,a,{forzaRegistrazione:"T"},!1)})})},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();
a.storeForm=b.store=a.storeAnagrafica;b.controller=a;a.controllerRicerca=a.cbaConfig.controllerGrigliaRicerca;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.getPaginatore().show();a.salvaForm(b)},annulla_callback:function(){a.getPaginatore().show();a.aggiornaStore()},nuovo_callback:function(){a.getPaginatore().hide();controller_nuovoRecord(b,a.getTxtRagioneSociale());a.getRgbSoggetto().setReadOnly(!1);b.getForm().setValues({idOrganizzazione:a.cbaConfig.idOrganizzazione});
b.getForm().setValues({personaFisicaSesso:""});b.getForm().setValues({attivo:"T"});b.getForm().setValues({codiceSpeseTrasm:"1"});56==CBA.moduli.moduloAttivo&&b.getForm().setValues({flagSaltuario:"T"})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(b){if(0===b[0].tipo){b=a.cbaConfig.controllerGrigliaRicerca.getGridCliFo();var d=trovaRecord(b.getStore(),"id",c),e=b.getStore().indexOf(d)-1;b.getStore().remove(d);
a.svuotaTestata();e=0>e?0:e;b.getSelectionModel().select(e)}})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){a.controllerRicerca.cbaConfig.callbackRiapriStore&&a.controllerRicerca.cbaConfig.callbackRiapriStore();a.getForm().up("window").close()}}});inserisciBottoni(b.boxBottoni,c,!0,"start");a.controllerRicerca.cbaConfig.mostraEsciGenerale||b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);
a.getPaginatore().setDisabled(e)})},svuotaTestata:function(){var a=this.getForm(),b=this.getPaginatore();this.idTestata=0;clearForm(a);b.hide()},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store,g=b.getPaginatore(),h=b.cbaConfig.controllerGrigliaRicerca.getGridCliFo();b.idTestata||(b.idTestata=a);b.changePersonaFisica=!1;delete b.valoriCF;b.idTestata&&0<b.idTestata?(clearForm(c),e.load({params:{id:b.idTestata},callback:function(c,e,m){m?Ext.isEmpty(c)?b.svuotaTestata():(d.loadRecord(c[0]),
b.setReadOnlySoggetto(b.getRgbSoggetto(),c[0].get("tipoSoggetto")),a&&(b.isInInsert?(b.cbaConfig.controllerGrigliaRicerca.getGridCliFo().getSelectionModel().deselectAll(),b.cbaConfig.controllerGrigliaRicerca.EffettuaRicerca(a)):(e=trovaRecord(h.getStore(),"id",a))&&e.set(c[0].getData())),b.changePersonaFisica=!0,b.changeChbPersona_Fisica(),setCombo(b.getPF_ComuneNascita(),c[0].get("personaFisicaIstatComuneNascita"),c[0].get("personaFisicaDescrizioneComuneNascita")),g.queryById("PnlLavAutonomo").tab.setVisible("T"===
c[0].get("ritenuta")),g.fireEvent("tabchange",g,g.getActiveTab())):msgShowError("",e.getError())}})):b.svuotaTestata()},dataCf:function(a){result=null;if(null!=a){a=a.toUpperCase();var b=$jscomp.makeIterator([a.substring(6,8),a.substring(9,11)]),c=b.next().value,b=b.next().value;40<b&&(b=(""+(b-40)).padStart(2,"0"));a=(20>c?"20":"19")+c+"-"+{A:"01",B:"02",C:"03",D:"04",E:"05",H:"06",L:"07",M:"08",P:"09",R:"10",S:"11",T:"12"}[a.charAt(8)]+"-"+b;result=creaData(a.substring(8,10),a.substring(5,7),a.substring(0,
4))}return result},onLaunch:function(){var a=this;a.changePersonaFisica=!0;a.getCbxIdCategoria().cbaConfig.modificaClick=function(){a.GestioneCategorie()};CBA.moduli.modulo56.abilitato&&a.getChbSaltuario().setVisible(56==CBA.moduli.moduloAttivo||44==CBA.moduli.moduloAttivo);a.storeAnagrafica=Ext.create("Generali.anaCliFor.store.Anagrafica");a.StoreCategCliFor=Ext.create("Generali.catCliFor.store.cboxCatCliFor");a.getCbxIdCategoria().bindStore(a.StoreCategCliFor);a.StoreCategCliFor.load({params:{idOrganizzazione:a.cbaConfig.idOrganizzazione}});
a.FiltroCatClienti=new Ext.util.Filter({filterFn:function(a){return"F"!=a.get("extra")}});a.FiltroCatFornitori=new Ext.util.Filter({filterFn:function(a){return"C"!=a.get("extra")}});a.storeElencoComuniNascita=Ext.create("Generali.comuni.store.cboxComuniGen");a.getPF_ComuneNascita().getStore().getProxy().extraParams={excom:!0};var b=a.getPF_NazioneNascita().getStore();b.getProxy().extraParams={exnaz:!0};b.load();a.storeComuniTmp=Ext.create("Generali.comuni.store.cboxComuniGenCodFisc");getIdEsercizioDefaultByIdOrg(a.cbaConfig.idOrganizzazione,
function(b){a.idEsercizioDefault=b});a.gestioneForm();a.getCbxCodFiscNazione().getStore().load()},destroy:function(){eliminaStore(this.storeForm);eliminaStore(this.StoreCategCliFor);eliminaStore(this.storeAnagrafica);eliminaStore(this.storeElencoComuniNascita);eliminaStore(this.storeComuniTmp);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Categorie",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCategorie",selector:this.selContainer+"#GridCategorie"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CbxIdCategoria",selector:this.selContainer+"#CbxIdCategoria"}]);this.control(this.selContainer+"#CbxIdCategoria",{change:this.changeCbxIdCategoria});
this.control(this.selContainer+"#GridCategorie",{select:this.selectGridCategorie})},changeCbxIdCategoria:function(a,b){},selectGridCategorie:function(a,b){var c=this.getForm();clearForm(this.getForm());c.loadRecord(b);this.controllerAnag.getRgbTipoClifor().resetOriginalValue()},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.getGridCategorie().controller.idCliFor});
for(var d in c)Ext.isEmpty(c[d],!1)&&delete c[d];controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridCategorie().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){var c=b.getForm().findField("id").getValue();
a.aggiornaStore(c)},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({tipoCliFor:a.tipoCliFor})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);
a.getGridCategorie().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridCategorie(),c=b.getStore(),d=this.getForm();d.getForm();this.getCbxIdCategoria().bindStore(this.StoreCategCliFor);this.StoreCategCliFor.load({params:{idOrganizzazione:this.idOrganizzazione,tipoCliFor:this.tipoCliFor}});c.load({params:{idCliFor:this.idCliFor},callback:function(e,g,h){h?Ext.isEmpty(e)?clearForm(d):(e=null,a&&(e=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(e?
[e]:0)):msgShowError("",g.getError())}})},svuotaStore:function(){svuotaStore(this.getGridCategorie().getStore())},GestioneCategorie:function(){var a=this;Ext.create("winCBA",{name:"Generali.catCliFor.view.CatCliFor",titolo:traduci("TAB_CATEGORIE_CLIENTI_FORNITORI"),dimensione:1,configItem:{idOrganizzazione:a.idOrganizzazione,permesso:a.cbaConfig.permesso,mostraEsci:!0,callbackRiapriStore:function(){a.getCbxIdCategoria().bindStore(a.StoreCategCliFor);a.StoreCategCliFor.load({params:{idOrganizzazione:a.idOrganizzazione,
tipoCliFor:a.tipoCliFor}})}},closable:!0}).show()},onLaunch:function(){var a=this;a.StoreCategCliFor=Ext.create("Generali.catCliFor.store.cboxCatCliFor");a.getGridCategorie().controller=a;a.gestioneForm();a.getCbxIdCategoria().cbaConfig.modificaClick=function(){a.GestioneCategorie()}},destroy:function(){eliminaStore(this.storeCategorie);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.CertificazionePcc",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"},{ref:"GridPcc",selector:this.selContainer+"#GridPcc"}]);this.control(this.selContainer+"#GridPcc",{select:this.selectGridPcc})},
selectGridPcc:function(a,b){var c=this.getForm(),d=c.getForm();b&&(clearForm(c),d.loadRecord(b))},verificaCampiForm:function(){var a=[],b=this.getForm(),c=!1;b.store.data.each(function(a){a.get("id")!=b.getForm().findField("id").getValue()&&a.get("idEsercizio")==b.getForm().findField("idEsercizio").getValue()&&(c=!0)});if(c)return Messaggio("ATTENZIONE","MSG_PRESENZA_STESSO_ESERCIZIO","OK","WARNING"),!1;b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=
this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.idCliFor,escluso:getBoolValue(c.escluso)});delete c.descrEsercizio;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.getGridPcc().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({idEsercizio:a.idEsercizioDefault})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",
function(c,e){controller_abilitaBottoni(b);a.getGridPcc().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridPcc(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridGrid().getStore())},
onLaunch:function(){this.getCBEsercizio().getStore().load({params:{idOrganizzazione:this.idOrganizzazione}});this.getGridPcc().controller=this;this.gestioneForm()},destroy:function(){eliminaStore(this.storeEsercizio);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.CondPag",{extend:"Generali.standard.ViewController",r0:function(a,b){for(var c=""+a;c.length<b;)c="0"+c;return c},calcola_CIN:function(a,b,c){a=StdSipcar.pdStrLeft(a,5,"0");var d=StdSipcar.pdStrLeft(b,5,"0"),e=StdSipcar.pdStrLeft(c,12,"0");c="";b=0;a=(a+d+e).toUpperCase().split("");for(var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],e=[1,0,5,7,9,13,15,17,19,21,2,4,18,20,11,3,6,8,12,14,16,10,22,25,24,23,27,28,26],g=0;g<
a.length;g++){var h="0123456789".indexOf(a[g]);0>h&&(h="ABCDEFGHIJKLMNOPQRSTUVWXYZ-. ".indexOf(a[g]));if(0>h){b=-1;break}b=0==g%2?b+e[h]:b+d[h]}-1!=b&&(c=b%26,c="ABCDEFGHIJKLMNOPQRSTUVWXYZ-. ".substring(c,c+1));return c},calcola_BBAN:function(a,b,c){var d=this.calcola_CIN(a,b,c);a=StdSipcar.pdStrLeft(a,5,"0");b=StdSipcar.pdStrLeft(b,5,"0");c=StdSipcar.pdStrLeft(c,12,"0");return d+a+b+c},calcola_CIN_EUR:function(a){var b="";if(-1!=a.search(/^[A-Z][0-9]{5}[0-9]{5}[A-Z0-9]{12}$/)){a+="IT00";for(var b=
"",c=0;27>c;c++)b+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(c));for(;2<b.length;)b=parseInt(b.substr(0,7),10)%97+b.substr(7);b="IT"+StdSipcar.pdStrLeft(98-parseInt(b,10)%97,2,"0")}return b},calcola_IBAN:function(a){return this.calcola_CIN_EUR(a)+a},campi_IBAN:function(a){a=void 0===a?"":a;"string"!=typeof a&&(a="");var b={};Ext.apply(b,{CIN_EUR:a.substring(0,4),CIN:a.substring(4,5),ABI:a.substring(5,10),CAB:a.substring(10,15),CC:a.substring(15,27)});return b},init:function(){this.selContainer=
"#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCondPag",selector:this.selContainer+"#GridCondPag"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CboxIdBanca",selector:this.selContainer+"#CboxIdBanca"},{ref:"CboxIdSportello",selector:this.selContainer+"#CboxIdSportello"},{ref:"ChbPredefinito",selector:this.selContainer+"#ChbPredefinito"},{ref:"TxtDescrizione",selector:this.selContainer+"#TxtDescrizione"},
{ref:"TxtIbanCompleto",selector:this.selContainer+"#TxtIbanCompleto"},{ref:"TxtCin",selector:this.selContainer+"#TxtCin"},{ref:"TxtCinEuro",selector:this.selContainer+"#TxtCinEuro"},{ref:"TxtConto",selector:this.selContainer+"#TxtConto"},{ref:"TxtBic",selector:this.selContainer+"#TxtBic"},{ref:"CbxTipoCliFor",selector:this.selContainer+"#CbxTipoCliFor"},{ref:"CbxIdCondPag",selector:this.selContainer+"#CbxIdCondPag"},{ref:"RbCliente",selector:this.selContainer+"#RbCliente"},{ref:"RbFornitore",selector:this.selContainer+
"#RbFornitore"},{ref:"CbxCodFiscNazioneIban",selector:this.selContainer+"#CbxCodFiscNazioneIban"},{ref:"BtnBanche",selector:this.selContainer+"#BtnBanche"}]);this.control(this.selContainer+"#CbxIdCondPag",{change:this.changeCbxIdCondPag});this.control(this.selContainer+"#GridCondPag",{select:this.selectGridCondPag});this.control(this.selContainer+"#CboxIdBanca",{change:this.changeCboxIdBanca,blur:this.calcolaIbanCompleto});this.control(this.selContainer+"#CboxIdSportello",{change:this.changeCampiIBAN,
blur:this.calcolaIbanCompleto});this.control(this.selContainer+"#TxtIbanCompleto",{});this.control(this.selContainer+"#TxtConto",{change:this.changeCampiIBAN,blur:this.blurTxtConto});this.control(this.selContainer+"#TxtCinEuro",{change:this.changeCampiIBAN,blur:this.calcolaIbanCompleto});this.control(this.selContainer+"#TxtCin",{change:this.changeCampiIBAN,blur:this.calcolaIbanCompleto});this.control(this.selContainer+"#CbxCodFiscNazioneIban",{change:this.changeCampiIBAN});this.control(this.selContainer+
"#BtnBanche",{click:this.linkToBanche})},linkToBanche:function(){var a=this;Ext.create("winCBA",{name:"Generali.banche.view.Banche",titolo:traduci("BANCHE"),dimensione:1,configItem:{permesso:a.cbaConfig.permesso,mostraEsci:!0},listeners:{beforeClose:function(b){b=a.getCboxIdBanca();var c=a.getCboxIdSportello();b.getStore().reload();c.getStore().reload()}},closable:!0}).show()},setObbligoCampiIBAN:function(a){var b=this.getCbxCodFiscNazioneIban().getValue(),b=b&&"0"!==b,c=[this.getTxtCinEuro(),this.getTxtCin(),
this.getCboxIdSportello(),this.getCboxIdBanca(),this.getTxtConto()];a&&this.changeCbxIdCondPag(this.getCbxIdCondPag());b&&(this.getTxtIbanCompleto().show(),this.getTxtBic().show());this.getTxtIbanCompleto().allowBlank=!b;this.getTxtIbanCompleto().validate();this.getTxtBic().allowBlank=!b;this.getTxtBic().validate();this.getTxtIbanCompleto().setReadOnly(!b);a=$jscomp.makeIterator(c);for(var d=a.next();!d.done;d=a.next()){var e=d.value,d=!0;b||(d=Ext.isEmpty(e.getValue(),!1)||!StdSipcar.isValidID(e.getValue())||
!e.isVisible());for(var e=$jscomp.makeIterator(c),g=e.next();!g.done;g=e.next())g=g.value,g.isVisible()&&(g.setVisible(!b),g.allowBlank=d,g.isValid());if(!d)break}},changeCampiIBAN:function(a,b,c,d){this.setObbligoCampiIBAN("CbxCodFiscNazioneIban"===a.getItemId());!b&&Ext.isDefined(a.lastSelectedRecords)&&delete a.lastSelectedRecords},GestioneCondPag:function(){var a=this;Ext.create("winCBA",{name:"Generali.condizionidipagamento.view.CondPag",titolo:traduci("TAB_COND_PAGAM"),dimensione:1,configItem:{permesso:a.cbaConfig.permesso,
mostraEsci:!0,callbackRiapriStore:function(){a.getCbxIdCondPag().bindStore(a.storeCondPag);a.storeCondPag.load()}},closable:!0}).show()},changeCbxIdCondPag:function(a,b){var c=this.getCbxIdCondPag(),d=trovaRecord(c.getStore(),"codice",c.getValue());d&&(c=d.data.extra.split(",")[0],d=d.data.extra.split(",")[1],this.getTxtIbanCompleto().hide(),this.getTxtCin().hide(),this.getTxtCinEuro().hide(),this.getTxtConto().hide(),this.getTxtBic().hide(),this.getCboxIdBanca().hide(),this.getCboxIdSportello().hide(),
"T"==c&&(this.getTxtIbanCompleto().show(),this.getTxtCin().show(),this.getTxtCinEuro().show(),this.getTxtConto().show(),this.getTxtBic().show(),this.getCboxIdBanca().show(),this.getCboxIdSportello().show()),"T"==d&&this.getTxtConto().show())},blurTxtConto:function(a,b,c){a=this.getTxtConto();c=this.getCbxIdCondPag();b=a.getValue();if((c=trovaRecord(c.getStore(),"codice",c.getValue()))&&"T"==c.data.extra.split(",")[0]&&""!=b){for(;12>b.length;)b="0"+b;a.setValue(b)}this.calcolaIbanCompleto()},calcolaIbanCompleto:function(){this.getForm();
var a=this.getTxtCinEuro(),b=this.getTxtCin(),c=this.getCboxIdBanca(),d=this.getCboxIdSportello(),e=this.getTxtConto(),g,h,k="",l="",m="";StdSipcar.isValidID(c.getValue())&&(h=trovaRecord(c.getStore(),"codice",c.getValue()));StdSipcar.isValidID(d.getValue())&&(g=trovaRecord(d.getStore(),"codice",d.getValue()));if(StdSipcar.isValidID(c.getValue())&&StdSipcar.isValidID(d.getValue())&&e.getValue()){var l=g.get("extra").split(","),k=StdSipcar.pdStrLeft(l[0],5,"0"),l=StdSipcar.pdStrLeft(l[1],5,"0"),m=
StdSipcar.pdStrLeft(e.getValue(),12,"0"),n=this.calcola_BBAN(k,l,m),p=this.calcola_IBAN(n),n=n?n.charAt(0):"",p=p?p.substr(0,4):"";Ext.isEmpty(a.getValue())&&a.setValue(p);Ext.isEmpty(b.getValue())&&b.setValue(n)}a.getValue()&&b.getValue()&&StdSipcar.isValidID(c.getValue())&&StdSipcar.isValidID(d.getValue())&&e.getValue()?(a=a.getValue()+b.getValue()+k+l+m,g=h.get("valore")+" - "+g.get("valore"),setValue(this.getTxtIbanCompleto(),a),setValue(this.getTxtDescrizione(),g.substr(0,100))):(this.getTxtIbanCompleto().setValue(""),
this.getTxtDescrizione().setValue(""))},changeCboxIdBanca:function(a,b){var c=this,d=c.getForm().getForm();cbBanca=c.getCboxIdBanca();cbSportello=c.getCboxIdSportello();c.changeCampiIBAN(a,b);if(!Ext.isNumber(b))return cbSportello.clearValue(),svuotaStore(cbSportello.getStore()),!1;cbBanca.getValue()&&cbSportello.getStore().load({params:{codAbi:b},callback:function(a,b,h){h?StdSipcar.isValidID(d.findField("id").getValue())&&(a=c.getGridCondPag().getSelectionModel().getSelection()[0])&&trovaRecord(cbSportello.getStore(),
"codice",a.get("idSportello"))&&c.getForm().getForm().setValues({idSportello:a.get("idSportello")}):msgShowError("",b.getError())}})},selectGridCondPag:function(a,b){var c=this.getForm();this.getCboxIdSportello();clearForm(this.getForm());c.loadRecord(b);this.getCbxCodFiscNazioneIban().getValue()||setCombo(this.getCbxCodFiscNazioneIban(),b.get("codFiscNazioneIban"));this.controllerAnag.getRgbTipoClifor().resetOriginalValue()},verificaCampiForm:function(){var a=[],b=this.getForm();this.setObbligoCampiIBAN();
b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a,b){var c=this.getCbxCodFiscNazioneIban().getValue(),c=c&&"0"!==c,d=this.getForm(),e=d.getForm().getFieldValues();delete e.abiSportello;Ext.apply(e,{predefinito:getBoolValue(e.predefinito),idCliFor:this.getGridCondPag().controller.idCliFor});c&&(delete e.cinEuro,delete e.cin,delete e.abiSportello,delete e.idSportello,delete e.conto);for(var g in e)Ext.isEmpty(e[g],!1)&&delete e[g];controller_salvaRecord(d,
e,a,{forzaRegistrazione:b?"T":"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridCondPag().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b,c){a.salvaForm(b,c)},annulla_callback:function(){var c=b.getForm().findField("id").getValue();a.aggiornaStore(c)},nuovo_callback:function(){controller_nuovoRecord(b);
b.getForm().setValues({tipoCliFor:a.tipoCliFor})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){var b=!0;if(b=a.verificaCampiForm()){if(!Ext.isEmpty(a.getTxtIbanCompleto().getValue())){var e=a.getCbxCodFiscNazioneIban().getValue();e&&"0"!==e||(e=a.campi_IBAN(a.getTxtIbanCompleto().getValue()),e=a.calcola_BBAN(e.ABI,e.CAB,e.CC),(e=a.calcola_CIN_EUR(e))&&
e!=a.getTxtCinEuro().getValue()&&(b=!1))}b||Messaggio("ATTENZIONE","MSG_CONFIRM_IBAN","YESNO","QUESTION",!1,function(){c.cbaConfig.conferma_callback(null,!0)})}return b}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridCondPag().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridCondPag(),c=b.getStore(),d=this.getForm();d.getForm();this.getRbCliente().hide();this.getRbFornitore().hide();
"F"!=this.tipoCliFor&&"E"!=this.tipoCliFor||this.getRbFornitore().show();"C"!=this.tipoCliFor&&"E"!=this.tipoCliFor||this.getRbCliente().show();c.load({params:{idCliFor:this.idCliFor},callback:function(e,g,h){h?Ext.isEmpty(e)?clearForm(d):(e=null,a&&(e=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(e?[e]:0)):msgShowError("",g.getError())}})},svuotaStore:function(){svuotaStore(this.getGridCondPag().getStore())},onLaunch:function(){var a=this;a.getCbxIdCondPag().cbaConfig.modificaClick=
function(){a.GestioneCondPag()};a.storeCondPag=Ext.create("Generali.condizionidipagamento.store.cboxCondPagamento");a.getCbxIdCondPag().bindStore(a.storeCondPag);a.storeCondPag.load();a.getGridCondPag().controller=a;a.gestioneForm()},destroy:function(){eliminaStore(this.storeCondPag);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Contab",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridContab",selector:this.selContainer+"#GridContab"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"CbxidContoBanca",selector:this.selContainer+"#CbxidContoBanca"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CbxSottoContoVendite",selector:this.selContainer+"#CbxSottoContoVendite"},
{ref:"CbxQuintoLivelloCrediti",selector:this.selContainer+"#CbxQuintoLivelloCrediti"},{ref:"CbxSottoContoAcquisti",selector:this.selContainer+"#CbxSottoContoAcquisti"},{ref:"CbxQuintoLivelloDebiti",selector:this.selContainer+"#CbxQuintoLivelloDebiti"},{ref:"CbxIdAliquotaIva",selector:this.selContainer+"#CbxIdAliquotaIva"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"}]);this.control(this.selContainer+"#GridContab",{select:this.selectGridContab});this.control(this.selContainer+"#CBEsercizio",
{change:this.changeCBEsercizio})},GestioneIva:function(){var a=this;Ext.create("winCBA",{name:"Generali.aliquotaiva.view.AliIva",titolo:traduci("TAB_ALIQUOTE_IVA"),dimensione:1,configItem:{permesso:a.cbaConfig.permesso,mostraEsci:!0,callbackRiapriStore:function(){a.getCbxIdAliquotaIva().bindStore(a.storeIva);a.storeIva.load()}},closable:!0}).show()},GestionePDC:function(){var a=this;Ext.create("winCBA",{name:"Generali.pianodeiconti.view.PnlPianoConti",titolo:traduci("TAB_PDC"),dimensione:1,configItem:{idOrganizzazione:a.idOrganizzazione,
idEsercizio:a.getCBEsercizio().getValue(),permesso:a.cbaConfig.permesso,chiamataEsterna:!0,mostraEsci:!0,callbackRiapriStore:function(){a.fireEvent("changeCBEsercizio")}},closable:!0}).show()},changeCBEsercizio:function(a,b,c,d){this.getCBEsercizio().getValue()&&(this.extraParametri(this.storePdc_1),this.settaStoreCredDEbVarie(this.storePdc_2,1),this.extraParametri(this.storePdc_3),this.settaStoreCredDEbVarie(this.storePdc_4,2),this.getCbxidContoBanca().getStore().load({params:{idOrganizzazione:this.idOrganizzazione,
idEsercizio:this.getCBEsercizio().getValue(),contoBanca:"T"}}))},selectGridContab:function(a,b){var c=this.getForm();clearForm(this.getForm());c.loadRecord(b);this.getCBEsercizio().getValue()&&(b.get("sottoContoVendite")&&setCombo(this.getCbxSottoContoVendite(),b.get("sottoContoVendite"),b.get("descrSottoContoVendite"),{descrizione:b.get("descrSottoContoVendite")}),b.get("quintoLivelloCrediti")&&setCombo(this.getCbxQuintoLivelloCrediti(),b.get("quintoLivelloCrediti"),b.get("descrQuintoLivelloCrediti"),
{descrizione:b.get("descrQuintoLivelloCrediti")}),b.get("sottoContoAcquisti")&&setCombo(this.getCbxSottoContoAcquisti(),b.get("sottoContoAcquisti"),b.get("descrSottoContoAcquisti"),{descrizione:b.get("descrSottoContoAcquisti")}),b.get("quintoLivelloDebiti")&&setCombo(this.getCbxQuintoLivelloDebiti(),b.get("quintoLivelloDebiti"),b.get("descrQuintoLivelloDebiti"),{descrizione:b.get("descrQuintoLivelloDebiti")}))},extraParametri:function(a){a.getProxy().extraParams={idOrganizzazione:this.idOrganizzazione,
idEsercizio:this.getCBEsercizio().getValue()}},settaStoreCredDEbVarie:function(a,b){a.getProxy().extraParams={idOrganizzazione:this.idOrganizzazione,idEsercizio:this.getCBEsercizio().getValue(),sezione:b}},verificaCampiForm:function(){var a=[],b=this.getForm(),c=!1;b.store.data.each(function(a){a.get("id")!=b.getForm().findField("id").getValue()&&a.get("idEsercizio")==b.getForm().findField("idEsercizio").getValue()&&(c=!0)});c&&msgAddError(a,"MSG_PRESENZA_STESSO_ESERCIZIO");b.isValid()||msgAddError(a,
"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.getGridContab().controller.idCliFor});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridContab().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({idEsercizio:a.idEsercizioDefault})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();
if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridContab().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridContab(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridContab().getStore())},
onLaunch:function(){var a=this;a.getCBEsercizio().getStore().load({params:{idOrganizzazione:a.idOrganizzazione}});a.storePdc_1=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.storePdc_2=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.storePdc_3=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.storePdc_4=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.getCbxSottoContoVendite().bindStore(a.storePdc_1);a.getCbxQuintoLivelloCrediti().bindStore(a.storePdc_2);
a.getCbxSottoContoAcquisti().bindStore(a.storePdc_3);a.getCbxQuintoLivelloDebiti().bindStore(a.storePdc_4);a.storeIva=Ext.create("Generali.aliquotaiva.store.cboxAliquotaIva");a.storeIva.load();a.getCbxIdAliquotaIva().bindStore(a.storeIva);a.getGridContab().controller=a;a.gestioneForm();a.getCbxIdAliquotaIva().cbaConfig.modificaClick=function(){a.GestioneIva()};a.getCbxSottoContoAcquisti().cbaConfig.modificaClick=function(){a.GestionePDC()}},destroy:function(){eliminaStore(this.storeForm);eliminaStore(this.storePdc_1);
eliminaStore(this.storePdc_2);eliminaStore(this.storePdc_3);eliminaStore(this.storePdc_4);eliminaStore(this.storeIva);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Contatti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridContatti",selector:this.selContainer+"#GridContatti"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBComune",selector:this.selContainer+"#CBComune"},{ref:"Cap",selector:this.selContainer+"#Cap"},{ref:"CBNazione",selector:this.selContainer+
"#CBNazione"}]);this.control(this.selContainer+"#GridContatti",{select:this.selectGridContatti});this.control(this.selContainer+"#CBComune",{change:this.changeCBComune,beforequery:this.beforequeryCBComune});this.control(this.selContainer+"#CBNazione",{change:this.changeCBNazione})},changeCBNazione:function(a,b,c,d){a=b&&"0"!==b;b=$jscomp.makeIterator(["CBComune","Cap"]);for(c=b.next();!c.done;c=b.next())c=this["get"+c.value](),c.setDisabled(a),c.isDisabled()&&setValue(c,"")},beforequeryCBComune:function(a,
b){if(!a.query)return!1},changeCBComune:function(a,b,c,d){if(!b)return!1;(a=a.getSelection())&&this.getCap().setValue(parseInt(a.get("extra").split(",")[1]))},selectGridContatti:function(a,b){var c=this.getForm();clearForm(this.getForm());c.loadRecord(b);setCombo(this.getCBComune(),b.get("comune"),b.get("desComune"))},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();
Ext.apply(c,{idCliFor:this.getGridContatti().controller.idCliFor});c.mailPredefinitaOrdini=c.mailPredefinitaOrdini?"T":"F";controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridContatti().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridContatti().setDisabled(e)})},
aggiornaStore:function(a){var b=this.getGridContatti(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridContatti().getStore())},onLaunch:function(){Ext.define("UrlOverride",{override:"Ext.form.field.VTypes",
url:function(a){return/(((([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*)|(localhost|LOCALHOST))\/?)/i.test(a)}});this.getGridContatti().controller=this;this.gestioneForm()},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.CupCig",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCupCig",selector:this.selContainer+"#GridCupCig"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"Ritenuta",selector:this.selContainer+"#Ritenuta"},{ref:"DataScad",selector:this.selContainer+"#DataScad"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"}]);this.control(this.selContainer+
"#GridCupCig",{select:this.selectGridCupCig})},selectGridCupCig:function(a,b){var c=this.getForm();clearForm(this.getForm());c.loadRecord(b)},verificaCampiForm:function(){var a=[],b=this.getForm(),c=b.getForm().findField("cig").getValue(),d=b.getForm().findField("cup").getValue();Ext.isEmpty(c)&&Ext.isEmpty(d)&&msgAddError(a,"INSERIRE_CIG_CUP");b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,
{idCliFor:this.getGridCupCig().controller.idCliFor,predefinito:getBoolValue(c.predefinito),ritenuta:getBoolValue(c.ritenuta)});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridCupCig().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridCupCig().setDisabled(e)})},
aggiornaStore:function(a){var b=this.getGridCupCig(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridCupCig().getStore())},onLaunch:function(){var a=this,b=a.getRitenuta();a.getDataScad().setDisabled(!0);
b.on("change",function(b,d,e,g){a.getDataScad().setDisabled(!d)});a.getGridCupCig().controller=a;a.gestioneForm()},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Delegati",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridDelegati",selector:this.selContainer+"#GridDelegati"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"}]);this.control(this.selContainer+"#GridDelegati",{select:this.selectGridDelegati})},selectGridDelegati:function(a,b){var c=this.getForm();
clearForm(this.getForm());c.loadRecord(b)},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.getGridDelegati().controller.idCliFor});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=
a.getBoxBottoni();a.storeForm=b.store=a.getGridDelegati().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});
inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridDelegati().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridDelegati(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?
[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridDelegati().getStore())},onLaunch:function(){this.getGridDelegati().controller=this;this.gestioneForm()},destroy:function(){this.callParent()}});
Ext.define("Generali.anaCliFor.controller.FattElettronica",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridSelezione",selector:this.selContainer+"#GridSelezione"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"CntPA",selector:this.selContainer+"#CntPA"},{ref:"TxCodUfficio",selector:this.selContainer+"#TxCodUfficio"},{ref:"TxDescrUfficio",
selector:this.selContainer+"#TxDescrUfficio"},{ref:"CntB2B",selector:this.selContainer+"#CntB2B"},{ref:"TxCodice",selector:this.selContainer+"#TxCodice"},{ref:"TxPec",selector:this.selContainer+"#TxPec"},{ref:"ChbAttivo",selector:this.selContainer+"#ChbAttivo"}]);this.control(this.selContainer+"#GridSelezione",{select:this.selectGrid});this.control(this.selContainer+"#TxCodice",{change:Ext.Function.createBuffered(this.changeTestoB2B,100,this)});this.control(this.selContainer+"#TxPec",{change:Ext.Function.createBuffered(this.changeTestoB2B,
100,this)})},aggiornaStatoTestata:function(a){var b,c;Ext.isDefined(this.controllerAnag)&&this.controllerAnag&&(b=this.controllerAnag,c=b.getRgbSoggetto(),!a&&c.readOnly||b.setReadOnlySoggetto(c,c.getValue().tipoSoggetto))},selectGrid:function(a,b){var c=this.getForm();clearForm(this.getForm());b&&c.loadRecord(b)},changeTestoB2B:function(a){("TxCodice"==a.getItemId()?this.getTxPec():this.getTxCodice()).setDisabled(!Ext.isEmpty(a.getValue()))},verificaCampiForm:function(){var a=[];this.getForm().isValid()||
msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.idCliFor,tipoFattElettronica:this.tipoFattEle,attivo:getBoolValue(c.attivo)});"B2B"==this.tipoFattEle&&this.getCntB2B().isVisible()&&(this.getTxCodice().isDisabled()&&Ext.apply(c,{codice:""}),this.getTxPec().isDisabled()&&Ext.apply(c,{pec:""}));controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},
gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridSelezione().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){var c;"PA"==a.tipoFattEle?c=a.getTxCodUfficio():"B2B"==a.tipoFattEle&&(c=a.getTxCodice());controller_nuovoRecord(b,c)},elimina_callback:function(){var c=
b.getForm().findField("id").getValue();controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},aggiornaStore:function(a){var b=this,c=b.getGridSelezione(),d=c.getStore(),e=b.getForm();e.getForm();d.load({params:{idCliFor:b.idCliFor,tipoFattEle:b.tipoFattEle},
callback:function(g,h,k){if(k){var l;Ext.isEmpty(g)?clearForm(e):(l=trovaRecord(d,"id",a),c.getSelectionModel().deselectAll());b.aggiornaStatoTestata(Ext.isEmpty(g));c.getSelectionModel().select(l?[l]:0)}else msgShowError("",h.getError())}})},onLaunch:function(){var a=this.getGridSelezione();this.tipoFattEle="P"==this.tipoSoggetto?"PA":"B2B";a.controller=this;this.gestioneForm();this.aggiornaStore()},svuotaStore:function(){svuotaStore(this.getGridSelezione().getStore())},destroy:function(){this.callParent()}});
Ext.define("Generali.anaCliFor.controller.GestioneDurc",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridDurc",selector:this.selContainer+"#GridDurc"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BtnAllega",selector:this.selContainer+"#BtnAllega"},{ref:"CntAnteprima",selector:this.selContainer+"#CntAnteprima"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"}]);this.control(this.selContainer+
"#BtnAllega",{change:this.importaAllegato});this.control(this.selContainer+"#GridDurc",{select:this.selectGrid})},nuovoRecord:function(){this.getCntAnteprima().removeAll();controller_nuovoRecord(this.getForm())},verificaForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.idCliFor});this.blobData&&Ext.apply(c,{fileData:Array.from(this.blobData)});
controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},eliminaRecord:function(){var a=this,b=a.getForm(),c=b.getForm().findField("id").getValue();StdSipcar.isValidID(c)&&controller_eliminaRecord(b.store,{id:c},function(){return a.aggiornaStore()})},fileToArray:function(a){var b=new FileReader;return new Promise(function(c,d){b.onload=function(a){a=new Uint8Array(b.result);c(a)};b.onerror=function(a){d(a)};b.readAsArrayBuffer(a)})},creaAnteprima:function(a,
b){b=void 0===b?"sample.txt":b;this.getCntAnteprima().removeAll();if(!Ext.isEmpty(a)){var c,d=window.URL||window.webkitURL;c=b.split(".").pop().toLowerCase();var e=new File([a],b,{type:("pdf"==c?"application":"image")+"/"+c}),d=d.createObjectURL(e),e=e.name,g="icon-"+c;(c="pdf"==c?!(Ext.browser.is.IE||-1<Ext.browser.userAgent.indexOf("Edge"))&&1024<Ext.getBody().getViewSize().width?{flex:1,itemId:"iframePdf",reference:"iframePdf",html:'<iframe id="pdf" width="100%" height="100%" src="'+d+'"></iframe>'}:
creaItemDownload(g,d,e,e):-1!=Ext.Array.indexOf(getEstensioniImg(),c)?{xtype:"container",scrollable:!0,flex:1,items:[{html:'<a href="'+d+'" download="'+e+'">'+traduci("DOWNLOAD")+" "+e+"</a>"},{xtype:"image",src:""+d}]}:creaItemDownload(g,d,e,e))&&this.getCntAnteprima().add(c)}},importaAllegato:function(a,b,c){if(b=b.target.files[0]){var d=this,e=d.getForm().getForm().findField("fileName");e.setValue(b.name);d.fileToArray(b).then(function(a){d.blobData=a;d.creaAnteprima(d.blobData,e.getValue())})["catch"](function(a){msgShowError("",
a)})}a.fileInputEl.dom.value=null},eliminaAllegato:function(){this.getForm().getForm().findField("fileName").setValue(null);this.getCntAnteprima().removeAll();delete this.blobData},convertToBinary:function(a){a=atob(a);var b=a.length,c=new Uint8Array(new ArrayBuffer(b));for(i=0;i<b;i++)c[i]=a.charCodeAt(i);return c},selectGrid:function(a,b,c,d){a=this.getForm();delete this.blobData;clearForm(a);b&&(a.loadRecord(b),b.get("fileData")&&(this.blobData=this.convertToBinary(b.get("fileData")),this.creaAnteprima(this.blobData,
b.get("fileName"))))},gestioneForm:function(){var a=this,b=a.getGridDurc(),c=a.getForm();c.controller=a;c.permesso=a.cbaConfig.permesso;c.boxBottoni=a.getBoxBottoni();c.store=b.getStore();b=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:a.salvaForm.bind(a),annulla_callback:function(){var b=c.getForm().findField("id");a.aggiornaStore(b.getValue())},nuovo_callback:a.nuovoRecord.bind(a),elimina_callback:a.eliminaRecord.bind(a),verificaCampiForm_callback:a.verificaForm.bind(a)}});
inserisciBottoni(c.boxBottoni,b);c.boxBottoni.queryById("btnEsci").hide();if("L"!=c.permesso)c.getForm().on("dirtychange",function(a,b){controller_abilitaBottoni(c)})},aggiornaStore:function(a){var b=this.getGridDurc(),c=b.getStore(),d=this.getForm();b.getSelectionModel().deselectAll();this.getCntAnteprima().removeAll();svuotaStore(c);clearForm(d);this.idCliFor&&c.load({params:{idCliFor:this.idCliFor},callback:function(d,g,h){if(h){var e;Ext.isEmpty(d)||a&&(e=trovaRecord(c,"id",a));b.getSelectionModel().select(e?
[e]:0)}else msgShowError("",g.getError())}})},onLaunch:function(){this.getGridDurc().controller=this;this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Indirizzi",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridIndirizzi",selector:this.selContainer+"#GridIndirizzi"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"IND_Comune",selector:this.selContainer+"#IND_Comune"},{ref:"IND_Nazione",selector:this.selContainer+"#IND_Nazione"},{ref:"IND_Cap",selector:this.selContainer+"#IND_Cap"},{ref:"BoxBottoni",
selector:this.selContainer+"#BoxBottoni"},{ref:"EdtEstero",selector:this.selContainer+"#EdtEstero"},{ref:"IND_CodIso",selector:this.selContainer+"#IND_CodIso"}]);this.control(this.selContainer+"#GridIndirizzi",{select:this.selectGridIndirizzi});this.control(this.selContainer+"#IND_Comune",{beforequery:this.beforequeryIND_Comune});this.control(this.selContainer+"#IND_Comune",{select:this.selectIND_Comune});this.control(this.selContainer+"#IND_Nazione",{change:this.changeIND_Nazione});this.control(this.selContainer+
"#IND_CodIso",{change:this.changeIND_CodIso})},changeIND_CodIso:function(a,b,c,d){this.getIND_CodIso().setValue(b.toUpperCase())},changeIND_Nazione:function(a,b,c,d){if(!b)return!1;"0"!=b&&(setValue(this.getIND_Comune(),""),setValue(this.getIND_Cap(),""));this.getIND_Comune().setDisabled("0"!=b);this.getIND_Cap().setDisabled("0"!=b);this.getIND_Cap().allowBlank="0"!=b;this.getIND_Cap().validate();this.getEdtEstero().setVisible("0"!=b);"0"!=b?(this.getEdtEstero().allowBlank=!1,this.getEdtEstero().validate()):
(this.getEdtEstero().allowBlank=!0,setValue(this.getEdtEstero(),""))},selectIND_Comune:function(a,b,c,d){b&&a.originalValue!==b.get("codice")&&(this.getIND_Cap().setValue(parseInt(b.get("extra").split(",")[1])),this.getIND_CodIso().setValue("IT"))},beforequeryIND_Comune:function(a,b){if(!a.query)return!1},selectGridIndirizzi:function(a,b){var c=this.getForm();clearForm(this.getForm());c.loadRecord(b);setCombo(this.getIND_Comune(),b.get("istatComune"),b.get("descrizioneComune"))},verificaCampiForm:function(){var a=
[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.getGridIndirizzi().controller.idCliFor});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},setCampiObbligatori:function(a){var b=this.getForm(),c=this.getIND_Nazione(),d=this.getIND_Comune();c.allowBlank=!a;d.allowBlank=!a;a&&(validaForm(b),b.isValid()||(Ext.isEmpty(b.getForm().findField("id").getValue())?
b.boxBottoni.queryById("btnNuovo").handler():(a=b.getForm().getRecord(),(Ext.isEmpty(a.get("istatComune"))||Ext.isEmpty(a.get("codIstatNazione")))&&b.getForm().findField("id").setValue(0+b.getForm().findField("id").getValue()))))},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridIndirizzi().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);a.getIND_Nazione().setValue("0")},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);
a.getGridIndirizzi().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridIndirizzi(),c=b.getStore(),d=this.getForm(),e=d.getForm();this.getIND_Comune().setDisabled(!1);this.getIND_Cap().setDisabled(!1);this.idCliFor&&c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridIndirizzi().getStore())},
onLaunch:function(){this.getGridIndirizzi().controller=this;this.gestioneForm();this.getIND_Nazione().getStore().load()},destroy:function(){this.callParent()}});
Ext.define("Generali.anaCliFor.controller.LavAutonomo",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridLavAutonomo",selector:this.selContainer+"#GridLavAutonomo"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"},{ref:"CBCau770",selector:this.selContainer+"#CBCau770"},{ref:"CBTributo",
selector:this.selContainer+"#CBTributo"},{ref:"PercRitenuta",selector:this.selContainer+"#PercRitenuta"},{ref:"CBCodAltreSomme",selector:this.selContainer+"#CBCodAltreSomme"},{ref:"CBEntePrevidenziale",selector:this.selContainer+"#CBEntePrevidenziale"},{ref:"CBCatEntePrevidenziale",selector:this.selContainer+"#CBCatEntePrevidenziale"}]);this.control(this.selContainer+"#GridLavAutonomo",{select:this.selectGridLavAutonomo});this.control(this.selContainer+"#CBEntePrevidenziale",{change:this.changeCBEntePrevidenziale})},
changeCBEntePrevidenziale:function(a,b,c,d){var e=this.getCBCatEntePrevidenziale();e.allowBlank=!b;setValue(e,null);e.setValue(null);if(b){var g=e.getStore();g.load({params:{codEntePrev:b},callback:function(a,c,d){c=!b||0>=b;d=!Ext.isEmpty(a);e.setVisible(d).setDisabled(e.isHidden()||c);1===a.length&&e.setValue(g.getAt(0))}})}e.validate()},selectGridLavAutonomo:function(a,b){var c=this.getForm(),d=c.getForm();b&&this.getCBEsercizio().getStore().load({params:{idOrganizzazione:this.idOrganizzazione},
callback:function(a,g,h){clearForm(c);d.loadRecord(b)}})},verificaCampiForm:function(){var a=[],b=this.getForm(),c=!1;b.store.data.each(function(a){a.get("id")!=b.getForm().findField("id").getValue()&&a.get("idEsercizio")==b.getForm().findField("idEsercizio").getValue()&&(c=!0)});if(c)return Messaggio("ATTENZIONE","MSG_PRESENZA_STESSO_ESERCIZIO","OK","WARNING"),!1;b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();
Ext.apply(c,{idCliFor:this.idCliFor});delete c.descrEsercizio;delete c.descrTributo;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.getGridLavAutonomo().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},
nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({idEsercizio:a.idEsercizioDefault})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);
a.getGridLavAutonomo().setDisabled(e)})},aggiornaStore:function(a){var b=this.getGridLavAutonomo(),c=b.getStore(),d=this.getForm(),e=d.getForm();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridLavAutonomo().getStore())},onLaunch:function(){this.storeCaus770=
Ext.create("Generali.store.CausaliLavoroAutonomo");this.getCBCau770().bindStore(this.storeCaus770);this.storeCaus770.load();this.getCBEsercizio().getStore().load({params:{idOrganizzazione:this.idOrganizzazione}});this.storeTributo=Ext.create("Generali.tributi.store.cboxTributi");this.getCBTributo().bindStore(this.storeTributo);this.storeTributo.load();this.getGridLavAutonomo().controller=this;this.gestioneForm()},destroy:function(){eliminaStore(this.storeCaus770);eliminaStore(this.storeEsercizio);
this.callParent()}});
Ext.define("Generali.anaCliFor.controller.Spesometro",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridSpesometro",selector:this.selContainer+"#GridSpesometro"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"},{ref:"ColCliente",selector:this.selContainer+"#ColCliente"},{ref:"ColFornitore",
selector:this.selContainer+"#ColFornitore"}]);this.control(this.selContainer+"#GridSpesometro",{select:this.selectGridSpesometro})},selectGridSpesometro:function(a,b){var c=this.getForm(),d=c.getForm();b&&(clearForm(c),d.loadRecord(b))},verificaCampiForm:function(){var a=[],b=this.getForm(),c=!1;b.store.data.each(function(a){a.get("id")!=b.getForm().findField("id").getValue()&&a.get("idEsercizio")==b.getForm().findField("idEsercizio").getValue()&&(c=!0)});if(c)return Messaggio("ATTENZIONE","MSG_PRESENZA_STESSO_ESERCIZIO",
"OK","WARNING"),!1;b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idCliFor:this.idCliFor,includereInTracciatoCliente:getBoolValue(c.includereInTracciatoCliente),includereInTracciatoFornitore:getBoolValue(c.includereInTracciatoFornitore)});delete c.descrEsercizio;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=
this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.getGridSpesometro().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({idEsercizio:a.idEsercizioDefault,includereInTracciatoCliente:"C"==a.tipoCliFor||"E"==a.tipoCliFor?"T":"F",includereInTracciatoFornitore:"F"==
a.tipoCliFor||"E"==a.tipoCliFor?"T":"F"})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridSpesometro().setDisabled(e)})},aggiornaStore:function(a){var b=
this.getGridSpesometro(),c=b.getStore(),d=this.getForm(),e=d.getForm();this.getColFornitore().hide();this.getColCliente().hide();"F"!=this.tipoCliFor&&"E"!=this.tipoCliFor||this.getColFornitore().show();"C"!=this.tipoCliFor&&"E"!=this.tipoCliFor||this.getColCliente().show();c.load({params:{idCliFor:this.idCliFor},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:
0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridGrid().getStore())},onLaunch:function(){this.getCBEsercizio().getStore().load({params:{idOrganizzazione:this.idOrganizzazione}});this.getGridSpesometro().controller=this;this.gestioneForm()},destroy:function(){eliminaStore(this.storeEsercizio);this.callParent()}});
Ext.define("Generali.anaCliFor.controller.ZZ_Contab",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridContab",selector:this.selContainer+"#GridContab"}]);this.control(this.selContainer+"#GridContab",{beforeedit:this.beforeeditGridContab,edit:this.editGridContab,canceledit:this.canceleditGridContab,validateedit:this.validateeditGridContab})},beforeeditGridContab:function(a,b,c){if(!0===a.editing)return!1;
a=a.getEditor().getForm();a.findField("sottoContoVendite").bindStore(this.storePdc);a.findField("quintoLivelloCrediti").bindStore(this.storePdc);a.findField("sottoContoAcquisti").bindStore(this.storePdc);a.findField("quintoLivelloDebiti").bindStore(this.storePdc);a.findField("idAliquotaIva").bindStore(this.storeIva);this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){},editGridContab:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();
Ext.apply(c,{idCliFor:this.idCliFor});delete c.descrSottoContoVendite;delete c.descrSottoContoAcquisti;delete c.descrQuintoLivelloCrediti;delete c.descrQuintoLivelloDebiti;delete c.descrAliquotaIva;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridContab:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridContab:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=
this.getGridContab(),c=b.getStore();c.load({params:{idCliFor:this.idCliFor},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridGrid().getStore())},onLaunch:function(){this.storePdc=Ext.create("Generali.pianodeiconti.store.cboxPianoConti");this.storePdc.load({params:{idOrganizzazione:getIdOrg(),anno:(new Date(CBA.moduli.modulo44.serverDate)).getFullYear()}});
this.storeIva=Ext.create("Generali.aliquotaiva.store.cboxAliquotaIva");this.storeIva.load();this.getGridContab().controller=this},destroy:function(){eliminaStore(this.storePdc);eliminaStore(this.storeIva);this.callParent()}});
Ext.define("Generali.anaCliFor.store.Allegato",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"data",type:"date"},{name:"descrizione"},{name:"fileName"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/allegati/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/allegati/list",create:"/cba/gen/ws/general/anaCliFor/allegati/insert",update:"/cba/gen/ws/general/anaCliFor/allegati/update",destroy:"/cba/gen/ws/general/anaCliFor/allegati/delete"}},
autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.AnaCliFor",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"attivo"},{name:"tipoCliFor"},{name:"descrizione"},{name:"codFiscale"},{name:"partitaIva"},{name:"idCategoria"},{name:"note"},{name:"personaFisica"},{name:"personaFisicaCognome"},{name:"personaFisicaNome"},{name:"personaFisicaSesso"},{name:"personaFisicaDtNascita",type:"date"},{name:"personaFisicaIstatComuneNascita"},{name:"personaFisicaCodFiscNazioneNascita"},{name:"categoriaClienteFornitore"},
{name:"personaFisicaDescrizioneComuneNascita"},{name:"personaFisicaCodIstatNazioneNascita"},{name:"ritenuta"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/list",reader:{type:"json",messageProperty:"message",rootProperty:"data",totalProperty:"total"}},autoDestroy:!0,autoLoad:!1});
Ext.define("Generali.anaCliFor.store.Anagrafica",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"attivo"},{name:"tipoCliFor"},{name:"descrizione"},{name:"codFiscale"},{name:"partitaIva"},{name:"idCategoria"},{name:"note"},{name:"personaFisica"},{name:"personaFisicaCognome"},{name:"personaFisicaNome"},{name:"personaFisicaSesso"},{name:"personaFisicaDtNascita",type:"date"},{name:"personaFisicaIstatComuneNascita"},{name:"personaFisicaCodFiscNazioneNascita"},{name:"categoriaClienteFornitore"},
{name:"personaFisicaDescrizioneComuneNascita"},{name:"personaFisicaCodIstatNazioneNascita"},{name:"ritenuta"},{name:"tipoSoggetto"},{name:"codFiscNazione"},{name:"siglaNazionePartitaIva"},{name:"escludiDa730"},{name:"codiceSpeseTrasm"},{name:"flagSaltuario"},{name:"escludiDaIndTemp"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/get",create:"/cba/gen/ws/general/anaCliFor/new",
update:"/cba/gen/ws/general/anaCliFor/update",destroy:"/cba/gen/ws/general/anaCliFor/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Categoria",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"dataDal",type:"date"},{name:"dataAl",type:"date"},{name:"idCategoria"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cliForCategoria/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/cliForCategoria/list",create:"/cba/gen/ws/general/anaCliFor/cliForCategoria/new",update:"/cba/gen/ws/general/anaCliFor/cliForCategoria/update",
destroy:"/cba/gen/ws/general/anaCliFor/cliForCategoria/delete"}},autoDestroy:!0});Ext.define("Generali.anaCliFor.store.CboxCupCig",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cupCig/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.CertificazionePcc",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"idEsercizio"},{name:"escluso"},{name:"descrEsercizio"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/certCrediti/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/certCrediti/list",create:"/cba/gen/ws/general/anaCliFor/certCrediti/new",update:"/cba/gen/ws/general/anaCliFor/certCrediti/update",destroy:"/cba/gen/ws/general/anaCliFor/certCrediti/delete"}},
autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.CondPag",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"dataDal",type:"date"},{name:"dataAl",type:"date"},{name:"tipoCliFor"},{name:"idCondPag"},{name:"cinEuro"},{name:"cin"},{name:"idSportello"},{name:"conto"},{name:"bic"},{name:"descrizione"},{name:"ibanCompleto"},{name:"predefinito"},{name:"ridIntestatario"},{name:"ridCodFiscaleIntestatario"},{name:"ridDelegato"},{name:"ridCodFiscaleDelegato"},{name:"ridDataSottoscrizione",type:"date"},
{name:"descrSportello"},{name:"abiSportello"},{name:"clcTipo",convert:function(a,b){return"C"==b.get("tipoCliFor")?"Cliente":"F"==b.get("tipoCliFor")?"Fornitore":b.get("tipoCliFor")}},{name:"codFiscNazioneIban"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/condPag/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/condPag/list",create:"/cba/gen/ws/general/anaCliFor/condPag/new",update:"/cba/gen/ws/general/anaCliFor/condPag/update",
destroy:"/cba/gen/ws/general/anaCliFor/condPag/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Contab",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"idEsercizio"},{name:"sottoContoVendite"},{name:"sottoContoAcquisti"},{name:"quintoLivelloCrediti"},{name:"quintoLivelloDebiti"},{name:"idAliquotaIva"},{name:"capitoloEntrate"},{name:"articoloEntrate"},{name:"capitoloSpese"},{name:"articoloSpese"},{name:"descrEsercizio"},{name:"descrSottoContoVendite"},{name:"descrSottoContoAcquisti"},{name:"descrQuintoLivelloCrediti"},{name:"descrQuintoLivelloDebiti"},
{name:"descrAliquotaIva"},{name:"idContoBanca"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/contab/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/contab/list",create:"/cba/gen/ws/general/anaCliFor/contab/new",update:"/cba/gen/ws/general/anaCliFor/contab/update",destroy:"/cba/gen/ws/general/anaCliFor/contab/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Contatti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"contatto"},{name:"mail"},{name:"telefono"},{name:"fax"},{name:"cellulare"},{name:"web"},{name:"note"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/contatti/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/contatti/list",create:"/cba/gen/ws/general/anaCliFor/contatti/new",update:"/cba/gen/ws/general/anaCliFor/contatti/update",
destroy:"/cba/gen/ws/general/anaCliFor/contatti/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.CupCig",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"dataDal",type:"date"},{name:"dataAl",type:"date"},{name:"cup"},{name:"cig"},{name:"predefinito"},{name:"ibanDedicato"},{name:"note"},{name:"ritenuta"},{name:"importoCig"},{name:"dataScadenzaDurc",type:"date"},{name:"procedura"},{name:"nomeBando"},{name:"dataPubblicazioneBando",type:"date"},{name:"importoAggiudicazioneBando"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cupCig/list",
reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/cupCig/list",create:"/cba/gen/ws/general/anaCliFor/cupCig/new",update:"/cba/gen/ws/general/anaCliFor/cupCig/update",destroy:"/cba/gen/ws/general/anaCliFor/cupCig/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Delegati",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"dataDal",type:"date"},{name:"delegato"},{name:"codiceFiscale"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/delegati/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/delegati/list",create:"/cba/gen/ws/general/anaCliFor/delegati/new",update:"/cba/gen/ws/general/anaCliFor/delegati/update",destroy:"/cba/gen/ws/general/anaCliFor/delegati/delete"}},
autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.FattElettronica",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"tipoFattElettronica"},{name:"codUfficio"},{name:"descrUfficio"},{name:"codice"},{name:"pec"},{name:"attivo"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/list",create:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/new",update:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/update",
destroy:"/cba/gen/ws/general/anaCliFor/fatturaElettronica/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.GestioneDurc",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idCliFor"},{name:"dataRichiesta",type:"date"},{name:"dataScadenza",type:"date"},{name:"descrizione"},{name:"fileName"}],proxy:{url:"/cba/gen/ws/general/anaCliFor/durc/get",api:{read:"/cba/gen/ws/general/anaCliFor/durc/list",create:"/cba/gen/ws/general/anaCliFor/durc/insert",update:"/cba/gen/ws/general/anaCliFor/durc/update",destroy:"/cba/gen/ws/general/anaCliFor/durc/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Indirizzi",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"dataDal",type:"date"},{name:"indirizzo"},{name:"civico"},{name:"interno"},{name:"esponente"},{name:"cap",convert:function(a){return StdSipcar.pdStrLeft(a,5,"0")}},{name:"istatComune"},{name:"codFiscNazione"},{name:"descrizioneComune"},{name:"codIstatNazione"},{name:"comuneEstero"},{name:"codNazIso3166"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/indirizzi/list",reader:{type:"json",
messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/indirizzi/list",create:"/cba/gen/ws/general/anaCliFor/indirizzi/new",update:"/cba/gen/ws/general/anaCliFor/indirizzi/update",destroy:"/cba/gen/ws/general/anaCliFor/indirizzi/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.InfoCliFor",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"descrizione"},{name:"codFiscale"},{name:"partitaIva"},{name:"tipoCliFor"},{name:"note"},{name:"attivo"},{name:"indirizzo"},{name:"civico"},{name:"interno"},{name:"esponente"},{name:"cap"},{name:"istatComune"},{name:"codFiscNazione"},{name:"descrizioneComune"},{name:"descrizioneProvincia"},{name:"idCondPag"},{name:"descrizioneCondPag"},{name:"idCupCigDefault"},{name:"clcCFPI",
convert:function(a,b){return Ext.isEmpty(b.get("partitaIva"))?b.get("codFiscale"):b.get("partitaIva")}},{name:"desBancaCliente"},{name:"ibanCliente"},{name:"desBancaFornitore"},{name:"ibanFornitore"},{name:"provincia"},{name:"categoria"},{name:"descrizioneNazione"},{name:"telefono"},{name:"fax"},{name:"cellulare"},{name:"mail"},{name:"web"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/infoIndirizzo/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.LavAutonomo",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"idEsercizio"},{name:"causale770"},{name:"percRitenuta"},{name:"idTributo"},{name:"descrEsercizio"},{name:"descrTributo"},{name:"codSommeNonSoggette"},{name:"codEntePrev"},{name:"categoriaEntePrev"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/lavoroAutonomo/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/lavoroAutonomo/list",
create:"/cba/gen/ws/general/anaCliFor/lavoroAutonomo/new",update:"/cba/gen/ws/general/anaCliFor/lavoroAutonomo/update",destroy:"/cba/gen/ws/general/anaCliFor/lavoroAutonomo/delete"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.Spesometro",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCliFor"},{name:"idEsercizio"},{name:"includereInTracciatoCliente"},{name:"includereInTracciatoFornitore"},{name:"descrEsercizio"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/spesometro/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/spesometro/list",create:"/cba/gen/ws/general/anaCliFor/spesometro/new",update:"/cba/gen/ws/general/anaCliFor/spesometro/update",
destroy:"/cba/gen/ws/general/anaCliFor/spesometro/delete"}},autoDestroy:!0});Ext.define("Generali.anaCliFor.store.cboxAnaCliCondPag",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/condPag/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.store.cboxAnaCliFor",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"clcValore",convert:function(a,b){a=b.get("valore");if(b.get("extra")){var c=b.get("extra").split(","),d=!1,e="",g=c[2],h=c[3],c=c[4];g&&"?"!=g&&(e+="CF: "+g,d=!0);h&&"?"!=h&&(e=e+(d?" - ":"")+("PI: "+h),d=!0);c&&"?"!=c&&(e=e+(d?" - ":"")+(""+c));Ext.isEmpty(e)||(a+=" ("+e+")")}return a}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cbox",reader:{type:"json",
messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.anaCliFor.view.Allegato",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridAllegati",reference:"GridAllegati",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:170,store:Ext.create("Generali.anaCliFor.store.Allegato"),viewConfig:{loadMask:!1},title:"ALLEGATI",collapsible:!0,collapseDirection:"left",hideHeaders:!0,columns:[{xtype:"actioncolumn",width:20,
text:"",items:[{iconCls:"icon-allegato",isDisabled:function(a,b,c,d,e){return Ext.isEmpty(e.get("fileName"))}}]},{xtype:"gridcolumn",flex:1,dataIndex:"descrizione"}]},{xtype:"splitter",nonDisabilitare:!0},{xtype:"container",scrollable:!0,border:0,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"form",itemId:"Form",reference:"Form",nonDisabilitare:"L"==this.cbaConfig.permesso?!1:!0,scrollable:!0,padding:"15 0 0 10",border:0,layout:{type:"vbox",align:"stretch"},trackResetOnLoad:!0,items:[{xtype:"numberfield",
hidden:!0,name:"id"},{xtype:"numberfield",hidden:!0,name:"idCliFor"},{xtype:"datefield",itemId:"Data",reference:"Data",maxWidth:180,fieldLabel:"DATA",labelWidth:70,labelClsExtra:"cbaLabel",allowBlank:!1,selectOnFocus:!0,name:"data"},{xtype:"textfield",itemId:"TxtDescrizione",reference:"TxtDescrizione",name:"descrizione",fieldLabel:"DESCRIZIONE",maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel",allowBlank:!1,maxWidth:370,labelWidth:70},{xtype:"displayfield",itemId:"TxtFileName",reference:"TxtFileName",
name:"fileName",labelClsExtra:"cbaLabel",maxLength:100,enforceMaxLength:!0,maxWidth:370,editable:!1}]},{xtype:"container",itemId:"CntAllegato",reference:"CntAllegato",flex:1,layout:{type:"fit"},items:[{xtype:"container",itemId:"FormAllegato",reference:"FormAllegato",border:!1,padding:5,bodyPadding:"5 0 0 0",layout:"hbox",items:[{xtype:"filefield",itemId:"AllegatoUpload",reference:"AllegatoUpload",baseCls:"cba-button-25",buttonOnly:!0,name:"fileData",buttonConfig:{xtype:"filebutton",margin:"0 0 1 0",
cls:"cba-button-25",alwaysOnTop:!0,itemId:"BtnAllega",reference:"BtnAllega",text:traduci("ALLEGA_FILE"),iconCls:"icon-allegato",disabled:"L"==this.cbaConfig.permesso},listeners:{afterrender:function(a){a.fileInputEl.set({accept:StdSipcar.getValidExtensions()})}}},{xtype:"button",itemId:"BtnEliminaAllegato",reference:"BtnEliminaAllegato",cls:"cba-button-25",iconCls:"icon-elimina",margin:"0 0 1 0",text:"ELIMINA",hidden:!0}]}]}]},{xtype:"container",itemId:"CntAnteprima",reference:"CntAnteprima",border:0,
flex:2,layout:{type:"fit"}},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.AnaCliFor",{extend:"Generali.standard.ControlledContainer",itemId:"GEANFOCL",reference:"GEANFOCL",layout:{align:"stretch",type:"hbox"},title:"CLIENTI_FORNITORI",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",width:280,split:!0,title:"RICERCA",itemId:"PnlRicerca",reference:"PnlRicerca",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},padding:5,fieldDefaults:{margin:"0 5 5 0"},nonDisabilitare:!0,
items:[{xtype:"fieldset",title:"TIPO",items:[{xtype:"radiogroup",itemId:"RgbCliFor",reference:"RgbCliFor",vertical:!1,defaults:{margin:"auto 10 auto auto"},columns:3,items:[{boxLabel:"CLIENTE",name:"tipoCliFor",inputValue:"C",cls:"cbaLabel"},{boxLabel:"FORNITORE",name:"tipoCliFor",inputValue:"F",cls:"cbaLabel"},{boxLabel:"ENTRAMBI",name:"tipoCliFor",inputValue:"E",cls:"cbaLabel",checked:!0}]}]},{xtype:"checkboxgroup",flex:1,margin:"0 0 5 0",labelClsExtra:"cbaLabel",items:[{xtype:"checkboxfield",itemId:"CbxFiltroAttivo_T",
reference:"CbxFiltroAttivo_T",boxLabel:"ATTIVO",checked:!0,cls:"cbaLabel"},{xtype:"checkboxfield",itemId:"CbxFiltroAttivo_F",reference:"CbxFiltroAttivo_F",boxLabel:"NON_ATTIVO",checked:!0,cls:"cbaLabel"}]},{xtype:"radiogroup",flex:1,margin:"0 0 5 0",labelWidth:65,itemId:"RgbFiltro",reference:"RgbFiltro",labelClsExtra:"cbaLabel",layout:{type:"column"},fieldLabel:"CERCA_PER",items:[{xtype:"radiofield",width:120,name:"RgbFiltro",boxLabel:"RAGIONE_SOCIALE",inputValue:"RS",checked:!0,cls:"cbaLabel"},{xtype:"radiofield",
width:120,name:"RgbFiltro",boxLabel:"PARTITA_IVA",inputValue:"PI",cls:"cbaLabel"},{xtype:"radiofield",width:120,fieldLabel:"",name:"RgbFiltro",boxLabel:"CODICE_FISCALE",inputValue:"CF",cls:"cbaLabel"}]},{xtype:"checkboxfield",boxLabel:"SALTUARIO",itemId:"ChbSaltuarioRic",reference:"ChbSaltuarioRic",checked:!1,hidden:!0,cls:"cbaLabel"},{xtype:"textfield",itemId:"TxtCercaCliFor",reference:"TxtCercaCliFor",flex:1,fieldLabel:"",emptyText:"CERCA",enableKeyEvents:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",
itemId:"CbComune",reference:"CbComune",flex:1,labelWidth:70,fieldLabel:"COMUNE",displayField:"valore",valueField:"codice",queryMode:"local",minChars:3,store:Ext.create("Generali.comuni.store.cboxComuniGen",{proxy:{url:"/cba/gen/ws/general/comuni/list/cbox"},autoLoad:!0}),labelClsExtra:"cbaLabel"},{xtype:"container",height:45,itemId:"PnlBottoni",reference:"PnlBottoni",layout:{type:"hbox"},items:[{xtype:"button",cls:"btnLarge",itemId:"BtnCerca",reference:"BtnCerca",formBind:!0,margin:"0 5 0 0",width:80,
iconCls:"icon-ricerca",scale:"large",text:"CERCA"},{xtype:"button",cls:"btnLarge",itemId:"BtnImport",reference:"BtnImport",formBind:!0,margin:"0 5 0 0",iconCls:"icon-elabora",scale:"large",text:"IMPORT_ANACLIFOR_CSV"}]}]},{xtype:"gridpanel",itemId:"GridCliFo",reference:"GridCliFo",store:Ext.create("Generali.anaCliFor.store.AnaCliFor",{autoDestroy:!1}),border:0,flex:1,plugins:[{ptype:"bufferedrenderer"}],columns:[{xtype:"gridcolumn",dataIndex:"descrizione",text:"RAGIONE_SOCIALE",sortable:!1,flex:1}],
viewConfig:{trackOver:!1,loadMask:!1,getRowClass:function(a,b){if("T"!=a.get("attivo"))return"non_attivi"}},dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",itemId:"PTGridCliFo",reference:"PTGridCliFo"}]}]},{xtype:"splitter",nonDisabilitare:!0},{xtype:"panel",flex:1,layout:"fit",border:0,itemId:"PnlAnagrafica",reference:"PnlAnagrafica"}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Anagrafica",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"form",flex:.6,bodyPadding:5,fieldDefaults:{margin:"0 5 5 0"},overflowX:"hidden",overflowY:"auto",layout:{type:"vbox",align:"stretch"},border:0,itemId:"Form",reference:"Form",title:"",trackResetOnLoad:!0,items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",margin:"0 0 5 0"},
{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idOrganizzazione"},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"ATTIVO",inputValue:"T",uncheckedValue:"F",name:"attivo",itemId:"ChbAttivo",reference:"ChbAttivo",width:100,cls:"cbaLabel"},{xtype:"fieldset",title:"TIPO",items:[{xtype:"radiogroup",title:"TIPOLOGIA",itemId:"RgbTipoClifor",reference:"RgbTipoClifor",width:300,items:[{xtype:"radiofield",name:"tipoCliFor",boxLabel:"CLIENTE",
inputValue:"C",itemId:"RgbTipoClifor_C",reference:"RgbTipoClifor_C",cls:"cbaLabel"},{xtype:"radiofield",name:"tipoCliFor",boxLabel:"FORNITORE",inputValue:"F",itemId:"RgbTipoClifor_F",reference:"RgbTipoClifor_F",cls:"cbaLabel"},{xtype:"radiofield",name:"tipoCliFor",boxLabel:"ENTRAMBI",inputValue:"E",itemId:"RgbTipoClifor_E",reference:"RgbTipoClifor_E",cls:"cbaLabel"}]}]}]},{xtype:"container",items:[{xtype:"radiogroup",fieldLabel:"SOGGETTO",labelClsExtra:"cbaLabel",labelWidth:105,width:315,columns:2,
itemId:"RgbSoggetto",reference:"RgbSoggetto",items:[{boxLabel:"PUBBLICO",name:"tipoSoggetto",inputValue:"P",cls:"cbaLabel",checked:!0},{boxLabel:"PRIVATO",name:"tipoSoggetto",inputValue:"R",cls:"cbaLabel"}]},{xtype:"textfield",width:526,fieldLabel:"RAGIONE_SOCIALE",name:"descrizione",itemId:"TxtRagioneSociale",reference:"TxtRagioneSociale",allowBlank:!1,maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxCodFiscNazione",reference:"CbxCodFiscNazione",store:Ext.create("Generali.nazioni.store.cboxNazioniGen"),
width:526,fieldLabel:"NAZIONE",name:"codFiscNazione",displayField:"valore",queryParam:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"container",flex:1,layout:{type:"hbox"},items:[{xtype:"textfield",fieldStyle:"text-transform: uppercase",width:270,fieldLabel:"CODICE_FISCALE",enableKeyEvents:!0,name:"codFiscale",itemId:"TxtCodFiscale",reference:"TxtCodFiscale",validator:function(a){var b=!0,d=this.up("form").getForm(),e=d.getRecord()?"T"==d.getRecord().get("personaFisica"):
!1,d=d.getRecord()?d.getRecord().get("codFiscNazione"):"0";e&&"0"===d&&(b=ControllaCF(a));return b},maxLength:16,cbaConfig:{erroreBloccante:!1},labelClsExtra:"cbaLabel"},{xtype:"displayfield",labelWidth:80,isFormField:!1,renderer:function(a){return'<span style="font-weight: bold;">'+traduci("PARTITA_IVA")+"</span>"}},{xtype:"displayfield",width:25,itemId:"LblSiglaNazione",reference:"LblSiglaNazione",name:"siglaNazionePartitaIva",renderer:function(a){return'<span style="font-weight: bold;">'+a+"</span>"}},
{xtype:"textfield",width:150,labelWidth:0,itemId:"TxtPartitaIva",reference:"TxtPartitaIva",name:"partitaIva",regexText:traduci("MSG_PARITAIVA_ERRATA"),labelClsExtra:"cbaLabel"}]},{xtype:"comboModifica",itemId:"CbxIdCategoria",reference:"CbxIdCategoria",valueField:"codice",displayField:"valore",queryMode:"local",width:526,fieldLabel:"CATEGORIA",name:"idCategoria",labelClsExtra:"cbaLabel",hidden:!0},{xtype:"container",flex:1,layout:"column",items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"RITENUTA",
itemId:"ChbRitenuta",reference:"ChbRitenuta",inputValue:"T",uncheckedValue:"F",name:"ritenuta",cls:"cbaLabel"},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"REGIME_MINIMI",itemId:"ChbRegMinimi",reference:"ChbRegMinimi",inputValue:"T",uncheckedValue:"F",name:"regimeMinimi",readOnly:!0,cls:"cbaLabel"},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"CP_OPPOSIZIONE_730_TS",inputValue:"T",uncheckedValue:"F",name:"escludiDa730",itemId:"ChbTs730",reference:"ChbTs730",cls:"cbaLabel"},{xtype:"checkboxfield",
fieldLabel:"",boxLabel:"CP_ESCLUDI_DA_IND_TEMP",inputValue:"T",uncheckedValue:"F",name:"escludiDaIndTemp",itemId:"ChbIndTemp",reference:"ChbIndTemp",cls:"cbaLabel"}]},{xtype:"textfield",width:526,fieldLabel:"COD_IDENTIFICATIVO_ESTERO",name:"codIdentificativoEstero",itemId:"CodIdEstero",reference:"CodIdEstero",maxLength:30,enforceMaxLength:!0,enableKeyEvents:!0,labelClsExtra:"cbaLabel",hidden:!0},{xtype:"textfield",width:526,labelWidth:130,fieldLabel:"CODICE_ENTE_PAGOPA",name:"codentePagoPa",itemId:"TxtCodEntePagoPa",
reference:"TxtCodEntePagoPa",allowBlank:!0,maxLength:11,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"fieldset",title:"DATI_PERSONA_FISICA",width:650,layout:{align:"stretch",type:"vbox"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"PERSONA_FISICA",itemId:"ChbPersona_Fisica",reference:"ChbPersona_Fisica",checked:!1,inputValue:"T",uncheckedValue:"F",name:"personaFisica",cls:"cbaLabel"},{xtype:"container",layout:{type:"hbox",align:"stretch"},itemId:"CntPersFis1",reference:"CntPersFis1",
items:[{xtype:"container",width:300,layout:{align:"stretch",type:"vbox"},items:[{xtype:"textfield",width:270,fieldLabel:"COGNOME",name:"personaFisicaCognome",itemId:"PF_Cognome",reference:"PF_Cognome",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel",validator:function(b){return a.controller.confrontoCF(b,"cognome")}},{xtype:"textfield",width:270,fieldLabel:"NOME",itemId:"PF_Nome",reference:"PF_Nome",name:"personaFisicaNome",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel",validator:function(b){return a.controller.confrontoCF(b,
"nome")}}]},{xtype:"container",width:250,layout:{align:"stretch",type:"vbox"},items:[{xtype:"radiogroup",width:350,labelWidth:95,layout:{align:"stretch",type:"hbox"},getErrors:function(){var a=[],c=this.validator;!this.allowBlank&&Ext.isEmpty(this.getChecked())&&a.push(this.blankText);Ext.isFunction(c)&&(msg=c.call(this,this.getValue()),!0!==msg&&a.push(msg));return a},validator:function(b){return a.controller.confrontoCF(b,"sesso")},msgTarget:"side",autoFitErrors:!1,itemId:"PF_Sesso",reference:"PF_Sesso",
labelClsExtra:"cbaLabel",fieldLabel:"SESSO",items:[{xtype:"radiofield",name:"personaFisicaSesso",width:80,boxLabel:"M",inputValue:"M",cls:"cbaLabel"},{xtype:"radiofield",name:"personaFisicaSesso",width:80,boxLabel:"F",inputValue:"F",cls:"cbaLabel"}]},{xtype:"datefield",width:220,labelWidth:95,fieldLabel:"DATA_NASCITA",name:"personaFisicaDtNascita",itemId:"PF_DtNascita",reference:"PF_DtNascita",labelClsExtra:"cbaLabel",validator:function(b){return a.controller.confrontoCF(b,"dataNascita")}}]}]},{xtype:"container",
flex:1,itemId:"CntPersFis2",reference:"CntPersFis2",layout:{type:"hbox"},items:[{xtype:"combobox",itemId:"PF_ComuneNascita",reference:"PF_ComuneNascita",width:295,fieldLabel:"COMUNE_NASCITA",name:"personaFisicaIstatComuneNascita",displayField:"valore",minChars:3,queryParam:"valore",store:Ext.create("Generali.comuni.store.cboxComuniGen"),valueField:"codice",labelClsExtra:"cbaLabel",validator:function(b){return a.controller.confrontoCF(b,"comune")}},{xtype:"combobox",itemId:"PF_NazioneNascita",reference:"PF_NazioneNascita",
width:300,labelWidth:95,fieldLabel:"NAZIONE_NASCITA",name:"personaFisicaCodFiscNazioneNascita",displayField:"valore",queryParam:"valore",queryMode:"local",store:Ext.create("Generali.nazioni.store.cboxNazioniGen"),valueField:"codice",labelClsExtra:"cbaLabel",validator:function(b){return a.controller.confrontoCF(b,"nazione")}}]}]},{xtype:"textfield",height:30,flex:1,width:650,layout:{align:"stretch"},fieldLabel:"NOTE",labelWidth:50,name:"note",enforceMaxLength:!0,maxLength:2E3,labelClsExtra:"cbaLabel"},
{xtype:"fieldset",title:"COMMISSIONI_SPESA",itemId:"FsTipoSpese",reference:"FsTipoSpese",width:700,layout:{align:"stretch",type:"vbox"},items:[{xtype:"radiogroup",title:"TIPO_SPESE",itemId:"RgbTipoSpese",reference:"RgbTipoSpese",width:300,items:[{xtype:"radiofield",name:"codiceSpeseTrasm",boxLabel:"SP_NESSUNA",inputValue:"1",itemId:"RgbTipoSpese_1",reference:"RgbTipoSpese_1",cls:"cbaLabel"},{xtype:"radiofield",name:"codiceSpeseTrasm",boxLabel:"SP_ESENTE",inputValue:"2",itemId:"RgbTipoSpese_2",reference:"RgbTipoSpese_2",
cls:"cbaLabel"},{xtype:"radiofield",name:"codiceSpeseTrasm",boxLabel:"SP_CARICO_FORNITORE",inputValue:"3",itemId:"RgbTipoSpese_3",reference:"RgbTipoSpese_3",cls:"cbaLabel"},{xtype:"radiofield",name:"codiceSpeseTrasm",boxLabel:"SP_CARICO_ENTE",inputValue:"4",itemId:"RgbTipoSpese_4",reference:"RgbTipoSpese_4",cls:"cbaLabel"}]}]},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"SALTUARIO",itemId:"ChbSaltuario",reference:"ChbSaltuario",checked:!1,inputValue:"T",uncheckedValue:"F",name:"flagSaltuario",hidden:!0,
cls:"cbaLabel"}]}]},{xtype:"tabpanel",itemId:"Paginatore",reference:"Paginatore",flex:.4,items:[{xtype:"panel",itemId:"PnlIndirizzi",reference:"PnlIndirizzi",title:"INDIRIZZI",cbaConfig:{url:"Generali.anaCliFor.view.Indirizzi",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlCategorie",reference:"PnlCategorie",title:"CATEGORIE",cbaConfig:{url:"Generali.anaCliFor.view.Categorie",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlContatti",reference:"PnlContatti",
title:"CONTATTI",cbaConfig:{url:"Generali.anaCliFor.view.Contatti",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlContab",reference:"PnlContab",title:"CONTABILITA",cbaConfig:{url:"Generali.anaCliFor.view.Contab",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlCondPag",reference:"PnlCondPag",title:"CONDIZIONI_DI_PAGAMENTO",cbaConfig:{url:"Generali.anaCliFor.view.CondPag",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",
itemId:"PnlCupCig",reference:"PnlCupCig",title:"CODICI_CIG_CUP",cbaConfig:{url:"Generali.anaCliFor.view.CupCig",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlDurc",reference:"PnlDurc",title:"DURC",cbaConfig:{url:"Generali.anaCliFor.view.GestioneDurc",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlFattEle",reference:"PnlFattEle",title:"FATTURAZIONE_ELETTRONICA",cbaConfig:{url:"Generali.anaCliFor.view.FattElettronica",permesso:a.cbaConfig.permesso},
layout:{type:"fit"}},{xtype:"panel",itemId:"PnlLavAutonomo",reference:"PnlLavAutonomo",title:"LAVORO_AUTONOMO",cbaConfig:{url:"Generali.anaCliFor.view.LavAutonomo",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlSpesometro",reference:"PnlSpesometro",title:"SPESOMETRO",hidden:!0,cbaConfig:{url:"Generali.anaCliFor.view.Spesometro",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlPcc",reference:"PnlPcc",title:"CERTIFICAZIONE_CREDITI",cbaConfig:{url:"Generali.anaCliFor.view.CertificazionePcc",
permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlDelegati",reference:"PnlDelegati",title:"DELEGATI",cbaConfig:{url:"Generali.anaCliFor.view.Delegati",permesso:a.cbaConfig.permesso},layout:{type:"fit"}},{xtype:"panel",itemId:"PnlAllegati",reference:"PnlAllegati",title:"ALLEGATI",cbaConfig:{url:"Generali.anaCliFor.view.Allegato",permesso:a.cbaConfig.permesso},layout:{type:"fit"}}]}]}]});a.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Categorie",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridCategorie",reference:"GridCategorie",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:170,store:Ext.create("Generali.anaCliFor.store.Categoria"),viewConfig:{loadMask:!1},columns:[{xtype:"datecolumn",text:"DATA_DAL",flex:1,dataIndex:"dataDal",format:"d/m/Y",
width:90}]},{xtype:"form",itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,viewConfig:{loadMask:!1},bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"container",flex:1,layout:{type:"column"},items:[{xtype:"datefield",width:170,labelWidth:55,fieldLabel:"DATA_DAL",name:"dataDal",allowBlank:!1,maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"datefield",
width:170,labelWidth:50,fieldLabel:"DATA_AL",name:"dataAl",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"container",flex:1,layout:{type:"column",align:"stretch"},items:[{xtype:"comboModifica",itemId:"CbxIdCategoria",reference:"CbxIdCategoria",width:500,labelWidth:55,fieldLabel:"CATEGORIA",name:"idCategoria",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});
this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.CertificazionePcc",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridPcc",reference:"GridPcc",width:200,overflowX:"hidden",overflowY:"auto",store:Ext.create("Generali.anaCliFor.store.CertificazionePcc"),columns:[{xtype:"gridcolumn",text:"ESERCIZIO",flex:1,dataIndex:"descrEsercizio"}],viewConfig:{loadMask:!1}},{xtype:"form",
itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"ESERCIZIO",editable:!1,allowBlank:!1,itemId:"CBEsercizio",reference:"CBEsercizio",name:"idEsercizio",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont"),
labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"ESCLUDI_DA_TRACCIATO_PCC",labelWidth:110,inputValue:"T",uncheckedValue:"F",name:"escluso",cls:"cbaLabel"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.CondPag",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridCondPag",reference:"GridCondPag",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:170,store:Ext.create("Generali.anaCliFor.store.CondPag"),viewConfig:{loadMask:!1},columns:[{xtype:"datecolumn",text:"DATA_DAL",flex:1,dataIndex:"dataDal",format:"d/m/Y",
width:90},{xtype:"gridcolumn",text:"TIPO",flex:1,dataIndex:"clcTipo"}]},{xtype:"form",itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,viewConfig:{loadMask:!1},bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"container",flex:1,layout:{type:"column"},items:[{xtype:"datefield",width:170,labelWidth:55,fieldLabel:"DATA_DAL",name:"dataDal",allowBlank:!1,maxLength:10,
enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"datefield",width:170,labelWidth:50,fieldLabel:"DATA_AL",name:"dataAl",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"PREDEFINITO",inputValue:"T",uncheckedValue:"F",name:"predefinito",itemId:"ChbPredefinito",reference:"ChbPredefinito",cls:"cbaLabel"}]},{xtype:"container",flex:1,bodyPadding:10,layout:{type:"column",align:"stretch"},items:[{xtype:"fieldset",title:"CONDIZIONE_DI_PAGAMENTO",width:480,labelClsExtra:"cbaLabel",
layout:{type:"column"},items:[{xtype:"radiofield",name:"tipoCliFor",itemId:"RbCliente",reference:"RbCliente",cls:"cbaLabel",boxLabel:"CLIENTE",width:60,inputValue:"C"},{xtype:"radiofield",name:"tipoCliFor",itemId:"RbFornitore",reference:"RbFornitore",cls:"cbaLabel",boxLabel:"FORNITORE",width:100,inputValue:"F"},{xtype:"comboModifica",itemId:"CbxIdCondPag",reference:"CbxIdCondPag",width:300,labelWidth:40,fieldLabel:"TIPO",name:"idCondPag",displayField:"valore",queryMode:"local",valueField:"codice",
labelClsExtra:"cbaLabel"}]}]},{xtype:"fieldset",title:"IBAN",items:[{xtype:"container",layout:"column",items:[{xtype:"combobox",itemId:"CbxCodFiscNazioneIban",reference:"CbxCodFiscNazioneIban",labelWidth:75,store:Ext.create("Generali.nazioni.store.cboxNazioniGen",{autoLoad:!0}),fieldLabel:"NAZIONE",name:"codFiscNazioneIban",displayField:"valore",queryParam:"valore",minChars:0,valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"button",itemId:"BtnBanche",reference:"BtnBanche",cls:"cba-button-25",
iconCls:"icon-chain",text:"BANCHE"}]},{xtype:"container",layout:"column",items:[{xtype:"textfield",maxLength:4,enforceMaxLength:!0,labelAlign:"top",width:70,fieldLabel:"CIN_EUR",name:"cinEuro",itemId:"TxtCinEuro",reference:"TxtCinEuro",labelClsExtra:"cbaLabel"},{xtype:"textfield",maxLength:1,enforceMaxLength:!0,labelAlign:"top",width:30,fieldLabel:"CIN",name:"cin",itemId:"TxtCin",reference:"TxtCin",labelClsExtra:"cbaLabel"},{xtype:"combobox",enableRegEx:!0,itemId:"CboxIdBanca",reference:"CboxIdBanca",
width:200,labelAlign:"top",fieldLabel:"ABI",name:"abiSportello",listConfig:{width:300,loadMask:!1},labelClsExtra:"cbaLabel",minChars:2,displayField:"clcDescrizione",queryParam:"clcDescrizione",store:Ext.create("Generali.banche.store.cboxBancheABICAB",{autoLoad:!0}),valueField:"codice",queryMode:"local"},{xtype:"combobox",itemId:"CboxIdSportello",reference:"CboxIdSportello",width:200,listConfig:{width:300,loadMask:!1},labelAlign:"top",fieldLabel:"CAB",name:"idSportello",labelClsExtra:"cbaLabel",minChars:2,
displayField:"clcDescrizione",queryParam:"clcDescrizione",store:Ext.create("Generali.banche.store.cboxSportelliABICAB"),valueField:"codice",queryMode:"local"},{xtype:"textfield",width:120,labelAlign:"top",fieldLabel:"CONTO",name:"conto",itemId:"TxtConto",reference:"TxtConto",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:250,labelAlign:"top",fieldLabel:"IBAN_COMPLETO",name:"ibanCompleto",itemId:"TxtIbanCompleto",reference:"TxtIbanCompleto",readOnly:!0,maxLength:35,
enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:250,labelAlign:"top",fieldLabel:"DESCRIZIONE",name:"descrizione",itemId:"TxtDescrizione",reference:"TxtDescrizione",maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:110,labelAlign:"top",itemId:"TxtBic",reference:"TxtBic",fieldLabel:"BIC",name:"bic",maxLength:11,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}]},{xtype:"fieldset",title:"SDD",itemId:"FsRid",reference:"FsRid",flex:1,layout:{type:"column"},
items:[{xtype:"textfield",maxLength:60,enforceMaxLength:!0,labelAlign:"top",width:150,fieldLabel:"INTESTATARIO_SDD",name:"ridIntestatario",labelClsExtra:"cbaLabel"},{xtype:"textfield",maxLength:16,enforceMaxLength:!0,labelAlign:"top",width:150,fieldLabel:"CODICE_FISCALE",name:"ridCodFiscaleIntestatario",labelClsExtra:"cbaLabel"},{xtype:"textfield",maxLength:140,enforceMaxLength:!0,labelAlign:"top",width:150,fieldLabel:"DELEGATO_SDD",name:"ridDelegato",labelClsExtra:"cbaLabel"},{xtype:"textfield",
maxLength:140,enforceMaxLength:!0,labelAlign:"top",width:150,fieldLabel:"CODICE_FISCALE",name:"ridCodFiscaleDelegato",labelClsExtra:"cbaLabel"},{xtype:"datefield",maxLength:10,enforceMaxLength:!0,labelAlign:"top",width:150,fieldLabel:"DATA_SOTTOSCRIZIONE",name:"ridDataSottoscrizione",labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Contab",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridContab",reference:"GridContab",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:200,store:Ext.create("Generali.anaCliFor.store.Contab"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",text:"ESERCIZIO",flex:1,dataIndex:"descrEsercizio"}]},{xtype:"form",
itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"ESERCIZIO",editable:!1,itemId:"CBEsercizio",reference:"CBEsercizio",name:"idEsercizio",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont"),
labelClsExtra:"cbaLabel"},{xtype:"comboModifica",itemId:"CbxSottoContoAcquisti",reference:"CbxSottoContoAcquisti",minChars:3,width:378,labelWidth:110,fieldLabel:"COSTI",name:"sottoContoAcquisti",displayField:"valore",queryParam:"descrizione",valueField:"codice",cbaConfig:{modificaClick:function(){}},labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxQuintoLivelloDebiti",reference:"CbxQuintoLivelloDebiti",minChars:3,width:360,labelWidth:110,fieldLabel:"DEBITI",name:"quintoLivelloDebiti",displayField:"valore",
queryParam:"descrizione",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxSottoContoVendite",reference:"CbxSottoContoVendite",minChars:3,width:360,labelWidth:110,fieldLabel:"RICAVI",name:"sottoContoVendite",displayField:"valore",queryParam:"descrizione",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxQuintoLivelloCrediti",reference:"CbxQuintoLivelloCrediti",minChars:3,width:360,labelWidth:110,fieldLabel:"CREDITI",name:"quintoLivelloCrediti",displayField:"valore",
queryParam:"descrizione",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"comboModifica",itemId:"CbxIdAliquotaIva",reference:"CbxIdAliquotaIva",width:378,labelWidth:110,fieldLabel:"IVA",name:"idAliquotaIva",displayField:"valore",queryMode:"local",valueField:"codice",cbaConfig:{modificaClick:function(){}},labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxidContoBanca",reference:"CbxidContoBanca",width:360,labelWidth:110,fieldLabel:"CONTO_BANCA_APPOGGIO",name:"idContoBanca",displayField:"valore",
store:Ext.create("Generali.pianodeiconti.store.DesSottoconto"),queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Contatti",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridContatti",reference:"GridContatti",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:170,store:Ext.create("Generali.anaCliFor.store.Contatti"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",text:"RIFERIMENTO",flex:1,dataIndex:"contatto"}]},
{xtype:"form",itemId:"Form",reference:"Form",overflowX:"auto",overflowY:"auto",trackResetOnLoad:!0,layout:"hbox",bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"container",items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"textfield",width:350,fieldLabel:"RIFERIMENTO",name:"contatto",allowBlank:!1,maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:350,fieldLabel:"INDIRIZZO",
name:"indirizzo",maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"numberfield",fieldLabel:"NUMERO",width:170,name:"civico",allowDecimals:!1,useThousandSeparator:!1,labelClsExtra:"cbaLabel"},{xtype:"combobox",width:350,minChars:3,fieldLabel:"COMUNE",itemId:"CBComune",reference:"CBComune",store:Ext.create("Generali.comuni.store.cboxComuniGen"),name:"comune",valueField:"codice",displayField:"valore",queryParam:"valore",labelClsExtra:"cbaLabel"},{xtype:"textfield",width:170,fieldLabel:"CAP",
itemId:"Cap",reference:"Cap",fieldStyle:"text-align: right",name:"cap",maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",width:350,fieldLabel:"NAZIONE",itemId:"CBNazione",reference:"CBNazione",minChars:0,store:Ext.create("Generali.nazioni.store.cboxNazioniGen",{autoLoad:!0}),name:"nazione",displayField:"valore",queryParam:"valore",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"textfield",width:350,fieldLabel:"NOTE",name:"note",maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},
{xtype:"container",items:[{xtype:"textfield",width:350,fieldLabel:"TELEFONO",name:"telefono",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:350,fieldLabel:"CELLULARE",name:"cellulare",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:350,fieldLabel:"FAX",name:"fax",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",vtype:"email",width:350,fieldLabel:"EMAIL",name:"mail",maxLength:200,enforceMaxLength:!0,
labelClsExtra:"cbaLabel",listeners:{change:function(a,b,c,d){c=!0;b&&a.isValid()&&(Ext.isEmpty(b)||Ext.isEmpty(b.trim())||(c=!1));a.triggers.change.setHidden(c)}},triggers:{change:{cls:"icon-email16",hidden:!0,handler:function(a){if(!Ext.isEmpty(a.getValue())&&a.isValid()){var b=document.createElement("a");b.href="mailto:"+a.getValue();b.target="_blank";b.click()}}}}},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"MAIL_PREDEFINITA_ORDINI",inputValue:"T",uncheckedValue:"F",name:"mailPredefinitaOrdini",
cls:"cbaLabel"},{xtype:"textfield",vtype:"email",width:350,fieldLabel:"EMAIL_PEC",name:"pec",maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel",listeners:{change:function(a,b,c,d){c=!0;b&&a.isValid()&&(Ext.isEmpty(b)||Ext.isEmpty(b.trim())||(c=!1));a.triggers.change.setHidden(c)}},triggers:{change:{cls:"icon-email16",hidden:!0,handler:function(a){!Ext.isEmpty(a.getValue())&&a.isValid()&&window.open("mailto:"+a.getValue(),"Invia E-mail","_self").close()}}}},{xtype:"textfield",vtype:"url",width:350,
fieldLabel:"SITO",name:"web",maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.CupCig",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridCupCig",reference:"GridCupCig",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:280,store:Ext.create("Generali.anaCliFor.store.CupCig"),viewConfig:{loadMask:!1},columns:[{xtype:"datecolumn",text:"DATA_DAL",dataIndex:"dataDal",format:"d/m/Y",width:80},
{xtype:"datecolumn",text:"DATA_AL",dataIndex:"dataAl",format:"d/m/Y",width:80},{xtype:"gridcolumn",text:"CUP_CIG",flex:1,renderer:function(a,b,c,d,e,g,h){a=Ext.isEmpty(c.get("cig"))?"":c.get("cig");c=Ext.isEmpty(c.get("cup"))?"":c.get("cup");return a+(Ext.isEmpty(c)?"":" / "+c)}}]},{xtype:"form",itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},
{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"container",layout:{type:"column"},items:[{xtype:"datefield",width:220,labelWidth:90,fieldLabel:"DATA_DAL",name:"dataDal",allowBlank:!1,maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"datefield",width:220,labelWidth:90,fieldLabel:"DATA_AL",name:"dataAl",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"PREDEFINITO",inputValue:"T",uncheckedValue:"F",name:"predefinito",cls:"cbaLabel"}]},
{xtype:"container",autoScroll:!0,flex:1,layout:"hbox",items:[{xtype:"textfield",width:220,labelWidth:90,fieldLabel:"CIG",name:"cig",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"datefield",width:220,labelWidth:90,fieldLabel:"DATA_PUB_BANDO",name:"dataPubblicazioneBando",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"container",autoScroll:!0,flex:1,layout:"hbox",items:[{xtype:"textfield",width:220,labelWidth:90,fieldLabel:"CUP",name:"cup",maxLength:15,enforceMaxLength:!0,
labelClsExtra:"cbaLabel"},{xtype:"numberfield",width:220,labelWidth:90,fieldLabel:"IMPORTO_AGGIUDICAZIONE",name:"importoAggiudicazioneBando",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"numberfield",width:220,labelWidth:90,fieldLabel:"IMPORTO",name:"importoCig",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxProcedura",reference:"CbxProcedura",width:420,labelWidth:90,fieldLabel:"PROCEDURA",name:"procedura",displayField:"valore",store:Ext.create("Generali.store.TabProcedura",
{sorters:[{property:"valore",direction:"ASC"}]}),queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"textfield",width:420,labelWidth:90,fieldLabel:"OGGETTO_BANDO",name:"nomeBando",maxLength:100,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:370,labelWidth:90,fieldLabel:"IBAN",name:"ibanDedicato",maxLength:27,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textarea",width:420,labelWidth:90,fieldLabel:"NOTE",name:"note",maxLength:255,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},
{xtype:"container",layout:{type:"column"},items:[{xtype:"checkboxfield",fieldLabel:"RITENUTA05",itemId:"Ritenuta",reference:"Ritenuta",width:220,labelWidth:90,inputValue:"T",uncheckedValue:"F",name:"ritenuta",labelClsExtra:"cbaLabel"}]},{xtype:"datefield",width:220,labelWidth:90,itemId:"DataScad",reference:"DataScad",fieldLabel:"DATA_SCAD",name:"dataScadenzaDurc",maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});
this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Delegati",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridDelegati",reference:"GridDelegati",overflowX:"hidden",overflowY:"auto",width:100,store:Ext.create("Generali.anaCliFor.store.Delegati"),viewConfig:{loadMask:!1},columns:[{xtype:"datecolumn",text:"DATA_DAL",flex:1,dataIndex:"dataDal",format:"d/m/Y"}]},{xtype:"form",
itemId:"Form",reference:"Form",trackResetOnLoad:!0,overflowX:"hidden",overflowY:"auto",viewConfig:{loadMask:!1},bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"datefield",width:200,labelWidth:70,fieldLabel:"DATA_DAL",name:"dataDal",allowBlank:!1,maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"container",layout:{align:"stretch",type:"column"},items:[{xtype:"textfield",width:300,
labelWidth:70,fieldLabel:"DELEGATO",name:"delegato",allowBlank:!1,maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:300,labelWidth:100,fieldLabel:"CODICE_FISCALE",name:"codiceFiscale",allowBlank:!1,maxLength:16,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.FattElettronica",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){var a="P"==this.tipoSoggetto,b="R"==this.tipoSoggetto;Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridSelezione",reference:"GridSelezione",overflowX:"hidden",overflowY:"auto",layout:{align:"stretch"},width:170,store:Ext.create("Generali.anaCliFor.store.FattElettronica"),viewConfig:{loadMask:!1},hideHeaders:!1,columns:[{xtype:"gridcolumn",
text:"ELENCO",flex:1,width:90,renderer:function(c,d,e,g,h,k,l){var m;b?m=Ext.isEmpty(e.get("codice"))?e.get("pec"):e.get("codice"):a&&(m=e.get("descrUfficio"));return m}}]},{xtype:"splitter"},{xtype:"container",nonDisabilitare:"L"==this.cbaConfig.permesso?!1:!0,scrollable:!0,border:0,flex:1,layout:{type:"hbox"},items:[{xtype:"form",itemId:"Form",reference:"Form",border:0,padding:"15 0 0 10",flex:1,trackResetOnLoad:!0,items:[{xtype:"numberfield",hidden:!0,name:"id"},{xtype:"container",itemId:"CntPA",
reference:"CntPA",border:0,disabled:b,hidden:b,items:[{xtype:"textfield",itemId:"TxCodUfficio",reference:"TxCodUfficio",width:350,labelWidth:150,fieldLabel:"CODICE_UFFICIO",name:"codUfficio",labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:6,enforceMaxLength:!0,disabled:b},{xtype:"textfield",itemId:"TxDescrUfficio",reference:"TxDescrUfficio",width:350,labelWidth:150,fieldLabel:"DESCRIZIONE_UFFICIO",name:"descrUfficio",labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:200,enforceMaxLength:!0,disabled:b}]},
{xtype:"container",itemId:"CntB2B",reference:"CntB2B",border:0,disabled:a,hidden:a,items:[{xtype:"textfield",itemId:"TxCodice",reference:"TxCodice",width:350,labelWidth:150,fieldLabel:"CODICE",name:"codice",labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:7,enforceMaxLength:!0,disabled:a},{xtype:"textfield",itemId:"TxPec",reference:"TxPec",width:350,labelWidth:150,fieldLabel:"PEC",name:"pec",allowBlank:!1,maxLength:256,enforceMaxLength:!0,labelClsExtra:"cbaLabel",disabled:a}]},{xtype:"checkboxfield",
itemId:"ChbAttivo",reference:"ChbAttivo",fieldLabel:"",boxLabel:"ATTIVO",inputValue:"T",uncheckedValue:"F",name:"attivo",width:100,cls:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.GestioneDurc",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridDurc",reference:"GridDurc",overflowX:"hidden",overflowY:"auto",collapsible:!0,collapseDirection:"left",hideHeaders:!0,layout:{align:"stretch"},width:200,store:Ext.create("Generali.anaCliFor.store.GestioneDurc"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",
dataIndex:"descrizione",flex:1}]},{xtype:"splitter",nonDisabilitare:!0},{xtype:"form",itemId:"Form",reference:"Form",margin:"15 5 5 5",nonDisabilitare:"S"!=a.cbaConfig.permesso?!1:!0,scrollable:!0,border:0,layout:{type:"vbox",align:"stretch"},trackResetOnLoad:!0,items:[{xtype:"numberfield",hidden:!0,name:"id"},{xtype:"numberfield",hidden:!0,name:"idCliFor"},{xtype:"datefield",fieldLabel:"DATA_RICHIESTA",labelClsExtra:"cbaLabel",allowBlank:!1,selectOnFocus:!0,name:"dataRichiesta"},{xtype:"datefield",
fieldLabel:"DATA_SCADENZA",labelClsExtra:"cbaLabel",allowBlank:!1,selectOnFocus:!0,name:"dataScadenza"},{xtype:"textarea",name:"descrizione",labelAlign:"top",fieldLabel:"DESCRIZIONE",maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel",height:50},{xtype:"textfield",margin:"10 auto 10 auto",readOnly:!0,name:"fileName",labelClsExtra:"cbaLabel",triggers:{triggerText:{cls:"icon-elimina"}},listeners:{afterrender:function(){var b=this.getTrigger("triggerText").getEl();b.dom.setAttribute("data-qtip",
traduci("ELIMINA"));b.on({click:a.controller.eliminaAllegato.bind(a.controller)})},change:function(a,c,d,e){a.triggers.triggerText.setHidden(Ext.isEmpty(c)||Ext.isEmpty(c.trim()))}}},{xtype:"container",layout:"column",items:[{xtype:"filebutton",itemId:"BtnAllega",reference:"BtnAllega",cls:"cba-button-25",iconCls:"icon-allegato",text:"ALLEGA_FILE"}]}]},{xtype:"container",itemId:"CntAnteprima",reference:"CntAnteprima",layout:"fit",flex:1},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
width:120}]}]});a.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Indirizzi",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridIndirizzi",reference:"GridIndirizzi",overflowX:"hidden",overflowY:"auto",width:100,store:Ext.create("Generali.anaCliFor.store.Indirizzi"),viewConfig:{loadMask:!1},columns:[{xtype:"datecolumn",text:"DATA_DAL",flex:1,dataIndex:"dataDal",format:"d/m/Y"}]},{xtype:"form",
itemId:"Form",reference:"Form",trackResetOnLoad:!0,overflowX:"hidden",overflowY:"auto",viewConfig:{loadMask:!1},bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"datefield",width:200,labelWidth:70,fieldLabel:"DATA_DAL",name:"dataDal",allowBlank:!1,maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"container",layout:{align:"stretch",type:"column"},items:[{xtype:"textfield",width:300,
labelWidth:70,fieldLabel:"INDIRIZZO",name:"indirizzo",allowBlank:!1,maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"numberfield",width:130,labelWidth:70,fieldLabel:"NUMERO",name:"civico",allowDecimals:!1,useThousandSeparator:!1,maxLength:10,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"container",layout:{align:"stretch",type:"column"},items:[{xtype:"textfield",width:130,labelWidth:70,fieldLabel:"INTERNO",name:"interno",maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},
{xtype:"textfield",width:130,labelWidth:70,fieldLabel:"ESPONENTE",name:"esponente",maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"container",layout:{align:"stretch",type:"column"},items:[{xtype:"combobox",itemId:"IND_Nazione",reference:"IND_Nazione",labelWidth:70,width:300,fieldLabel:"NAZIONE",name:"codFiscNazione",displayField:"valore",queryParam:"valore",queryMode:"local",store:Ext.create("Generali.nazioni.store.cboxNazioniGen"),valueField:"codice",labelClsExtra:"cbaLabel"},
{xtype:"textfield",itemId:"IND_CodIso",reference:"IND_CodIso",width:160,labelWidth:120,fieldLabel:"CODICE_NAZ_ISO",name:"codNazIso3166",maxLength:2,enforceMaxLength:!0,labelClsExtra:"cbaLabel",maskRe:/[a-zA-Z]/,validator:function(a){return/^[a-zA-Z]*$/.test(a)?!0:!1}},{xtype:"combobox",itemId:"IND_Comune",reference:"IND_Comune",labelWidth:70,width:300,fieldLabel:"COMUNE",name:"istatComune",displayField:"valore",minChars:3,queryParam:"valore",store:Ext.create("Generali.comuni.store.cboxComuniGen"),
valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"textfield",width:130,labelWidth:70,fieldLabel:"CAP",fieldStyle:"text-align: right",name:"cap",itemId:"IND_Cap",reference:"IND_Cap",allowBlank:!1,maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"textfield",width:300,labelWidth:70,itemId:"EdtEstero",reference:"EdtEstero",fieldLabel:"CITTA",name:"comuneEstero",maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel",hidden:!0}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.LavAutonomo",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridLavAutonomo",reference:"GridLavAutonomo",width:200,overflowX:"hidden",overflowY:"auto",store:Ext.create("Generali.anaCliFor.store.LavAutonomo"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",text:"ESERCIZIO",flex:1,dataIndex:"descrEsercizio"}]},{xtype:"form",
itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"ESERCIZIO",editable:!1,allowBlank:!1,itemId:"CBEsercizio",reference:"CBEsercizio",name:"idEsercizio",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont"),
labelClsExtra:"cbaLabel"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"CAUSALE_770",itemId:"CBCau770",reference:"CBCau770",name:"causale770",displayField:"clcDescrizione",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"COD_TRIBUTO",itemId:"CBTributo",reference:"CBTributo",name:"idTributo",displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"numberfield",itemId:"PercRitenuta",reference:"PercRitenuta",
labelWidth:110,fieldLabel:"PERC_RITENUTA",name:"percRitenuta",width:230,maxLength:6,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"COD_ALTRE_SOMME_NON_SOGGETTE",labelClsExtra:"cbaLabel",itemId:"CBCodAltreSomme",reference:"CBCodAltreSomme",name:"codSommeNonSoggette",queryMode:"local",displayField:"valore",valueField:"codice",store:Ext.create("Generali.store.CodiceAltreSomme")},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"ENTE_PREVIDENZIALE",
labelClsExtra:"cbaLabel",itemId:"CBEntePrevidenziale",reference:"CBEntePrevidenziale",name:"codEntePrev",queryMode:"local",displayField:"valore",valueField:"codice",forceSelection:!1,store:Ext.create("Generali.store.EntePrevidenziale")},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"CATEGORIA_ENTE_PREVIDENZIALE",labelClsExtra:"cbaLabel",itemId:"CBCatEntePrevidenziale",reference:"CBCatEntePrevidenziale",name:"categoriaEntePrev",queryMode:"local",displayField:"valore",valueField:"codice",forceSelection:!1,
hidden:!0,store:Ext.create("Generali.store.CategoriaEntePrevidenziale")}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.Spesometro",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridSpesometro",reference:"GridSpesometro",width:200,overflowX:"hidden",overflowY:"auto",store:Ext.create("Generali.anaCliFor.store.Spesometro"),columns:[{xtype:"gridcolumn",text:"ESERCIZIO",flex:1,dataIndex:"descrEsercizio"}],viewConfig:{loadMask:!1}},{xtype:"form",
itemId:"Form",reference:"Form",overflowX:"hidden",overflowY:"auto",trackResetOnLoad:!0,bodyPadding:10,fieldDefaults:{margin:"0 5 5 0"},viewConfig:{loadMask:!1},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idCliFor"},{xtype:"combobox",width:360,labelWidth:110,fieldLabel:"ESERCIZIO",editable:!1,allowBlank:!1,itemId:"CBEsercizio",reference:"CBEsercizio",name:"idEsercizio",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont"),
labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",itemId:"ColCliente",reference:"ColCliente",boxLabel:"INCLUDERE_IN_TRACCIATO_CLIENTE",labelWidth:180,inputValue:"T",uncheckedValue:"F",name:"includereInTracciatoCliente",cls:"cbaLabel"},{xtype:"checkboxfield",itemId:"ColFornitore",reference:"ColFornitore",boxLabel:"INCLUDERE_IN_TRACCIATO_FORNITORE",labelWidth:180,inputValue:"T",uncheckedValue:"F",name:"includereInTracciatoFornitore",cls:"cbaLabel"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.anaCliFor.view.ZZ_Contab",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridContab",reference:"GridContab",flex:1,height:300,margin:"0 0 15 0",store:Ext.create("Generali.anaCliFor.store.Contab",{sorters:[{property:"anno",direction:"DESC"}]}),columns:[{xtype:"gridcolumn",text:"ANNO",dataIndex:"anno",width:50},{xtype:"gridcolumn",text:"VENDITE",dataIndex:"sottoContoVendite",flex:1,renderer:function(a,
b,c){return c.get("descrSottoContoVendite")},editor:{xtype:"combobox",displayField:"valore",queryMode:"local",valueField:"codice"}},{xtype:"gridcolumn",text:"CREDITI",dataIndex:"quintoLivelloCrediti",flex:1,renderer:function(a,b,c){return c.get("descrQuintoLivelloCrediti")},editor:{xtype:"combobox",displayField:"valore",queryMode:"local",valueField:"codice"}},{xtype:"gridcolumn",text:"ACQUISTI",dataIndex:"sottoContoAcquisti",flex:1,renderer:function(a,b,c){return c.get("descrSottoContoAcquisti")},
editor:{xtype:"combobox",displayField:"valore",queryMode:"local",valueField:"codice"}},{xtype:"gridcolumn",text:"DEBITI",dataIndex:"quintoLivelloDebiti",flex:1,renderer:function(a,b,c){return c.get("descrQuintoLivelloDebiti")},editor:{xtype:"combobox",displayField:"valore",queryMode:"local",valueField:"codice"}},{xtype:"gridcolumn",text:"IVA",dataIndex:"idAliquotaIva",flex:1,renderer:function(a,b,c){return c.get("descrAliquotaIva")},editor:{xtype:"combobox",displayField:"valore",queryMode:"local",
valueField:"codice"}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],viewConfig:{loadMask:!1}}]});this.callParent(arguments)}});
Ext.define("Generali.aperturaEsercizio.controller.AperturaEsercizio",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"GridApeEs",selector:this.selContainer+"#GridApeEs"},{ref:"ChbGestCda",selector:this.selContainer+"#ChbGestCda"}]);this.control(this.selContainer+"#GridApeEs",{select:this.selectGridApeEs})},
selectGridApeEs:function(a,b){clearForm(this.getForm());this.getForm().loadRecord(b)},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idOrganizzazione:this.idOrganizzazione,chiuso:getBoolValue(c.chiuso)});this.getChbGestCda().isVisible()?Ext.apply(c,{gestioneCda:getBoolValue(c.gestioneCda)}):delete c.gestioneCda;controller_salvaRecord(b,
c,a,{forzaRegistrazione:"F",idModuloSipcar:CBA.moduli.moduloAttivo,tipoContabilita:this.tipoContabilita})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridApeEs().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){inizioAttesa();setTimeout(function(){a.salvaForm(b);fineAttesa()},500)},annulla_callback:function(){a.aggiornaStore()},
nuovo_callback:function(){controller_nuovoRecord(b);a.getGridApeEs().setDisabled(!0)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){a.getForm().up("window").close();a.cbaConfig.callbackRiapriStore&&a.cbaConfig.callbackRiapriStore()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();
if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridApeEs().setDisabled(e)})},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store;e.load({params:{idOrganizzazione:b.idOrganizzazione},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(c):(a||(a=d.findField("id").getValue()),g=trovaRecord(e,"id",a),h=b.getGridApeEs(),h.getSelectionModel().deselectAll(),h.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},onLaunch:function(){this.idOrganizzazione=
getIdOrg();this.tipoContabilita="";43==CBA.moduli.moduloAttivo&&(this.tipoContabilita=getPersonContabili(this.idOrganizzazione,new Date,!0,null).tipoContabilitaAbilitata);this.gestioneForm();this.aggiornaStore();this.getChbGestCda().setVisible(CBA.moduli.modulo51.abilitato&&54==CBA.moduli.moduloAttivo)},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.aperturaEsercizio.store.AperturaEsercizio",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"dataInizioPeriodo",type:"date"},{name:"dataFinePeriodo",type:"date"},{name:"descrizione"},{name:"chiuso"},{name:"gestioneCda"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/esercizioCont/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/esercizioCont/list",create:"/cba/gen/ws/general/esercizioCont/aperturaEsercizio",
update:"/cba/gen/ws/general/esercizioCont/update",destroy:"/cba/gen/ws/general/esercizioCont/delete"}},autoDestroy:!0});
Ext.define("Generali.aperturaEsercizio.view.AperturaEsercizio",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridApeEs",reference:"GridApeEs",width:200,store:Ext.create("Generali.aperturaEsercizio.store.AperturaEsercizio"),columns:[{xtype:"gridcolumn",dataIndex:"descrizione",text:"ESERCIZI",flex:1}],viewConfig:{loadMask:!1}},{xtype:"form",flex:1,itemId:"Form",reference:"Form",autoScroll:!0,
layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxDescrizione",reference:"TxDescrizione",width:350,fieldLabel:"DESCRIZIONE",name:"descrizione",allowBlank:!1,maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"datefield",name:"dataInizioPeriodo",itemId:"DtIniPeriodo",reference:"DtIniPeriodo",width:210,labelClsExtra:"cbaLabel",fieldLabel:"DAL",allowBlank:!1},{xtype:"datefield",name:"dataFinePeriodo",
itemId:"DtFinePeriodo",reference:"DtFinePeriodo",width:210,labelClsExtra:"cbaLabel",fieldLabel:"AL",allowBlank:!1},{xtype:"checkboxfield",name:"gestioneCda",itemId:"ChbGestCda",reference:"ChbGestCda",cls:"cbaLabel",fieldLabel:"",boxLabel:"GESTIONE_CDA",inputValue:"T",uncheckedValue:"F"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.attivitacommerciali.controller.AttComm",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridAttComm",selector:a.selContainer+"#GridAttComm"},{ref:"BtnNuovo",selector:a.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:a.selContainer+"#BtnElimina"},{ref:"TxtCerca",selector:a.selContainer+"#TxtCerca"}]);a.control(a.selContainer+"#GridAttComm",{beforeedit:a.beforeeditGridAttComm,
edit:a.editGridAttComm,canceledit:a.canceleditGridAttComm,validateedit:a.validateeditGridAttComm});a.control(a.selContainer+"#BtnNuovo",{click:a.clickBtnNuovo});a.control(a.selContainer+"#BtnElimina",{click:a.clickBtnElimina});a.control(a.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(function(b){var c=a.getGridAttComm(),d=c.getStore();d.clearFilter();d.filter(function(a){var c=!1;(a=a.get("descrizione"))&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&(c=!0);return c});b.focus();
0<d.getCount()&&c.getSelectionModel().select(0);b.focus()},100,a)})},clickBtnNuovo:function(a){controller_nuovoRecordGrid({idOrganizzazione:this.cbaConfig.idOrganizzazione,id:null},this.getGridAttComm())},clickBtnElimina:function(a){var b=this;a=b.getGridAttComm();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridAttComm:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);
this.getBtnElimina().setDisabled(!a)},editGridAttComm:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridAttComm:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridAttComm:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=this.getGridAttComm(),c=b.getStore();
this.getTxtCerca().setValue(Ext.emptyString);c.load({params:{idOrganizzazione:this.cbaConfig.idOrganizzazione,descrizione:""},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridAttComm().getStore())},onLaunch:function(){this.getGridAttComm().controller=this;this.aggiornaStore()}});
Ext.define("Generali.attivitacommerciali.store.AttivitaComm",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codEnte"},{name:"idOrganizzazione"},{name:"descrizione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/attivitaCommerciale/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/attivitaCommerciale/list",create:"/cba/gen/ws/general/attivitaCommerciale/insert",update:"/cba/gen/ws/general/attivitaCommerciale/update",destroy:"/cba/gen/ws/general/attivitaCommerciale/delete"}},
autoDestroy:!0});
Ext.define("Generali.attivitacommerciali.view.AttComm",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridAttComm",reference:"GridAttComm",store:Ext.create("Generali.attivitacommerciali.store.AttivitaComm"),columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:100,enforceMaxLength:!0}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,
errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:200,fieldLabel:"",emptyText:"CERCA"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.banche.controller.Banche",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridBanche",selector:a.selContainer+"#GridBanche"},{ref:"BtnNuovo",selector:a.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:a.selContainer+"#BtnElimina"},{ref:"CntSportelli",selector:a.selContainer+"#CntSportelli"},{ref:"TxtCercaBanche",selector:a.selContainer+"#TxtCercaBanche"},{ref:"RgbRicercaBanca",
selector:a.selContainer+"#RgbRicercaBanca"},{ref:"BtnImport",selector:a.selContainer+"#BtnImport"}]);a.control(a.selContainer+"#GridBanche",{beforeedit:a.beforeeditGridBanche,edit:a.editGridBanche,canceledit:a.canceleditGridBanche,validateedit:a.validateeditGridBanche});a.control(a.selContainer+"#BtnNuovo",{click:a.clickBtnNuovo});a.control(a.selContainer+"#BtnElimina",{click:a.clickBtnElimina});a.control(a.selContainer+"#GridBanche",{select:a.selectGridBanche});a.control(a.selContainer+"#BtnImport",
{click:a.clickBtnImport});a.control(a.selContainer+"#TxtCercaBanche",{change:Ext.Function.createBuffered(function(b){var c=a.getGridBanche(),d=a.getRgbRicercaBanca().getValue().tipoRicercaBanca,c=c.getStore();c.clearFilter();c.filter(function(a){var c=!1;(a=a.get(d).toString())&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&(c=!0);return c});b.focus()},100,a)})},selectGridBanche:function(a,b){if(null!=b.get("id")){var c=this.getCntSportelli().down("#GridSportelli");c.controller.codAbi=b.get("codAbi");
c.controller.aggiornaStore()}},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null},this.getGridBanche())},clickBtnElimina:function(a){var b=this;a=b.getGridBanche();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},clickBtnImport:function(a,b,c){Ext.create("winCBA",{name:"Generali.banche.view.SbloccaImport",titolo:"IMPORT_BANCHE_CSV",dimensione:3,altezzaWin:600,larghezzaWin:1010,configItem:{caricamentoEsterno:!0,
cbaConfig:this.cbaConfig},closable:!0}).show()},beforeeditGridBanche:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a);this.getCntSportelli().setDisabled(!a)},editGridBanche:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,
0)},canceleditGridBanche:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridBanche:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=this.getGridBanche(),c=b.getStore();this.getTxtCercaBanche().setValue(Ext.emptyString);c.load({params:{descrizione:""},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridBanche().getStore())},
onLaunch:function(){this.getCntSportelli().add(Ext.create("Generali.banche.view.Sportelli",{cbaConfig:{controllerBanche:this}}));this.getGridBanche().controller=this;var a=this.getGridBanche();a.on("afterrender",function(){Ext.Ajax.request({method:"GET",url:"gen/ws/general/banca/getTableComment",async:!1,success:function(b){a.setTitle(traduci(a.getTitle())+" "+(null!=b.responseText?" ("+b.responseText+")":""))}})});this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.banche.controller.SbloccaImport",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"PnlPrincipale",selector:this.selContainer+"#PnlPrincipale"}])},loadData:function(){var a=this.getPnlPrincipale();a.removeAll();a.add(Ext.create("Generali.imports.view.ImportBancheSportelli"),{cbaConfig:this.cbaConfig})},destroy:function(){this.callParent()}});
Ext.define("Generali.banche.controller.Sportelli",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridSportelli",selector:a.selContainer+"#GridSportelli"},{ref:"Form",selector:a.selContainer+"#Form"},{ref:"BoxBottoni",selector:a.selContainer+"#BoxBottoni"},{ref:"CodiceCab",selector:a.selContainer+"#CodiceCab"},{ref:"TxtCerca",selector:a.selContainer+"#TxtCerca"},{ref:"RgbRicerca",selector:a.selContainer+
"#RgbRicerca"}]);a.control(a.selContainer+"#GridSportelli",{select:a.selectGridSportelli});a.control(a.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(function(b){var c=a.getGridSportelli(),d=a.getRgbRicerca().getValue().tipoRicerca,c=c.getStore();c.clearFilter();c.filter(function(a){var c=!1;(a=a.get(d).toString())&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&(c=!0);return c});b.focus()},100,a)})},selectGridSportelli:function(a,b){this.recSport=b;var c=this.getForm();clearForm(this.getForm());
c.loadRecord(b)},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c="F",d=b.getForm().getFieldValues();-9999!=d.id&&(c=this.recSport.data.codCab==d.codCab?"T":"F");Ext.apply(d,{codAbi:this.getGridSportelli().controller.codAbi});controller_salvaRecord(b,d,a,{forzaRegistrazione:c})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=
a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.getGridSportelli().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);a.getCodiceCab().focus()},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},
verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridSportelli().setDisabled(e);a.cbaConfig.controllerBanche.getGridBanche().setDisabled(e)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStore:function(a){var b=this.getGridSportelli(),c=b.getStore(),d=this.getForm(),e=d.getForm();this.getTxtCerca().setValue(Ext.emptyString);
c.load({params:{codAbi:this.codAbi},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(d):(a||(a=e.findField("id").getValue()),g=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},svuotaStore:function(){svuotaStore(this.getGridSportelli().getStore())},onLaunch:function(){this.recSport=null;this.getGridSportelli().controller=this;this.gestioneForm()},destroy:function(){this.callParent()}});
Ext.define("Generali.banche.store.AnaBanche",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codAbi",convert:function(a,b){if(""!=a){var c=a;1E4>c&&!Ext.String.startsWith(c,"0",!0)&&(c="0"+c);return c}}},{name:"descrizione",sortType:"asUCText"},{name:"origineDato"},{name:"dataDecorrenza",type:"date"},{name:"dataCessazione",type:"date"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/banca/list",
create:"/cba/gen/ws/general/banca/insert",update:"/cba/gen/ws/general/banca/update",destroy:"/cba/gen/ws/general/banca/delete"}},autoDestroy:!0});
Ext.define("Generali.banche.store.AnaSportelli",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codAbi"},{name:"codCab",convert:function(a,b){var c=a;1E4>c&&!Ext.String.startsWith(c,"0",!0)&&(c="0"+c);return c}},{name:"descrizione",sortType:"asUCText"},{name:"indirizzo"},{name:"localita"},{name:"cap"},{name:"comune"},{name:"provincia"},{name:"origineDato"},{name:"dataDecorrenza",type:"date"},{name:"dataCessazione",type:"date"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/sportello/list",
reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/banca/sportello/list",create:"/cba/gen/ws/general/banca/sportello/insert",update:"/cba/gen/ws/general/banca/sportello/update",destroy:"/cba/gen/ws/general/banca/sportello/delete"}},autoDestroy:!0});
Ext.define("Generali.banche.store.cboxBanche",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore",convert:function(a,b){var c=b.get("codice");1E4>c&&(c="0"+c);return c+" - "+a}},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/abiCbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.banche.store.cboxBancheABICAB",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"clcDescrizione",convert:function(a,b){var c=b.get("codice");1E4>c&&(c="0"+c);return c+" - "+b.get("valore")}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/abiCbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.banche.store.cboxBancheId",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore",convert:function(a,b){var c=b.get("extra");1E4>c&&(c="0"+c);return c+" - "+a}},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.banche.store.cboxSportelli",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore",convert:function(a,b){var c=b.get("codice");1E4>c&&(c="0"+c);return c+" - "+a}},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/sportello/cabCbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.banche.store.cboxSportelliABICAB",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"clcDescrizione",convert:function(a,b){for(var c=b.get("extra").split(",")[1];5>c.length;)c="0"+c;return c+" - "+b.get("valore")}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/banca/sportello/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.banche.view.Banche",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},title:"ANAGRAFICA_BANCHE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",height:200,itemId:"GridBanche",reference:"GridBanche",title:"ANAGRAFICA_BANCHE",store:Ext.create("Generali.banche.store.AnaBanche"),flex:1,columns:[{xtype:"gridcolumn",text:"CODICE_ABI",width:100,dataIndex:"codAbi",editor:{xtype:"textfield",allowBlank:!1,maxLength:5,enforceMaxLength:!0}},
{xtype:"gridcolumn",text:"DESCRIZIONE_BANCA",flex:1,dataIndex:"descrizione",editor:{xtype:"textfield",allowBlank:!1,maxLength:70,enforceMaxLength:!0}},{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataCessazione",text:"DATA_CESSAZIONE",width:100,sortable:!1,align:"center",editor:{xtype:"datefield",allowBlank:!0}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",
reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"NUOVO"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"ELIMINA"},{xtype:"textfield",itemId:"TxtCercaBanche",reference:"TxtCercaBanche",emptyText:"CERCA",width:150},{xtype:"radiogroup",width:220,columns:2,vertical:!1,itemId:"RgbRicercaBanca",reference:"RgbRicercaBanca",items:[{boxLabel:"DESCRIZIONE",name:"tipoRicercaBanca",inputValue:"descrizione",cls:"cbaLabel",checked:!0},{boxLabel:"CODICE_ABI",
name:"tipoRicercaBanca",inputValue:"codAbi",cls:"cbaLabel"}]},{xtype:"button",disabled:!1,cls:"cba-button-25",itemId:"BtnImport",reference:"BtnImport",formBind:!0,margin:"1 0 0 0",iconCls:"icon-elabora",text:"IMPORT_BANCHE_CSV"}]}]},{xtype:"splitter"},{xtype:"container",itemId:"CntSportelli",reference:"CntSportelli",layout:{type:"fit"},flex:1}]});this.callParent(arguments)}});
Ext.define("Generali.banche.view.SbloccaImport",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_IMPORT_BANCHE",nomeFunzioneDaAttivare:"Import Banche e Sportelli",codiceFunzione:"GEN_IMPORT_BANCHE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",itemId:"PnlPrincipale",reference:"PnlPrincipale",layout:{align:"stretch",type:"hbox"}}]});this.callParent(arguments)}});
Ext.define("Generali.banche.view.Sportelli",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",title:"SPORTELLI",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",width:380,layout:{align:"stretch",type:"hbox"},items:[{xtype:"gridpanel",itemId:"GridSportelli",reference:"GridSportelli",store:Ext.create("Generali.banche.store.AnaSportelli"),flex:1,columns:[{xtype:"gridcolumn",text:"CODICE_CAB",align:"center",renderer:cell_renderer_numero,
width:85,dataIndex:"codCab"},{xtype:"gridcolumn",text:"DESCRIZIONE_SPORTELLO",renderer:cell_renderer_stringa,flex:1,dataIndex:"descrizione"},{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataCessazione",text:"DATA_CESSAZIONE",width:100}],viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",emptyText:"CERCA",width:150},{xtype:"radiogroup",flex:1,columns:2,vertical:!1,itemId:"RgbRicerca",reference:"RgbRicerca",items:[{boxLabel:"DESCRIZIONE",
name:"tipoRicerca",inputValue:"descrizione",cls:"cbaLabel",checked:!0},{boxLabel:"CODICE_CAB",name:"tipoRicerca",inputValue:"codCab",cls:"cbaLabel"}]}]}]}]},{xtype:"splitter"},{xtype:"form",itemId:"Form",reference:"Form",trackResetOnLoad:!0,bodyPadding:5,flex:1,items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",margin:"0 0 5 0"},{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"codAbi"},{xtype:"container",layout:"column",defaults:{margin:"0 5 5 0"},items:[{xtype:"textfield",
labelWidth:150,width:250,maxLength:5,enforceMaxLength:!0,itemId:"CodiceCab",reference:"CodiceCab",fieldLabel:"CODICE_CAB",name:"codCab",allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"datefield",itemId:"EdtDtCessazione",reference:"EdtDtCessazione",width:245,fieldLabel:"DATA_CESSAZIONE",labelWidth:120,labelClsExtra:"cbaLabel",allowBlank:!0,name:"dataCessazione"}]},{xtype:"textfield",labelWidth:150,width:500,maxLength:40,enforceMaxLength:!0,fieldLabel:"DESCRIZIONE_SPORTELLO",name:"descrizione",allowBlank:!1,
labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,width:500,maxLength:80,enforceMaxLength:!0,fieldLabel:"INDIRIZZO",name:"indirizzo",labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,width:250,maxLength:5,enforceMaxLength:!0,fieldLabel:"CAP",name:"cap",labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,width:500,maxLength:40,enforceMaxLength:!0,fieldLabel:"CITTA",name:"localita",labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,width:200,maxLength:2,enforceMaxLength:!0,
fieldLabel:"PROV",name:"provincia",labelClsExtra:"cbaLabel"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.bugiardino.controller.Bugiardino",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"CntBugiardino",selector:this.selContainer+"#CntBugiardino"}]);this.control(this.selContainer+"#BtnEsci",{click:this.clickBtnEsci})},clickBtnEsci:function(a){a.up("window").close()},onLaunch:function(){var a=this;Ext.Ajax.request({method:"GET",url:49===
CBA.moduli.moduloAttivo?"/cba/css/cs/ws/farmaci/farmadati/bugy":"",params:{aic:this.cbaConfig.aic},success:function(b){b=Ext.JSON.decode(b.responseText);b.success&&!Ext.isEmpty(b.data.filePath)?a.getCntBugiardino().setHtml('<iframe width="100%" height="100%" src="'+b.data.filePath+'"></iframe>'):a.getCntBugiardino().setHtml('<div style="width: 100%; height: 100%; display: table; text-align: center;"><span style="vertical-align: middle; display: table-cell";">'+traduci("TERAPIE_NESSUN_FOGLIO")+"</span></div>")}})},
destroy:function(){this.callParent()}});
Ext.define("Generali.bugiardino.view.Bugiardino",{extend:"Generali.standard.ControlledContainer",initComponent:function(){this.items=[{xtype:"panel",layout:"fit",items:[{xtype:"container",itemId:"CntBugiardino",reference:"CntBugiardino",padding:5,scrollable:!0,style:"color: #8d8a8a; font-style: italic"}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"CSSButtonsPanel",flex:1,layout:{type:"hbox",pack:"end"},items:[{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",nonDisabilitare:!0}]}]}]}];
this.callParent()},destroy:function(){this.callParent()}});
Ext.define("Generali.catCliFor.controller.CatCliFor",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"GridCategorieClientiFornitori",selector:this.selContainer+"#GridCategorieClientiFornitori"},{ref:"Fieldfornitore",selector:this.selContainer+
"#Fieldfornitore"},{ref:"ChkBollorette",selector:this.selContainer+"#ChkBollorette"},{ref:"Fsbollorette",selector:this.selContainer+"#Fsbollorette"},{ref:"TxtCercaCategoria",selector:this.selContainer+"#TxtCercaCategoria"},{ref:"TipoCategoria",selector:this.selContainer+"#TipoCategoria"},{ref:"CBModFattura",selector:this.selContainer+"#CBModFattura"}]);this.control(this.selContainer+"#GridCategorieClientiFornitori",{select:this.selectGridCategorieClientiFornitori});this.control(this.selContainer+
"#TxtCercaCategoria",{change:this.changeTxtCercaCategoria});this.control(this.selContainer+"#TipoCategoria",{change:this.changeTipoCategoria})},selectGridCategorieClientiFornitori:function(a,b){clearForm(this.getForm());this.getForm().loadRecord(b)},changeTipoCategoria:function(a,b,c,d){a=b&&b.tipoCategoria&&"F"!=b.tipoCategoria;this.getFsbollorette().setVisible(a);this.getChkBollorette().setVisible(a).setValue(!1);this.getCBModFattura().setVisible(a).setValue(null)},changeTxtCercaCategoria:function(a,
b){setTaskField(a,function(){var b=a.up("gridpanel"),d=b.getStore();d.clearFilter();d.filter(function(b){var c=!1;(b=b.get("descrizione"))&&0<=b.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);return c});a.focus();0<d.getCount()&&b.getSelectionModel().select(0)})},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idOrganizzazione:this.cbaConfig.idOrganizzazione,
bolloRette:getBoolValue(c.bolloRette)});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridCategorieClientiFornitori().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},
nuovo_callback:function(){controller_nuovoRecord(b);a.getGridCategorieClientiFornitori().setDisabled(!0);b.getForm().setValues({idOrganizzazione:a.cbaConfig.idOrganizzazione})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){a.cbaConfig.callbackRiapriStore&&a.cbaConfig.callbackRiapriStore();a.getForm().up("window").close()}}});
inserisciBottoni(b.boxBottoni,c);a.cbaConfig.mostraEsci||b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridCategorieClientiFornitori().setDisabled(e)})},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store;b.getGridCategorieClientiFornitori().getStore().clearFilter();e.load({params:{idOrganizzazione:b.cbaConfig.idOrganizzazione},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(c):(a||
(a=d.findField("id").getValue()),g=trovaRecord(e,"id",a),h=b.getGridCategorieClientiFornitori(),h.getSelectionModel().deselectAll(),h.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError())}})},loadStoreModFattura:function(){var a=StdSipcar.coalesce(this.cbaConfig.idOrganizzazione,getIdOrg()),b=this.getCBModFattura();b.getStore().load({params:{idOrganizzazione:a},callback:function(a,d,e){e&&null!=a&&1==a.length&&setValue(b,a[0].get("codice"))}})},onLaunch:function(){this.loadStoreModFattura();
this.gestioneForm();this.aggiornaStore()},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.catCliFor.store.CatCliFor",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codEnte"},{name:"descrizione"},{name:"tipoCategoria"},{name:"bolloRette"},{name:"idOrganizzazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/categoria/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/categoria/list",create:"/cba/gen/ws/general/anaCliFor/categoria/new",update:"/cba/gen/ws/general/anaCliFor/categoria/update",
destroy:"/cba/gen/ws/general/anaCliFor/categoria/delete"}},autoDestroy:!0});Ext.define("Generali.catCliFor.store.cboxCatCliFor",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/categoria/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.catCliFor.store.cboxModelliFattura",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/categoria/modelliFattura/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.catCliFor.view.CatCliFor",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",flex:1,border:0,layout:{align:"stretch",type:"hbox"},items:[{xtype:"gridpanel",itemId:"GridCategorieClientiFornitori",reference:"GridCategorieClientiFornitori",border:0,width:250,store:Ext.create("Generali.catCliFor.store.CatCliFor"),columns:[{xtype:"gridcolumn",dataIndex:"descrizione",text:"DESCRIZIONE",
flex:1}],viewConfig:{loadMask:!1}},{xtype:"form",flex:1,itemId:"Form",reference:"Form",autoScroll:!0,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",width:400,fieldLabel:"DESCRIZIONE",name:"descrizione",allowBlank:!1,maxLength:50,enforceMaxLength:!0},{xtype:"fieldset",title:"TIPO_CATEGORIA_CLIENTE_FORNITORE",defaults:{cls:"cbaLabel",
labelClsExtra:"cbaLabel"},items:[{xtype:"radiogroup",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},layout:{align:"stretchmax",type:"vbox"},itemId:"TipoCategoria",reference:"TipoCategoria",allowBlank:!1,items:[{xtype:"radiofield",boxLabel:"CLIENTE",name:"tipoCategoria",inputValue:"C",itemId:"Fieldcliente"},{xtype:"radiofield",boxLabel:"FORNITORE",name:"tipoCategoria",inputValue:"F"},{xtype:"radiofield",boxLabel:"ENTRAMBI",name:"tipoCategoria",inputValue:"E",itemId:"Fieldentrambi"}]}]},{xtype:"fieldset",
title:"PARAMETRI_PER_CONTABILITA_UTENTI",itemId:"Fsbollorette",reference:"Fsbollorette",hidden:!0,items:[{xtype:"checkboxfield",itemId:"ChkBollorette",reference:"ChkBollorette",cls:"cbaLabel",fieldLabel:"",boxLabel:"BOLLO_RETTE",inputValue:"T",uncheckedValue:"F",name:"bolloRette"},{xtype:"combobox",itemId:"CBModFattura",reference:"CBModFattura",store:Ext.create("Generali.catCliFor.store.cboxModelliFattura"),name:"idModelloFattura",fieldLabel:"MODELLO_FATTURA",displayField:"valore",queryMode:"local",
valueField:"codice",labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.categoriecespiti.controller.CategorieCespiti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCategoCesp",selector:this.selContainer+"#GridCategoCesp"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"TxtCerca",selector:this.selContainer+"#TxtCerca"}]);this.control(this.selContainer+"#GridCategoCesp",{beforeedit:this.beforeeditGridCategoCesp,
edit:this.editGridCategoCesp,canceledit:this.canceleditGridCategoCesp,validateedit:this.validateeditGridCategoCesp});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#TxtCerca",{change:this.changeTxtCerca})},changeTxtCerca:function(a,b,c,d){setTaskField(a,function(){var b=a.up("gridpanel"),c=b.getStore();c.clearFilter();c.filter(function(b){var c=!1;(b=b.get("descrizione"))&&
0<=b.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);return c});a.focus();0<c.getCount()&&b.getSelectionModel().select(0)})},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null},this.getGridCategoCesp())},clickBtnElimina:function(a){var b=this;a=b.getGridCategoCesp();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridCategoCesp:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},
abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},editGridCategoCesp:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();c.idOrganizzazione=this.idOrganizzazione;d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridCategoCesp:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridCategoCesp:function(a,
b,c){b.newValues.idOrganizzazione=this.idOrganizzazione;return msgShow("",[])},aggiornaStore:function(a){var b=this.getGridCategoCesp(),c=b.getStore();this.getTxtCerca().setValue(Ext.emptyString);c.load({params:{idOrganizzazione:this.idOrganizzazione,descrizione:""},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridCategoCesp().getStore())},
onLaunch:function(){this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();this.getGridCategoCesp().controller=this;this.aggiornaStore()}});
Ext.define("Generali.categoriecespiti.store.CategorieCespiti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"descrizione"},{name:"percentuale"}],proxy:{type:"ajax",url:"cba/gen/ws/general/cespiti/categoria/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/cespiti/categoria/list",create:"/cba/gen/ws/general/cespiti/categoria/insert",update:"/cba/gen/ws/general/cespiti/categoria/update",destroy:"/cba/gen/ws/general/cespiti/categoria/delete"}},
autoDestroy:!0});Ext.define("Generali.categoriecespiti.store.cboxCategoCespiti",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore",convert:function(a,b){return a+" ("+b.get("extra")+"%)"}},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/cespiti/categoria/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.categoriecespiti.view.CategorieCespiti",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridCategoCesp",reference:"GridCategoCesp",store:Ext.create("Generali.categoriecespiti.store.CategorieCespiti"),columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:100,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"PERCENTUALE",dataIndex:"percentuale",
editor:{xtype:"numberfield",allowBlank:!1,maxLength:5,enforceMaxLength:!0},renderer:function(a,b,c,d,e,g,h){b.style="text-align:right !important";return formatFloat(a)}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",
text:"Elimina"},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:200,fieldLabel:"",emptyText:"CERCA"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.cda.controller.AlberoCda",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:a+"#TreeRep"},{ref:"BtnNuovo",selector:a+"#BtnNuovo"},{ref:"BtnElimina",selector:a+"#BtnElimina"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnConferma1",selector:a+"#BtnConferma1"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"CntEconomica",selector:a+"#CntEconomica"},{ref:"CBAnno",selector:a+
"#CBAnno"},{ref:"Anno",selector:a+"#Anno"},{ref:"BtnSyncPaghe",selector:a+"#BtnSyncPaghe"},{ref:"TxtCerca",selector:a+"#TxtCerca"}]);this.control(a+"#TreeRep",{beforeitemcontextmenu:this.beforeitemcontextmenuTreeRep,beforeedit:this.beforeeditTreeRep,edit:this.editTreeRep,canceledit:this.canceleditTreeRep,validateedit:this.validateeditTreeRep,select:this.selectTreeRep,itemdblclick:this.itemdblclickTreeRep});this.control(a+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(a+"#BtnElimina",{click:this.clickBtnElimina});
this.control(a+"#BtnConferma",{click:this.clickBtnConferma});this.control(a+"#BtnConferma1",{click:this.clickBtnConfermaFinali});this.control(a+"#BtnEsci",{click:this.clickBtnEsci});this.control(a+"#CBAnno",{change:this.changeCBAnno});this.control(a+"#Anno",{change:this.changeAnnoEconomicaOld});this.control(a+"#BtnSyncPaghe",{click:this.syncAllCdaPaghe});this.control(a+"#TxtCerca",{change:Ext.Function.createBuffered(this.filtraAlbero,200,this)})},filtraAlbero:function(a){var b=this.getTreeRep();if(!b.isDisabled()){var c=
b.getStore(),d=a.getValue();Ext.suspendLayouts();var e=function(a,b){a.filter(function(a){for(var c=!1,d=$jscomp.makeIterator(b),e=d.next();!e.done&&!(c=e.value,c=a.isLeaf()?a===c:a.contains(c));e=d.next());return c})},g=[];c.clearFilter();Ext.isEmpty(a.getValue())||b.expandAll(function(){c.each(function(a){if(a.isLeaf()){var b=a.get("descrizioneCodice");b&&0<=b.toUpperCase().indexOf(d.toUpperCase())&&g.push(a)}});e(c,g)});Ext.resumeLayouts(!0)}},changeAnnoEconomicaOld:function(a,b){this.aggiornaStore()},
changeCBAnno:function(a,b){var c=this;b?(this.aggiornaStore(),this.lastIdEserc=b):this.getCBAnno().setValue(this.lastIdEserc);CBA.moduli.modulo51.abilitato&&this.isActiveSyncCdaPaghe().then(function(a){c.getBtnSyncPaghe().setVisible(a)})["catch"](function(a){msgShowError("",a.message)})},itemdblclickTreeRep:function(a,b,c,d,e,g){b.get("leaf")&&(1==this.cbaConfig.soloIntermedi?"I"==b.get("tipoCda")?this.selezionaEsci():msgShowError("","MSG_INTERMEDI"):this.selezionaEsci())},selezionaEsci:function(){var a=
this.getBtnConferma();if(a.isVisible()){if(this.cbaConfig.afterConferma){var b=[];Ext.each(this.getTreeRep().getSelectionModel().getSelection(),function(a){a.get("leaf")&&b.push(a)});if(Ext.isEmpty(b))this.cbaConfig.afterEsci&&this.cbaConfig.afterEsci();else{if(2==this.cbaConfig.tipoContabilita){var c=b[0].get("depth"),d=[0,0,0,0];d[c-1]=b[0].get("cdaCode");var e=""+b[0].get("idVisibile");null==e?e="00":1==e.length&&(e="0"+e);for(var g=c;3>=g;g++)e+="-00";for(g=b[0].parentNode;1<c;){var h=""+g.get("idVisibile");
null==h&&(h="00");1==h.length&&(h="0"+h);e=h+"-"+e;d[c-1]=g.get("cdaCode");g=g.parentNode;c--}b[0].data.cdaCode=e;b[0].data.cda1=d[0];b.annoCda=b.desAnnoCda=this.getAnno().getValue()}else b.annoCda=this.getCBAnno().getValue(),b.desAnnoCda=this.getCBAnno().getDisplayValue();this.cbaConfig.afterConferma(b)}}a.up("window").close()}},selezionaEsciFinali:function(){var a=this.getBtnConferma1();if(a.isVisible()){if(this.cbaConfig.afterConferma){var b=[];this.getTreeRep().getStore().each(function(a){if(a.isLeaf()&&
"F"==a.get("tipoCda"))return b.push(a),!1});if(Ext.isEmpty(b))this.cbaConfig.afterEsci&&this.cbaConfig.afterEsci();else{if(2==this.cbaConfig.tipoContabilita){var c=b[0].get("depth"),d=[0,0,0,0];d[c-1]=b[0].get("cdaCode");var e=""+b[0].get("idVisibile");null==e?e="00":1==e.length&&(e="0"+e);for(var g=c;3>=g;g++)e+="-00";for(g=b[0].parentNode;1<c;){var h=""+g.get("idVisibile");null==h&&(h="00");1==h.length&&(h="0"+h);e=h+"-"+e;d[c-1]=g.get("cdaCode");g=g.parentNode;c--}b[0].data.cdaCode=e;b[0].data.cda1=
d[0];b.annoCda=b.desAnnoCda=this.getAnno().getValue()}else b.annoCda=this.getCBAnno().getValue(),b.desAnnoCda=this.getCBAnno().getDisplayValue(),b.soloFinali=!0;this.cbaConfig.afterConferma(b)}}a.up("window").close()}},clickBtnConferma:function(a){this.selezionaEsci()},clickBtnConfermaFinali:function(a){this.selezionaEsciFinali()},clickBtnEsci:function(a){this.cbaConfig.afterEsci&&this.cbaConfig.afterEsci();a.up("window").close()},selectTreeRep:function(a,b){this.getBtnElimina().setDisabled(0===b.get("cdaCode")||
"L"==this.cbaConfig.permesso);this.cbaConfig.multiSelezione||this.getBtnConferma().setDisabled(0===b.get("cdaCode")||!b.get("leaf"));if(!this.cbaConfig.onlyTree){var c=this.getTreeRep().up("#CntPrincipale").down("#FormCda").controller;c.idTestata=b.get("cdaCode");c.getFormCda().setDisabled(0==b.get("cdaCode"));c.hasChild=b.hasChildNodes();0!=b.get("cdaCode")?c.aggiornaStore():clearForm(c.getFormCda())}},beforeeditTreeRep:function(a,b,c){if(!0===a.editing||0===b.record.get("cdaCode"))return!1;this.abilitaBottoniGrid(!1)},
editTreeRep:function(a,b,c){var d=b.record.getData();c=a.getEditor().getForm();c.controller=this;c.store=this.getTreeRep().getStore();d={id:d.cdaCode?d.cdaCode:null,idOrganizzazione:getIdOrg(),idEsercizio:this.idEsercizioDefault,idPadre:d.idPadre,descrizione:d.text};controller_salvaRecord(c,d,!1,!1)?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditTreeRep:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("cdaCode"))},validateeditTreeRep:function(a,b,c){return msgShow("",
[])},beforeitemcontextmenuTreeRep:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a){var b=this,c=b.getTreeRep(),d=c.getStore(),e={idOrganizzazione:b.cbaConfig.idOrganizzazione,tipoCont:b.cbaConfig.tipoContabilita};2==b.cbaConfig.tipoContabilita?Ext.apply(e,{anno:b.getAnno().getValue()}):Ext.apply(e,{idEsercizio:b.getCBAnno().getValue()});d.load({params:e,callback:function(d,e,k){if(k)if(d=c.getRootNode().findChild("cdaCode",a,!0),c.expandAll(),d)c.getSelectionModel().deselectAll(),
c.getSelectionModel().select(0),c.getSelectionModel().select([d]);else{if(b.cbaConfig.cespite)return c.getSelectionModel().deselectAll(),!1;c.getSelectionModel().select(0)}else msgShowError("",e.getError())}})},clickBtnNuovo:function(){var a=this.getTreeRep();a.getStore();var b=a.getSelectionModel().getLastSelected();b.set("leaf",!1);b.appendChild({leaf:!0,idPadre:b.get("cdaCode")});a.getView().refresh();b.expand();a.getPlugin().startEdit(b.lastChild,0);a.up("#CntPrincipale").down("#FormCda").controller.getFsTipoCda().setDisabled(!1);
this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},clickBtnElimina:function(){var a=this,b=a.getTreeRep(),c=b.getSelectionModel().getSelection()[0],d=c.hasChildNodes()?"MSG_ELIMINA_NODO":"";controller_eliminaRecord(b.getStore(),{id:c?c.get("cdaCode"):""},function(){a.aggiornaStore()},!1,d)},isActiveSyncCdaPaghe:function(){var a=this,b=a.getCBAnno().getValue(),c=a.cbaConfig.idOrganizzazione;if(b&&0<b&&c&&0<c)return new Promise(function(b,
c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/centriAttivita/isActiveSyncCdaPaghe",params:{idEsercizio:a.getCBAnno().getValue(),idOrganizzazione:a.cbaConfig.idOrganizzazione},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b("T"===a.data):c(a.message)}})})},syncAllCdaPaghe:function(a){var b=this;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/centriAttivita/syncAllCdaPaghe",timeout:72E5,params:{idEsercizio:b.getCBAnno().getValue(),idOrganizzazione:b.cbaConfig.idOrganizzazione},
success:function(a){a=Ext.JSON.decode(a.responseText);var c=[];a.success?(msgAdd(c,a.message),b.aggiornaStore()):msgAddError(c,a.message);msgShow("",c)}})},onLaunch:function(){var a=this,b=a.getTreeRep();a.cbaConfig.idOrganizzazione||(a.cbaConfig.idOrganizzazione=getIdOrg());b.controller=a;if(4==a.cbaConfig.tipoContabilita||5==a.cbaConfig.tipoContabilita){var c=a.getCBAnno(),d=Ext.create("Generali.esercizioCont.store.cboxEsercizioCont");c.bindStore(d);c.setVisible(!0);a.cbaConfig.allowChangeAnno?
c.setDisabled(!1):a.cbaConfig.codViedataChiamante?"ANAsVelCdaCespiti"!=a.cbaConfig.codViedataChiamante?c.setDisabled(a.cbaConfig.onlyTree):c.setDisabled(!1):c.setDisabled(a.cbaConfig.onlyTree);d.load({params:{idOrganizzazione:a.cbaConfig.idOrganizzazione},callback:function(b,d,h){getIdEsercizioDefaultByIdOrg(a.cbaConfig.idOrganizzazione,function(b){a.idEsercizioDefault=b;a.cbaConfig.idAnnoVideata?c.setValue(a.cbaConfig.idAnnoVideata):a.cbaConfig.cespite?c.setValue(a.cbaConfig.idAnnoCesp):c.setValue(a.idEsercizioDefault)})}})}else b.getStore().getProxy().url=
"/cba/gen/ws/general/cda/tree",a.getAnno().setValue(a.cbaConfig.idAnno),a.getAnno().setVisible(!0),a.aggiornaStore();a.cbaConfig.onlyTree&&(a.getBtnConferma().setVisible(!0),a.getBtnEsci().setVisible(!0),a.cbaConfig.bottoneCdaFinali?a.getBtnConferma1().setVisible(!0):a.getBtnConferma1().setVisible(!1));a.cbaConfig.multiSelezione&&(b.selModel.selectionMode="MULTI");a.cbaConfig.cespite&&(Ext.apply(a.cbaConfig,{onlyTree:!0}),a.getBtnConferma().setVisible(!0),a.getBtnEsci().setVisible(!0))},destroy:function(){this.callParent()}});
Ext.define("Generali.cda.controller.GestCda",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"FormCda",selector:this.selContainer+"#FormCda"},
{ref:"IdForm",selector:this.selContainer+"#IdForm"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"FsTipoCda",selector:this.selContainer+"#FsTipoCda"},{ref:"txCodRaccordo",selector:this.selContainer+"#txCodRaccordo"}])},verificaCampiForm:function(){var a=[];this.getFormCda().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormCda(),c=b.getForm().getFieldValues();-9999==this.getIdForm().getValue()&&(c.idPadre=this.idTestata);
Ext.apply(c,{idOrganizzazione:this.cbaConfig.idOrganizzazione,idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue()});this.recordModificato=!0;this.allineamentoCdaPaghe&&-9999!=c.id&&Messaggio("ATTENZIONE","CDA_COLLEGATI_PAGHE","OK","INFORMATION");controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getFormCda();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.storeCda;b.controller=
a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.recordModificato=!0;a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.setDisabled(!1);a.getFsTipoCda().setDisabled(!1);a.getTxCodRaccordo().setDisabled(!1);Ext.Ajax.request({method:"GET",params:{idOrganizzazione:a.cbaConfig.idOrganizzazione},url:"/cba/gen/ws/general/centriAttivita/nextCodRaccordo",success:function(b){b=
Ext.JSON.decode(b.responseText);b.success?a.getTxCodRaccordo().setValue(b.data):msgShowError("",b.message)}})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);c=!Ext.isEmpty(a.cbaConfig.url);43==CBA.moduli.moduloAttivo&&(c=!1);b.boxBottoni.queryById("btnEsci").hide();
b.boxBottoni.queryById("BtnStampa").setVisible(c);a.configurePrintButton(b.boxBottoni.queryById("BtnStampa"),"preview");if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},stampa:function(){var a=this.cbaConfig,b=a.winElaborazione,c={};Ext.apply(c,{idOrganizzazione:a.idOrganizzazione,idEsercizio:a.controllerAlbero.getCBAnno().getValue(),reportId:a.idRecord});"string"===typeof b&&(b=b===(!0).toString());
Ext.apply(this.parametriStampa,{url:a.url,jsonData:a.jsonData,titolo:a.titolo,winElaborazione:b});a=this.parametriStampa;Ext.apply(a.params,c);this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampa();this.callParent([a,b])},aggiornaStore:function(a){var b=this,c=b.storeCda,d=b.getFormCda();d.getForm();b.recordModificato?(b.recordModificato=
!1,b.cbaConfig.controllerAlbero.aggiornaStore(a),a||(clearForm(d),b.getFsTipoCda().setDisabled(!1),b.getTxCodRaccordo().setDisabled(!1))):(b.getFsTipoCda().setDisabled(!1),b.getTxCodRaccordo().setDisabled(!1),CBA.moduli.modulo51.abilitato&&Ext.Ajax.request({method:"GET",url:"/cba/amm/an/ws/prszn/general/list",params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue()},success:function(a){a=Ext.JSON.decode(a.responseText);a.success&&a.data&&
a.data[0]&&(b.allineamentoCdaPaghe="T"==a.data[0].allineaAlberoCdaAStipendi?!0:!1)}}),c.load({params:{id:b.idTestata},callback:function(a,c,h){h?(clearForm(d),a&&(b.getFormCda().loadRecord(a[0]),b.getFsTipoCda().setDisabled(b.hasChild),b.getTxCodRaccordo().setDisabled(b.hasChild))):msgShowError("",c.getError())}}))},onLaunch:function(){this.cbaConfig.idOrganizzazione||(this.cbaConfig.idOrganizzazione=getIdOrg());this.storeCda=Ext.create("Generali.cda.store.GestCda");this.allineamentoCdaPaghe=!1;this.gestioneForm()},
destroy:function(){eliminaStore(this.storeCda);eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.cda.controller.PnlGestCda",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CntPrincipale",selector:this.selContainer+"#CntPrincipale"}])},onLaunch:function(){this.cbaConfig.idOrganizzazione||(this.cbaConfig.idOrganizzazione=getIdOrg());if(43==CBA.moduli.moduloAttivo&&null==this.cbaConfig.tipoContabilita&&null==this.cbaConfig.idAnno){var a=getPersonContabili(this.cbaConfig.idOrganizzazione,
new Date,!0,null);this.cbaConfig.tipoContabilita=a.tipoContabilitaAbilitata;this.cbaConfig.idAnno=a.idEsercizio}a=Ext.create("Generali.cda.view.AlberoCda",{cbaConfig:{idOrganizzazione:this.cbaConfig.idOrganizzazione,permesso:this.cbaConfig.permesso,idAnno:this.cbaConfig.idAnno,onlyTree:2==this.cbaConfig.tipoContabilita?!0:this.cbaConfig.onlyTree,multiSelezione:this.cbaConfig.multiSelezione,tipoContabilita:this.cbaConfig.tipoContabilita,allowChangeAnno:this.cbaConfig.allowChangeAnno,currentCda:this.cbaConfig.currentCda,
controllerPadre:this,afterConferma:this.cbaConfig.afterConferma?this.cbaConfig.afterConferma:!1,soloIntermedi:this.cbaConfig.soloIntermedi,idAnnoVideata:this.cbaConfig.idAnnoVideata,afterEsci:this.cbaConfig.afterEsci?this.cbaConfig.afterEsci:!1,bottoneCdaFinali:this.cbaConfig.bottoneCdaFinali,codViedataChiamante:this.cbaConfig.codViedataChiamante}});this.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:a});var b={permesso:this.cbaConfig.permesso,controllerPadre:this,controllerAlbero:a.down("#TreeRep").controller,
idOrganizzazione:this.cbaConfig.idOrganizzazione};Ext.apply(b,this.cbaConfig);a.cbaConfig.onlyTree||this.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:Ext.create("Generali.cda.view.GestCda",{cbaConfig:b})})}});
Ext.define("Generali.cda.model.AlberoCda",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"cdaCode"},{name:"idOrganizzazione"},{name:"idPadre"},{name:"idVisibile"},{name:"idEsercizio"},{name:"descrizione"},{name:"tipoCda"},{name:"children"},{name:"text",convert:function(a,b){return b.get("idVisibile")?b.get("idVisibile")+" . "+b.get("descrizione"):b.get("descrizione")}},{name:"expanded"},{name:"leaf"},{name:"iconCls"}]});
Ext.define("Generali.cda.store.AlberoCda",{extend:"Ext.data.TreeStore",model:"Generali.cda.model.AlberoCda",autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/centriAttivita/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"},api:{create:"/cba/gen/ws/general/centriAttivita/insert",update:"/cba/gen/ws/general/centriAttivita/update",destroy:"/cba/gen/ws/general/centriAttivita/deleteRicorsivo"}},autoDestroy:!0});
Ext.define("Generali.cda.store.CboxCda",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/centriAttivita/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.cda.store.CboxCdaLevel",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/centriAttivita/cbox/maxlevel",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.cda.store.CboxCdaPadri",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/centriAttivita/cbox/padri",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.cda.store.GestCda",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"idPadre"},{name:"idVisibile"},{name:"idEsercizio"},{name:"descrizione"},{name:"tipoCda"},{name:"codiceRaccordo"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/centriAttivita/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/centriAttivita/get",create:"/cba/gen/ws/general/centriAttivita/insert",update:"/cba/gen/ws/general/centriAttivita/update",
destroy:"/cba/gen/ws/general/centriAttivita/deleteRicorsivo"}},autoDestroy:!0});
Ext.define("Generali.cda.view.AlberoCda",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",flex:1,width:300,border:0,viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){b="";d.isFiltered()&&a.isLeaf()&&(b="cba-dirty-record");return b}},itemId:"TreeRep",reference:"TreeRep",store:Ext.create("Generali.cda.store.AlberoCda"),useArrows:!0,rootVisible:!1,columns:[{xtype:"treecolumn",dataIndex:"text",
text:"CENTRI_DI_ATTIVITA",autoScroll:!0,flex:1,editor:{xtype:"textfield",allowBlank:!1}}],dockedItems:[{xtype:"toolbar",dock:"top",padding:"5 10 5 10",items:[{xtype:"container",itemId:"CntEconomica",reference:"CntEconomica",layout:{type:"hbox",align:"middle"},items:[{xtype:"combobox",width:300,labelWidth:50,fieldLabel:"ESERCIZIO",editable:!1,itemId:"CBAnno",reference:"CBAnno",displayField:"valore",queryMode:"local",valueField:"codice",hidden:!0},{xtype:"anno",itemId:"Anno",reference:"Anno",hidden:!0}]},
{xtype:"fieldset",title:"LEGENDA",html:(2==this.cbaConfig.tipoContabilita?'<span style="height:16px; width:26px; display:inline-block;" class="d"></span>'+traduci("DIRETTO"):"")+'<span style="height:16px; width:26px; display:inline-block;" class="i"></span>'+traduci("INTERMEDIO")+'<span style="height:16px; width:26px; display:inline-block;" class="f"></span>'+traduci("FINALE")},{xtype:"button",itemId:"BtnSyncPaghe",reference:"BtnSyncPaghe",iconCls:"icon-switch",text:"ALLINEA_STIPENDI",hidden:!0},
{xtype:"tbfill"},{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo",hidden:!0},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina",hidden:!0},{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-ok",text:"SELEZIONA_ESCI",hidden:!0},{xtype:"button",itemId:"BtnConferma1",reference:"BtnConferma1",iconCls:"icon-ok",text:'<span style="color:red; font-weight: bold;">'+traduci("SEL_FINALI")+
"</span>",hidden:!0},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-esciGriglia",text:"ESCI",hidden:!0}]},{xtype:"toolbar",dock:"top",padding:"5 10 5 10",items:[{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:300,fieldLabel:"",emptyText:"CERCA",listeners:{afterrender:function(){this.focus()}}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.cda.view.GestCda",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"form",flex:1,itemId:"FormCda",reference:"FormCda",autoScroll:!0,layout:{type:"vbox",align:"stretch"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",name:"id",itemId:"IdForm",reference:"IdForm",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",
name:"idEsercizio",hidden:!0},{xtype:"textfield",name:"idPadre",hidden:!0},{xtype:"container",items:[{xtype:"numberfield",fieldLabel:"CODICE",name:"idVisibile",width:150,allowBlank:!1,maxLength:3,enforceMaxLength:!0,allowDecimals:!1,useThousandSeparator:!1}]},{xtype:"textfield",fieldLabel:"DESCRIZIONE",name:"descrizione",allowBlank:!1,maxLength:100,enforceMaxLength:!0},{xtype:"fieldset",title:"TIPO",itemId:"FsTipoCda",reference:"FsTipoCda",items:[{xtype:"radiogroup",title:"TIPOLOGIA",itemId:"RgTipoCda",
reference:"RgTipoCda",items:[{xtype:"radiofield",name:"tipoCda",boxLabel:"INTERMEDIO",inputValue:"I"},{xtype:"radiofield",name:"tipoCda",boxLabel:"FINALE",inputValue:"F"}]}]},{xtype:"textfield",fieldLabel:"COD_RACCORDO",name:"codiceRaccordo",labelWidth:100,width:250,itemId:"txCodRaccordo",reference:"txCodRaccordo",maxLength:11,enforceMaxLength:!0}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.cda.view.PnlGestCda",{extend:"Generali.standard.ControlledContainer",uses:"Generali.standard.stampe.Button Generali.cda.view.AlberoCda Generali.cda.store.AlberoCda Generali.cda.controller.AlberoCda Generali.esercizioCont.store.cboxEsercizioCont Generali.cda.view.GestCda Generali.cda.controller.GestCda Generali.cda.store.GestCda Generali.standard.controller_PannelloBottoniVert".split(" "),initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"CntPrincipale",
reference:"CntPrincipale",layout:{align:"stretch",type:"hbox"}}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.controller.Anagrafica",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"DesBancaCli",selector:a+"#DesBancaCli"},{ref:"DesBancaFo",selector:a+"#DesBancaFo"},{ref:"TipoPagamento",selector:a+"#TipoPagamento"},{ref:"Form",selector:a+"#Form"},{ref:"IbanCli",selector:a+"#IbanCli"},{ref:"IbanFo",selector:a+"#IbanFo"},{ref:"RdgCondPag",selector:a+"#RdgCondPag"}]);this.control(a+"#RdgCondPag",
{change:this.changeRdgCondPag})},changeRdgCondPag:function(a,b,c,d){this.getIbanCli().setVisible("C"==b.tipoCondPag);this.getDesBancaCli().setVisible("C"==b.tipoCondPag);this.getIbanFo().setVisible("C"!=b.tipoCondPag);this.getDesBancaFo().setVisible("C"!=b.tipoCondPag)},caricaAnagrafica:function(a){var b=this;b.storeAnagrafica.load({params:{id:a},callback:function(a,d,e){e?(a=a[0],d=b.getForm(),Ext.isEmpty(a)?clearForm(d):d.loadRecord(a),b.getRdgCondPag().setDisabled("E"!=a.get("tipoAnagrafica")),
e="C"==a.get("tipoAnagrafica")||"E"==a.get("tipoAnagrafica")?"C":"F",d.getForm().setValues({tipoCondPag:e,iban:formattaIban(a.get("codCIN"),a.get("iban"),a.get("codABI"),a.get("codCAB"),a.get("contoCorrente")),ibanFrn:formattaIban(a.get("codCinFrn"),a.get("ibanFrn"),a.get("CodAbiFrn"),a.get("CodCabFrn"),a.get("contoCorrenteFrn")),telefono1:a.get("prefissoTelef1")+a.get("telefono1"),telefono2:a.get("prefissoTelef2")+a.get("telefono2"),fax:a.get("prefissoFax")+a.get("fax"),categoria:a.get("categoriaDesc")})):
msgShowError("",d.getError())}})},caricaInfoCliFor:function(a){var b=this;b.storeInfoCliFor.load({params:{idCliFor:a},callback:function(a,d,e){e?(d=a[0],a=b.getForm(),Ext.isEmpty(d)?clearForm(a):a.getForm().setValues({tipoAnagrafica:d.get("tipoCliFor"),ragioneSociale:d.get("descrizione"),indirizzo:d.get("indirizzo"),citta:d.get("descrizioneComune"),provincia:d.get("descrizioneProvincia"),cap:d.get("cap"),desNazione:d.get("descrizioneNazione"),codiceFiscale:d.get("codFiscale"),partitaIva:d.get("partitaIva"),
tipoPagamento:d.get("idCondPag"),categoria:d.get("categoria"),desBanca:d.get("desBancaCliente"),iban:d.get("ibanCliente"),desBancaFrn:d.get("desBancaFornitore"),ibanFrn:d.get("ibanFornitore"),telefono1:d.get("telefono"),telefono2:d.get("cellulare"),fax:d.get("fax"),mail:d.get("mail"),url:d.get("web")}),b.getRdgCondPag().setDisabled("E"!=d.get("tipoCliFor")),d="C"==d.get("tipoCliFor")||"E"==d.get("tipoCliFor")?"C":"F",a.getForm().setValues({tipoCondPag:d})):msgShowError("",d.getError())}})},onLaunch:function(){this.storeAnagrafica=
Ext.create("Generali.clientiFornitori.store.Anagrafica");this.storeInfoCliFor=Ext.create("Generali.anaCliFor.store.InfoCliFor");this.getTipoPagamento().getStore().load();containerSolaLettura(this.getForm())},destroy:function(){eliminaStore(this.storeAnagrafica);eliminaStore(this.storeInfoCliFor)}});
Ext.define("Generali.clientiFornitori.controller.DestinatarioFattura",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:a+"#Container"},{ref:"BtnImportaDest",selector:a+"#BtnImportaDest"},{ref:"Form",selector:a+"#Form"},{ref:"GridDestinatari",selector:a+"#GridDestinatari"},{ref:"TabPersonaRif",selector:a+"#TabPersonaRif"},{ref:"TabPagante",selector:a+"#TabPagante"},{ref:"TPDestinatario",selector:a+
"#TPDestinatario"},{ref:"CBUtente",selector:a+"#CBUtente"},{ref:"TxtPagante",selector:a+"#TxtPagante"},{ref:"RagioneSociale",selector:a+"#RagioneSociale"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"PnlImportaDest",selector:a+"#PnlImportaDest"}]);this.control(a+"#GridDestinatari",{itemdblclick:this.itemdblclickGridDestinatari});this.control(a+"#TPDestinatario",{tabchange:this.tabchangeTPDestinatario});this.control(a+"#TxtPagante",{change:this.changeTxtPagante});this.control(a+"#CBUtente",{select:this.selectCBUtente});
this.control(a+"#BtnImportaDest",{click:this.clickBtnImportaDest})},clickBtnImportaDest:function(){this.importaDestinatario()},itemdblclickGridDestinatari:function(a,b,c,d,e,g){a.up().solaLettura||this.importaDestinatario()},importaDestinatario:function(){var a=this;Messaggio("Attenzione","MSG_IMPORTA_DESTINATARIO","YESNOCANCEL","QUESTION","",function(){var b=a.getTPDestinatario().getActiveTab(),c=a.getGridDestinatari().getSelectionModel().getSelection()[0],d="",e="",g="",h="",k="";c&&(b==a.getTabPagante()?
(d=c.get("ragioneSociale"),e=c.get("indirizzo"),g=c.get("citta"),h=c.get("provincia"),k=c.get("cap")):b==a.getTabPersonaRif()&&(d=c.get("nomePersona"),c.get("indirizzo")&&(e=c.get("indirizzo").indirizzo+(c.get("indirizzo").civico?" "+c.get("indirizzo").civico:""),c.get("indirizzo").esponente&&(e+="/"+c.get("indirizzo").esponente),c.get("indirizzo").interno&&(e+=" Int. "+c.get("indirizzo").interno),g=c.get("indirizzo").desComune,h=c.get("indirizzo").provincia,k=c.get("indirizzo").cap)),a.getForm().getForm().setValues({cognomeNome:d,
indirizzo:e,citta:g,provincia:h,cap:k}),a.salvaForm())})},selectCBUtente:function(){this.aggiornaDestinatari()},changeTxtPagante:function(a,b){var c=this;setTaskField(a,function(){if(a.minChars&&a.getValue()&&a.getValue().length<a.minChars)return!1;var b=c.getGridDestinatari(),e=b.getStore();e.getProxy().extraParams={valore:a.getValue()?a.getValue():"",tipoContabilita:c.personContabili.tipoContabilitaAbilitata};svuotaStore(e);e.loadPage(1,{callback:function(c,d,e){b.getSelectionModel().select(0);
a.focus(!1,20)}})})},tabchangeTPDestinatario:function(a,b,c,d){this.codfocl&&this.aggiornaDestinatari()},aggiornaDestinatari:function(){var a=this.getGridDestinatari(),b=a.down("toolbar"),c=this.getTPDestinatario().getActiveTab(),d;c==this.getTabPagante()?(d=traduci("RAGIONE_SOCIALE"),c=this.storePaganti,a.reconfigure(c),b.bindStore(c),b.show(),c.getProxy().extraParams={valore:"",tipoContabilita:this.personContabili.tipoContabilitaAbilitata},c.loadPage(1,{callback:function(b,c,d){a.rendered&&a.getSelectionModel().select(0)}})):
c==this.getTabPersonaRif()&&(d=traduci("COGNOME_NOME"),50==CBA.moduli.moduloAttivo&&(d=traduci("NOMINATIVO")),c=this.storePersoneRif,a.reconfigure(c),b.bindStore(c),b.show(),c.getProxy().extraParams={valore:"",codospite:this.getCBUtente().getValue()?this.getCBUtente().getValue():0,idPagante:this.codfocl?this.codfocl:0},c.loadPage(1,{callback:function(b,c,d){a.rendered&&a.getSelectionModel().select(0)}}));a.columns[0].setText(d);this.getRagioneSociale().setFieldLabel(d)},aggiornaStore:function(){var a=
this.getForm();a.store.load({params:{codfocl:this.codfocl},callback:function(b,c,d){d?(b=b[0],Ext.isEmpty(b)?clearForm(a):(a.loadRecord(b),a.getForm().setValues({formDirty:!1}))):msgShowError("",c.getError())}})},caricaDestinatario:function(a,b){"L"!=this.permesso&&(containerSolaLettura(this.getContainer(),!1),controller_abilitaBottoni(this.getForm()));this.getForm().setTitle(traduci("DESTINATARIO_FATTURA")+": "+b);this.codfocl=a;this.aggiornaStore();this.getTPDestinatario().getActiveTab()!=this.getTabPersonaRif()?
this.getTPDestinatario().setActiveTab(this.getTabPersonaRif()):this.aggiornaDestinatari()},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){form=this.getForm();form.getForm().setValues({codFoCl:this.codfocl});var b=form.getForm().getFieldValues();delete b.formDirty;controller_salvaRecord(form,b,a)?a&&this.callbackEsci&&this.callbackEsci():form.getForm().findField("formDirty").setValue(!0)},gestioneForm:function(){var a=
this,b=a.getForm();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.storeDestFatt;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},esci_callback:function(){var c=a.getForm().up("window");controller_puoiUscire(c,b,function(){a.salvaForm(!0)},function(){a.callbackEsci&&a.callbackEsci();c.close()},function(){a.callbackEsci&&a.callbackEsci();c.close()})},annulla_callback:function(){a.aggiornaStore()},
nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){controller_eliminaRecord(b.store,{id:b.getForm().findField("id").getValue()},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnNuovo").hide();a.hideButtonEsci&&b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);e?a.getPnlImportaDest().setDisabled(!0):
a.getPnlImportaDest().setDisabled(!1)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},onLaunch:function(){this.storeDestFatt=Ext.create("Generali.clientiFornitori.store.DestinatarioFattura");this.storePaganti=Ext.create("Generali.clientiFornitori.store.ClientiFornitoriSrc",{autoDestroy:!1,tipoStore:"paganti"});this.storePersoneRif=Ext.create("Generali.clientiFornitori.store.PersoneRiferimento",{autoDestroy:!1,tipoStore:"personeRif"});this.personContabili=getPersonContabili(getIdOrg(),new Date,
!0,null);this.gestioneForm();containerSolaLettura(this.getContainer())},destroy:function(){eliminaStore(this.storeDestFatt);eliminaStore(this.storePaganti);eliminaStore(this.storePersoneRif);eliminaStore(this.storeForm)}});
Ext.define("Generali.clientiFornitori.controller.GridFranchigie",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"GridFranchigia",selector:this.selContainer+"#GridFranchigia"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"}]);this.control(this.selContainer+"#GridFranchigia",{beforeedit:this.beforeeditGridFranchigia,
edit:this.editGridFranchigia,canceledit:this.canceleditGridFranchigia,validateedit:this.validateeditGridFranchigia});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina})},clickBtnNuovo:function(a){a={idFranchigia:this.idFranchigia};"P"==this.tipoImporto&&Ext.apply(a,{dalGiorno:0,quotaSanitaria:100,quotaSociale:100});controller_nuovoRecordGrid(a,this.getGridFranchigia())},clickBtnElimina:function(a){var b=
this;a=b.getGridFranchigia();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridFranchigia:function(a,b,c){if(!0===a.editing)return!1;this.abilitaComponentiTestata(!1);this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},editGridFranchigia:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=
this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,!1,"id")?(this.abilitaComponentiTestata(!0),this.abilitaBottoniGrid(!0)):a.startEdit(b.record,0)},canceleditGridFranchigia:function(a,b,c){this.abilitaComponentiTestata(!0);this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridFranchigia:function(a,b,c){a=[];b=b.newValues;Ext.isEmpty(b.quotaSanitaria)&&Ext.isEmpty(b.quotaSociale)?msgAddError(a,"MSG_QSAN_QSOC_OBBLIGATORI"):"D"!=this.tipoImporto&&(b.quotaSanitaria&&
0>b.quotaSanitaria||b.quotaSociale&&0>b.quotaSociale)&&msgAddError(a,"MSG_QUOTE_NEGATIVE");return msgShow("",a)},aggiornaStore:function(a){var b=this.getGridFranchigia(),c=b.getStore();c.load({params:{idFranchigia:this.idFranchigia},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridFranchigia().getStore())},onLaunch:function(){ImpostaUrl([this.getGridFranchigia().getStore()]);
this.getGridFranchigia().controller=this}});
Ext.define("Generali.clientiFornitori.controller.PersonFattEle",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"idCodIpaPF",selector:a+"#idCodIpaPF"},{ref:"GrigliaCampiAgg",selector:a+"#GrigliaCampiAgg"},{ref:"ckbflagAttivo",selector:a+"#ckbflagAttivo"},{ref:"CkbFattNetPens",selector:a+"#CkbFattNetPens"},{ref:"CkbBollSenzAdd",selector:a+"#CkbBollSenzAdd"},{ref:"CkbBollNaNegativo",
selector:a+"#CkbBollNaNegativo"},{ref:"CkbNascondiDettZero",selector:a+"#CkbNascondiDettZero"},{ref:"CbxAccorpaDesc",selector:a+"#CbxAccorpaDesc"},{ref:"CkbSoloInizialiNome",selector:a+"#CkbSoloInizialiNome"},{ref:"numeroInizialiNome",selector:a+"#numeroInizialiNome"},{ref:"CkbNascondiNome",selector:a+"#CkbNascondiNome"},{ref:"Codfocl",selector:a+"#Codfocl"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"BtnRiprGrid",selector:a+"#BtnRiprGrid"},{ref:"BtnConfGrid",selector:a+"#BtnConfGrid"}]);this.control(a+
"#CkbSoloInizialiNome",{change:this.changeCkbSoloInizialiNome});this.control(a+"#BtnConfGrid",{click:this.salvaGrid});this.control(a+"#BtnRiprGrid",{click:this.aggiornaStore});this.control(a+"#idCodIpaPF",{change:this.changeIdCodIpaPF});this.control(a+"#ckbflagAttivo",{checkchange:this.ckbflagAttivo});this.control(a+"#GrigliaCampiAgg",{select:this.onGrigliaCampiAggSelect,deselect:this.onGrigliaCampiAggDeSelect,beforeedit:this.onGrigliaCampiAggBeforeEdit,edit:this.onGrigliaCampiAggEdit})},changeCkbSoloInizialiNome:function(a,
b){this.getNumeroInizialiNome().setDisabled(!b)},onGrigliaCampiAggBeforeEdit:function(a,b,c){a=a.grid;c=b.record;c.set("recModificato",!0);"valore_predefinito"!=b.field||Ext.isEmpty(c.get("lunghezzamassima"))||(b=b.column.getEditor(),b.rendered?b.inputEl.set({maxLength:c.get("lunghezzamassima")}):b.maxLength=c.get("lunghezzamassima"));a.getSelectionModel().select([c],!0,!0)},onGrigliaCampiAggSelect:function(a,b,c){b.set("recModificato",!0);b.set("flagAttivo",!0)},onGrigliaCampiAggDeSelect:function(a,
b,c){b.set("recModificato",!0);b.set("flagAttivo",!1)},onGrigliaCampiAggEdit:function(a,b,c){var d=[];a.grid.getStore().each(function(a){"T"!=a.get("flagAttivo")&&1!=a.get("flagAttivo")&&Ext.isEmpty(a.get("valore_predefinito"))||d.push(a)});a.grid.getSelectionModel().deselectAll();a.grid.getSelectionModel().select(d,!1)},clickBtnRiprGrid:function(){this.getGrigliaCampiAgg().getStore().rejectChanges()},changeIdCodIpaPF:function(a,b){this.getGrigliaCampiAgg();this.idcodipa=b;this.aggiornaStore()},aggiornaStoreForm:function(a,
b){var c=this,d,e;null!=b?(d=b,e=c.storeForm):e=d=c;e.load({params:{idOrganizzazione:c.idOrg,idCodIpa:c.idcodipa},callback:function(a,b,e){e?(Ext.isEmpty(a)?clearForm(d):(b=a[0],e=b.get("numeroInizialiNome"),c.getNumeroInizialiNome().setDisabled(0==e),Ext.apply(b.data,{soloInizialiNome:0==e?!1:!0}),d.loadRecord(a[0]),c.getCkbSoloInizialiNome().setValue(0<e)),c.setDisableCheckBoxForm(!1)):msgShowError("",b.getError())}})},aggiornaStore:function(){var a=this,b=a.getGrigliaCampiAgg().getStore(),c=a.getForm();
svuotaStore(b);a.setDisableCheckBoxForm(!0);null!=a.idcodipa&&(a.aggiornaStoreForm(null,c),b.load({params:{idPagante:a.codfocl,idOrganizzazione:a.idOrg,idCodIpa:a.idcodipa},callback:function(b){a.impostaFlagAttivi(b)}}))},impostaFlagAttivi:function(a){var b=this.getGrigliaCampiAgg(),c=[];Ext.each(a,function(a){"T"!=a.get("flagAttivo")&&null==a.get("id")||c.push(a)});b.getSelectionModel().select(c,!0,!0);b.getStore().commitChanges()},verificaCampiForm:function(){},caricaPersonFattEle:function(a){var b=
this;b.codfocl=a;b.storeIdCodIpaPF=Ext.create("GestioneFatture.store.CodIpa",{autoDestroy:!1});b.storeIdCodIpaPF.load({params:{codCliente:a,idOrganizzazione:b.idOrg},callback:function(a){Ext.each(a,function(a){a="B2B"==a.get("extra")?traduci("COD_PEC_B2B"):traduci("COD_IPA");b.getIdCodIpaPF().setFieldLabel(a)});b.getIdCodIpaPF().setValue(null);clearForm(b.getForm());1==a.length&&b.getIdCodIpaPF().setValue(a[0].get("codice"))}});b.getIdCodIpaPF().bindStore(b.storeIdCodIpaPF)},gestioneForm:function(){var a=
this,b=a.getForm();clearForm(b);b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=Ext.create("Generali.clientiFornitori.store.PersonFeClienti");b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaPersonFeClienti(b)},annulla_callback:function(){a.aggiornaStore()},verificaCampiForm_callback:function(){return!0}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnNuovo").setVisible(!1);
b.boxBottoni.queryById("btnElimina").setVisible(!1);b.boxBottoni.queryById("btnEsci").setVisible(!1);if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},onLaunch:function(){function a(){var a=d.isModified();b.getBtnConfGrid().setDisabled(!a);b.getBtnRiprGrid().setDisabled(!a)}var b=this,c=b.getGrigliaCampiAgg();b.caricaPersonFattEle;b.gestioneForm();var d=c.getStore();c.getStore().on({datachanged:a,update:a});b.setDisableCheckBoxForm(!0)},setDisableCheckBoxForm:function(a){this.getCkbFattNetPens().setDisabled(a);
this.getCkbBollSenzAdd().setDisabled(a);this.getCkbBollNaNegativo().setDisabled(a);this.getCkbNascondiDettZero().setDisabled(a);this.getCbxAccorpaDesc().setDisabled(a);this.getCkbNascondiNome().setDisabled(a);this.getCkbSoloInizialiNome().setDisabled(a)},salvaPersonFeClienti:function(a){var b=this,c=[],d=b.getForm().getForm(),e=d.getFieldValues(),g="/cba/gen/ws/general/fatturaElettronica/prszn/fePerCli/";Ext.apply(e,{});null==e.accorpaDescrizioni&&(e.accorpaDescrizioni="F");a={id:e.id,idCodIpa:b.idcodipa,
esportaNettoPensioni:e.esportaNettoPensioni?"T":"F",addebitaBollo:e.addebitaBollo?"T":"F",bolloNAccNegativo:e.bolloNAccNegativo?"T":"F",includeBolloLinee:e.includeBolloLinee?"T":"F",accorpaDescrizioni:e.accorpaDescrizioni,nascondiDettZero:e.nascondiDettZero?"T":"F",idOrganizzazione:b.idOrg,numeroInizialiNome:b.getCkbSoloInizialiNome().getValue()?e.numeroInizialiNome:0,nascondiNome:e.nascondiNome?"T":"F"};g=""==e.id||0===e.id?g+"new":g+"update";Ext.Ajax.request({url:g,method:"POST",jsonData:a,async:!1,
success:function(a){a=Ext.JSON.decode(a.responseText);a.success&&(msgAdd(c,a.message),msgShow("MSG_SALVATAGGIO_DATI",c),b.aggiornaStoreForm(e.id,d))}})},salvaGrid:function(a){function b(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d].idCampoTe==b)return d;return-1}a="MSG_SALVATAGGIO_DATI";var c=[],d=[],e=!0,g,h=this.getGrigliaCampiAgg(),k=h.getStore(),l=[],m=[],n=[],p=k.getModifiedRecords();g=!1;Ext.each(k.getRange(),function(a){var c,d,e;c=a.get("idcampoTe");d=a.get("obbligatorio");e=a.get("nometag");
idcampoDeFormat=a.get("idcampoDeFormat");a=a.get("flagAttivo");if(d)if(d=b(m,c),0<=d){if(c=m[d].numOcc+1,m[d].numOcc=c,"F"==a||0==a)a=m[d].numFalse+1,m[d].numFalse=a,e=m[d].elencoCampi+"\n"+idcampoDeFormat+" - "+e,m[d].elencoCampi=e}else"F"==a||0==a?(a=1,e=idcampoDeFormat+" - "+e):(a=0,e=""),m.push({idCampoTe:c,numOcc:1,numFalse:a,elencoCampi:e});else("T"==a||1==a)&&0>n.indexOf(c)&&n.push(c)});for(i=0;i<p.length;i++){var q=p[i],k=q.get("idcampoTe"),t=q.get("flagAttivo");q.get("obbligatorio");0==t&&
(q.data.valore_predefinito=null);q.data.idCampo=q.data.idcampoDe;null==q.data.id&&(q.data.codFoCl=this.codfocl,q.data.idCodIpa=this.idcodipa,q.data.idOrganizzazione=this.idOrg);l.push(q.data);t=b(m,k);0<=t&&0<m[t].numFalse&&(-1<n.indexOf(k)&&(g=!0,q=k,q+="\n",q+=m[t].elencoCampi,Ext.Array.contains(d,q)||d.push(q)),m[t].numFalse!=m[t].numOcc&&(g=!0,q=k,q+="\n",q+=m[t].elencoCampi,Ext.Array.contains(d,q)||d.push(q)))}g?(e=!1,Ext.each(d,function(a){msgAddError(c,a)}),a="MSG_CAMPI_OBBLIGATORI"):Ext.Ajax.request({url:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/saveGrid",
method:"POST",jsonData:Ext.JSON.encode(l),async:!1,success:function(a){e=Ext.JSON.decode(a.responseText).success?!0:!1}});h.getStore().commitChanges();e?msgShow(a,c):msgShowError(a,c);this.aggiornaStore();return e},destroy:function(){eliminaStore(this.storeForm);eliminaStore(this.storeIdCodIpaPF);this.callParent()}});
Ext.define("Generali.clientiFornitori.controller.PersonFranchigia",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"Nuovo",selector:this.selContainer+"#Nuovo"},{ref:"Elimina",selector:this.selContainer+"#Elimina"},{ref:"Servizio",selector:this.selContainer+
"#Servizio"},{ref:"GridTestata",selector:this.selContainer+"#GridTestata"},{ref:"CntTestata",selector:this.selContainer+"#CntTestata"},{ref:"TipoImporto",selector:this.selContainer+"#TipoImporto"},{ref:"CBMotivoAssenza",selector:this.selContainer+"#CBMotivoAssenza"},{ref:"CBTipoAssenza",selector:this.selContainer+"#CBTipoAssenza"},{ref:"CalcoloFranchigia",selector:this.selContainer+"#CalcoloFranchigia"},{ref:"TipoCalcolo",selector:this.selContainer+"#TipoCalcolo"},{ref:"TipoCalcoloInfo",selector:this.selContainer+
"#TipoCalcoloInfo"}]);this.control(this.selContainer+"#GridTestata",{select:this.selectGridTestata});this.control(this.selContainer+"#Servizio",{select:this.changeTipoAssenza});this.control(this.selContainer+"#CBTipoAssenza",{select:this.changeTipoAssenza});this.control(this.selContainer+"#TipoCalcoloInfo",{afterrender:this.tipoCalcoloInfoAfterrender})},tipoCalcoloInfoAfterrender:function(a,b){var c=traduci("FRANCHIGIE_TIPOCALCOLO_RES_TOOLTIP");if("S"==this.cbaConfig.tipoServizio||"A"==this.cbaConfig.tipoServizio||
"M"==this.cbaConfig.tipoServizio)c=traduci("FRANCHIGIE_TIPOCALCOLO_TOOLTIP");creaToolTip(a.getId(),c,"",100,300,!1,!1)},loadStoreMotiviAssenza:function(a,b){this.storeMotivoAssenza.load({async:!1,params:{idServizio:a,filtroTipoUscita:b}})},changeTipoAssenza:function(a,b){this.getCBMotivoAssenza().clearValue();var c=null,d=null;"Servizio"==a.getItemId()?(c=b.data.codice,d=this.getCBTipoAssenza().getValue()):(c=this.getServizio().getValue(),d=b.data.codice);this.loadStoreMotiviAssenza(c,d);this.getTipoCalcolo().getStore().clearFilter();
this.getTipoCalcolo().getStore().filter(function(a){var c=!0;"S"==b.get("extra")||"A"==b.get("extra")||"M"==b.get("extra")?"C"===a.get("codice")||"M"===a.get("codice")?c=!0:c=!1:"C"===a.get("codice")||"S"===a.get("codice")?c=!0:c=!1;return c})},selectGridTestata:function(a,b){clearForm(this.getForm());this.loadStoreMotiviAssenza(b.get("idServizio"),b.get("tipoAssenza"));this.getForm().loadRecord(b);var c=this.getCntGridFranchigia();c.controller.idFranchigia=b.get("id");c.controller.tipoImporto=b.get("tipoImporto");
var d=trovaRecord(this.getServizio().getStore(),"codice",b.get("idServizio"));c.controller.tipoServizio=d.get("extra").split(",")[1];c.controller.aggiornaStore();this.getTipoCalcolo().getStore().clearFilter();this.getTipoCalcolo().getStore().filter(function(a){var b=!0;"S"==c.controller.tipoServizio||"A"==c.controller.tipoServizio||"M"==c.controller.tipoServizio?"C"===a.get("codice")||"M"===a.get("codice")?b=!0:b=!1:"C"===a.get("codice")||"S"===a.get("codice")?b=!0:b=!1;return b});this.getForm().getForm().setValues({tipoCalcolo:Ext.isEmpty(b.get("tipoCalcolo"))?
"C":b.get("tipoCalcolo")})},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){form=this.getForm();var b=form.getForm().getFieldValues();Ext.apply(b,{codfocl:this.codfocl});controller_salvaRecord(form,b,a)&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridTestata().getStore();b.controller=
a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){svuotaStore(a.storeMotivoAssenza);controller_nuovoRecord(b);50==getModuloAttivo()&&a.getCBTipoAssenza().setValue("F");b.getForm().setValues({dataDal:new Date,tipoImporto:"P",tipoCalcolo:"C"});a.getCntTestata().setVisible(!0);a.getCntGridFranchigia().setVisible(!0)},elimina_callback:function(){var c=
b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getCntGridFranchigia().setDisabled(e)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},caricaFranchigie:function(a){"L"!=this.permesso&&
(containerSolaLettura(this.getContainer(),!1),controller_abilitaBottoni(this.getForm()));this.codfocl=a;svuotaStore(this.storeMotivoAssenza);this.aggiornaStore()},abilitaComponentiTestata:function(a){this.getGridTestata().setDisabled(!a);this.getCntTestata().setDisabled(!a);this.getBoxBottoni().setDisabled(!a)},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store;e.load({params:{soloTestata:!0,chiave:b.idOrg,idPagante:b.codfocl},callback:function(g,h,k){k?Ext.isEmpty(g)?(clearForm(c),
b.getCntTestata().setVisible(!1),b.getCntGridFranchigia().controller.svuotaStore(),b.getCntGridFranchigia().setVisible(!1)):(a||(a=d.findField("id").getValue()),g=trovaRecord(e,"id",a),h=b.getGridTestata(),h.getSelectionModel().deselectAll(),h.getSelectionModel().select(g?[g]:0),b.getCntTestata().setVisible(!0),b.getCntGridFranchigia().setVisible(!0)):msgShowError("",h.getError())}})},onLaunch:function(){var a=this,b=a.getCBTipoAssenza().getStore();ImpostaUrl([a.getGridTestata().getStore(),b,a.getServizio().getStore(),
a.getCBMotivoAssenza().getStore()]);b.load();a.getServizio().getStore().load({params:{idOrganizzazione:a.idOrg,type:getTipiServizio()}});a.storeMotivoAssenza=a.getCBMotivoAssenza().getStore();a.storeMotivoAssenza.getProxy().extraParams={scheda:"H",domanda:2,extraField:"tipoUscita"};var c=Ext.create("Generali.clientiFornitori.view.GridFranchigie",{height:150,width:425});a.getForm().add(c);a.getCntGridFranchigia=function(){return c};b=Ext.create("Generali.store.EuroPerc");b.insert(1,[{codice:"R",valore:traduci("FRANCHIGIE_PERC_ROUND2")}]);
b.add({codice:"D",valore:"-"});a.getTipoImporto().bindStore(b);b=Ext.create("Generali.store.FranchigiaTipoCalcolo");a.getTipoCalcolo().bindStore(b);a.gestioneForm();a.getCntGridFranchigia().controller.abilitaComponentiTestata=function(b){a.abilitaComponentiTestata(b)};containerSolaLettura(a.getContainer())},destroy:function(){eliminaStore(this.storeForm)}});
Ext.define("Generali.clientiFornitori.controller.PersonRette",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:a+"#Container"},{ref:"Form",selector:a+"#Form"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"CBCodFoCl",selector:a+"#CBCodFoCl"},{ref:"Codfocl",selector:a+"#Codfocl"},{ref:"CkbPersIng",selector:a+"#CkbPersIng"},{ref:"CntCheckIng",selector:a+"#CntCheckIng"},{ref:"Capitolo",selector:a+
"#Capitolo"},{ref:"TipoDocumento",selector:a+"#TipoDocumento"},{ref:"Attivita",selector:a+"#Attivita"},{ref:"Registro",selector:a+"#Registro"},{ref:"cntCda",selector:a+"#cntCda"},{ref:"CBForzaParamContabili",selector:a+"#CBForzaParamContabili"},{ref:"CntContoRegistro",selector:a+"#CntContoRegistro"},{ref:"CntCapitoloArticolo",selector:a+"#CntCapitoloArticolo"},{ref:"ProtezioneRetta",selector:a+"#ProtezioneRetta"},{ref:"CausaleFattura",selector:a+"#CausaleFattura"},{ref:"CausaleNotaAccredito",selector:a+
"#CausaleNotaAccredito"},{ref:"IdAliquotaIva",selector:a+"#IdAliquotaIva"},{ref:"RitenutaIdAliquotaIva",selector:a+"#RitenutaIdAliquotaIva"},{ref:"idModelloFattura",selector:a+"#idModelloFattura"},{ref:"BolloAutomatico",selector:a+"#BolloAutomatico"},{ref:"IdImpostazioniBollo",selector:a+"#IdImpostazioniBollo"},{ref:"RitenutaConto",selector:a+"#RitenutaConto"},{ref:"Conto",selector:a+"#Conto"},{ref:"CbRitenutaAcconto",selector:a+"#CbRitenutaAcconto"},{ref:"CntRitenutaCda",selector:a+"#CntRitenutaCda"},
{ref:"Cig",selector:a+"#Cig"},{ref:"Cup",selector:a+"#Cup"},{ref:"CigCupNote",selector:a+"#CigCupNote"},{ref:"Iban",selector:a+"#Iban"},{ref:"SeparazioneRetta",selector:a+"#SeparazioneRetta"},{ref:"rbTipoCalcoloRetta",selector:a+"#rbTipoCalcoloRetta"},{ref:"ConguaglioAutomatico",selector:a+"#ConguaglioAutomatico"},{ref:"fsIdCodIpa",selector:a+"#fsIdCodIpa"},{ref:"IdCodIpa",selector:a+"#IdCodIpa"},{ref:"cbEnteIva",selector:a+"#cbEnteIva"},{ref:"BtnPriorita",selector:a+"#BtnPriorita"},{ref:"MotiviDim",
selector:a+"#MotiviDim"},{ref:"DirtyGrid",selector:a+"#DirtyGrid"},{ref:"CkgiornoDimissione",selector:a+"#CkgiornoDimissione"},{ref:"CkgiornoDecesso",selector:a+"#CkgiornoDecesso"}]);this.control(a+"#rbTipoCalcoloRetta",{change:this.changeRbTipoCalcoloRetta});this.control(a+"#CbRitenutaAcconto",{change:this.changeCbRitenutaAcconto});this.control(a+"#CkbPersIng",{change:this.changeCkbPersIng});this.control(a+"#Capitolo",{select:this.selectCapitolo});this.control(a+"#TipoDocumento",{select:this.selectTipoDocumento,
change:this.changeTipoDocumento});this.control(a+"#BntCigCupClear",{click:this.btnCigCupClearClick});this.control(a+"#BntCigCupSelect",{click:this.btnCigCupSelectClick});this.control(a+"#BtnPrioritaFina",{afterrender:this.BtnPrioritaafterrender});this.control(a+"#BtnPriorita",{afterrender:this.BtnPrioritaafterrender});this.control(a+"#BolloAutomatico",{change:this.changeBolloAutomatico});this.control(a+"#CkgiornoDimissione",{change:this.changeGGDimissione});this.control(a+"#CkgiornoDecesso",{change:this.changeGGDecesso})},
changeGGDimissione:function(){this.getCkgiornoDecesso().getValue()||this.getCkgiornoDimissione().getValue()?this.getMotiviDim().setDisabled(!1):this.getMotiviDim().setDisabled(!0)},changeGGDecesso:function(){this.getCkgiornoDecesso().getValue()||this.getCkgiornoDimissione().getValue()?this.getMotiviDim().setDisabled(!1):this.getMotiviDim().setDisabled(!0)},changeBolloAutomatico:function(a,b){this.getIdImpostazioniBollo().setVisible(b)},BtnPrioritaafterrender:function(a,b,c){b=Ext.create("Generali.clientiFornitori.view.PnlPriorita");
creaToolTip(a.id,"","PRIORITA_PARAMETRI_CONTABILI",235,300,b)},changeRbTipoCalcoloRetta:function(a,b){"A"==b.tipoCalcoloRetta?this.getConguaglioAutomatico().enable():this.getConguaglioAutomatico().disable()},btnCigCupSelectClick:function(){var a=this;"S"==a.permesso&&Ext.create("winCBA",{name:"Generali.clientiFornitori.view.SelezionaCigCup",titolo:"CIGCUP_SELECT",dimensione:2,configItem:{isWindow:!0,permesso:a.permesso,idCliFor:a.codfocl,leggiTabellaNuova:a.tabelleAmm2?"T":"F",editDettagli:!0,afterConferma:function(b,
c,d,e,g){a.getCig().setValue(c);a.getCup().setValue(d);a.getCigCupNote().setValue(g);a.getIban().setValue(e);a.getForm().isDirty()||a.getCodfocl().setValue("0"+a.codfocl)}},closable:!0}).show()},btnCigCupClearClick:function(){"S"!=this.permesso||Ext.isEmpty(this.getCodfocl().getValue())||(this.getCig().setValue(""),this.getCup().setValue(""),this.getIban().setValue(""),this.getCigCupNote().setValue(""),this.getForm().isDirty()||this.getCodfocl().setValue("0"+this.codfocl))},changeCbRitenutaAcconto:function(a,
b,c,d){a=["T"];this.getRitenutaIdAliquotaIva().setVisible(a.includes(b));this.getRitenutaConto().setVisible(a.includes(b));this.getCntRitenutaCda().setVisible(a.includes(b));Ext.apply(this.getCntRitenutaCda().cbaConfig,{tipoContabilita:null})},changeTipoDocumento:function(a,b,c,d){b!=c&&null!=c&&(this.getRegistro().clearValue(),this.getCausaleFattura().clearValue(),this.getCausaleNotaAccredito().clearValue());this.getCausaleNotaAccredito().allowBlank=4!=b;this.getCausaleNotaAccredito().setVisible(4==
b);this.getIdAliquotaIva().setVisible(5!=b);this.abilitaCampi()},loadRegistro:function(a){var b=this,c=b.getTipoDocumento().getValue(),d=b.getForm().getForm(),e=null;b.tabelleAmm2&&a&&(a.data.annoRegistro||a.data.annoConto||a.data.annoCda)?Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/esercizioCont/get",params:{id:a.data.annoRegistro||a.data.annoConto||a.data.annoCda},async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?e=new Date(Ext.Date.parse(a.data.dataFinePeriodo,
"Y-m-d H:i:s")):msgShowError("",a.message)}}):e=new Date;var g=e.getFullYear();Ext.apply(b.getCntCda().cbaConfig,{tipoContabilita:null});var h={};b.tabelleAmm2?(b.storeRegistro.urlAmm1||(b.storeRegistro.urlAmm1=b.storeRegistro.getProxy().url),b.storeRegistro.getProxy().url="/cba/osp/co/ws/genAmmPers/registriIva/detail/cboxByDate",Ext.apply(h,{dataControllo:e,tipoDocumento:c/2,idOrganizzazione:null!=b.cbaConfig.idOrganizzazione?b.cbaConfig.idOrganizzazione:getIdOrg()})):(b.storeRegistro.urlAmm1&&(b.storeRegistro.getProxy().url=
b.storeRegistro.urlAmm1),Ext.apply(h,{anno:g,tipoDocOspiti:c}));b.storeRegistro.load({params:h,callback:function(e,g,h){a&&a.get("tipoDocumento")==c&&d.setValues({registro:b.tabelleAmm2&&a.get("idRegistro")?a.get("idRegistro"):a.get("registro")});!d.findField("registro").getValue()&&e&&1==e.length&&b.getRegistro().setValue(e[0].get("codice"))}})},loadConto:function(a){var b=(new Date).getFullYear(),c=this.getForm().getForm(),d={};annoConto=a&&a.get("conto")&&a.get("annoConto")?a.get("annoConto"):
this.personContabili.idEsercizio;this.tabelleAmm2?(this.storeConto.getProxy().url="/cba/gen/ws/general/pianoDeiConti/leaf/cbox",Ext.apply(d,{idOrganizzazione:getIdOrg(),idEsercizio:annoConto}),c.setValues({annoConto:annoConto})):(this.storeConto.getProxy().url="/cba/gen/ws/general/conto/src",Ext.apply(d,{anno:a&&a.get("annoConto")?a.get("annoConto"):b}),c.setValues({annoConto:d.anno}));this.storeConto.load({params:d,callback:function(){a&&c.setValues({conto:a.get("conto"),ritenuta_conto:a.get("ritenuta_conto")})}})},
selectTipoDocumento:function(a){var b=this,c=b.getRegistro(),d=a?a.value:0;svuotaStore(c.getStore());svuotaStore(b.storeCausaleContabilita);if(!d||0==d)return!1;5==d||c.editable||b.loadRegistro();b.storeCausaleContabilita.load({params:{tipoContabilita:b.personContabili.tipoContabilitaAbilitata,tipoDocOspiti:d,idOrganizzazione:getIdOrg()},callback:function(a,c,h){b.filterCausaliFattura(d);b.getCausaleFattura().getStore().data.items&&1==b.getCausaleFattura().getStore().data.items.length&&b.getCausaleFattura().setValue(b.getCausaleFattura().getStore().data.items[0].get("codice"));
b.getCausaleNotaAccredito().getStore().data.items&&1==b.getCausaleNotaAccredito().getStore().data.items.length&&b.getCausaleNotaAccredito().setValue(b.getCausaleNotaAccredito().getStore().data.items[0].get("codice"));b.getCausaleFattura().validate();b.getCausaleNotaAccredito().validate()}})},filterCausaliFattura:function(a){var b=this;b.getCausaleFattura().setFieldLabel(4==a?traduci("CAUSALE_FATTURA"):traduci("CAUSALE"));b.getCausaleFattura().getStore().clearFilter();b.getCausaleFattura().getStore().filter({filterFn:function(c){return b.tabelleAmm2?
"4"==a?"+"!=c.data.extra.split(",")[0]||"FV"!=c.data.extra.split(",")[1]&&"FVS"!=c.data.extra.split(",")[1]?!1:!0:"5"==a?"+"==c.data.extra.split(",")[0]&&"A"==c.data.extra.split(",")[2]?!0:!1:"6"==a?"+"==c.data.extra.split(",")[0]&&"CO"==c.data.extra.split(",")[1]?!0:!1:"+"==c.data.extra.split(",")[0]?!0:!1:"+"==c.data.extra?!0:!1}});b.getCausaleNotaAccredito().getStore().clearFilter();b.getCausaleNotaAccredito().getStore().filter({filterFn:function(a){return b.tabelleAmm2?"-"!=a.data.extra.split(",")[0]||
"AV"!=a.data.extra.split(",")[1]&&"AVS"!=a.data.extra.split(",")[1]?!1:!0:"-"==a.data.extra?!0:!1}})},selectCapitolo:function(a){var b=(new Date).getFullYear();this.getForm().getForm().findField("articolo").getStore().load({params:{anno:b,codCapitolo:a?a.value:0}})},changeCkbPersIng:function(a,b){this.getCntCheckIng().setDisabled(!b)},abilitaCampi:function(){var a=this.getForm().getForm(),b=a.findField("tipoDocumento"),c=a.findField("conto"),d=a.findField("registro"),e=a.findField("capitolo"),g=a.findField("articolo"),
h=a.findField("cda"),k=a.findField("attivita");c.setDisabled(!this.personContabili.vediConto);d.setDisabled(!this.personContabili.vediRegistro||5==b.getValue());e.setDisabled(!this.personContabili.vediCapitolo);g.setDisabled(!this.personContabili.vediArticolo);h.setReadOnly(!this.personContabili.vediCda);k.setVisible(4==this.personContabili.tipoContabilitaAbilitata&&5==b.getValue());k.allowBlank=4!=this.personContabili.tipoContabilitaAbilitata||5!=b.getValue();k.validate();this.storeAttivita&&1==
this.storeAttivita.count()&&a.setValues({attivita:this.storeAttivita.getAt(0).get("codice")});this.personContabili.vediRegistroMan?(d.setDisabled(!1),d.maxLength=2,d.setEditable(!0),d.cbaConfig.valida=!1,d.forceSelection=!1,d.setHideTrigger(!0)):(d.setEditable(!1),d.setHideTrigger(!1),d.cbaConfig.valida=!0,d.maxLength=Number.MAX_VALUE,d.forceSelection=!0)},filterPaganti:function(a){var b=this;a.getStore().clearFilter();a.getStore().filter({filterFn:function(a){return b.tabelleAmm2?"T"==a.data.extra.split(",")[1]?
!0:!1:!0}})},aggiornaStore:function(){var a=this,b=a.getForm(),c=b.getForm();clearForm(b);c.setValues({descrizioneCodice:traduci("NESSUNA_SELEZIONE")});c.setValues({ritenuta_descrizioneCodice:traduci("NESSUNA_SELEZIONE")});a.getIdModelloFattura().getStore().load({params:{idOrg:a.idOrg}});a.getIdImpostazioniBollo().getStore().load({params:{idOrg:a.idOrg,tipo:"B"}});b.store.load({params:{codfocl:a.codfocl,idOrg:a.idOrg,tipoContabilita:a.personContabili.tipoContabilitaAbilitata},callback:function(d,
e,g){if(g){var h=d[0];e=c.findField("capitolo").getStore();g=(new Date).getFullYear();a.storeIdCodIpa.load({params:{codCliente:h.get("codfocl"),idOrganizzazione:getIdOrg()},callback:function(b){Ext.each(b,function(b){b="B2B"==b.get("extra")?traduci("COD_PEC_B2B"):traduci("COD_IPA");a.getFsIdCodIpa().setTitle(b)});c.setValues({idCodIpa:h.get("idCodIpa")})}});Ext.isEmpty(h)||Ext.isEmpty(h.get("id"))?(a.loadConto(),e.load({params:{anno:g}}),a.getProtezioneRetta().setValue(a.getProtezioneRetta().getStore().getAt(0)),
a.getSeparazioneRetta().setValue(a.getSeparazioneRetta().getStore().getAt(0)),svuotaStore(a.storeCausaleContabilita),svuotaStore(a.storeIdCodIpa)):(b.loadRecord(h),c.setValues({tipoDocumento:h.get("tipoDocumento")}),5!=h.get("tipoDocumento")&&a.loadRegistro(h),a.loadConto(h),1==a.personContabili.tipoContabilitaAbilitata&&(c.findField("capitolo").getStore().load({params:{anno:g},callback:function(){c.setValues({capitolo:h.get("capitolo")})}}),c.findField("articolo").getStore().load({params:{anno:g,
codCapitolo:h.get("capitolo")?h.get("capitolo"):0},callback:function(){c.setValues({articolo:h.get("articolo")})}})),d[0].get("cda")&&c.setValues({descrizioneCodice:h.get("cda")}),d[0].get("ritenuta_cda")&&c.setValues({ritenuta_descrizioneCodice:h.get("ritenuta_cda")}),a.getCBCodFoCl().getStore().load({params:{valore:h.get("desCodFoClPassaggioDati")},callback:function(b,d,e){e&&(a.filterPaganti(a.getCBCodFoCl()),h.get("codFoClPassaggioDati")&&c.setValues({codFoClPassaggioDati:h.get("codFoClPassaggioDati")}))}}),
null==h.get("protezioneRetta")&&a.getProtezioneRetta().setValue(a.getProtezioneRetta().getStore().getAt(0)),null==h.get("separazioneRetta")&&a.getSeparazioneRetta().setValue(a.getSeparazioneRetta().getStore().getAt(0)),a.storeCausaleContabilita.load({params:{tipoContabilita:a.personContabili.tipoContabilitaAbilitata,tipoDocOspiti:h.get("tipoDocumento")?h.get("tipoDocumento"):0,idOrganizzazione:getIdOrg()},callback:function(){a.filterCausaliFattura(h.get("tipoDocumento"));c.setValues({codCausaleDocumento:h.get("codCausaleDocumento"),
codCausaleNotaAccredito:h.get("codCausaleNotaAccredito")})}}),4==h.data.tipoContabilitaAbilitata&&5==h.get("tipoDocumento")&&c.setValues({attivita:h.get("attivita")}),a.getMotiviDim().getStore().load({params:{scheda:"A",domanda:1,idOrganizzazione:a.idOrg},callback:function(b,c,d){if(d){c=h.get("motiviDimissione");for(d=0;d<b.length;d++)(Ext.isEmpty(c)||!Ext.isEmpty(c)&&c.includes(b[d].getData().risposta))&&a.getMotiviDim().getSelectionModel().select([b[d]],!0,!1);a.getDirtyGrid().setValue("")}else b=
[],msgAddError(b,c.getError()),msgShow("",b)}}));c.setValues({tipoContabilita:a.personContabili.tipoContabilitaAbilitata,idEsercizio:a.personContabili.idEsercizio});a.abilitaCampi();a.getCntContoRegistro().setVisible(1!=a.personContabili.tipoContabilitaAbilitata);a.getCntCapitoloArticolo().setVisible(1==a.personContabili.tipoContabilitaAbilitata);a.getCntCapitoloArticolo().isVisible()&&(enteIvaFinAbilitato=getPersonFinanziaria()[1],a.getCbEnteIva().setVisible(enteIvaFinAbilitato),a.getCbEnteIva().isVisible()&&
setCombo(a.getCbEnteIva(),h.get("enteIvaFinanziaria")));a.addAnnoToLabel(h)}else msgShowError("",e.getError())}})},addAnnoToLabel:function(a){var b=a.get("desAnnoRegistro"),c=a.get("desAnnoConto"),d=a.get("ritenuta_desAnnoConto");this.getRegistro().setFieldLabel(traduci("REGISTRO")+(b?"["+b+"]":""));this.getConto().setFieldLabel(traduci("CONTO")+(a.get("conto")&&c?"["+c+"]":""));this.getRitenutaConto().setFieldLabel(traduci("CONTO")+(a.get("ritenuta_conto")&&d?"["+d+"]":""))},caricaPerson:function(a){"L"!=
this.permesso&&1==this.getContainer().isDisabled()&&this.getContainer().setDisabled(!1);this.getCig().setReadOnly(!0);this.getCup().setReadOnly(!0);this.getIban().setReadOnly(!0);this.codfocl=a;this.aggiornaStore()},verificaCampiForm:function(){var a=[],b=this.getForm(),c=b.getForm();if(!b.isValid()){msgAddError(a,"MSG_CAMPI_OBBLIGATORI");var d="";Ext.each(b.getForm().getFields().items,function(a){a.validate()||(""!=d&&(d+=", "),""!=a.fieldLabel?d+=a.fieldLabel:"rgTipiPagante"==a.getItemId()&&(d+=
traduci(a.up().title)))});msgAddError(a,d)}4!=c.findField("tipoDocumento").getValue()||c.findField("codCausaleNotaAccredito").getValue()||msgAddError(a,"NOTA_ACCREDITO_OBB");c.findField("codFoClPassaggioDati").getValue()==this.codfocl&&msgAddError(a,"MSG_ERRORE_ANA_PASS_CONT");return msgShow("",a)},salvaForm:function(a){var b=this.getForm();b.getForm().setValues({codFoCl:this.codfocl});var c=b.getForm().getFieldValues(),d=this.getMotiviDim().store.data.items,e=[];if(0!=this.getMotiviDim().getSelectionModel().getCount()&&
this.getMotiviDim().getSelectionModel().getCount()!=this.getMotiviDim().getStore().getTotalCount())for(var g=0;g<d.length;g++)this.getMotiviDim().selModel.isSelected(d[g])&&e.push(d[g].data.risposta);e=e.toString();Ext.isEmpty(c.conto)?c.annoConto=null:null==c.annoConto&&(c.annoConto=this.personContabili.idEsercizio);Ext.isEmpty(c.ritenuta_conto)?c.ritenuta_annoConto=null:null==c.ritenuta_annoConto&&(c.ritenuta_annoConto=this.personContabili.idEsercizio);Ext.apply(c,{codfocl:this.codfocl,idOrganizzazione:this.idOrg,
bolloAutomatico:getBoolValue(c.bolloAutomatico),splitPayment:getBoolValue(c.splitPayment),giornoDimissione:getBoolValue(c.giornoDimissione),giornoDecesso:getBoolValue(c.giornoDecesso),giornoIngresso:getBoolValue(c.giornoIngresso),giornoRientro:getBoolValue(c.giornoRientro),giornoUscita:getBoolValue(c.giornoUscita),persIngressoDimissGenerali:getBoolValue(c.persIngressoDimissGenerali),escludiCalcoloRette:getBoolValue(c.escludiCalcoloRette),pensioneUsaEccedenza:getBoolValue(c.pensioneUsaEccedenza),totFatturaNettoPensioni:getBoolValue(c.totFatturaNettoPensioni),
ritenuta05:Ext.isEmpty(c.ritenuta05)?null:c.ritenuta05,conguaglioAutomatico:"A"==c.tipoCalcoloRetta?getBoolValue(c.conguaglioAutomatico):null,registro:this.getRegistro().getRawValue(),idRegistro:Ext.isNumber(this.getRegistro().getValue())?this.getRegistro().getValue():null,idImpostazioniBollo:c.bolloAutomatico?c.idImpostazioniBollo:null,motiviDimissione:Ext.isEmpty(e)?null:e});delete c.tipoContabilita;delete c.idEsercizio;delete c.descrizioneCodice;delete c.ritenuta_descrizioneCodice;delete c.desAnnoCda;
delete c.ritenuta_desAnnoCda;delete c.DirtyGrid;controller_salvaRecord(b,c,a)&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=Ext.create("Generali.clientiFornitori.store.PersonPagante");b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},esci_callback:function(){var c=a.getForm().up("window");
controller_puoiUscire(c,b,function(){a.salvaForm(!0)},function(){a.callbackEsci&&a.callbackEsci();c.close()},function(){a.callbackEsci&&a.callbackEsci();c.close()})},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,
c);b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnEsci").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},onLaunch:function(){this.storeRegistro=this.getRegistro().getStore();ImpostaUrl([this.storeRegistro,this.getMotiviDim().getStore()]);this.storeConto=Ext.create("Generali.store.Conto",{autoDestroy:!1});this.getConto().bindStore(Ext.create("Ext.data.ChainedStore",{source:this.storeConto}));
this.getRitenutaConto().bindStore(Ext.create("Ext.data.ChainedStore",{source:this.storeConto}));this.getProtezioneRetta().bindStore(new Ext.data.ArrayStore({fields:["codice","valore"],data:[[null,traduci("SECONDO_PERSON_GENERALE")],["T",traduci("USA_DESC_ALTERNATIVA")],["2",traduci("USA_DESC_ALTERNATIVA2")],["F",traduci("USA_DESC_PRINCIPALE")]],autoLoad:!0,autoDestroy:!0}));this.getSeparazioneRetta().bindStore(new Ext.data.ArrayStore({fields:["codice","valore"],data:[[null,traduci("SECONDO_PERSON_GENERALE")],
["F",traduci("RETTE_SEPARAZIONE_NESSUNA")],["S",traduci("RETTE_SEPARAZIONE_SERVIZIO")],["T",traduci("RETTE_SEPARAZIONE_UTENTE")]],autoLoad:!0,autoDestroy:!0}));this.personContabili=getPersonContabili(this.idOrg,new Date,!0,null);this.tabelleAmm2="4"==this.personContabili.tipoContabilitaAbilitata||"5"==this.personContabili.tipoContabilitaAbilitata;this.getCBCodFoCl().getStore().getProxy().setExtraParam("tipoContabilita",this.personContabili.tipoContabilitaAbilitata);this.getCBCodFoCl().getStore().getProxy().setExtraParam("limit",
0);this.storeCausaleContabilita=Ext.create("Generali.store.CausaleContabilita",{autoDestroy:!1});this.storeIdCodIpa=Ext.create("GestioneFatture.store.CodIpa",{autoDestroy:!1});this.getCausaleFattura().bindStore(Ext.create("Ext.data.ChainedStore",{source:this.storeCausaleContabilita}));this.getCausaleNotaAccredito().bindStore(Ext.create("Ext.data.ChainedStore",{source:this.storeCausaleContabilita}));this.getIdCodIpa().bindStore(this.storeIdCodIpa);var a=Ext.create("Generali.store.TipoDocRette");a.load({params:{soloTipiGenerici:!0,
tipoContabilita:this.personContabili.tipoContabilitaAbilitata}});this.getTipoDocumento().bindStore(a);4==this.personContabili.tipoContabilitaAbilitata&&(this.storeAttivita=Ext.create("Generali.data.StoreCodiceValore",{proxy:{url:"/cba/osp/co/ws/genAmm/attivita/cbox"}}),this.getAttivita().bindStore(this.storeAttivita),this.storeAttivita.load({params:{applicaFiltro:"T"}}));this.gestioneForm();Ext.isEmpty(this.codfocl)&&"L"!=this.permesso&&this.getContainer().setDisabled(!0)},destroy:function(){eliminaStore(this.storeForm);
eliminaStore(this.storeConto);eliminaStore(this.storeCausaleContabilita);eliminaStore(this.storeIdCodIpa);this.storeAttivita&&eliminaStore(this.storeAttivita);this.callParent()}});
Ext.define("Generali.clientiFornitori.controller.SbloccaImport",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"PnlPrincipale",selector:this.selContainer+"#PnlPrincipale"}])},loadData:function(){var a=this.getPnlPrincipale();a.removeAll();a.add(Ext.create("CP.importExport.view.ImportAnagClientiFornitori"),{cbaConfig:this.cbaConfig})},destroy:function(){this.callParent()}});
Ext.define("Generali.clientiFornitori.controller.SelezionaCigCup",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCigCup",selector:a+"#GridCigCup"},{ref:"ColonnaEditDettagli",selector:a+"#ColonnaEditDettagli"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"VisualizzaCigCup",selector:a+"#VisualizzaCigCup"}]);this.control(a+"#GridCigCup",{celldblclick:this.gridDblClick});
this.control(a+"#BtnConferma",{click:this.clickBtnConferma});this.control(a+"#BtnEsci",{click:this.clickBtnEsci});this.control(a+"#VisualizzaCigCup",{change:this.changeVisualizza});this.cbaConfig.insModifica&&(this.addRef([{ref:"BtnNuovo",selector:a+"#BtnNuovo"},{ref:"BtnEdit",selector:a+"#BtnEdit"}]),this.control(a+"#GridCigCup",{selectionchange:this.selectionchangeGrid,beforeedit:this.beforeeditGrid,edit:this.editGrid,canceledit:this.canceleditGrid,validateedit:this.validateeditGrid}))},selectionchangeGrid:function(a,
b,c){this.nuovoInserimento||this.getBtnEdit().setVisible(0<b.length)},abilitaBottoniGrid:function(a){this.cbaConfig.insModifica&&(this.getBtnConferma().setDisabled(!a),this.getBtnNuovo().setDisabled(!a),this.getBtnEdit().setDisabled(!a))},beforeeditGrid:function(a,b,c){if(!0===a.editing||!a.siEdit)return!1;a.siEdit=!1;this.abilitaBottoniGrid(!1)},validateeditGrid:function(a,b,c){return msgShow("",[])},editGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=
b.view.getStore();Ext.apply(c,{predefinito:getBoolValue(c.predefinito),ritenutaDurc:getBoolValue(c.ritenutaDurc)});controller_salvaRecord(d,c,!1,{forzaRegistrazione:"F"},null,null,"progr")||a.startEdit(b.record,0)},canceleditGrid:function(a,b,c){this.aggiornaStore(b.record.get("prog"))},clickBtnNuovo:function(a){a=this.getGridCigCup();var b=a.getStore(),c={};Ext.apply(c,{codFoCl:this.cbaConfig.idCliFor});var d=a.columns.find(function(a){return"dataDal"===a.dataIndex});a.editingPlugin.siEdit=!0;controller_nuovoRecordGrid(c,
a,b.getCount(),!0,d)},clickBtnEdit:function(a){a=this.getGridCigCup();var b=a.getSelectionModel();if(b=b.hasSelection()?b.getSelection()[0]:!1){var c=a.columns.find(function(a){return"dataDal"===a.dataIndex});a.editingPlugin.siEdit=!0;a.editingPlugin.startEdit(b,c)}},aggiornaStore:function(a){var b=this.getGridCigCup(),c=b.getStore();this.abilitaBottoniGrid(!0);c.reload({callback:function(d,e,g){g&&(d=trovaRecord(c,"progr",a),b.getSelectionModel().select(d?[d]:0))}})},changeVisualizza:function(a,
b,c,d){var e=this;a=e.getGridCigCup().getStore();b=b?"F":e.cbaConfig.soloAttivi?e.cbaConfig.soloAttivi:"F";c={};Ext.apply(c,{idCliFor:e.cbaConfig.idCliFor,leggiTabellaNuova:e.cbaConfig.leggiTabellaNuova&&"T"==e.cbaConfig.leggiTabellaNuova?"T":"F",soloAttivi:b});"T"==b&&(Ext.isDate(e.cbaConfig.dataDal)&&Ext.apply(c,{dataDal:e.cbaConfig.dataDal}),Ext.isDate(e.cbaConfig.dataAl)&&Ext.apply(c,{dataAl:e.cbaConfig.dataAl}));a.load({params:c,callback:function(a,b){b?e.getBtnConferma().setDisabled(!a||0==
a.length):(e.getBtnConferma().setDisabled(!0),msgShowError("",operation.getError()))}})},clickBtnConferma:function(a){if("S"==this.cbaConfig.permesso){var b=this.getGridCigCup().getSelectionModel().getSelection()[0];b&&(this.cbaConfig.saltaControlloCigCup||(0==b.data.residuoCigCup?Messaggio("ATTENZIONE","MSG_CONFIRM_CIGCUPDETAIL_SELECT","OK","INFORMATION"):null!=b.data.residuoCigCup&&this.cbaConfig.recScadenza&&this.cbaConfig.recScadenza.get("importoScadenza")>b.data.residuoCigCup&&Messaggio("ATTENZIONE",
"MSG_CONFIRM_CIGCUPDETAIL_SELECT","OK","INFORMATION")),this.cbaConfig.afterConferma&&this.cbaConfig.afterConferma(b.get("progr"),b.get("cig"),b.get("cup"),b.get("iban"),b.get("note"),b.get("ritenutaDurc")),a.up("window").close())}},clickBtnEsci:function(a){a.up("window").close()},gridDblClick:function(a,b,c,d,e,g,h){7>c&&this.clickBtnConferma(a)},gridActionClick:function(a,b){var c=this.getGridCigCup().getStore().getAt(a);switch(b){case 1:Ext.create("winCBA",{name:"Generali.clientiFornitori.view.SelezionaCigCupDetail",
titolo:"CIGCUP_SELECT",dimensione:4,configItem:{isWindow:!0,permesso:this.cbaConfig.permesso,tipo:1,idCigCup:c.get("progr"),afterConferma:function(a){havedetails=a&&"T"==a?"T":"F";c.set("haveDetails",a)}},closable:!0}).show();break;case 2:Messaggio("ATTENZIONE","MSG_CONFIRM_CIGCUPDETAIL_RESET","YESNO","QUESTION",null,function(){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/anaCliFor/cupCig/deleteDetails",params:{idCupCig:c.get("progr")},success:function(a){a=Ext.JSON.decode(a.responseText);
a.success?(c.set("haveDetails","F"),msgShow("MSG_OPERAZIONE_OK",a.message)):msgShowError("",a.message)}})})}},onLaunch:function(){var a=this;a.cbaConfig.idCliFor&&""!=a.cbaConfig.idCliFor||(a.cbaConfig.idCliFor=0);a.cbaConfig.editDettagli&&a.getColonnaEditDettagli().setVisible(!0);a.storeProcedura=Ext.create("Generali.store.TabProcedura",{sorters:[{property:"valore",direction:"ASC"}]});var b=a.getGridCigCup();b.controller=a;var c={},d=a.cbaConfig.soloAttivi?a.cbaConfig.soloAttivi:"F";Ext.apply(c,
{idCliFor:a.cbaConfig.idCliFor,leggiTabellaNuova:a.cbaConfig.leggiTabellaNuova&&"T"==a.cbaConfig.leggiTabellaNuova?"T":"F",soloAttivi:d});"T"==d&&(Ext.isDate(a.cbaConfig.dataDal)&&Ext.apply(c,{dataDal:a.cbaConfig.dataDal}),Ext.isDate(a.cbaConfig.dataAl)&&Ext.apply(c,{dataAl:a.cbaConfig.dataAl}));b.getStore().load({params:c,callback:function(b,c){c?a.getBtnConferma().setDisabled(!b||0==b.length):(a.getBtnConferma().setDisabled(!0),msgShowError("",operation.getError()))}})},destroy:function(){this.callParent()}});
Ext.define("Generali.clientiFornitori.controller.SelezionaCigCupDetail",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"RgrpTipoDettaglio",selector:a+"#RgrpTipoDettaglio"},{ref:"GridServizi",selector:a+"#GridServizi"},{ref:"CheckColumnServizi",selector:a+"#CheckColumnServizi"},{ref:"GridUtenti",selector:a+"#GridUtenti"},{ref:"BtnNuovoUtente",selector:a+"#BtnNuovoUtente"},{ref:"BtnEliminaUtente",selector:a+"#BtnEliminaUtente"},
{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnRipristina",selector:a+"#BtnRipristina"}]);this.control(a+"#CheckColumnServizi",{checkchange:this.checkchangeCheckColumnServizi});this.control(a+"#GridUtenti",{beforeedit:this.beforeeditGridUtenti,edit:this.confermaeditGridUtenti,canceledit:this.canceleditGridUtenti,validateedit:this.validateeditGridUtenti});this.control(a+"#BtnNuovoUtente",{click:this.clickBtnNuovoUtente});this.control(a+"#BtnEliminaUtente",
{click:this.clickBtnEliminaUtente});this.control(a+"#RgrpTipoDettaglio",{change:this.changeRgrpTipoDettaglio});this.control(a+"#BtnConferma",{click:this.clickBtnConferma});this.control(a+"#BtnRipristina",{click:this.clickBtnRipristina})},checkchangeCheckColumnServizi:function(a,b,c,d){this.getRgrpTipoDettaglio().contieneDati=!0;this.getBtnConferma().setDisabled(!1)},beforeeditGridUtenti:function(a,b,c){if(!0===a.editing)return!1;this.comboUtenti||(this.comboUtenti=Ext.create("GeneraliOSP.cercaFascicolo.store.Utenti",
{autoDestroy:!1}),ImpostaUrl(this.comboUtenti),this.comboUtenti.load({params:{cognome:"",dataDal:this.cbaConfig&&this.cbaConfig.dataDal?this.cbaConfig.dataDal:new Date((new Date).setHours(0,0)),dataAl:this.cbaConfig&&this.cbaConfig.dataAl?this.cbaConfig.dataAl:new Date((new Date).setHours(23,59)),attivi:"T",nonAttivi:"F"},callback:function(a,b,c){c||msgShowError("",b.getError())}}));a.getEditor().getForm().findField("codice").bindStore(this.comboUtenti);this.abilitaBottoniGridUtente(!1)},confermaeditGridUtenti:function(a,
b,c){a=this.comboUtenti.findExact("codOspite",b.newValues.codice);-1!=a&&(rs=this.comboUtenti.getAt(a).data,b.record.set("valore",rs.nominativo),b.record.set("extra",!0));b.store.sort();this.getBtnConferma().setDisabled(!1);this.getRgrpTipoDettaglio().contieneDati=!0},canceleditGridUtenti:function(a,b,c){b.record.data.codice||this.clickBtnEliminaUtente(null);this.abilitaBottoniGridUtente(!0)},validateeditGridUtenti:function(a,b,c){this.abilitaBottoniGridUtente(!0)},abilitaBottoniGridUtente:function(a){this.getBtnNuovoUtente().setDisabled(!a);
this.getBtnEliminaUtente().setDisabled(!a);this.getBoxBottoni().setDisabled(!a);this.getRgrpTipoDettaglio().setDisabled(!a)},clickBtnNuovoUtente:function(a){a=this.getGridUtenti();controller_nuovoRecordGrid({id:a.getStore().count()+1},a)},clickBtnEliminaUtente:function(a){a=this.getGridUtenti();var b=a.getSelectionModel().getSelection()[0];b&&a.getStore().remove(b);a.getSelectionModel().select(0);this.getRgrpTipoDettaglio().contieneDati=0<a.getStore().getTotalCount();this.getBtnConferma().setDisabled(!1)},
visualizzaGriglia:function(a){"1"==a?(a=this.getGridUtenti(),this.getGridServizi().setVisible(!1)):(a=this.getGridServizi(),this.getGridUtenti().setVisible(!1));a.setVisible(!0);this.getRgrpTipoDettaglio().contieneDati=!1},changeRgrpTipoDettaglio:function(a,b,c,d){if(a.ignoraEvento)a.ignoraEvento=!1;else{var e=this;a.contieneDati?Messaggio("ATTENZIONE","MSG_CIGCUPDETAIL_TYPE_CHANGE","YESNO","QUESTION",null,function(){e.getGridServizi().getStore().each(function(a){a.get("extra")&&a.set("extra",!1)});
svuotaStore(e.getGridUtenti().getStore());e.getBtnConferma().setDisabled(!1);e.visualizzaGriglia(b.rbTipo)},function(){a.ignoraEvento=!0;a.setValue({rbTipo:c.rbTipo})}):e.visualizzaGriglia(b.rbTipo)}},clickBtnConferma:function(a){var b=this,c=[],d=null,d=1==b.getRgrpTipoDettaglio().getValue().rbTipo?b.getGridUtenti().getStore():b.getGridServizi().getStore();d.each(function(a){1==a.data.extra&&c.push({codice:a.data.codice,valore:a.data.valore,extra:"T"})});Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/anaCliFor/cupCig/saveDetails",
jsonData:Ext.JSON.encode(c),params:{idCigCup:b.cbaConfig.idCigCup,tipo:b.getRgrpTipoDettaglio().getValue()},success:function(d){d=Ext.JSON.decode(d.responseText);d.success?(b.cbaConfig.afterConferma&&b.cbaConfig.afterConferma(0<c.length?"T":"F"),a.up("window").close()):msgShowError("",d.message)}})},clickBtnRipristina:function(a){a.up("window").close()},onLaunch:function(){var a=this;a.cbaConfig.idCigCup&&""!=a.cbaConfig.idCigCup||(a.cbaConfig.idCigCup=0);a.getRgrpTipoDettaglio().contieneDati=!1;
a.getGridServizi().getStore().load({params:{idCigCup:a.cbaConfig.idCigCup,tipo:2},callback:function(b,c){c?b&&0<b.length&&Ext.each(b,function(b){if(b.get("extra"))return a.getRgrpTipoDettaglio().contieneDati=!0,!1}):(a.getBtnConferma().setDisabled(!0),msgShowError("",operation.getError()))}});a.getGridUtenti().getStore().load({params:{idCigCup:a.cbaConfig.idCigCup,tipo:1},callback:function(b,c){c?b&&0<b.length&&(a.getRgrpTipoDettaglio().setValue({rbTipo:"1"}),a.getRgrpTipoDettaglio().contieneDati=
!0):(a.getBtnConferma().setDisabled(!0),msgShowError("",operation.getError()))}});a.getBtnConferma().setDisabled(!0)},destroy:function(){this.callParent()}});
Ext.define("Generali.clientiFornitori.store.Anagrafica",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codiceEnte"},{name:"ragioneSociale"},{name:"indirizzo"},{name:"cap"},{name:"citta"},{name:"provincia"},{name:"nazione"},{name:"desNazione"},{name:"codiceFiscale"},{name:"partitaIva"},{name:"telefono1"},{name:"prefissoTelef1"},{name:"telefono2"},{name:"prefissoTelef2"},{name:"fax"},{name:"prefissoFax"},{name:"note"},{name:"mail"},{name:"url"},{name:"categoria"},{name:"categoriaDesc"},{name:"tipoPagamento"},
{name:"tipoAnagrafica"},{name:"desBanca"},{name:"iban"},{name:"codCIN"},{name:"codABI"},{name:"codCAB"},{name:"codRID"},{name:"contoCorrente"},{name:"desBancaFrn"},{name:"ibanFrn"},{name:"codCinFrn"},{name:"codAbiFrn"},{name:"codCabFrn"},{name:"codRidFrn"},{name:"contoCorrenteFrn"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anfocl/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.ClientiFornitori",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anfocl/cbox",timeout:72E5,reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.ClientiFornitoriSrc",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"ragioneSociale"},{name:"citta"},{name:"indirizzo"},{name:"cap"},{name:"provincia"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/CU2/anfocl/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.DestinatarioFattura",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codFoCl"},{name:"cognomeNome"},{name:"indirizzo"},{name:"cap"},{name:"citta"},{name:"provincia"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/dstfatt/getbypgn",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/dstfatt/getbypgn",create:"/cba/gen/ws/general/dstfatt/new",update:"/cba/gen/ws/general/dstfatt/update",destroy:"/cba/gen/ws/general/dstfatt/delete"}},
autoDestroy:!0});Ext.define("Generali.clientiFornitori.store.FranchigieDe",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idFranchigia"},{name:"dalGiorno"},{name:"quotaSanitaria"},{name:"quotaSociale"}],proxy:{type:"ajax",urlGen:"/ws/genOsp/prszn/dettfrcg/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:".",create:".",update:".",destroy:"."}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.FranchigieTe",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"descrizione"},{name:"tipoImporto"},{name:"codfocl"},{name:"idServizio"},{name:"desServizio"},{name:"tipoAssenza"},{name:"desTipoAssenza"},{name:"dataDal",type:"date"},{name:"desMotivoAssenza"},{name:"tipoCalcolo"}],proxy:{type:"ajax",urlGen:"/ws/genOsp/prszn/franc/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:".",create:".",update:".",destroy:"."}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.PersonFattEle",{extend:"Generali.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"codFoCl"},{name:"idCampo"},{name:"idCodIpa"},{name:"valore_predefinito"},{name:"idcampoTe"},{name:"idcampoTeFormat"},{name:"nometagTe"},{name:"idcampoDe"},{name:"idcampoDeFormat"},{name:"versionetracciato"},{name:"nometag"},{name:"tipodato"},{name:"lunghezzamassima"},{name:"obbligatorio"},{name:"flagattivo"}],proxy:{type:"ajax",urlGen:"/ws/general/fatturaElettronica/prszn/feCa/cbox",
reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{create:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/new",read:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/cbox",update:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/update",destroy:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/delete"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.PersonFeClienti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCodIpa"},{name:"esportaNettoPensioni"},{name:"addebitaBollo"},{name:"bolloNAccNegativo"},{name:"includeBolloLinee"},{name:"idOrganizzazione"},{name:"nascondiDettZero"},{name:"accorpaDescrizioni"},{name:"soloInizialiNome"},{name:"nascondiNome"}],proxy:{type:"ajax",urlGen:"/ws/general/fatturaElettronica/prszn/fePerCli/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},
api:{create:"/cba/gen/ws/general/fatturaElettronica/prszn/fePerCli/new",read:"/cba/gen/ws/general/fatturaElettronica/prszn/fePerCli/get",update:"/cba/gen/ws/general/fatturaElettronica/prszn/fePerCli/update",destroy:"/cba/gen/ws/general/fatturaElettronica/prszn/fePerCli/delete"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.PersonPagante",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codfocl"},{name:"idOrganizzazione"},{name:"persIngressoDimissGenerali"},{name:"giornoIngresso"},{name:"giornoDimissione"},{name:"giornoDecesso"},{name:"giornoUscita"},{name:"giornoRientro"},{name:"motiviDimissione"},{name:"idParametriContabilita"},{name:"tipoDocumento"},{name:"cig"},{name:"cup"},{name:"cigCupNote"},{name:"iban"},{name:"bolloAutomatico"},{name:"tipoPagante"},{name:"tipoCalcoloRetta"},
{name:"conguaglioAutomatico"},{name:"mensilita"},{name:"conto"},{name:"annoConto"},{name:"capitolo"},{name:"articolo"},{name:"idRegistro"},{name:"registro"},{name:"idAliquotaIva"},{name:"annoCda"},{name:"desAnnoCda"},{name:"cda"},{name:"cda1"},{name:"ritenuta05"},{name:"ritenuta_idParametriContabilita"},{name:"ritenuta_conto"},{name:"ritenuta_annoConto"},{name:"ritenuta_desAnnoConto"},{name:"ritenuta_idAliquotaIva"},{name:"ritenuta_annoCda"},{name:"ritenuta_desAnnoCda"},{name:"ritenuta_cda"},{name:"ritenuta_cda1"},
{name:"protezioneRetta"},{name:"separazioneRetta"},{name:"codFoClPassaggioDati"},{name:"desCodFoClPassaggioDati"},{name:"escludiCalcoloRette"},{name:"codCausaleDocumento"},{name:"codCausaleNotaAccredito"},{name:"idModelloFattura"},{name:"idCodIpa"},{name:"splitPayment"},{name:"enteIvaFinanziaria"},{name:"attivita"},{name:"pensioneUsaEccedenza"},{name:"totFatturaNettoPensioni"},{name:"idImpostazioniBollo"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/prszn/perspgn/src",reader:{type:"json",messageProperty:"message",
rootProperty:"data"},api:{read:"/cba/osp/co/ws/prszn/perspgn/src",create:"/cba/osp/co/ws/prszn/perspgn/new",update:"/cba/osp/co/ws/prszn/perspgn/update",destroy:"/cba/osp/co/ws/prszn/perspgn/delete"}},autoDestroy:!0});Ext.define("Generali.clientiFornitori.store.PersoneRiferimento",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"nomePersona"},{name:"indirizzo"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/genOsp/prsrif/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.SelezionaCigCup",{extend:"Ext.data.Store",fields:[{name:"progr"},{name:"dataDal",type:"date"},{name:"dataAl",type:"date"},{name:"cig"},{name:"cup"},{name:"iban"},{name:"note"},{name:"predefinito"},{name:"ritenutaDurc"},{name:"haveDetails"},{name:"importo"},{name:"residuoCigCup"},{name:"procedura"},{name:"dataPubblicazioneBando",type:"date"},{name:"importoAggiudicazioneBando"},{name:"nomeBando"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cupCig/ricerca",
reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anaCliFor/cupCig/ricerca",create:"/cba/gen/ws/general/anaCliFor/cupCig/ricerca/new",update:"/cba/gen/ws/general/anaCliFor/cupCig/ricerca/update"}},params:{leggiTabellaNuova:!1},autoLoad:!1,autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.SelezionaCigCupDetail",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra",type:"bool",convert:function(a){return"T"===a||!0===a?!0:!1}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anaCliFor/cupCig/getDetails",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},sorters:[{property:"valore",direction:"ASC"}],autoLoad:!1,autoDestroy:!0});
Ext.define("Generali.clientiFornitori.store.UtentiSrc",{extend:"Ext.data.Store",fields:[{name:"nominativo"},{name:"codOspite"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/genOsp/users/search",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.clientiFornitori.view.Anagrafica",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"form",flex:1,border:0,itemId:"Form",reference:"Form",bodyPadding:10,title:"",trackResetOnLoad:!0,items:[{xtype:"fieldset",width:350,items:[{xtype:"radiogroup",items:[{xtype:"radiofield",cls:"cbaLabel",name:"tipoAnagrafica",boxLabel:"CLIENTE",inputValue:"C"},{xtype:"radiofield",
cls:"cbaLabel",name:"tipoAnagrafica",boxLabel:"FORNITORE",inputValue:"F"},{xtype:"radiofield",cls:"cbaLabel",name:"tipoAnagrafica",boxLabel:"ENTRAMBI",inputValue:"E"}]}]},{xtype:"container",items:[{xtype:"textfield",width:450,fieldLabel:"RAGIONE_SOCIALE",labelClsExtra:"cbaLabel",name:"ragioneSociale"},{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",width:450,fieldLabel:"INDIRIZZO",labelClsExtra:"cbaLabel",name:"indirizzo"}]},
{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",width:270,fieldLabel:"CITTA",labelClsExtra:"cbaLabel",name:"citta"},{xtype:"textfield",width:80,fieldLabel:"PROV",labelClsExtra:"cbaLabel",labelWidth:40,name:"provincia"},{xtype:"textfield",width:90,fieldLabel:"CAP",labelClsExtra:"cbaLabel",labelWidth:30,name:"cap"}]},{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",
width:260,fieldLabel:"NAZIONE",labelClsExtra:"cbaLabel",name:"desNazione"}]},{xtype:"textfield",width:450,fieldLabel:"CATEGORIA",labelClsExtra:"cbaLabel",name:"categoria"},{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",width:260,fieldLabel:"CODICE_FISCALE",labelClsExtra:"cbaLabel",name:"codiceFiscale"},{xtype:"textfield",width:185,fieldLabel:"P_IVA",labelClsExtra:"cbaLabel",labelWidth:70,name:"partitaIva"}]},{xtype:"combobox",
itemId:"TipoPagamento",reference:"TipoPagamento",store:Ext.create("Generali.store.CondizioniPagamento"),valueField:"codice",displayField:"valore",width:450,fieldLabel:"TIPO_PAGAMENTO",labelClsExtra:"cbaLabel",name:"tipoPagamento"},{xtype:"fieldset",width:200,title:"CONDIZIONE_PAGAMENTO",items:[{xtype:"radiogroup",disabled:!0,itemId:"RdgCondPag",reference:"RdgCondPag",items:[{xtype:"radiofield",cls:"cbaLabel",name:"tipoCondPag",boxLabel:"CLIENTE",inputValue:"C"},{xtype:"radiofield",cls:"cbaLabel",
name:"tipoCondPag",boxLabel:"FORNITORE",inputValue:"F"}]}]},{xtype:"container",items:[{xtype:"displayfield",width:450,name:"desBanca",itemId:"DesBancaCli",reference:"DesBancaCli",fieldLabel:"BANCA",labelClsExtra:"cbaLabel",hidden:!0},{xtype:"displayfield",fieldLabel:"",name:"iban",itemId:"IbanCli",reference:"IbanCli",labelClsExtra:"cbaLabel",margin:"0 0 0 105",hidden:!0},{xtype:"textfield",fieldLabel:"RID",labelClsExtra:"cbaLabel",name:"codRID",hidden:!0}]},{xtype:"container",items:[{xtype:"displayfield",
width:450,name:"desBancaFrn",itemId:"DesBancaFo",reference:"DesBancaFo",fieldLabel:"BANCA",labelClsExtra:"cbaLabel",hidden:!0},{xtype:"displayfield",fieldLabel:"",name:"ibanFrn",itemId:"IbanFo",reference:"IbanFo",labelClsExtra:"cbaLabel",margin:"0 0 0 105",hidden:!0}]},{xtype:"tabpanel",bodyPadding:5,activeTab:0,items:[{xtype:"panel",title:"TELEFONO",items:[{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",width:300,fieldLabel:"TELEFONO",
labelClsExtra:"cbaLabel",name:"telefono1"}]},{xtype:"container",margin:"0 0 5 0",defaults:{margin:"0 5 0 0"},layout:{align:"stretch",type:"hbox"},items:[{xtype:"textfield",width:300,fieldLabel:"TELEFONO",labelClsExtra:"cbaLabel",name:"telefono2"}]}]},{xtype:"panel",title:"FAX",items:[{xtype:"textfield",width:300,fieldLabel:"FAX",labelClsExtra:"cbaLabel",name:"fax"}]},{xtype:"panel",layout:{type:"fit"},title:"NOTE",items:[{xtype:"textareafield",fieldLabel:"",name:"note"}]},{xtype:"panel",title:"ALTRO",
items:[{xtype:"textfield",width:350,fieldLabel:"EMAIL",labelClsExtra:"cbaLabel",name:"mail"},{xtype:"textfield",width:350,fieldLabel:"SITO_INTERNET",labelClsExtra:"cbaLabel",name:"url"}]}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.DestinatarioFattura",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",border:0,layout:{align:"stretch",type:"vbox"},items:[{xtype:"form",itemId:"Form",reference:"Form",border:0,margin:"0 0 5 0",layout:{align:"stretch",type:"hbox"},trackResetOnLoad:!0,items:[{xtype:"container",flex:1,padding:5,layout:{align:"stretch",type:"vbox"},items:[{xtype:"textfield",
fieldLabel:"NOMINATIVO",itemId:"RagioneSociale",reference:"RagioneSociale",labelClsExtra:"cbaLabel",name:"cognomeNome",allowBlank:!1,maxLength:100,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"INDIRIZZO",labelClsExtra:"cbaLabel",name:"indirizzo",allowBlank:!1,maxLength:200,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"CITTA",labelClsExtra:"cbaLabel",name:"citta",allowBlank:!1,maxLength:50,enforceMaxLength:!0},{xtype:"container",defaults:{margin:"0 5 0 0"},layout:{type:"hbox"},items:[{xtype:"textfield",
width:140,fieldLabel:"PROVINCIA",name:"provincia",labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:2,enforceMaxLength:!0},{xtype:"textfield",width:110,fieldLabel:"CAP",labelWidth:40,name:"cap",labelClsExtra:"cbaLabel",allowBlank:!1,allowDecimals:!1,hideTrigger:!0,useThousandSeparator:!1,maxLength:6,maskRe:/[0-9]/,enforceMaxLength:!0}]},{xtype:"textfield",itemId:"recordId",reference:"recordId",hidden:!0,fieldLabel:"id",name:"id"},{xtype:"textfield",hidden:!0,fieldLabel:"codfocl",name:"codFoCl"},{xtype:"checkboxfield",
hidden:!0,fieldLabel:"",name:"formDirty",boxLabel:"formDirty"}]},{xtype:"panel",itemId:"BoxBottoni",reference:"BoxBottoni",border:0,width:120}]},{xtype:"panel",itemId:"PnlImportaDest",reference:"PnlImportaDest",flex:1,layout:{align:"stretch",type:"vbox"},bodyPadding:5,collapsible:!0,title:"IMPORTA_DESTINATARIO",items:[{xtype:"container",padding:"0 0 5 0",layout:{align:"center",pack:"center",type:"vbox"},items:[{xtype:"button",itemId:"BtnImportaDest",reference:"BtnImportaDest",cls:"cba-stdbutton-25",
width:200,iconCls:"icon-upload",text:"IMPORTA_DESTINATARIO"}]},{xtype:"tabpanel",itemId:"TPDestinatario",reference:"TPDestinatario",activeTab:0,items:[{xtype:"panel",itemId:"TabPagante",reference:"TabPagante",title:"PAGANTE",tabConfig:{xtype:"tab"},border:0,padding:5,items:[{xtype:"fieldset",collapsible:!0,title:"FILTRI",items:[{xtype:"textfield",anchor:"100%",minChars:3,fieldLabel:"PAGANTE",itemId:"TxtPagante"}]}]},{xtype:"panel",itemId:"TabPersonaRif",reference:"TabPersonaRif",border:0,padding:5,
title:"PERSONA_RIFERIMENTO",items:[{xtype:"fieldset",collapsible:!0,title:"FILTRI",items:[{xtype:"combobox",anchor:"100%",fieldLabel:"UTENTE",itemId:"CBUtente",reference:"CBUtente",hideTrigger:!0,displayField:"nominativo",minChars:3,pageSize:10,queryParam:"cognome",store:Ext.create("Generali.clientiFornitori.store.UtentiSrc"),valueField:"codOspite"}]}]}]},{xtype:"gridpanel",itemId:"GridDestinatari",reference:"GridDestinatari",flex:1,border:0,title:"",columns:[{xtype:"gridcolumn",renderer:function(a,
b,c,d,e,g,h){a="";"paganti"==g.tipoStore?a=c.data.ragioneSociale:"personeRif"==g.tipoStore?a=c.data.nomePersona:"utenti"==g.tipoStore&&(a=c.data.nominativo);return a},dataIndex:"ragioneSociale",text:"RAGIONE_SOCIALE",flex:1},{xtype:"gridcolumn",renderer:function(a,b,c,d,e,g,h){a="";"paganti"==g.tipoStore?a=c.data.indirizzo:"personeRif"==g.tipoStore?c.data.indirizzo&&(a=c.data.indirizzo.indirizzo+(c.data.indirizzo.civico?" "+c.data.indirizzo.civico:""),c.data.indirizzo.esponente&&(a+="/"+c.data.indirizzo.esponente),
c.data.indirizzo.interno&&(a+=" Int. "+c.data.indirizzo.interno)):"utenti"==g.tipoStore&&c.data.indirizzo&&(a=c.data.indirizzo.indirizzo+(c.data.indirizzo.civico?" "+c.data.indirizzo.civico:""),c.data.indirizzo.esponente&&(a+="/"+c.data.indirizzo.esponente),c.data.indirizzo.interno&&(a+=" Int. "+c.data.indirizzo.interno));return a},dataIndex:"string",text:"INDIRIZZO",flex:1},{xtype:"gridcolumn",renderer:function(a,b,c,d,e,g,h){b=a="";"paganti"==g.tipoStore?(a=c.data.provincia?" ("+c.data.provincia+
")":"",b=c.data.citta?c.data.citta:""):"personeRif"==g.tipoStore?c.data.indirizzo&&(a=c.data.indirizzo.provincia?" ("+c.data.indirizzo.provincia+")":"",b=c.data.indirizzo.desComune?c.data.indirizzo.desComune:""):"utenti"==g.tipoStore&&c.data.indirizzo&&(a=c.data.indirizzo.provincia?" ("+c.data.indirizzo.provincia+")":"",b=c.data.indirizzo.desComune?c.data.indirizzo.desComune:"");return b+a},dataIndex:"string",text:"CITTA",flex:1},{xtype:"gridcolumn",renderer:function(a,b,c,d,e,g,h){a="";"paganti"==
g.tipoStore?a=c.data.cap:"personeRif"==g.tipoStore?c.data.indirizzo&&(a=c.data.indirizzo.cap):"utente"==g.tipoStore&&c.data.indirizzo&&(a=c.data.indirizzo.cap);return a},width:50,dataIndex:"cap",text:"CAP"}],viewConfig:{loadMask:!1},dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",displayInfo:!0}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.GridFranchigie",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridFranchigia",reference:"GridFranchigia",store:Ext.create("Generali.clientiFornitori.store.FranchigieDe"),columns:[{xtype:"numbercolumn",dataIndex:"dalGiorno",format:"0,",text:"DALGIORNO",align:"right",allowDecimals:!1,editor:{xtype:"numberfield",allowDecimals:!1,selectOnFocus:!0}},{xtype:"gridcolumn",text:"QUOTA_SAN",
flex:1,format:"0.00,",sortable:!1,align:"center",dataIndex:"quotaSanitaria",editor:{xtype:"numberfield"},renderer:function(a,b,c,d,e,g,h){b.style="text-align:right !important";return formatFloat(a)}},{xtype:"gridcolumn",text:"QUOTA_SOC",flex:1,format:"0.00,",sortable:!1,align:"center",dataIndex:"quotaSociale",editor:{xtype:"numberfield"},renderer:function(a,b,c,d,e,g,h){b.style="text-align:right !important";return formatFloat(a)}}],viewConfig:{width:200,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.PersonFattEle",{extend:"Generali.standard.ControlledContainer",initComponent:function(){this.storeTipoAccorpamento=new Ext.data.ArrayStore({fields:["codice","valore"],data:[["F",traduci("ACCORPA_DESCRIZIONI_NON_ACCORPARE"),""],["T",traduci("ACCORPA_DESCRIZIONI_IMPORTO"),""],["N",traduci("ACCORPA_DESCRIZIONI_ALIIVA"),""]],autoLoad:!0,autoDestroy:!0});Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",
items:[{xtype:"combobox",margin:"2 0 2 10",width:500,labelWidth:150,fieldLabel:"COD_IPA",itemId:"idCodIpaPF",reference:"idCodIpaPF",name:"idCodIpaPF",displayField:"valore",queryMode:"local",valueField:"codice"}]},{xtype:"form",itemId:"Form",reference:"Form",border:1,margin:"0 0 5 0",trackResetOnLoad:!0,layout:{align:"stretch",type:"hbox"},scrollable:!0,items:[{xtype:"container",layout:{type:"vbox"},items:[{xtype:"textfield",name:"id",itemId:"IdFePersonCli",reference:"IdFePersonCli",dataIndex:"id",
hidden:!0},{xtype:"textfield",name:"includeBolloLinee",itemId:"IncludeBolloLinee",reference:"IncludeBolloLinee",dataIndex:"includeBolloLinee",hidden:!0},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"container",layout:{type:"vbox"},width:250,items:[{xtype:"checkboxfield",margin:"0 0 0 10",itemId:"CkbFattNetPens",reference:"CkbFattNetPens",fieldLabel:"",boxLabel:"CREA_FATT_NETTO_PENSIONI",inputValue:"T",uncheckedValue:"F",dataIndex:"esportaNettoPensioni",name:"esportaNettoPensioni"}]},{xtype:"container",
layout:{type:"vbox"},flex:1,items:[{xtype:"checkboxfield",margin:"0 0 0 10",itemId:"CkbBollSenzAdd",reference:"CkbBollSenzAdd",fieldLabel:"",boxLabel:"INSERISCI_BOLLO_SENZA_ADD",inputValue:"T",uncheckedValue:"F",dataIndex:"addebitaBollo",name:"addebitaBollo"},{xtype:"checkboxfield",margin:"0 0 0 35",itemId:"CkbBollNaNegativo",reference:"CkbBollNaNegativo",fieldLabel:"",boxLabel:"BOLLO_VIRTUALE_NEGATIVO_PER_NA",inputValue:"T",uncheckedValue:"F",dataIndex:"bolloNAccNegativo",name:"bolloNAccNegativo"}]}]},
{xtype:"container",layout:{type:"hbox"},items:[{xtype:"container",layout:{type:"vbox"},width:250,items:[{xtype:"checkboxfield",margin:"0 0 2 10",itemId:"CkbNascondiDettZero",reference:"CkbNascondiDettZero",fieldLabel:"",boxLabel:"NASCONDI_DETT_ZERO",inputValue:"T",uncheckedValue:"F",dataIndex:"nascondiDettZero",name:"nascondiDettZero"},{xtype:"checkboxfield",margin:"0 0 0 10",itemId:"CkbNascondiNome",reference:"CkbNascondiNome",fieldLabel:"",boxLabel:"NASCONDI_NOME",inputValue:"T",uncheckedValue:"F",
dataIndex:"nascondiNome",name:"nascondiNome"}]},{xtype:"container",layout:{type:"vbox"},flex:1,items:[{xtype:"combobox",itemId:"CbxAccorpaDesc",reference:"CbxAccorpaDesc",name:"accorpaDescrizioni",emptyText:"ACCORPA_DESCRIZIONI_EMPTYTEXT",labelWidth:112,margin:"0 0 2 10",width:350,queryMode:"local",store:this.storeTipoAccorpamento,valueField:"codice",displayField:"valore",allowBlank:!1},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"checkboxfield",margin:"0 0 0 10",itemId:"CkbSoloInizialiNome",
reference:"CkbSoloInizialiNome",boxLabel:"SOLO_INIZIALI_NOME",inputValue:"T",uncheckedValue:"F",name:"soloInizialiNome"},{xtype:"numberfield",margin:"0 0 5 10",itemId:"numeroInizialiNome",reference:"numeroInizialiNome",allowDecimals:!1,hideTrigger:!1,minValue:0,maxValue:5,width:40,name:"numeroInizialiNome",disabled:!0}]}]}]}]},{xtype:"panel",itemId:"BoxBottoni",reference:"BoxBottoni",margin:"0 0 0 10",width:100,title:""}]},{xtype:"gridpanel",flex:1,title:"FE_CAMPI_AGGIUNTIVI",scrollable:!0,itemId:"GrigliaCampiAgg",
reference:"GrigliaCampiAgg",selModel:Ext.create("Ext.selection.CheckboxModel",{checkOnly:!0}),store:Ext.create("Generali.clientiFornitori.store.PersonFattEle",{groupField:"nometagTe"}),columns:[{xtype:"gridcolumn",text:"Campo",dataIndex:"nometagTe",hidden:!0},{xtype:"gridcolumn",dataIndex:"id",width:100,hidden:!0},{xtype:"gridcolumn",dataIndex:"idcodipa",width:100,hidden:!0},{xtype:"gridcolumn",text:"CODICE",dataIndex:"idcampoDeFormat",width:100,renderer:function(a,b,c,d,e,g,h){Ext.isEmpty(c.get("valore_predefinito"))&&
"T"!=c.get("flagAttivo")||(a=a.replace(a,"<b>"+a+"</b>"));return a}},{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"nometag",width:200,renderer:function(a,b,c,d,e,g,h){Ext.isEmpty(c.get("valore_predefinito"))&&"T"!=c.get("flagAttivo")||(a=a.replace(a,"<b>"+a+"</b>"));return a}},{xtype:"gridcolumn",dataIndex:"valore_predefinito",text:"Valore",flex:1,width:200,editor:{xtype:"textfield",enforceMaxLength:!0},renderer:function(a,b,c,d,e,g,h){d="";"T"==c.get("obbligatorio")&&(b.style="border: 1px solid red;",
d="campo obbligatorio ,");d+=" TIPO: ";"D"==c.get("tipodato")&&(d+=" data, formato gg-mm-yyyy");"N"==c.get("tipodato")&&(d+=" numerico");"S"==c.get("tipodato")&&(d+=" stringa, lunghezza max="+c.get("lunghezzamassima"));b.tdAttr='data-qtip="'+d+'"';Ext.isEmpty(a)||(a=a.replace(a,"<b>"+a+"</b>"));return Ext.isEmpty(a)?"":a}},{xtype:"gridcolumn",text:"Campo",dataIndex:"recModificato",hidden:!0}],features:[{ftype:"grouping"}],hideGroupedHeader:!0,plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfGrid",reference:"BtnConfGrid",iconCls:"icon-conferma",text:"Conferma",disabled:!0},{xtype:"button",itemId:"BtnRiprGrid",reference:"BtnRiprGrid",iconCls:"icon-annulla32",text:"Ripristina",disabled:!0}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.PersonFranchigia",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"gridpanel",itemId:"GridTestata",reference:"GridTestata",height:150,title:"ELENCO",store:Ext.create("Generali.clientiFornitori.store.FranchigieTe"),columns:[{xtype:"gridcolumn",text:"SERVIZIO",dataIndex:"desServizio",flex:1},{xtype:"gridcolumn",
text:"TIPO_USCITA",dataIndex:"desTipoAssenza",flex:1},{xtype:"gridcolumn",text:"MOTIVI_USCITA_TEMP",dataIndex:"desMotivoAssenza",flex:1},{xtype:"datecolumn",text:"DATA_DECORRENZA",dataIndex:"dataDal",format:"d/m/Y"}],viewConfig:{loadMask:!1}},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"form",itemId:"Form",reference:"Form",flex:1,border:0,layout:{type:"vbox",align:"stretch"},bodyPadding:10,title:"",trackResetOnLoad:!0,items:[{xtype:"container",itemId:"CntTestata",
reference:"CntTestata",margin:"0 0 20 0",items:[{xtype:"datefield",margin:"0 0 5 0",width:250,fieldLabel:"DATA_DECORRENZA",labelClsExtra:"cbaLabel",name:"dataDal",allowBlank:!1},{xtype:"combobox",margin:"0 0 5 0",fieldLabel:"TIPO_IMPORTO",name:"tipoImporto",itemId:"TipoImporto",reference:"TipoImporto",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",width:250,labelWidth:100,allowBlank:!1},{xtype:"container",itemId:"CalcoloFranchigia",reference:"CalcoloFranchigia",
margin:"0 0 5 0",layout:{align:"stretch",type:"hbox"},items:[{xtype:"combobox",fieldLabel:"TIPO_CALCOLO",name:"tipoCalcolo",itemId:"TipoCalcolo",reference:"TipoCalcolo",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",width:250,labelWidth:100,allowBlank:!1},{xtype:"button",cls:"btnLarge",itemId:"TipoCalcoloInfo",reference:"TipoCalcoloInfo",margin:"0 0 0 10",iconCls:"icon-info",scale:"medium",text:""}]},{xtype:"container",layout:{align:"stretch",type:"vbox"},items:[{xtype:"combobox",
fieldLabel:"SERVIZIO",itemId:"Servizio",reference:"Servizio",name:"idServizio",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("GeneraliOSP.store.TipoServizio"),allowBlank:!1},{xtype:"combobox",name:"tipoAssenza",fieldLabel:"TIPO_USCITA",itemId:"CBTipoAssenza",reference:"CBTipoAssenza",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("GeneraliOSP.store.UscitaTemp"),allowBlank:!1},{xtype:"combobox",
name:"motivoAssenza",fieldLabel:"MOTIVI_USCITA_TEMP",itemId:"CBMotivoAssenza",reference:"CBMotivoAssenza",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.data.StoreCodiceValore",{proxy:{urlGen:"/ws/genOsp/risposte/cbox"}}),listeners:{afterrender:function(a){a.setStyleNonAttivo(a)}}}]},{xtype:"textfield",itemId:"recordId",reference:"recordId",hidden:!0,fieldLabel:"id",name:"id"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
width:120}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.PersonRette",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",layout:{type:"fit"},items:[{xtype:"form",itemId:"Form",reference:"Form",border:0,margin:"0 0 5 0",layout:{align:"stretch",type:"hbox"},trackResetOnLoad:!0,items:[{xtype:"container",flex:1,padding:5,layout:{type:"vbox"},autoScroll:!0,items:[{xtype:"container",defaults:{margin:"0 5 0 0"},
layout:{align:"stretch",type:"hbox"},items:[{xtype:"fieldset",title:"TIPI_PAGANTE",items:[{xtype:"radiogroup",itemId:"rgTipiPagante",fieldLabel:"",columns:1,allowBlank:!1,msgTarget:"side",autoFitErrors:!1,anchor:"-18",items:[{xtype:"radiofield",cls:"cbaLabel",name:"tipoPagante",boxLabel:"PRIVATI",allowBlank:!1,inputValue:"P"},{xtype:"radiofield",cls:"cbaLabel",name:"tipoPagante",boxLabel:"ENTI",allowBlank:!1,inputValue:"E"},{xtype:"radiofield",cls:"cbaLabel",name:"tipoPagante",boxLabel:"COMUNI",allowBlank:!1,
inputValue:"C"},{xtype:"radiofield",cls:"cbaLabel",name:"tipoPagante",boxLabel:"ALTRO",allowBlank:!1,inputValue:"A"}]}]},{xtype:"fieldset",layout:{type:"hbox"},items:[{xtype:"container",layout:{type:"vbox"},items:[{xtype:"checkboxfield",itemId:"CkbPersIng",reference:"CkbPersIng",cls:"cbaLabel",fieldLabel:"",name:"persIngressoDimissGenerali",boxLabel:"PERSON_INGDIM_CLIENTE",inputValue:"T",uncheckedValue:"F"},{xtype:"container",itemId:"CntCheckIng",reference:"CntCheckIng",disabled:!0,margin:"0 0 0 5",
padding:"0 0 0 5",items:[{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"giornoIngresso",boxLabel:"giornoIngressoRette",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",itemId:"CkgiornoDimissione",reference:"CkgiornoDimissione",cls:"cbaLabel",fieldLabel:"",name:"giornoDimissione",boxLabel:"giornoDimissioneRette",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",itemId:"CkgiornoDecesso",reference:"CkgiornoDecesso",cls:"cbaLabel",fieldLabel:"",name:"giornoDecesso",boxLabel:"giornoDecessoRette",
inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"giornoUscita",boxLabel:"giornoUscitaRette",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"giornoRientro",boxLabel:"giornoRientroRette",inputValue:"T",uncheckedValue:"F"}]}]},{xtype:"gridpanel",itemId:"MotiviDim",reference:"MotiviDim",padding:"3 10 0 20",width:250,height:170,title:"",disabled:!0,store:Ext.create("GeneraliOSP.store.RisposteSmall"),columns:[{xtype:"gridcolumn",
dataIndex:"descrizione",text:traduci("MOTIVI_DIM"),flex:1}],viewConfig:{loadMask:!1},selModel:Ext.create("Ext.selection.CheckboxModel",{checkOnly:!0,listeners:{selectionchange:function(a,b,c){this.column.getView().up().up().up().up().up().controller.getDirtyGrid().setValue("xx")}}}),features:[{ftype:"grouping",groupHeaderTpl:["{name}"]}]},{xtype:"textfield",itemId:"DirtyGrid",reference:"DirtyGrid",name:"DirtyGrid",hidden:!0},{xtype:"textfield",itemId:"motiviDimissione",reference:"motiviDimissione",
hidden:!0,name:"motiviDimissione"}]}]},{xtype:"combobox",itemId:"TipoDocumento",reference:"TipoDocumento",width:423,margin:"5 0 5 5",fieldLabel:"TIPO_DOCUMENTO",labelClsExtra:"cbaLabel",name:"tipoDocumento",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"combobox",margin:"5 0 0 5",itemId:"Attivita",reference:"Attivita",width:423,fieldLabel:"ATTIVITA",labelClsExtra:"cbaLabel",name:"attivita",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice"},
{xtype:"combobox",margin:"5 0 0 5",width:423,fieldLabel:"CAUSALE_FATTURA",labelClsExtra:"cbaLabel",itemId:"CausaleFattura",reference:"CausaleFattura",name:"codCausaleDocumento",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"combobox",margin:"5 0 0 5",width:423,fieldLabel:"CAUSALE_NOTA_ACCREDITO",labelClsExtra:"cbaLabel",itemId:"CausaleNotaAccredito",reference:"CausaleNotaAccredito",name:"codCausaleNotaAccredito",allowBlank:!1,displayField:"valore",queryMode:"local",
valueField:"codice"},{xtype:"combobox",margin:"5 0 0 5",width:423,fieldLabel:"ALIQUOTA",labelClsExtra:"cbaLabel",itemId:"IdAliquotaIva",reference:"IdAliquotaIva",name:"idAliquotaIva",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.AliquotaIva",{autoLoad:!0}),tpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"<tpl if=\"extra.split(',')[1] == 'F'\">",'<div style="font-style: italic !important; color: #707070 !important;" class="x-boundlist-item">{valore}</div>',
"<tpl else>",'<div class="x-boundlist-item">{valore}</div>',"</tpl>","</tpl>")},{xtype:"fieldset",margin:"5 0 0 0",itemId:"CntContoRegistro",reference:"CntContoRegistro",width:428,hidden:!0,items:[{xtype:"container",margin:"5 0 5 0",layout:{type:"hbox"},items:[{xtype:"combobox",itemId:"Registro",reference:"Registro",width:160,fieldLabel:"REGISTRO",labelClsExtra:"cbaLabel",name:"registro",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.Registro")},{xtype:"button",
margin:"0 0 0 5",cls:"btnLarge",itemId:"BtnPriorita",reference:"BtnPriorita",iconCls:"icon-info",scale:"medium",tooltip:""}]},{xtype:"combobox",width:415,fieldLabel:"CONTO",itemId:"Conto",reference:"Conto",labelClsExtra:"cbaLabel",name:"conto",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"numberfield",hidden:!0,name:"annoConto"},{xtype:"cda",annoData:"annoCda",labelWidth:100,width:450,margin:"0 0 0 0",hideCodice:!0,showDesCda:!0,hideAnno:!1,itemId:"cntCda",reference:"cntCda",
cbaConfig:{tipoContabilita:4,allowChangeAnno:!0}},{xtype:"combobox",itemId:"CBForzaParamContabili",reference:"CBForzaParamContabili",width:415,fieldLabel:"FORZA_PARAM_CONTABILI",labelClsExtra:"cbaLabel",name:"forzaParamContabili",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("GeneraliOSP.store.ForzaParamContabili")},{xtype:"numberfield",hidden:!0,name:"idEsercizio"}]},{xtype:"combobox",width:350,labelAlign:"top",labelClsExtra:"cbaLabel",itemId:"SeparazioneRetta",reference:"SeparazioneRetta",
fieldLabel:"RETTE_SEPARAZIONE",name:"separazioneRetta",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"checkboxfield",itemId:"BolloAutomatico",reference:"BolloAutomatico",cls:"cbaLabel",fieldLabel:"",name:"bolloAutomatico",boxLabel:"BOLLO_AUTOMATICO",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"splitPayment",boxLabel:"SPLIT_PAYMENT",inputValue:"T",uncheckedValue:"F",
margin:"0 0 0 80"}]},{xtype:"combobox",itemId:"IdImpostazioniBollo",reference:"IdImpostazioniBollo",width:350,fieldLabel:"IMPOSTAZIONI_BOLLO",labelClsExtra:"cbaLabel",name:"idImpostazioniBollo",allowBlank:!0,displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.CboxPersonalizzazioni",{autoLoad:!1})},{xtype:"fieldset",title:"RETTE_CALCOLO",layout:{align:"stretch",type:"hbox"},width:350,items:[{xtype:"radiogroup",itemId:"rbTipoCalcoloRetta",reference:"rbTipoCalcoloRetta",
flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"radiofield",cls:"cbaLabel",name:"tipoCalcoloRetta",boxLabel:"RETTE_anticipate",inputValue:"A"},{xtype:"radiofield",cls:"cbaLabel",name:"tipoCalcoloRetta",boxLabel:"RETTE_posticipate",inputValue:"P"}]},{xtype:"container",flex:1,items:[{xtype:"checkboxfield",x:20,y:17,labelWidth:50,cls:"cbaLabel",fieldLabel:"",name:"conguaglioAutomatico",itemId:"ConguaglioAutomatico",reference:"ConguaglioAutomatico",boxLabel:"RETTE_CONGUAGLIO_AUTO",inputValue:"T",
uncheckedValue:"F",disabled:!0}]}]},{xtype:"fieldset",title:"RETTE_EMISSIONE",width:350,items:[{xtype:"radiogroup",columns:3,items:[{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_mensile",cls:"cbaLabel",inputValue:"M"},{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_trimestrale",cls:"cbaLabel",inputValue:"T"},{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_semestrale",cls:"cbaLabel",inputValue:"S"},{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_bimestrale",cls:"cbaLabel",inputValue:"B"},
{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_quadrimestrale",cls:"cbaLabel",inputValue:"Q"},{xtype:"radiofield",name:"mensilita",boxLabel:"RETTE_annuale",cls:"cbaLabel",inputValue:"A"}]}]},{xtype:"combobox",itemId:"ProtezioneRetta",reference:"ProtezioneRetta",width:350,labelAlign:"top",fieldLabel:"PROTEZIONE_RETTA",labelClsExtra:"cbaLabel",name:"protezioneRetta",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"combobox",itemId:"CBCodFoCl",reference:"CBCodFoCl",width:350,
labelAlign:"top",fieldLabel:"ANA_PASSAGGIO_CONT",labelClsExtra:"cbaLabel",name:"codFoClPassaggioDati",displayField:"valore",valueField:"codice",minChars:3,queryParam:"valore",store:Ext.create("Generali.clientiFornitori.store.ClientiFornitori"),tpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"<tpl if=\"extra=='' || extra.indexOf('null')!=-1 || extra.indexOf(',')==0\">",'<div class="x-boundlist-item">{valore}</div>',"<tpl else>","<tpl if=\"extra.indexOf(',')!=-1\">","<tpl if=\"extra.split(',')[1]=='F'\">",
'<div style="font-style: italic !important; color: #707070 !important;" class="x-boundlist-item">{valore} [CF: {[values.extra.split(\',\')[0]]}]</div>',"<tpl else>","<div class=\"x-boundlist-item\">{valore} [CF: {[values.extra.split(',')[0]]}]</div>","</tpl>","<tpl else>",'<div class="x-boundlist-item">{valore} [CF: {extra}]</div>',"</tpl>","</tpl>","</tpl>")},{xtype:"fieldset",itemId:"CntCapitoloArticolo",reference:"CntCapitoloArticolo",hidden:!0,items:[{xtype:"container",margin:"0 0 5 0",layout:{type:"hbox"},
items:[{xtype:"combobox",width:350,fieldLabel:"ENTE_IVA",labelClsExtra:"cbaLabel",itemId:"cbEnteIva",reference:"cbEnteIva",name:"enteIvaFinanziaria",displayField:"valore",queryMode:"local",store:Ext.create("GeneraliOSP.store.EnteIvaFina"),valueField:"codice"},{xtype:"button",cls:"btnLarge",itemId:"BtnPrioritaFina",reference:"BtnPrioritaFina",iconCls:"icon-info",scale:"medium",tooltip:""}]},{xtype:"combobox",itemId:"Capitolo",reference:"Capitolo",width:350,fieldLabel:"CAPITOLO",labelClsExtra:"cbaLabel",
name:"capitolo",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.Capitolo")},{xtype:"combobox",width:350,fieldLabel:"ARTICOLO",labelClsExtra:"cbaLabel",name:"articolo",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.Articolo")}]},{xtype:"textfield",itemId:"recordId",reference:"recordId",hidden:!0,fieldLabel:"id",name:"id"},{xtype:"textfield",itemId:"Codfocl",reference:"Codfocl",hidden:!0,fieldLabel:"codfocl",
name:"codfocl"},{xtype:"textfield",hidden:!0,fieldLabel:"idOrganizzazione",name:"idOrganizzazione"},{xtype:"textfield",hidden:!0,fieldLabel:"idParametriContabilita",name:"idParametriContabilita"},{xtype:"checkboxfield",itemId:"TotFatturaNettoPensioni",reference:"TotFatturaNettoPensioni",cls:"cbaLabel",fieldLabel:"",name:"totFatturaNettoPensioni",boxLabel:"RETTE_NETTO_PENSIONI",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",itemId:"EsclCalcRette",reference:"EsclCalcRette",cls:"cbaLabel",
fieldLabel:"",name:"escludiCalcoloRette",boxLabel:"ESCLUDI_DA_CALCOLO_RETTE",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",itemId:"PensUsaEccedenza",reference:"PensUsaEccedenza",cls:"cbaLabel",fieldLabel:"",name:"pensioneUsaEccedenza",boxLabel:"UTILIZZA_ECCEDENZA_PENSIONE",inputValue:"T",uncheckedValue:"F"},{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},width:350,items:[{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},padding:"0 0 2 0",items:[{xtype:"displayfield",
fieldLabel:"CIG",labelClsExtra:"cbaLabel",name:"cig",itemId:"Cig",reference:"Cig",readOnly:!0,labelWidth:30,width:130},{xtype:"displayfield",fieldLabel:"CUP",labelClsExtra:"cbaLabel",name:"cup",itemId:"Cup",reference:"Cup",readOnly:!0,labelWidth:30,width:175,padding:"0 5 0 5"},{xtype:"textfield",hidden:!0,name:"cigCupNote",itemId:"CigCupNote",reference:"CigCupNote"},{xtype:"button",iconCls:"icon-ricerca16",tooltip:"CIGCUP_SELECT",itemId:"BntCigCupSelect",reference:"BntCigCupSelect",width:22}]},{xtype:"container",
flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",fieldLabel:"IBAN",labelClsExtra:"cbaLabel",name:"iban",itemId:"Iban",reference:"Iban",readOnly:!0,labelWidth:30,padding:"0 5 0 0",width:310},{xtype:"button",iconCls:"icon-elimina16",tooltip:"CIGCUP_DELETE",itemId:"BntCigCupClear",reference:"BntCigCupClear",width:22}]}]},{xtype:"fieldset",title:"COD_IPA",itemId:"fsIdCodIpa",reference:"fsIdCodIpa",items:[{xtype:"combobox",itemId:"IdCodIpa",reference:"IdCodIpa",anchor:"100%",width:250,
name:"idCodIpa",displayField:"valore",queryMode:"local",valueField:"codice"}]},{xtype:"combobox",itemId:"idModelloFattura",reference:"idModelloFattura",width:350,fieldLabel:"MODELLO_FATTURA",labelClsExtra:"cbaLabel",name:"idModelloFattura",allowBlank:!0,displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.CboxModelliFattura",{autoLoad:!1})},{xtype:"fieldset",title:"RITENUTA",items:[{xtype:"textfield",hidden:!0,fieldLabel:"ritenuta_idParametriContabilita",name:"ritenuta_idParametriContabilita"},
{xtype:"combobox",itemId:"CbRitenutaAcconto",reference:"CbRitenutaAcconto",width:385,fieldLabel:"TIPO_RITENUTA",labelClsExtra:"cbaLabel",name:"ritenuta05",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("GeneraliOSP.store.Ritenuta",{autoLoad:!0})},{xtype:"combobox",hidden:!0,width:385,fieldLabel:"ALIQUOTA",labelClsExtra:"cbaLabel",itemId:"RitenutaIdAliquotaIva",reference:"RitenutaIdAliquotaIva",name:"ritenuta_idAliquotaIva",displayField:"valore",queryMode:"local",valueField:"codice",
store:Ext.create("Generali.store.AliquotaIva",{autoLoad:!0}),tpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"<tpl if=\"extra.split(',')[1] == 'F'\">",'<div style="font-style: italic !important; color: #707070 !important;" class="x-boundlist-item">{valore}</div>',"<tpl else>",'<div class="x-boundlist-item">{valore}</div>',"</tpl>","</tpl>")},{xtype:"combobox",hidden:!0,width:385,fieldLabel:"CONTO",labelClsExtra:"cbaLabel",name:"ritenuta_conto",itemId:"RitenutaConto",reference:"RitenutaConto",displayField:"valore",
queryMode:"local",valueField:"codice"},{xtype:"numberfield",hidden:!0,name:"ritenuta_annoConto"},{xtype:"cda",extraFieldName:"ritenuta_",annoData:"annoCda",labelWidth:100,width:400,margin:"0 0 0 0",hideCodice:!0,showDesCda:!0,hideAnno:!1,itemId:"CntRitenutaCda",reference:"CntRitenutaCda",hidden:!0,cbaConfig:{tipoContabilita:4}}]}]},{xtype:"panel",itemId:"BoxBottoni",reference:"BoxBottoni",border:0,width:120}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.PnlPriorita",{extend:"Ext.panel.Panel",border:0,itemId:"PnlPriorita",reference:"PnlPriorita",layout:{type:"vbox"},bodyPadding:10,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"displayfield",value:"1) Classificazione",labelClsExtra:"cbaLabel"},{xtype:"displayfield",value:"2) Assenza",labelClsExtra:"cbaLabel"},{xtype:"displayfield",value:"3) Cda per sede",labelClsExtra:"cbaLabel"},{xtype:"displayfield",value:"4) Cda per stanza",labelClsExtra:"cbaLabel"},
{xtype:"displayfield",value:"5) Parametri contabili del servizio",labelClsExtra:"cbaLabel"},{xtype:"displayfield",value:"6) Parametri contabili del pagante personalizzato",labelClsExtra:"cbaLabel"}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.SbloccaImport",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_IMPORT_CLIFOR",nomeFunzioneDaAttivare:"Import Anagrafiche Cliente/Fornitore",codiceFunzione:"CP_IMPORT_ANAG",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",itemId:"PnlPrincipale",reference:"PnlPrincipale",layout:{align:"stretch",type:"hbox"}}]});this.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.SelezionaCigCup",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",itemId:"GridCigCup",reference:"GridCigCup",sortableColumns:!1,store:Ext.create("Generali.clientiFornitori.store.SelezionaCigCup"),columns:[{xtype:"gridcolumn",text:"Pred",dataIndex:"predefinito",align:"center",renderer:function(a,b,e,g,h,k,l){b.tdCls="T"==e.data.predefinito?"presente":""},editor:{xtype:"checkboxfield",
inputValue:"T",uncheckedValue:"F"},width:35},{xtype:"datecolumn",text:"DAL",dataIndex:"dataDal",align:"center",format:"d/m/Y",width:70,editor:{xtype:"datefield",format:"d/m/Y",allowBlank:!1}},{xtype:"datecolumn",text:"AL",dataIndex:"dataAl",align:"center",format:"d/m/Y",width:70,editor:{xtype:"datefield",format:"d/m/Y"}},{xtype:"gridcolumn",text:"CIG",dataIndex:"cig",align:"center",width:80,editor:{xtype:"textfield",maxLength:10,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"CUP",dataIndex:"cup",
align:"center",width:120,editor:{xtype:"textfield",maxLength:15,enforceMaxLength:!0}},{xtype:"numbercolumn",text:"IMPORTO",dataIndex:"importo",align:"center",renderer:cell_renderer_importo,width:90,editor:{xtype:"numberfield"}},{xtype:"numbercolumn",text:"RESIDUO",dataIndex:"residuoCigCup",align:"center",renderer:cell_renderer_importo,width:90},{xtype:"gridcolumn",text:"IBAN",dataIndex:"iban",align:"left",width:120,editor:{xtype:"textfield"}},{xtype:"gridcolumn",width:70,align:"center",sortable:!1,
dataIndex:"ritenutaDurc",text:"RITENUTA",renderer:function(a,b){renderCheckColumn(b,a)},editor:{xtype:"checkboxfield",nputValue:"T",uncheckedValue:"F"}},{xtype:"gridcolumn",text:"NOTE",dataIndex:"note",align:"left",flex:1,editor:{xtype:"textfield"}},{xtype:"datecolumn",text:"DATA_PUB_BANDO",dataIndex:"dataPubblicazioneBando",align:"center",format:"d/m/Y",width:70,editor:{xtype:"datefield",format:"d/m/Y"}},{xtype:"gridcolumn",text:"OGGETTO_BANDO",dataIndex:"nomeBando",align:"left",width:130,flex:1,
editor:{xtype:"textfield"}},{xtype:"numbercolumn",text:"IMPORTO_AGGIUDICAZIONE",dataIndex:"importoAggiudicazioneBando",align:"center",renderer:cell_renderer_importo,width:90,editor:{xtype:"numberfield"}},{xtype:"gridcolumn",text:"PROCEDURA",align:"center",width:200,dataIndex:"procedura",editor:{xtype:"combobox",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.store.TabProcedura",{sorters:[{property:"valore",direction:"ASC"}]})},renderer:function(b,d,e){return b?
trovaRecord(a.controller.storeProcedura,"codice",b).get("valore"):""}},{xtype:"actioncolumn",width:70,align:"center",hidden:!0,itemId:"ColonnaEditDettagli",reference:"ColonnaEditDettagli",text:"GESTIONE_DETTAGLI",items:[{iconCls:"icon-ricerca16 ",getTip:function(){return traduci("CIGCUP_SET_DETAIL")},handler:function(a,b,e){this.up("gridpanel").controller.gridActionClick(b,1)}},{getClass:function(a,b,e){return e.get("haveDetails")&&"T"==e.get("haveDetails")?"icon-elimina16":"x-hide-display"},getTip:function(a,
b,e){if(e.get("haveDetails")&&"T"==e.get("haveDetails"))return traduci("CIGCUP_CLEAR_DETAIL")},handler:function(a,b,e){a=a.getStore().getAt(b);a.get("haveDetails")&&"T"==a.get("haveDetails")&&this.up("gridpanel").controller.gridActionClick(b,2)}}]},{xtype:"gridcolumn",text:"PROGR",dataIndex:"progr",hidden:!0}],dockedItems:[{xtype:"toolbar",dock:"bottom",layout:{pack:"center"},height:30,items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-ok",text:"SELEZIONA_ESCI",nonDisabilitare:!0,
width:135,height:25},{xtype:"tbspacer",width:30},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-esciGriglia",text:"ESCI",width:120,height:25,padding:"0 20 0 30"}]},{xtype:"checkboxfield",itemId:"VisualizzaCigCup",reference:"VisualizzaCigCup",cls:"cbaLabel",dock:"top",boxLabel:"VISUALIZZA_TUTTI_CIG_CUP",inputValue:"T",uncheckedValue:"F"}],viewConfig:{width:200,loadMask:!1}}]});if(a.cbaConfig.insModifica){var b=a.items.find(function(a){return"GridCigCup"===a.itemId});Ext.apply(b,
{plugins:[Ext.create("Ext.grid.plugin.RowEditing",{clicksToEdit:1,autoCancel:!1,errorSummary:!1})]});b.dockedItems.push({xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnEdit",reference:"BtnEdit",iconCls:"icon-edit16",text:traduci("MODIFICA"),hidden:!0,listeners:{afterrender:function(b,d){b.on("click",Ext.bind(a.controller.clickBtnEdit,a.controller))}}},{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:traduci("NUOVO"),listeners:{afterrender:function(b,
d){b.on("click",Ext.bind(a.controller.clickBtnNuovo,a.controller))}}}]})}a.callParent(arguments)}});
Ext.define("Generali.clientiFornitori.view.SelezionaCigCupDetail",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"radiogroup",padding:"5 0 0 110",cls:"cbaLabel",height:25,itemId:"RgrpTipoDettaglio",reference:"RgrpTipoDettaglio",items:[{boxLabel:"SERVIZIO",name:"rbTipo",inputValue:"2",checked:!0},{boxLabel:"UTENTE",name:"rbTipo",inputValue:"1"}]},{xtype:"gridpanel",itemId:"GridServizi",
reference:"GridServizi",sortableColumns:!1,flex:1,store:Ext.create("Generali.clientiFornitori.store.SelezionaCigCupDetail"),columns:[{xtype:"gridcolumn",text:"CODICE",dataIndex:"codice",hidden:!0},{xtype:"checkcolumn",text:"",dataIndex:"extra",width:35,itemId:"CheckColumnServizi"},{xtype:"gridcolumn",text:"SERVIZIO",dataIndex:"valore",flex:1}],viewConfig:{width:200,loadMask:!1}},{xtype:"gridpanel",itemId:"GridUtenti",reference:"GridUtenti",hidden:!0,flex:1,store:Ext.create("Generali.clientiFornitori.store.SelezionaCigCupDetail"),
columns:[{xtype:"gridcolumn",text:"UTENTE",flex:1,dataIndex:"codice",renderer:function(a,b,c,d,e,g,h){return c.get("valore")},editor:{xtype:"combobox",queryMode:"local",allowBlank:!1,valueField:"codOspite",displayField:"nominativo"}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoUtente",reference:"BtnNuovoUtente",iconCls:"icon-inserisciGriglia",text:"Nuovo"},
{xtype:"button",itemId:"BtnEliminaUtente",reference:"BtnEliminaUtente",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]},{xtype:"toolbar",itemId:"BoxBottoni",reference:"BoxBottoni",dock:"bottom",layout:{pack:"center"},height:30,items:[{xtype:"tbspacer",width:30},{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-ok",text:"CONFERMA",nonDisabilitare:!0,width:120,height:25},{xtype:"button",itemId:"BtnRipristina",reference:"BtnRipristina",iconCls:"icon-annulla",text:"RIPRISTINA",
nonDisabilitare:!0,width:120,height:25}]}]}]});this.callParent(arguments)}});Ext.define("Generali.comuni.store.cboxComuni",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/comuni/cbox/byProvincia",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.comuni.store.cboxComuniGen",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/comuni/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.comuni.store.cboxComuniGenCodFisc",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/comuni/cbox/codfisc",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.condizionidipagamento.controller.CondPag",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"GridCondPagamento",selector:this.selContainer+"#GridCondPagamento"},{ref:"CntMese",
selector:this.selContainer+"#CntMese"},{ref:"CBGiornoFisso",selector:this.selContainer+"#CBGiornoFisso"},{ref:"CBFineMese",selector:this.selContainer+"#CBFineMese"},{ref:"CKFineMeseDaDataArrivo",selector:this.selContainer+"#CKFineMeseDaDataArrivo"},{ref:"StpAvPag",selector:this.selContainer+"#StpAvPag"},{ref:"NumCopPag",selector:this.selContainer+"#NumCopPag"},{ref:"Text1aRata",selector:this.selContainer+"#Text1aRata"},{ref:"Text2aRata",selector:this.selContainer+"#Text2aRata"},{ref:"Text3aRata",
selector:this.selContainer+"#Text3aRata"},{ref:"Text4aRata",selector:this.selContainer+"#Text4aRata"},{ref:"Text5aRata",selector:this.selContainer+"#Text5aRata"},{ref:"ChkInserisciScadenziario",selector:this.selContainer+"#ChkInserisciScadenziario"},{ref:"FsGiorniScadenza",selector:this.selContainer+"#FsGiorniScadenza"},{ref:"RdgScadenza",selector:this.selContainer+"#RdgScadenza"},{ref:"ChkSenzaAutorizzazione",selector:this.selContainer+"#ChkSenzaAutorizzazione"},{ref:"ChkCreaScritturaPagInc",selector:this.selContainer+
"#ChkCreaScritturaPagInc"},{ref:"FsParametriScr",selector:this.selContainer+"#FsParametriScr"},{ref:"CBCausale",selector:this.selContainer+"#CBCausale"},{ref:"CBConto",selector:this.selContainer+"#CBConto"},{ref:"CBCausaleInc",selector:this.selContainer+"#CBCausaleInc"},{ref:"CBContoInc",selector:this.selContainer+"#CBContoInc"},{ref:"ChbConsGiorni",selector:this.selContainer+"#ChbConsGiorni"},{ref:"CKNon_tracciato",selector:this.selContainer+"#CKNon_tracciato"},{ref:"CkVisuCooBanc",selector:this.selContainer+
"#CkVisuCooBanc"}]);this.control(this.selContainer+"#GridCondPagamento",{select:this.selectGridCondPagamento});this.control(this.selContainer+"#StpAvPag",{});this.control(this.selContainer+"#CBGiornoFisso",{change:this.changeCBGiornoFisso});this.control(this.selContainer+"#CBFineMese",{change:this.changeCBFineMese});this.control(this.selContainer+"#Text1aRata",{change:this.changeText1aRata});this.control(this.selContainer+"#Text2aRata",{change:this.changeText2aRata});this.control(this.selContainer+
"#Text3aRata",{change:this.changeText3aRata});this.control(this.selContainer+"#Text4aRata",{change:this.changeText4aRata});this.control(this.selContainer+"#ChkInserisciScadenziario",{change:this.changeChkInserisciScadenziario});this.control(this.selContainer+"#ChkCreaScritturaPagInc",{change:this.changeChkCreaScritturaPagInc});this.control(this.selContainer+"#CkVisuCooBanc",{change:this.changeCkVisuCooBanc})},changeCkVisuCooBanc:function(a,b){1==b?(this.getCKNon_tracciato().setVisible(!1),this.getCKNon_tracciato().setValue(!1)):
this.getCKNon_tracciato().setVisible(!0)},changeChkCreaScritturaPagInc:function(a,b){1==b?this.getFsParametriScr().setVisible(!0):this.getFsParametriScr().setVisible(!1)},changeChkInserisciScadenziario:function(a,b){this.getRdgScadenza().allowBlank=!b;1==b?(this.getFsGiorniScadenza().setVisible(!0),this.getText1aRata().enable()):(this.getFsGiorniScadenza().setVisible(!1),this.getText1aRata().disable())},changeText1aRata:function(a,b,c,d){0<b?this.getText2aRata().enable():this.getText2aRata().disable()},
changeText2aRata:function(a,b,c,d){0<b?this.getText3aRata().enable():this.getText3aRata().disable()},changeText3aRata:function(a,b,c,d){0<b?this.getText4aRata().enable():this.getText4aRata().disable()},changeText4aRata:function(a,b,c,d){0<b?this.getText5aRata().enable():this.getText5aRata().disable()},changeCBGiornoFisso:function(a,b){var c;this.getCntMese().setVisible(b);1==b?(c=!1,this.getText1aRata().setMaxValue(31)):(c=!0,this.getText1aRata().setMaxValue(Number.MAX_VALUE));this.getText2aRata().setVisible(c);
this.getText3aRata().setVisible(c);this.getText4aRata().setVisible(c);this.getText5aRata().setVisible(c)},changeCBFineMese:function(a,b){this.getCKFineMeseDaDataArrivo().setVisible(b)},changeStpAvPag:function(a,b){var c;b?c="28 0 0 0":c="15 0 0 0";a.setMargin(c);this.getNumCopPag().setVisible(b)},selectGridCondPagamento:function(a,b){clearForm(this.getForm());this.getForm().loadRecord(b)},verificaCampiForm:function(){var a=[],b=this.getForm();b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");b.getForm().findField("ggScadenza1Rata").isValid()||
msgAddError(a,"MSG_VALORE_INSERITO_NON_CORRETTO");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{stampaQuietanza:getBoolValue(c.stampaQuietanza),stampaAvvisoPagamento:getBoolValue(c.stampaAvvisoPagamento),fineMeseDaDataArrivo:getBoolValue(c.fineMeseDaDataArrivo),visualizzaCoordBanca:getBoolValue(c.visualizzaCoordBanca),visualizzaCC:getBoolValue(c.visualizzaCC),inserisciScadenziario:getBoolValue(c.inserisciScadenziario),creaScritturaPagInc:getBoolValue(c.creaScritturaPagInc),
senzaAutorizzazione:getBoolValue(c.senzaAutorizzazione),attivo:getBoolValue(c.attivo),consideraGiorniEffettiviMese:getBoolValue(c.consideraGiorniEffettiviMese),nonTracciato:getBoolValue(c.nonTracciato)});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getGridCondPagamento().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){b.getForm().findField("id").getValue();a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().findField("attivo").setValue(!0);a.getGridCondPagamento().setDisabled(!0);a.getFsGiorniScadenza().setVisible(!1)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},
esci_callback:function(){a.cbaConfig.callbackRiapriStore&&a.cbaConfig.callbackRiapriStore();a.getForm().up("window").close()}}});inserisciBottoni(b.boxBottoni,c);a.cbaConfig.mostraEsci||(c=b.boxBottoni.queryById("BtnStampa"),c.setVisible(!Ext.isEmpty(a.cbaConfig.url)),a.configurePrintButton(c,"preview"),b.boxBottoni.queryById("btnEsci").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGridCondPagamento().setDisabled(e)})},stampa:function(){var a=
this.cbaConfig.winElaborazione;a&&"string"===typeof a&&(this.cbaConfig.winElaborazione=a===(!0).toString());Ext.apply(this.parametriStampa,{url:this.cbaConfig.url,jsonData:this.cbaConfig.jsonData,titolo:this.cbaConfig.titolo,winElaborazione:this.cbaConfig.winElaborazione,params:{reportId:this.cbaConfig.idRecord}});a=this.parametriStampa;Ext.apply(a.params,{});this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,
this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampa();this.callParent([a,b])},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store;e.load({params:{},callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(c):(a||(a=d.findField("id").getValue()),(h=trovaRecord(e,"id",a))?(b.idConto=h.get("idConto"),b.idCausale=h.get("idCausale"),b.idContoInc=h.get("idContoInc"),b.idCausaleInc=h.get("idCausaleInc")):(b.idConto=g[0].get("idConto"),b.idCausale=g[0].get("idCausale"),
b.idContoInc=g[0].get("idContoInc"),b.idCausaleInc=g[0].get("idCausaleInc")),g=b.getGridCondPagamento(),g.getSelectionModel().deselectAll(),g.getSelectionModel().select(h?[h]:0)):msgShowError("",h.getError())}})},gestionePdc:function(a){var b=this;Ext.create("winCBA",{name:"Generali.pianodeiconti.view.PnlPianoConti",titolo:traduci("PIANO_CONTI"),dimensione:"GestioneUtente",configItem:{idOrganizzazione:b.idOrganizzazione,idEsercizio:b.idEsercizio,permesso:"S",chiamataEsterna:!0,mostraEsci:!0,callbackRiapriStore:function(c){a?
b.getCBConto().getStore().load({params:{idOrganizzazione:b.idOrganizzazione,idEsercizio:b.idEsercizio},callback:function(a,e,g){g&&c&&b.getCBConto().setValue(c)}}):b.getCBContoInc().getStore().load({params:{idOrganizzazione:b.idOrganizzazione,idEsercizio:b.idEsercizio},callback:function(a,e,g){g&&c&&b.getCBContoInc().setValue(c)}})}}}).show()},gestioneCausali:function(a){var b=this;Ext.create("winCBA",{name:"GeneraliAM.causalicontabili.view.CauPrimaNota",titolo:"TAB_CAUSALI_CONTAB",dimensione:1,configItem:{idOrganizzazione:b.idOrganizzazione,
permesso:"S",mostraEsciGenerale:!0,callbackRiapriStore:function(){a?b.getCBCausale().getStore().load({params:{idOrganizzazione:b.idOrganizzazione,tipoCausale:"P",tipoContabile:"P"}}):b.getCBCausaleInc().getStore().load({params:{idOrganizzazione:b.idOrganizzazione,tipoCausale:"I",tipoContabile:"P"}})}}}).show()},onLaunch:function(){var a=this,b=[44,51,52,53,54,56],c=a.getCBConto().getStore(),d=a.getCBContoInc().getStore();!StdSipcar.isValidID(a.cbaConfig.idRecord)&&StdSipcar.isValidID(a.cbaConfig.id)&&
(a.cbaConfig.idRecord=a.cbaConfig.id);a.getFsGiorniScadenza().setVisible(!1);a.getFsParametriScr().setVisible(!1);a.idOrganizzazione=getIdOrg();var e=CBA.moduli["modulo"+CBA.moduli.moduloAttivo];Ext.Array.contains(b,CBA.moduli.moduloAttivo)&&CBA.moduli.modulo44.abilitato&&CBA.moduli.modulo44.installato&&Ext.create("GeneraliAM.personalizzazioni.store.ParametriGeneraliEconomica",{autoLoad:!1}).load({params:{idOrganizzazione:getIdOrg(),idEsercizio:e.defaultIdEsercizio},callback:function(b,c,d){d?Ext.isEmpty(b)?
a.getChkSenzaAutorizzazione().setVisible(!1):(b=b[0],a.getChkSenzaAutorizzazione().setVisible("T"===b.get("autorizzazionePagamento"))):msgShowError("",c.getError())}});a.gestioneForm();a.aggiornaStore();StdSipcar.isValidID(e.defaultIdEsercizio)||(e.defaultIdEsercizio=0);a.idEsercizio=e.defaultIdEsercizio;c.load({params:{idOrganizzazione:a.idOrganizzazione,idEsercizio:e.defaultIdEsercizio,contoBanca:"F",soloMovimentati:"F",soloCespite:"F",soloPatrimoniali:"T"},callback:function(b,c,d){d&&!a.getCBConto().getValue()&&
StdSipcar.isValidID(a.idConto)&&setValue(a.getCBConto(),a.idConto)}});d.load({params:{idOrganizzazione:a.idOrganizzazione,idEsercizio:e.defaultIdEsercizio,contoBanca:"F",soloMovimentati:"F",soloCespite:"F",soloPatrimoniali:"T"},callback:function(b,c,d){d&&!a.getCBContoInc().getValue()&&StdSipcar.isValidID(a.idContoInc)&&setValue(a.getCBContoInc(),a.idContoInc)}});a.getCBConto().cbaConfig.modificaClick=function(){a.gestionePdc(!0)};a.getCBContoInc().cbaConfig.modificaClick=function(){a.gestionePdc(!1)};
Ext.Array.contains(b,CBA.moduli.moduloAttivo)&&(a.storeCausale=Ext.create("GeneraliAM.store.CausaliContabili"),a.storeCausaleInc=Ext.create("GeneraliAM.store.CausaliContabili"),ImpostaUrl([a.storeCausale]),a.getCBCausale().bindStore(a.storeCausale),a.storeCausale.load({params:{idOrganizzazione:getIdOrg(),tipoCausale:"P",tipoContabile:"P"},callback:function(b,c,d){d&&!a.getCBCausale().getValue()&&StdSipcar.isValidID(a.idCausale)&&setValue(a.getCBCausale(),a.idCausale)}}),a.getCBCausale().cbaConfig.modificaClick=
function(){a.gestioneCausali(!0)},ImpostaUrl([a.storeCausaleInc]),a.getCBCausaleInc().bindStore(a.storeCausaleInc),a.storeCausaleInc.load({params:{idOrganizzazione:getIdOrg(),tipoCausale:"P",tipoContabile:"I"},callback:function(b,c,d){d&&!a.getCBCausaleInc().getValue()&&StdSipcar.isValidID(a.idCausaleInc)&&setValue(a.getCBCausaleInc(),a.idCausaleInc)}}),a.getCBCausaleInc().cbaConfig.modificaClick=function(){a.gestioneCausali(!1)})},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.condizionidipagamento.store.CondPagamento",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codEnte"},{name:"descrizione"},{name:"tipoScadenza"},{name:"ggScadenza1Rata"},{name:"ggScadenza2Rata"},{name:"ggScadenza3Rata"},{name:"ggScadenza4Rata"},{name:"ggScadenza5Rata"},{name:"visualizzaCoordBanca"},{name:"visualizzaCC"},{name:"inserisciScadenziario"},{name:"stampaQuietanza"},{name:"stampaAvvisoPagamento"},{name:"numCopieAvvisoPagamento"},{name:"tipoScadenzaMese"},{name:"fineMeseDaDataArrivo"},
{name:"creaScritturaPagInc"},{name:"senzaAutorizzazione"},{name:"idCausale"},{name:"idConto"},{name:"idCausaleInc"},{name:"idContoInc"},{name:"attivo"},{name:"nonTracciato"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/condpag/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/condpag/list",create:"/cba/gen/ws/general/condpag/insert",update:"/cba/gen/ws/general/condpag/update",destroy:"/cba/gen/ws/general/condpag/delete"}},autoDestroy:!0});
Ext.define("Generali.condizionidipagamento.store.cboxCondPagamento",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"gruppo"},{name:"valoreExtra",convert:function(a,b){var c=b.get("extra"),c=null!=c?c.split(","):null;return null!=c&&3<c.length&&"?"!=c[3]?b.get("valore")+" "+c[3]:b.get("valore")}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/condpag/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.condizionidipagamento.view.CondPag",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"gridpanel",itemId:"GridCondPagamento",reference:"GridCondPagamento",width:200,store:Ext.create("Generali.condizionidipagamento.store.CondPagamento"),columns:[{xtype:"gridcolumn",dataIndex:"descrizione",
text:"DESCRIZIONE",flex:1,cls:"cbaLabel",labelClsExtra:"cbaLabel"}],viewConfig:{loadMask:!1,getRowClass:function(a,b){if("T"!=a.get("attivo"))return"non_attivi"}}},{xtype:"form",flex:1,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"textfield",width:500,fieldLabel:"DESCRIZIONE_PAGAMENTO",labelWidth:150,name:"descrizione",allowBlank:!1,maxLength:30,enforceMaxLength:!0},{xtype:"container",
layout:"hbox",items:[{xtype:"checkboxfield",boxLabel:"ATTIVO",name:"attivo",itemId:"ChbAttivo",reference:"ChbAttivo",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel",width:105},{xtype:"checkboxfield",boxLabel:"CONSIDERA_GIORNI_EFFETTIVI_MESE",name:"consideraGiorniEffettiviMese",itemId:"ChbConsGiorni",reference:"ChbConsGiorni",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel"}]},{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0},{xtype:"fieldset",title:"SCADENZA",defaults:{cls:"cbaLabel"},items:[{xtype:"container",
itemId:"CntScadenza",reference:"CntScadenza",layout:"vbox",items:[{xtype:"radiogroup",itemId:"RdgScadenza",reference:"RdgScadenza",defaults:{cls:"cbaLabel"},items:[{xtype:"radiofield",name:"tipoScadenza",boxLabel:"DATA_FATTURA",inputValue:"1"},{xtype:"radiofield",itemId:"CBFineMese",reference:"CBFineMese",name:"tipoScadenza",boxLabel:"FINE_MESE",inputValue:"2"},{xtype:"radiofield",name:"tipoScadenza",boxLabel:"DATA_ARRIVO",inputValue:"3"},{xtype:"radiofield",itemId:"CBGiornoFisso",reference:"CBGiornoFisso",
name:"tipoScadenza",boxLabel:"GIORNO_FISSO",inputValue:"4"}]},{xtype:"fieldset",itemId:"CntMese",reference:"CntMese",title:"Mese",hidden:!0,defaults:{cls:"cbaLabel"},items:[{xtype:"radiogroup",layout:"vbox",itemId:"RgScadMese",reference:"RgScadMese",margin:"0 10 0 0",defaults:{cls:"cbaLabel"},items:[{xtype:"radiofield",name:"tipoScadenzaMese",boxLabel:"MESE_IN_CORSO",inputValue:"1"},{xtype:"radiofield",name:"tipoScadenzaMese",boxLabel:"MESE_SUCESSIVO",inputValue:"2"}]}]},{xtype:"checkboxfield",itemId:"CKFineMeseDaDataArrivo",
reference:"CKFineMeseDaDataArrivo",fieldLabel:"",boxLabel:"DA_DATA_ARRIVO",inputValue:"T",uncheckedValue:"F",name:"fineMeseDaDataArrivo",hidden:!0}]}]},{xtype:"fieldset",title:"PARAMETRI",defaults:{cls:"cbaLabel"},items:[{xtype:"checkboxfield",itemId:"ChkInserisciScadenziario",reference:"ChkInserisciScadenziario",margin:"5 0 0 0",fieldLabel:"",boxLabel:"INSERISCI_IN_SCADENZIARIO",inputValue:"T",uncheckedValue:"F",name:"inserisciScadenziario"},{xtype:"checkboxfield",itemId:"ChkCreaScritturaPagInc",
reference:"ChkCreaScritturaPagInc",margin:"5 0 0 0",fieldLabel:"",boxLabel:"CREA_SCRITTURA_PNOTA_PAGINC",inputValue:"T",uncheckedValue:"F",name:"creaScritturaPagInc"},{xtype:"checkboxfield",itemId:"ChkSenzaAutorizzazione",reference:"ChkSenzaAutorizzazione",margin:"5 0 0 0",fieldLabel:"",boxLabel:"SENZA_AUTORIZZAZIONE",inputValue:"T",uncheckedValue:"F",name:"senzaAutorizzazione",hidden:!0},{xtype:"checkboxfield",itemId:"CKNon_tracciato",reference:"CKNon_tracciato",fieldLabel:"",boxLabel:"NON_TRACCIATO",
inputValue:"T",uncheckedValue:"F",name:"nonTracciato",hidden:!0},{xtype:"checkboxfield",itemId:"StpAvPag",reference:"StpAvPag",margin:"5 0 0 0",fieldLabel:"",boxLabel:"STAMPA_AVVISO_DI_PAGAMENTO",inputValue:"T",uncheckedValue:"F",name:"stampaAvvisoPagamento"},{xtype:"checkboxfield",fieldLabel:"",margin:"5 0 0 0",boxLabel:"STAMPA_QUIETANZA",inputValue:"T",uncheckedValue:"F",name:"stampaQuietanza"},{xtype:"checkboxfield",fieldLabel:"",margin:"5 0 0 0",itemId:"CkVisuCooBanc",reference:"CkVisuCooBanc",
boxLabel:"VISUALIZZA_COORDINATE_BANCARIE",inputValue:"T",uncheckedValue:"F",name:"visualizzaCoordBanca"},{xtype:"checkboxfield",fieldLabel:"",margin:"5 0 0 0",boxLabel:"VISUALIZZA_SOLO_CC",inputValue:"T",uncheckedValue:"F",name:"visualizzaCC"}]},{xtype:"fieldset",itemId:"FsParametriScr",reference:"FsParametriScr",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"fieldset",title:"PAGAMENTI",itemId:"FsParPag",reference:"FsParPag",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"comboModifica",
width:370,labelWidth:70,fieldLabel:"CAUSALE",labelClsExtra:"cbaLabel",itemId:"CBCausale",reference:"CBCausale",name:"idCausale",displayField:"valore",queryMode:"local",valueField:"codice",minChars:3,cbaConfig:{modificaClick:function(){}}},{xtype:"comboModifica",itemId:"CBConto",reference:"CBConto",store:Ext.create("Generali.pianodeiconti.store.DesSottoconto"),width:370,labelWidth:70,fieldLabel:"CONTO",name:"idConto",queryMode:"local",displayField:"valore",valueField:"codice",labelClsExtra:"cbaLabel",
minChars:3}]},{xtype:"fieldset",title:"INCASSI",itemId:"FsParInc",reference:"FsParInc",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"comboModifica",width:370,labelWidth:70,fieldLabel:"CAUSALE",labelClsExtra:"cbaLabel",itemId:"CBCausaleInc",reference:"CBCausaleInc",name:"idCausaleInc",displayField:"valore",queryMode:"local",valueField:"codice",minChars:3,cbaConfig:{modificaClick:function(){}}},{xtype:"comboModifica",itemId:"CBContoInc",reference:"CBContoInc",store:Ext.create("Generali.pianodeiconti.store.DesSottoconto"),
width:370,labelWidth:70,fieldLabel:"CONTO",name:"idContoInc",queryMode:"local",displayField:"valore",valueField:"codice",labelClsExtra:"cbaLabel",minChars:3}]}]},{xtype:"fieldset",title:"GIORNI_SCADENZA",itemId:"FsGiorniScadenza",reference:"FsGiorniScadenza",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"numberfield",allowDecimals:!1,itemId:"Text1aRata",reference:"Text1aRata",width:150,fieldLabel:"1A_RATA",name:"ggScadenza1Rata"},{xtype:"numberfield",allowDecimals:!1,itemId:"Text2aRata",
reference:"Text2aRata",width:150,fieldLabel:"2A_RATA",name:"ggScadenza2Rata",disabled:!0,validator:function(a){var b=this.up("form");a=b.down("#Text1aRata").getValue();b=b.down("#Text2aRata").getValue();return b<=a&&""==!b?(traduci("2A_RATA"),traduci("MSG_VALORE_INSERITO_NON_CORRETTO"),"Impostare un numero superiore alla rata precedente"):!0}},{xtype:"numberfield",allowDecimals:!1,itemId:"Text3aRata",reference:"Text3aRata",width:150,fieldLabel:"3A_RATA",name:"ggScadenza3Rata",disabled:!0,validator:function(a){var b=
this.up("form");a=b.down("#Text1aRata").getValue();var c=b.down("#Text2aRata").getValue(),b=b.down("#Text3aRata").getValue();return(b<=a||b<=c)&&""==!b?(traduci("3A_RATA"),traduci("MSG_VALORE_INSERITO_NON_CORRETTO"),"Impostare un numero superiore alla rata precedente"):!0}},{xtype:"numberfield",allowDecimals:!1,itemId:"Text4aRata",reference:"Text4aRata",width:150,fieldLabel:"4A_RATA",name:"ggScadenza4Rata",disabled:!0,validator:function(a){var b=this.up("form");a=b.down("#Text1aRata").getValue();
var c=b.down("#Text2aRata").getValue(),d=b.down("#Text3aRata").getValue(),b=b.down("#Text4aRata").getValue();return(b<=a||b<=c||b<=d)&&""==!b?(traduci("4A_RATA"),traduci("MSG_VALORE_INSERITO_NON_CORRETTO"),"Impostare un numero superiore alla rata precedente"):!0}},{xtype:"numberfield",allowDecimals:!1,itemId:"Text5aRata",reference:"Text5aRata",width:150,fieldLabel:"5A_RATA",name:"ggScadenza5Rata",disabled:!0,validator:function(a){var b=this.up("form");a=b.down("#Text1aRata").getValue();var c=b.down("#Text2aRata").getValue(),
d=b.down("#Text3aRata").getValue(),e=b.down("#Text4aRata").getValue(),b=b.down("#Text5aRata").getValue();return(b<=a||b<=c||b<=d||b<=e)&&""==!b?(traduci("5A_RATA"),traduci("MSG_VALORE_INSERITO_NON_CORRETTO"),"Impostare un numero superiore alla rata precedente"):!0}}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]}]});this.callParent(arguments)}});
Ext.define("Generali.datiCatastali.controller.CategoriaCatastale",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormCategoria",selector:this.selContainer+"#FormCategoria"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CodiceGruppo",selector:this.selContainer+"#CodiceGruppo"},{ref:"DescrCategoria",selector:this.selContainer+"#DescrCategoria"}])},verificaCampiForm:function(){var a=
[];this.getFormCategoria().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormCategoria(),c=b.getForm().getFieldValues();this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getFormCategoria();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeCategoria;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",
{cbaConfig:{conferma_callback:function(c){store=a.cbaConfig.controllerTree.getTreeRep().getStore();if(Ext.isEmpty(b.getForm().findField("id").getValue()))var d=trovaRecord(store,"text",a.getDescrCategoria().getValue());d&&d.get("idGruppo")!=a.cbaConfig.codiceGruppo?Messaggio("ATTENZIONE","DATI_STESSA_DESCR","YESNO","QUESTION",!1,function(){a.salvaForm(c)},function(){var c=b.getForm().findField("id").getValue();a.recordModificato=!0;a.aggiornaStore(c)}):a.salvaForm(c)},annulla_callback:function(){a.cbaConfig.controllerTree.disabilitaTree(!1);
a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,
e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.disabilitaTree(e)})},aggiornaStore:function(a){var b=this,c=b.storeCategoria,d=b.getFormCategoria(),e=d.getForm();b.cbaConfig.codiceArticolo&&"L"!=b.cbaConfig.permesso&&containerSolaLettura(d);b.cbaConfig.codiceCategoria||a?c.load({params:{id:b.cbaConfig.codiceCategoria?b.cbaConfig.codiceCategoria:a},callback:function(c,d,k){k?(Ext.isEmpty(c)||e.loadRecord(c[0]),b.recordModificato&&(b.recordModificato=!1,Ext.isEmpty(c)?b.cbaConfig.controllerTree.aggiornaStore(a):
b.cbaConfig.controllerTree.aggiornaStore(b.cbaConfig.nodeID))):msgShowError("",d.getError())}}):(b.cbaConfig.CntPrincipale.removeAll(),b.cbaConfig.controllerTree.aggiornaStore())},onLaunch:function(){this.storeCategoria=Ext.create("Generali.datiCatastali.store.CategoriaCatastale");this.gestioneForm();this.cbaConfig.nuovoInserimento?(this.getBoxBottoni().queryById("btnNuovo").handler(),this.getCodiceGruppo().setValue(this.cbaConfig.codiceGruppo)):this.aggiornaStore()},destroy:function(){eliminaStore(this.storeCategoria)}});
Ext.define("Generali.datiCatastali.controller.DatiCatastali",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:this.selContainer+"#TreeRep"},{ref:"CntPrincipale",selector:this.selContainer+"#CntPrincipale"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"ToolbarFinestra",selector:this.selContainer+"#ToolbarFinestra"},{ref:"BtnSeleziona",selector:this.selContainer+"#BtnSeleziona"},
{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"TxtCerca",selector:this.selContainer+"#TxtCerca"},{ref:"LblSelettore",selector:this.selContainer+"#LblSelettore"}]);this.control(this.selContainer+"#TreeRep",{select:this.selectTree,celldblclick:this.treeDblClick,beforeitemcontextmenu:this.beforeitemcontextmenuTree});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnSeleziona",{click:this.conferma});this.control(this.selContainer+"#BtnEsci",
{click:this.clickBtnEsci});this.control(this.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(this.filtraTree,500,this)})},filtraTree:function(a){var b=this.getTreeRep(),c=b.getStore(),d=[];this.getLblSelettore().setVisible(!1);c.clearFilter();Ext.isEmpty(a.getValue())?(c.each(function(a){a.set("cls","")}),b.getSelectionModel().select(0)):(c.each(function(b){if(b.isLeaf()){var c=!1,e=b.get("text");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);c?(b.set("cls","cba-dirty-record"),
d.push(b)):b.set("cls","")}}),this.filtraPadri(c,d),this.getLblSelettore().setVisible(1<d.length),Ext.isEmpty(d)?b.getSelectionModel().select(0):(b.ensureVisible(d[0]),this.getLblSelettore().setText(d.length+" "+traduci("ELEMENTI_TROVATI"))));a.focus()},filtraPadri:function(a,b){a.filter(function(a){for(var c=!1,e=0,g=b.length;e<g;e++)if(a.contains(b[e])){c=!0;break}else if(a.isLeaf()&&(c=a===b[e]))break;return c})},treeDblClick:function(a,b,c,d,e,g,h,k){d.get("idCategoria")&&this.cbaConfig.callbackSeleziona&&
(this.cbaConfig.callbackSeleziona(d),this.clickBtnEsci(this.getBtnEsci()))},conferma:function(a){var b=this.getTreeRep().getSelectionModel().getSelection()[0];b.get("idCategoria")&&this.cbaConfig.callbackSeleziona&&(this.cbaConfig.callbackSeleziona(b),a.up("window").close())},clickBtnEsci:function(a){a.up("window").close()},clickBtnNuovo:function(){var a=this.getTreeRep().getSelectionModel().getSelection()[0],b=this.getCntPrincipale(),c={};b.removeAll();Ext.apply(c,{nuovoInserimento:!0,controllerTree:this,
CntPrincipale:b,codiceGruppo:a.get("idGruppo"),codiceCategoria:a.get("idCategoria")});a&&(Ext.isEmpty(a.get("idGruppo"))?b.add(Ext.create("Generali.datiCatastali.view.GruppoCatastale",{cbaConfig:c})):Ext.isEmpty(a.get("idCategoria"))&&b.add(Ext.create("Generali.datiCatastali.view.CategoriaCatastale",{cbaConfig:c})))},disabilitaTree:function(a){"L"!=this.cbaConfig.permesso&&this.getTreeRep().setDisabled(a)},selectTree:function(a,b,c,d){a={};c=this.getCntPrincipale();d=this.getBtnNuovo();this.cbaConfig.caricamentoEsterno||
(Ext.apply(a,{controllerTree:this,nuovoInserimento:this.nuovoInserimento,permesso:this.cbaConfig.permesso,text:b.get("text"),nodeID:b.get("nodeID"),codiceGruppo:b.get("idGruppo"),codiceCategoria:b.get("idCategoria")}),c.removeAll(),Ext.isEmpty(b.get("idGruppo"))&&!Ext.isEmpty(b.get("idCategoria"))?(d.setText(traduci("NUOVO")),d.setDisabled(!0)):(d.setText(traduci("NUOVO_GRUPPO")),d.setDisabled("L"==this.cbaConfig.permesso),Ext.isEmpty(b.get("idGruppo"))||(d.setText(traduci("NUOVA_CATEGORIA")),c.add(Ext.create("Generali.datiCatastali.view.GruppoCatastale",
{cbaConfig:a}))),Ext.isEmpty(b.get("idCategoria"))||(d.setText(traduci("NUOVA_CATEGORIA")),d.setDisabled(!0),c.add(Ext.create("Generali.datiCatastali.view.CategoriaCatastale",{cbaConfig:a})))))},beforeitemcontextmenuTree:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a){var b=this.getTreeRep();b.getStore().load({callback:function(c,d,e){e?(c=b.getRootNode().findChild("nodeID",a,!0),b.expandAll(),c?(b.getSelectionModel().select(0),b.getSelectionModel().select(c)):b.getSelectionModel().select(0)):
msgShowError("",d.getError())}})},onLaunch:function(){this.getToolbarFinestra().setVisible(this.cbaConfig.caricamentoEsterno);this.getBtnNuovo().setVisible(!this.cbaConfig.caricamentoEsterno);this.aggiornaStore()},destroy:function(){}});
Ext.define("Generali.datiCatastali.controller.GruppoCatastale",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormGruppo",selector:this.selContainer+"#FormGruppo"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBContoGruppo",selector:this.selContainer+"#CBContoGruppo"},{ref:"DescrizioneGruppo",selector:this.selContainer+"#DescrizioneGruppo"}])},verificaCampiForm:function(){var a=
[];this.getFormGruppo().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormGruppo(),c=b.getForm().getFieldValues();this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getFormGruppo();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeGruppo;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.cbaConfig.controllerTree.disabilitaTree(!1);a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});null==a.cbaConfig.codiceCategoria&&(inserisciBottoni(b.boxBottoni,
c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.disabilitaTree(e)})},aggiornaStore:function(a){var b=this,c=b.storeGruppo,d=b.getFormGruppo(),e=d.getForm();b.cbaConfig.codiceCategoria&&"L"!=b.cbaConfig.permesso&&containerSolaLettura(d);b.cbaConfig.codiceGruppo||a?c.load({params:{id:b.cbaConfig.codiceGruppo?b.cbaConfig.codiceGruppo:a},callback:function(c,
d,k){k?(Ext.isEmpty(c)||e.loadRecord(c[0]),b.recordModificato&&(b.recordModificato=!1,Ext.isEmpty(c)?b.cbaConfig.controllerTree.aggiornaStore(a):b.cbaConfig.controllerTree.aggiornaStore(b.cbaConfig.nodeID))):msgShowError("",d.getError())}}):(b.cbaConfig.CntPrincipale.removeAll(),b.cbaConfig.controllerTree.aggiornaStore())},onLaunch:function(){this.storeGruppo=Ext.create("Generali.datiCatastali.store.GruppoCatastale");this.gestioneForm();this.cbaConfig.nuovoInserimento?this.getBoxBottoni().queryById("btnNuovo").handler():
this.aggiornaStore()},destroy:function(){eliminaStore(this.storeGruppo)}});
Ext.define("Generali.datiCatastali.controller.SelezionaGruppo",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridGruppi",selector:this.selContainer+"#GridGruppi"},{ref:"BtnConferma",selector:this.selContainer+"#BtnConferma"},{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"}]);this.control(this.selContainer+"#GridGruppi",{celldblclick:this.dblClickGrid});this.control(this.selContainer+"#BtnConferma",
{click:this.clickBtnConferma});this.control(this.selContainer+"#BtnEsci",{click:this.clickBtnEsci})},clickBtnConferma:function(a){var b=this.getGridGruppi().getSelectionModel().getSelection()[0];this.cbaConfig.callbackSeleziona&&this.cbaConfig.callbackSeleziona(b);this.clickBtnEsci(a)},clickBtnEsci:function(a){a.up("window").close()},dblClickGrid:function(a,b,c,d,e,g,h,k){this.cbaConfig.callbackSeleziona&&this.cbaConfig.callbackSeleziona(d);this.clickBtnEsci(this.getBtnConferma())},onLaunch:function(){},
destroy:function(){this.callParent()}});
Ext.define("Generali.datiCatastali.store.CategoriaCatastale",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idGruppo"},{name:"descrizione"},{name:"descrGruppo"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/catasto/categoria/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/catasto/categoria/get",create:"/cba/gen/ws/general/catasto/categoria/insert",update:"/cba/gen/ws/general/catasto/categoria/update",destroy:"/cba/gen/ws/general/catasto/categoria/delete"}},
autoDestroy:!0});Ext.define("Generali.datiCatastali.store.CategorieCbox",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/catasto/categoria/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.datiCatastali.store.DatiCatastali",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"expanded"},{name:"leaf"},{name:"children"},{name:"idGruppo"},{name:"idCategoria"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/catasto/categoria/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.datiCatastali.store.GruppiCbox",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/catasto/gruppo/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.datiCatastali.store.GruppoCatastale",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"descrizione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/catasto/gruppo/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/catasto/gruppo/get",create:"/cba/gen/ws/general/catasto/gruppo/insert",update:"/cba/gen/ws/general/catasto/gruppo/update",destroy:"/cba/gen/ws/general/catasto/gruppo/delete"}},autoDestroy:!0});
Ext.define("Generali.datiCatastali.view.CategoriaCatastale",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"fieldset",title:"GESTIONE_CATEGORIA",flex:1,bodyPadding:10,items:[{xtype:"form",itemId:"FormCategoria",reference:"FormCategoria",trackResetOnLoad:!0,bodyPadding:10,border:0,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,itemId:"CodiceGruppo",
reference:"CodiceGruppo",name:"idGruppo"},{xtype:"textfield",labelWidth:150,flex:1,name:"descrizione",itemId:"DescrCategoria",reference:"DescrCategoria",fieldLabel:"DESCRIZIONE_CATEGORIA",allowBlank:!1,maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.datiCatastali.view.DatiCatastali",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",flex:this.cbaConfig.caricamentoEsterno?1:.3,border:5,itemId:"TreeRep",reference:"TreeRep",store:Ext.create("Generali.datiCatastali.store.DatiCatastali"),useArrows:!0,rootVisible:!1,animate:!0,viewConfig:{getRowClass:function(a,b,c,d){a.get("checked")&&a.set("checked",null);0==b&&a.set("text",
traduci("GRUPPI"));return!0}},dockedItems:[{xtype:"toolbar",itemId:"ToolbarFinestra",reference:"ToolbarFinestra",dock:"top",hidden:!0,height:48,items:[{xtype:"button",itemId:"BtnSeleziona",reference:"BtnSeleziona",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"ANNULLA"}]},{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"NUOVO"},
{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:150,fieldLabel:"",emptyText:"CERCA"}]},{xtype:"label",border:0,dock:"top",hidden:!0,itemId:"LblSelettore",reference:"LblSelettore"}]},{xtype:"splitter",hidden:this.cbaConfig.caricamentoEsterno,nonDisabilitare:!0},{xtype:"panel",itemId:"CntPrincipale",reference:"CntPrincipale",hidden:this.cbaConfig.caricamentoEsterno,flex:1,padding:"15 0 0 10",border:0,autoScroll:!0,layout:{type:"vbox",align:"stretch"}}]});this.callParent(arguments)}});
Ext.define("Generali.datiCatastali.view.GruppoCatastale",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"fieldset",title:"GESTIONE_GRUPPO",flex:1,bodyPadding:10,items:[{xtype:"form",itemId:"FormGruppo",reference:"FormGruppo",trackResetOnLoad:!0,bodyPadding:10,border:0,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",labelWidth:150,flex:1,name:"descrizione",
itemId:"DescrizioneGruppo",reference:"DescrizioneGruppo",fieldLabel:"DESCRIZIONE_GRUPPO",allowBlank:!1,maxLength:200,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.datiCatastali.view.SelezionaGruppo",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",store:Ext.create("Generali.datiCatastali.store.GruppiCbox",{autoLoad:!0}),border:0,itemId:"GridGruppi",reference:"GridGruppi",flex:1,columns:[{xtype:"gridcolumn",text:"DESCRIZIONE_GRUPPO",dataIndex:"valore",flex:1,sortable:!1,align:"left"}],viewConfig:{loadMask:!1,stripeRows:!0},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"ANNULLA"}]}]}]});this.callParent(arguments)}});
Ext.define("gestDestinatarioFattura.view.destinatarioFattura",{extend:"Ext.panel.Panel",border:0,id:"destinatarioFattura",itemId:"destinatarioFattura",reference:"destinatarioFattura",layout:{type:"border"},bodyPadding:5,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",region:"west",itemId:"pnlPaganti",reference:"pnlPaganti",width:270,layout:{align:"stretch",type:"vbox"},bodyPadding:3,title:"",items:[{xtype:"textfield",itemId:"pagante",reference:"pagante",fieldLabel:"PAGANTE",labelAlign:"top",
labelClsExtra:"cbaLabel",listeners:{change:{fn:this.onTextfieldChange,scope:this}}},{xtype:"gridpanel",flex:1,itemId:"gridPaganti",reference:"gridPaganti",collapsed:!1,collapsible:!0,title:"ELENCO",columns:[{xtype:"gridcolumn",dataIndex:"valore",text:"RAGIONE_SOCIALE",flex:1}],viewConfig:{loadMask:!1},dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",itemId:"PTCliFo",reference:"PTCliFo",width:360,displayInfo:!0,listeners:{change:{fn:this.onPagingtoolbarChange,scope:this}}}],listeners:{select:{fn:this.onGridPagantiSelect,
scope:this}}}]},{xtype:"container",flex:1,region:"center",border:0,itemId:"ContDest",reference:"ContDest",layout:{type:"fit"}}],listeners:{beforerender:{fn:this.onDestinatarioFatturaBeforeRender,scope:this}}});this.callParent(arguments)},onTextfieldChange:function(a,b,c,d){var e=this.queryById("gridPaganti");c=e.getStore();c.getProxy().extraParams={valore:b?b:""};svuotaStore(c);c.loadPage(1,{callback:function(b,c,d){e.getSelectionModel().select(0);a.focus(!1,20)}})},onPagingtoolbarChange:function(a,
b,c){},onGridPagantiSelect:function(a,b,c,d){this.queryById("ContDest").down().controller.caricaDestinatario(b.get("codice"),b.get("valore"))},onDestinatarioFatturaBeforeRender:function(a,b){Localizer.localize(a);var c=Ext.create("Generali.clientiFornitori.store.ClientiFornitori");a.queryById("gridPaganti").bindStore(c);a.queryById("PTCliFo").bindStore(c);this.queryById("ContDest").add(Ext.create("Generali.clientiFornitori.view.DestinatarioFattura",{permesso:a.cbaConfig.permesso,callbackEsci:function(){a.cbaConfig.afterEsci()}}));
a.queryById("pagante").setValue(a.cbaConfig.pagante)},esci:function(){var a=function(){me.gestioneEsci()};puoiUscire("win_"+this.id,this.id+"Form",!1,a,a)}});Ext.Loader.setConfig({enabled:!0});Ext.application({views:["destinatarioFattura"],name:"gestDestinatarioFattura",appFolder:"generali/destinatarioFattura/app"});
Ext.define("Generali.docPerson.controller.DocPerson",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"ContainerDettagli",selector:this.selContainer+"#ContainerDettagli"},{ref:"GridDoc",selector:this.selContainer+"#GridDoc"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+
"#BtnElimina"},{ref:"HtmlDoc",selector:this.selContainer+"#HtmlDoc"},{ref:"BtnModifica",selector:this.selContainer+"#BtnModifica"},{ref:"BtnStampa",selector:this.selContainer+"#BtnStampa"}]);this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#BtnModifica",{click:this.clickBtnModifica});this.control(this.selContainer+"#GridDoc",{select:this.selectGridDoc,itemdblclick:this.itemdblclickGridDoc,
render:this.renderGridDoc})},renderGridDoc:function(a){creaToolTip(a.getId(),"MSG_DBLCLICK_PORTLET","",!1,150)},itemdblclickGridDoc:function(a){this.editDocumento(!1)},selectGridDoc:function(a,b){var c="";Ext.isEmpty(b.get("header"))||(c=b.get("header"));c+=b.get("documento");Ext.isEmpty(b.get("footer"))||(c+=b.get("footer"));this.getHtmlDoc().update(c)},clickBtnModifica:function(){this.editDocumento(!1)},editDocumento:function(a){var b;a?(b="TINY_NUOVO_DOC",a=null):(b=this.getGridDoc().getSelectionModel().getSelection()[0],
a=b.get("id"),b=b.get("sigla"));"L"!=this.cbaConfig.permesso&&Ext.create("winCBA",{name:"Generali.docPerson.view.EditDocPerson",titolo:b,dimensione:1,configItem:{idOrg:this.idOrganizzazione,idModulo:CBA.moduli.moduloAttivo,idDoc:a,afterEsci:Ext.bind(this.aggiornaStore,this)}}).show()},clickBtnNuovo:function(a){this.editDocumento(!0)},clickBtnElimina:function(a){var b=this;a=b.getGridDoc();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},
aggiornaStore:function(a){var b=this,c=b.getGridDoc(),d=c.getStore();d.load({params:{idOrg:this.idOrganizzazione,idModulo:CBA.moduli.moduloAttivo},callback:function(e,g,h){h?(g=null,a?g=trovaRecord(d,"id",a):b.getHtmlDoc().update(),b.getBtnElimina().setDisabled(Ext.isEmpty(e)||"L"==b.cbaConfig.permesso),b.getBtnModifica().setDisabled(Ext.isEmpty(e)||"L"==b.cbaConfig.permesso),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(g?[g]:0),b.getBtnStampa().setDisabled(Ext.isEmpty(e))):msgShowError("",
g.getError())}})},doPrint:function(a,b){if(this.printSimple)this.stampa(),this.callParent([a,b]);else{var c=this.getGridDoc().getSelectionModel().getSelection()[0].get("id");showWinStampa(CBA.moduli.moduloAttivo,CBA.parametriGenerali.codEnte,"DocumentiPersonalizzati",{configBtnStampa:this.parametriStampa,eseguiStampa:!0,idModello:c,dataDal:new Date,dataAl:new Date,demo:!0})}},onLaunch:function(){this.idOrganizzazione=this.cbaConfig.idOrganizzazione||CBA.parametriGenerali.idOrganizzazione;49===CBA.moduli.moduloAttivo&&
this.lookup("BtnElimina").setIconCls(getIconButtons().btnEliminaX);this.configurePrintButton(this.getBtnStampa(),"print");this.getGridDoc().controller=this;this.aggiornaStore()},destroy:function(){this.callParent()}});Ext.define("Generali.docPerson.controller.DocumentiPerson",{extend:"Generali.docPerson.controller.DocPerson"});
Ext.define("Generali.docPerson.controller.EditDocPerson",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"Sigla",selector:this.selContainer+"#Sigla"},{ref:"Descrizione",selector:this.selContainer+"#Descrizione"},{ref:"Documento",selector:this.selContainer+"#Documento"},
{ref:"MargineSup",selector:this.selContainer+"#MargineSup"},{ref:"MargineInf",selector:this.selContainer+"#MarginMargineInfeSup"},{ref:"MargineSx",selector:this.selContainer+"#MargineSx"},{ref:"MargineDx",selector:this.selContainer+"#MargineDx"},{ref:"RdgOrientamento",selector:this.selContainer+"#RdgOrientamento"},{ref:"CbTipo",selector:this.selContainer+"#CbTipo"},{ref:"BtnHeader",selector:this.selContainer+"#BtnHeader"},{ref:"BtnFooter",selector:this.selContainer+"#BtnFooter"},{ref:"CbxPortale",
selector:this.selContainer+"#CbxPortale"},{ref:"CbxAllegaTerapie",selector:this.selContainer+"#CbxAllegaTerapie"},{ref:"CbxSoloAttive",selector:this.selContainer+"#CbxSoloAttive"}]);this.control(this.selContainer+"#Descrizione",{keydown:this.keydownDescrizione})},keydownDescrizione:function(a,b){9==b.getKey()&&this.getDocumento().focus(!0,20)},verificaCampiForm:function(){var a=[],b=this.getForm();b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");Ext.isEmpty(b.getForm().findField("documento").getValue())&&
msgAddError(a,traduci("TINY_TEXT")+traduci("CAMPO_OBBLIGATORIO"));return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idOrganizzazione:this.cbaConfig.idOrg,idModulo:CBA.moduli.moduloAttivo});var d=c.documento.match(/\_(\w+?#+?.+?)\_/g);d&&(d=Ext.Array.unique(d).toString());c.tags=d;c.margini=(c.margineSup?c.margineSup:0)+","+(c.margineInf?c.margineInf:0)+","+(c.margineSx?c.margineSx:0)+","+(c.margineDx?c.margineDx:0);c.abilita_pubblicazione=
c.abilita_pubblicazione?"T":"F";c.allegaTerapie=getBoolValue(c.allegaTerapie);c.soloAttive=getBoolValue(c.soloAttive);delete c.margineSup;delete c.margineInf;delete c.margineSx;delete c.margineDx;controller_salvaRecord(b,c,a)},gestioneForm:function(){var a=this,b=a.getForm();b.controller=a;b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=Ext.create("Generali.docPerson.store.EditDocPerson");var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore(b.getForm().findField("id").getValue())},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()})},esci_callback:function(){a.cbaConfig.afterEsci(b.getForm().findField("id").getValue());b.up("window").close()},verificaCampiForm_callback:function(){return a.verificaCampiForm()},textButtonStampa:traduci("ANTEPRIMA"),
noText:49===CBA.moduli.moduloAttivo?!0:null,personIcons:49===CBA.moduli.moduloAttivo?getIconButtons():null}});inserisciBottoni(b.boxBottoni,c,49===CBA.moduli.moduloAttivo);b.boxBottoni.down("#btnElimina").hide();b.boxBottoni.down("#btnNuovo").hide();49!==CBA.moduli.moduloAttivo&&(c=b.boxBottoni.down("#BtnStampa"),c.show(),a.configurePrintButton(c,"print"));if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},aggiornaStore:function(a){var b=this,c=b.getForm().getForm(),
d=b.storeForm;!a||0>a?clearForm(b.getForm()):d.load({params:{id:a},callback:function(a,d,h){h?(clearForm(b.getForm()),Ext.isEmpty(a)||(a=a[0],c.loadRecord(a),a.get("margini")&&(d=a.get("margini").split(","),c.setValues({margineSup:"0"!=d[0]?d[0]:"",margineInf:"0"!=d[1]?d[1]:"",margineSx:"0"!=d[2]?d[2]:"",margineDx:"0"!=d[3]?d[3]:""})),b.cbaConfig.idDoc=a.get("id"))):msgShowError("",d.getError())}})},doPrint:function(a,b){var c=this.getForm().getForm().findField("id").getValue();showWinStampa(CBA.moduli.moduloAttivo,
CBA.parametriGenerali.codEnte,"DocumentiPersonalizzati",{configBtnStampa:this.parametriStampa,eseguiStampa:!0,idModello:c,dataDal:new Date,dataAl:new Date,demo:!0})},onLaunch:function(){var a=this,b=!0,c=trovaRecord(Sipcar.app.getController("Login").storeModuli,"codice",CBA.moduli.moduloAttivo);c&&c.data&&c.data.codice==CBA.moduli.moduloAttivo&&(b="Utenti"!=c.data.area);a.getCbxPortale().hidden=b;a.getCbTipo().getStore().load({params:{idModulo:CBA.moduli.moduloAttivo}});a.getDocumento().idOrganizzazione=
a.cbaConfig.idOrg;a.gestioneForm();a.cbaConfig.idDoc?(a.aggiornaStore(a.cbaConfig.idDoc),setTimeout(function(){a.getSigla().focus()},500)):(controller_nuovoRecord(a.getForm()),a.getRdgOrientamento().setValue({orientamento:"P"}))},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});Ext.define("Generali.docPerson.store.CbDocPerson",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/prszn/docPers/cbox"}});
Ext.define("Generali.docPerson.store.DocPerson",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"sigla"},{name:"descrizione"},{name:"documento"},{name:"abilita_pubblicazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/prszn/docPers/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/prszn/docPers/src",create:"/cba/gen/ws/general/prszn/docPersnew",update:"/cba/gen/ws/general/prszn/docPers/update",destroy:"/cba/gen/ws/general/prszn/docPers/delete"}},
autoDestroy:!0});
Ext.define("Generali.docPerson.store.EditDocPerson",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"sigla"},{name:"descrizione"},{name:"documento"},{name:"header"},{name:"footer"},{name:"tags"},{name:"orientamento"},{name:"margini"},{name:"tipo"},{name:"abilita_pubblicazione"},{name:"allegaTerapie"},{name:"soloAttive"}],proxy:{url:"/cba/gen/ws/general/prszn/docPers/get",api:{read:"/cba/gen/ws/general/prszn/docPers/get",create:"/cba/gen/ws/general/prszn/docPers/new",update:"/cba/gen/ws/general/prszn/docPers/update",
destroy:"/cba/gen/ws/general/prszn/docPers/delete"}}});
Ext.define("Generali.docPerson.view.DocPerson",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",padding:5,maxWidth:1200,itemId:"Container",reference:"Container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridDoc",reference:"GridDoc",title:"Modelli personalizzati",height:200,margin:"0 0 10 0",store:Ext.create("Generali.docPerson.store.DocPerson"),columns:[{xtype:"gridcolumn",
width:200,dataIndex:"sigla",text:"NOME_MODELLO",editor:{xtype:"textfield",maxLength:30,enforceMaxLength:!0,allowBlank:!1}},{xtype:"gridcolumn",flex:1,dataIndex:"descrizione",text:"DESCRIZIONE",editor:{xtype:"textfield",maxLength:50,enforceMaxLength:!0,allowBlank:!1}},{xtype:"gridcolumn",dataIndex:"tipo",text:"TIPO",width:400,hidden:49!==CBA.moduli.moduloAttivo,renderer:function(a,b,c){b="";Ext.isEmpty(a)||(c=Ext.create("CS.personalizzazioni.personDocumenti.personalizzazioni.store.TipoDocPers"),(a=
trovaRecord(c,"codice",a))&&(b=a.get("descrizione")));return b}}],viewConfig:{loadMask:!1},dockedItems:[{xtype:49===CBA.moduli.moduloAttivo?"CSSButtonsPanel":"toolbar",dock:"top",layout:{type:"hbox",align:"stretch",pack:49===CBA.moduli.moduloAttivo?"end":null},itemId:"boxBottoni",reference:"boxBottoni",margin:"5 2 5 2",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",
text:"Elimina"},{xtype:"button",itemId:"BtnModifica",reference:"BtnModifica",iconCls:"icon-edit16",text:"MODIFICA",textHint:traduci("MODIFICA")},{xtype:"newButtonStampa",text:"ANTEPRIMA",itemId:"BtnStampa",reference:"BtnStampa",scale:"small",showPreview:!1,hidden:49===CBA.moduli.moduloAttivo},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",text:"ESCI",hidden:49!==CBA.moduli.moduloAttivo||!this.cbaConfig.controllerTestata,handler:function(a){return a.up("window").close()}}]}]},{xtype:"panel",
itemId:"ContainerDettagli",reference:"ContainerDettagli",ui:"cbaPanelAzzurro",title:"ANTEPRIMA",flex:1,layout:{type:"vbox",align:"center"},items:[{xtype:"container",scrollable:!0,margin:"30 25 5 25",width:800,flex:1,itemId:"HtmlDoc",reference:"HtmlDoc"}]}]}]});this.callParent(arguments)}});Ext.define("Generali.docPerson.view.DocumentiPerson",{extend:"Generali.docPerson.view.DocPerson"});
Ext.define("Generali.docPerson.view.EditDocPerson",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",margin:"5 0 0 0",itemId:"BoxBottoni",reference:"BoxBottoni"},{xtype:"form",flex:1,padding:"10 0 0 0",border:0,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox",align:"stretch"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"container",layout:{type:"hbox"},
margin:"0 0 5 0",items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"sigla",fieldLabel:"NOME_MODELLO",itemId:"Sigla",reference:"Sigla",labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:30,enforceMaxLength:!0,width:350},{xtype:"combobox",itemId:"CbTipo",reference:"CbTipo",margin:"0 0 0 30",name:"tipo",labelClsExtra:"cbaLabel",fieldLabel:"TIPO",displayField:"valore",valueField:"codice",queryMode:"local",width:250,labelWidth:50,store:Ext.create("Generali.data.StoreCodiceValore",{proxy:{url:"/cba/gen/ws/general/prszn/docPers/tipo/cbox"}}),
allowBlank:!1},{xtype:"checkboxfield",itemId:"CbxPortale",reference:"CbxPortale",margin:"0 0 0 5",name:"abilita_pubblicazione",boxLabel:"ABILITA_PUBBLICAZIONE",inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",itemId:"CbxAllegaTerapie",reference:"CbxAllegaTerapie",margin:"0 0 0 5",name:"allegaTerapie",boxLabel:"ALLEGA_TERAPIE",inputValue:"T",uncheckedValue:"F",hidden:49!=CBA.moduli.moduloAttivo},{xtype:"checkboxfield",itemId:"CbxSoloAttive",reference:"CbxSoloAttive",margin:"0 0 0 5",name:"soloAttive",
boxLabel:"SOLO_TERAPIE_ATTIVE",inputValue:"T",uncheckedValue:"F",hidden:49!=CBA.moduli.moduloAttivo}]},{xtype:"textfield",name:"descrizione",fieldLabel:"DESCRIZIONE",itemId:"Descrizione",reference:"Descrizione",enableKeyEvents:!0,labelClsExtra:"cbaLabel",allowBlank:!1,maxLength:50,enforceMaxLength:!0},{xtype:"tabpanel",margin:"5 0 0 0",flex:1,items:[{xtype:"tinymce",cbaTag:!0,title:"Corpo",name:"documento",itemId:"Documento",reference:"Documento"},{xtype:"tinymce",title:"HEADER",name:"header",itemId:"Header",
reference:"Header"},{xtype:"tinymce",cbaNumerazionePagina:!0,title:"FOOTER",name:"footer",itemId:"Footer",reference:"Footer"}]},{xtype:"container",margin:"5 0 0 0",layout:{type:"hbox"},items:[{xtype:"fieldset",title:"MARGINI_PIXEL",layout:{type:"hbox"},margin:"0 10 0 0",defaults:{margin:"0 10 2 0"},items:[{xtype:"numberfield",itemId:"MargineSup",reference:"MargineSup",name:"margineSup",labelClsExtra:"cbaLabel",width:130,hideTrigger:!1,labelWidth:70,allowDecimals:!1,minValue:0,maxValue:999,fieldLabel:"MARGINE_SUPERIORE"},
{xtype:"numberfield",itemId:"MargineInf",reference:"MargineInf",name:"margineInf",labelClsExtra:"cbaLabel",width:130,hideTrigger:!1,labelWidth:70,allowDecimals:!1,minValue:0,maxValue:999,fieldLabel:"MARGINE_INFERIORE"},{xtype:"numberfield",itemId:"MargineSx",reference:"MargineSx",name:"margineSx",labelClsExtra:"cbaLabel",width:130,hideTrigger:!1,labelWidth:70,allowDecimals:!1,minValue:0,maxValue:999,fieldLabel:"MARGINE_SINISTRO"},{xtype:"numberfield",itemId:"MargineDx",reference:"MargineDx",name:"margineDx",
labelClsExtra:"cbaLabel",width:130,hideTrigger:!1,labelWidth:70,minValue:0,maxValue:999,allowDecimals:!1,fieldLabel:"MARGINE_DESTRO"}]},{xtype:"fieldset",title:"ORIENTAMENTO",layout:{type:"hbox"},items:[{xtype:"radiogroup",itemId:"RdgOrientamento",reference:"RdgOrientamento",width:200,defaults:{margin:"0 10 2 0"},items:[{boxLabel:"ORIZZONTALE",name:"orientamento",cls:"cbaLabel",inputValue:"L"},{boxLabel:"VERTICALE",name:"orientamento",cls:"cbaLabel",inputValue:"P"}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.esercizioCont.store.cboxEsercizioCont",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/esercizioCont/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},idProperty:"codice",autoDestroy:!0});
Ext.define("Generali.esercizioCont.store.esercizioCont",{extend:"Ext.data.Store",fields:[{name:"data"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/esercizioCont/defaultByOrg",reader:{type:"json",messageProperty:"message",rootProperty:""}},autoDestroy:!0});
Ext.define("Generali.etichette.controller.EtichetteGen",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"grigliaModelliEtichette",selector:this.selContainer+"#grigliaModelliEtichette"},{ref:"formEtichette",selector:this.selContainer+"#formEtichette"},{ref:"abilitaFormModifica",selector:this.selContainer+"#abilitaFormModifica"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"numEtichette",
selector:this.selContainer+"#numEtichette"},{ref:"altezzaEtichetta",selector:this.selContainer+"#altezzaEtichetta"},{ref:"margineSuperiore",selector:this.selContainer+"#margineSuperiore"},{ref:"margineLaterale",selector:this.selContainer+"#margineLaterale"},{ref:"margineEtichettaOrizzontale",selector:this.selContainer+"#margineEtichettaOrizzontale"},{ref:"margineEtichettaVerticale",selector:this.selContainer+"#margineEtichettaVerticale"},{ref:"dimensioneCarattere",selector:this.selContainer+"#dimensioneCarattere"},
{ref:"rbIntestazionePers",selector:this.selContainer+"#rbIntestazionePers"},{ref:"edtIntestazione",selector:this.selContainer+"#edtIntestazione"},{ref:"btnNuovo",selector:this.selContainer+"#btnNuovo"},{ref:"btnElimina",selector:this.selContainer+"#btnElimina"},{ref:"btnSalva",selector:this.selContainer+"#btnSalva"},{ref:"btnAnnulla",selector:this.selContainer+"#btnAnnulla"}]);this.control(this.selContainer+"#abilitaFormModifica",{change:this.changeAbilitaFormModifica});this.control(this.selContainer+
"#grigliaModelliEtichette",{select:this.selectGrid});this.control(this.selContainer+"#formEtichette",{dirtychange:this.onDirtyChangeForm});this.control(this.selContainer+"#rbIntestazionePers",{change:this.changeRbIntestazionePers});this.control(this.selContainer+"#btnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#btnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#btnSalva",{click:this.clickBtnSalva});this.control(this.selContainer+"#btnAnnulla",{click:this.clickBtnAnnulla})},
onDirtyChangeForm:function(){this.getBtnNuovo().setDisabled(!0);this.getBtnElimina().setDisabled(!0);this.getBtnSalva().setDisabled(!1);this.getBtnAnnulla().setDisabled(!1)},changeRbIntestazionePers:function(a,b,c,d){this.getEdtIntestazione().setDisabled(!b||"F"==b)},changeAbilitaFormModifica:function(a,b){this.getFormEtichette().setDisabled(!b)},impostaDati:function(a){var b=this.getFormEtichette().getForm();b.loadRecord(a);b.reset()},selectGrid:function(a,b,c,d){this.impostaDati(b);this.abilitaNuovoElimina(!0)},
clickBtnNuovo:function(){this.getFormEtichette().getForm();controller_nuovoRecord(this.getFormEtichette(),!1,!1);this.getBtnNuovo().setDisabled(!0);this.getBtnElimina().setDisabled(!0);this.getBtnSalva().setDisabled(!1);this.getBtnAnnulla().setDisabled(!1)},checkImpostazione:function(a,b){a.isValid()||msgAddError(b,a.fieldLabel+" "+a.getActiveError())},verificaImpostazioniEtichette:function(a){var b=[],c=!1;msgAddError(b,"MSG_ERRORI_TROVATI");this.checkImpostazione(this.getNumEtichette(),b);this.checkImpostazione(this.getAltezzaEtichetta(),
b);this.checkImpostazione(this.getMargineSuperiore(),b);this.checkImpostazione(this.getMargineLaterale(),b);this.checkImpostazione(this.getMargineEtichettaOrizzontale(),b);this.checkImpostazione(this.getMargineEtichettaVerticale(),b);this.checkImpostazione(this.getDimensioneCarattere(),b);1==b.length?c=!0:msgShow(a,b);return c},clickBtnSalva:function(){var a=this;a.getGrigliaModelliEtichette();var b="/cba/gen/ws/general/etichette/";if(!this.verificaImpostazioniEtichette())return!1;var c=a.getFormEtichette().getForm().getValues();
Ext.isEmpty(c.idOrganizzazione)&&(c.idOrganizzazione=a.idOrganizzazione);b=0>c.id||Ext.isEmpty(c.id)?b+"new":b+"update";Ext.Ajax.request({method:"POST",url:b,jsonData:Ext.JSON.encode(c),writer:{type:"json"},success:function(b){b=Ext.JSON.decode(b.responseText);if(b.success)a.aggiornaStoreGriglia(b.data.id),msgShow("",b.message);else return msgShowError("",b.message),!1}});return!0},clickBtnAnnulla:function(){var a=this.getGrigliaModelliEtichette();formEtichette=this.getFormEtichette().getForm();a=
a.getSelection();a.length&&formEtichette.setValues(a[0].getData());this.abilitaNuovoElimina(!0)},abilitaNuovoElimina:function(a){this.getGrigliaModelliEtichette();formEtichette=this.getFormEtichette().getForm();this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a);this.getBtnSalva().setDisabled(a);this.getBtnAnnulla().setDisabled(a);formEtichette.reset();formEtichette.wasDirty=!1},clickBtnElimina:function(){var a=this,b=a.getGrigliaModelliEtichette(),c=b.getSelection()[0];controller_eliminaRecord(b.getStore(),
{id:c?c.get("id"):""},function(){a.aggiornaStoreGriglia()})},aggiornaStoreGriglia:function(a){var b=this,c=b.getFormEtichette(),d=b.getGrigliaModelliEtichette(),e=d.getStore();e.load({params:{idOrganizzazione:b.idOrganizzazione},callback:function(g,h,k){k?(Ext.isEmpty(g)?Ext.isEmpty(c.items)||clearForm(c):(g=a?trovaRecord(e,"id",a):g[0],d.setSelection(g),b.impostaDati(g),b.abilitaNuovoElimina(!0)),Ext.isEmpty(c.items)||(c.getForm().reset(),c.getForm().wasDirty=!1)):msgShowError("",h.getError())}})},
onLaunch:function(){this.cbaConfig.personalizzazioni||(this.getFormEtichette().setDisabled(!0),this.cbaConfig.etichCtrl=this);this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();this.aggiornaStoreGriglia();this.getEdtIntestazione().setDisabled(!0)},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.etichette.store.EtichetteGen",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"descrizione"},{name:"idOrganizzazione"},{name:"numEtichette"},{name:"altezzaEtichetta"},{name:"larghezzaEtichetta"},{name:"margineSuperiore"},{name:"margineLaterale"},{name:"margineEtichettaOrizzontale"},{name:"margineEtichettaVerticale"},{name:"intestazione"},{name:"dimensioneCarattere"},{name:"stpIntestazione"},{name:"ripetiSuPagina"}],proxy:{url:"/cba/gen/ws/general/etichette/list",api:{destroy:"/cba/gen/ws/general/etichette/delete"}},
autoDestroy:!0});
Ext.define("Generali.etichette.view.EtichetteGen",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"grigliaModelliEtichette",reference:"grigliaModelliEtichette",flex:1,store:Ext.create("Generali.etichette.store.EtichetteGen"),title:this.cbaConfig.personalizzazioni?"LISTA_ETICHETTE":"",autoScroll:!0,columns:[{xtype:"gridcolumn",dataIndex:"descrizione",text:"NOME_MODELLO_ETICHETTA",flex:5,
editor:{xtype:"textfield",allowBlank:!1,maxLength:50,enforceMaxLength:!0}},{xtype:"gridcolumn",dataIndex:"id",text:"ID",flex:1,hidden:!0,editor:{xtype:"textfield",allowBlank:!1,maxLength:50,enforceMaxLength:!0}}]},{xtype:"container",flex:4,layout:{align:"stretch",type:"vbox"},items:[{xtype:"checkboxfield",margin:"0 10 0 30",itemId:"abilitaFormModifica",reference:"abilitaFormModifica",boxLabel:"ABILITA_MODIFICA_TEMPORANEA",cls:"cbaLabel",name:"modificaTemp",inputValue:"T",uncheckedValue:"F",hidden:this.cbaConfig.personalizzazioni},
{xtype:"form",itemId:"formEtichette",reference:"formEtichette",trackResetOnLoad:!0,title:this.cbaConfig.personalizzazioni?"IMPOSTAZIONI_ETICHETTE":"",flex:4,layout:{type:"vbox"},items:[{xtype:"textfield",itemId:"idImpEtichette",reference:"idImpEtichette",name:"id",dataIndex:"id",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",itemId:"nomeModelloEtichetta",reference:"nomeModelloEtichetta",width:530,fieldLabel:"NOME_MODELLO_ETICHETTA",labelClsExtra:"cbaLabel",labelWidth:200,
name:"descrizione",allowBlank:!1,maxLength:300,enforceMaxLength:!0,margin:"10 0 0 10",hidden:!this.cbaConfig.personalizzazioni},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"fieldset",margin:"10 8 0 8",layout:{type:"vbox"},title:"MARGINI_FOGLIO",items:[{xtype:"numberfield",allowDecimals:!1,fieldLabel:"SUPERIORE_MM",itemId:"margineSuperiore",reference:"margineSuperiore",name:"margineSuperiore",labelClsExtra:"cbaLabel",labelWidth:100,width:140,minValue:1,maxvalue:50},{xtype:"numberfield",allowDecimals:!1,
fieldLabel:"LATERALE_MM",itemId:"margineLaterale",reference:"margineLaterale",name:"margineLaterale",labelClsExtra:"cbaLabel",labelWidth:100,width:140,minValue:1,maxvalue:50}]},{xtype:"fieldset",margin:"10 0 0 0",layout:{type:"vbox"},title:"MARGINI_ETICHETTE",items:[{xtype:"numberfield",allowDecimals:!1,fieldLabel:"ORIZZONTALE_MM",itemId:"margineEtichettaOrizzontale",reference:"margineEtichettaOrizzontale",name:"margineEtichettaOrizzontale",labelClsExtra:"cbaLabel",labelWidth:110,width:150,minValue:1,
maxvalue:50},{xtype:"numberfield",fieldLabel:"VERTICALE_MM",itemId:"margineEtichettaVerticale",reference:"margineEtichettaVerticale",name:"margineEtichettaVerticale",labelClsExtra:"cbaLabel",labelWidth:110,width:150,minValue:1,maxvalue:50,allowDecimals:!1}]},{xtype:"fieldset",margin:"10 0 0 10",layout:{type:"vbox"},title:"DIMENSIONI_ETICHETTA",items:[{xtype:"numberfield",allowDecimals:!1,fieldLabel:"ETICHETTE_RIGA",itemId:"numEtichette",reference:"numEtichette",name:"numEtichette",labelClsExtra:"cbaLabel",
labelWidth:170,width:210,minValue:2,maxValue:6},{xtype:"numberfield",allowDecimals:!1,fieldLabel:"ALTEZZA_MM",itemId:"altezzaEtichetta",reference:"altezzaEtichetta",name:"altezzaEtichetta",labelClsExtra:"cbaLabel",labelWidth:170,width:210,minValue:5}]}]},{xtype:"container",layout:{type:"hbox"},margin:"10 0 0 0",width:525,items:[{xtype:"combobox",itemId:"dimensioneCarattere",reference:"dimensioneCarattere",name:"dimensioneCarattere",width:180,fieldLabel:"DIMENSIONE_CARATTERE",labelAlign:"left",labelWidth:130,
labelClsExtra:"cbaLabel",maxLength:20,margin:"0 0 0 15",displayField:"valore",valueField:"valore",editable:!1,allowblank:!1,store:Ext.create("Ext.data.Store",{fields:[{name:"valore"}],data:[{valore:6},{valore:7},{valore:8},{valore:9},{valore:10},{valore:11}],autoLoad:!0})},{xtype:"checkboxfield",margin:"0 10 0 30",boxLabel:"RIPETI_ETICHETTA_SU_UNA_PAGINA",cls:"cbaLabel",name:"ripetiSuPagina",inputValue:"T",uncheckedValue:"F"}]},{xtype:"fieldset",layout:{type:"hbox"},title:"INTESTAZIONE_ETICHETTA",
margin:"10 0 8 8",width:560,items:[{xtype:"checkboxfield",itemId:"rbIntestazionePers",reference:"rbIntestazionePers",margin:"5 10 5 30",boxLabel:"STAMPA_INTESTAZIONE",cls:"cbaLabel",name:"stpIntestazione",inputValue:"T",uncheckedValue:"F"},{xtype:"textfield",itemId:"edtIntestazione",reference:"edtIntestazione",name:"intestazione",margin:"5 10 5 30",fieldLabel:"INTESTAZIONE_ETICHETTA",labelAlign:"left",labelClsExtra:"cbaLabel",labelWidth:130,width:250,maxLength:20}]}],dockedItems:[{xtype:"toolbar",
dock:"top",border:0,itemId:"toolbar",reference:"toolbar",hidden:!this.cbaConfig.personalizzazioni,items:[{xtype:"button",itemId:"btnNuovo",reference:"btnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo",disabled:"S"!=this.cbaConfig.permesso},{xtype:"button",itemId:"btnElimina",reference:"btnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina",disabled:"S"!=this.cbaConfig.permesso},{xtype:"button",itemId:"btnSalva",reference:"btnSalva",disabled:!0,scale:"small",iconCls:"icon-ok",text:"Conferma"},
{xtype:"button",disabled:!0,itemId:"btnAnnulla",reference:"btnAnnulla",iconCls:"icon-annulla",text:"Ripristina"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.controller.Allegati",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridAllegati",selector:this.selContainer+"#GridAllegati"},{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"}]);this.control(this.selContainer+"#BtnEsci",{click:this.esciClick})},esciClick:function(){this.getBtnEsci().up("window").close()},onLaunch:function(){this.idOrganizzazione=getIdOrg();
this.localSessionId=this.cbaConfig.localSessionId;this.idFatturaEletronica=this.cbaConfig.idFatturaEletronica;this.getGridAllegati().getStore().load({params:{idFattura:this.idFatturaEletronica}})},destroy:function(){this.callParent()}});
Ext.define("Generali.fatturazioneElettronica.controller.AllegatiAttiva",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"EditDocumentiForm",selector:this.selContainer+"#EditDocumentiForm"},{ref:"StoricoGridAllegatiAttiva",selector:this.selContainer+"#StoricoGridAllegatiAttiva"},{ref:"boxBottoni",selector:this.selContainer+"#boxBottoni"},{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"btnAllegaFile",
selector:this.selContainer+"#btnAllegaFile"},{ref:"DownloadDate",selector:this.selContainer+"#DownloadDate"},{ref:"Descrizione",selector:this.selContainer+"#Descrizione"},{ref:"LinkFileAllegato",selector:this.selContainer+"#LinkFileAllegato"},{ref:"LabelFileAllegato",selector:this.selContainer+"#LabelFileAllegato"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"docFormAllegato",selector:this.selContainer+"#docFormAllegato"}]);this.control(this.selContainer+"#StoricoGridAllegatiAttiva",
{select:this.selectStoricoGrid});this.control(this.selContainer+"#LinkFileAllegato",{afterrender:this.onLinkFileAllegatoAfterRender});this.control(this.selContainer+"#BtnEsci",{click:this.esciClick});this.control(this.selContainer+"#btnAllegaFile",{change:this.btnAllegaFileChange});this.control(this.selContainer+"#BtnElimina",{click:this.eliminaClick})},selectStoricoGrid:function(a,b){this.impostaDati(b)},onLinkFileAllegatoAfterRender:function(a,b){var c=this;a.getEl().on("click",function(){if(c.isEdit()){var b=
c.getStoricoGridAllegatiAttiva().getStore().findRecord("id",c.getEditDocumentiForm().getForm().getFieldValues().id);c.getEditDocumentiForm().getForm().getFieldValues();var e=b.data.fileName;e||(e="");b=b.data.id;null==b&&(b=0);setWindow(1);stampaEsporta(a,{url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/getFileRefById",params:{id:b},titolo:e})}})},impostaDati:function(a){var b=this.getEditDocumentiForm(),c=a.get("fileName");this.getStoricoGridAllegatiAttiva().setDisabled(!1);clearForm(b);
a?b.loadRecord(a):controller_abilitaBottoni(this.getEditDocumentiForm());this.getBoxBottoni().queryById("btnEsci").setDisabled(!1);""!=c?this.getBtnAllegaFile().hide(!0):(this.getBtnAllegaFile().show(),this.getBtnAllegaFile().enable());this.getDescrizione().enable();this.getDownloadDate().enable();this.setAllegato(c)},setAllegato:function(a){for(var b=getEstensioni(),c=a.lastIndexOf("."),c=a.length-c-1,c=a.substr(a.length-c,c).toLowerCase(),d=0;d<b.length;d++)this.getLinkFileAllegato().removeCls("icon-"+
b[d]);c&&(0<=Ext.Array.indexOf(b,c)?this.getLinkFileAllegato().addCls("icon-"+c):this.getLinkFileAllegato().addCls("icon-unknown"));this.getLabelFileAllegato().setText(a);""!==a?(this.getLabelFileAllegato().show(),this.getLinkFileAllegato().show(),setToolTip(this.getLinkFileAllegato().id,this.getLinkFileAllegato().getEl(),a)):(this.getLabelFileAllegato().hide(),this.getLinkFileAllegato().hide())},nuovo:function(){var a=this.getEditDocumentiForm(),b=this.getStoricoGridAllegatiAttiva();controller_nuovoRecord(this.getEditDocumentiForm());
this.getDescrizione().enable();this.getDownloadDate().enable();this.getLabelFileAllegato().hide();this.getLinkFileAllegato().hide();this.getBtnAllegaFile().enable();this.getBtnAllegaFile().show();this.getDownloadDate().allowBlank=!1;validaForm(a);a.getForm().setValues({id_cofatture_te:this.idFattTe,downloadDate:new Date});b.getSelectionModel().deselectAll()},verificaCampiForm:function(){var a=[];this.getEditDocumentiForm().getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");this.isEdit()||
null!=this.getBtnAllegaFile().fileInputEl.dom.files[0]||msgAddError(a,"MSG_NESSUN_ALLEGATO");return msgShow("",a)},isEdit:function(){return 0<+this.getEditDocumentiForm().getForm().findField("id").getValue()},salva:function(a){var b,c=this.getEditDocumentiForm();if(!this.verificaCampiForm())return!1;b=c.getForm().getValues();b.downloadDate=ConvertiDataInMMGGAAAA(b.downloadDate);var d=new FormData,e=JSON.stringify(b),g=this.getBtnAllegaFile().fileInputEl.dom.files[0],e=new Blob([e],{type:"application/json"});
d.append("allegato",e);d.append("fileData",g);c.getForm().setValues({id_cofatture_te:this.idFattTe});b={id:b.id,formData:d};c.store=this.getStoricoGridAllegatiAttiva().getStore();this.controller_salvaRecordAllegato(c,b,a,"")&&this.getBtnAllegaFile().enable(!0)},controller_salvaRecordAllegato:function(a,b,c,d,e,g,h,k){Ext.isEmpty(h)&&(h="id");var l=!1,m=b[h],n="",p=a.store,q=a.boxBottoni,t={};Ext.isEmpty(e)&&(e=!0);var v=trovaRecord(p,h,m,null,!0),u=!v||v&&v.phantom,p=u?p.getProxy().api.create:p.getProxy().api.update;
if(null==p)return msgShowError("ATTENZIONE","Errore salvataggio dati: URL non presente"),!1;d&&(n=d);k&&(""==n?n={forceStore:!0}:Ext.apply(n,{forceStore:!0}));Ext.Ajax.request({url:p,method:"POST",rawData:b.formData,params:n,async:!1,headers:{"Content-Type":null},success:function(k){k=Ext.JSON.decode(k.responseText);var n=[],p="";if(k.success)t=k.data,c?(g&&g(k),a.up("window").close()):(u&&k.data&&(m=k.data[h]),a.controller?a.controller.aggiornaStore(m,k):a.aggiornaStore(m)),e&&(k.message&&"$"==k.message[0]?
(k.message=k.message.substring(1),msgAddWarning(n,k.message)):(p="MSG_SALVATAGGIO_DATI",msgAdd(n,k.message)));else{if(k.message&&("?"==k.message[0]||k.message[0].testo&&"?"==k.message[0].testo[0])){Messaggio("ATTENZIONE",k.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){controller_salvaRecord(a,b,c,d,e,g,h,!0)});return}k.message&&"$"==k.message[0]?k.message=k.message.substring(1):msgAddError(n,k.message);g&&g(k)}msgShow(p,n);l=k.success},failure:function(a){}});!l&&q&&controller_abilitaBottoni(a);
return l?t:!1},btnAllegaFileChange:function(a,b,c){c=b.lastIndexOf("\\")||b.lastIndexOf("/");b.substring(c+1);a=a.fileInputEl.dom.files;this.setAllegato(a.length?a[0].name:"")},esciClick:function(){this.getBtnEsci().up("window").close()},aggiornaStore:function(){var a=this,b=a.getEditDocumentiForm();clearForm(b);a.getStoricoGridAllegatiAttiva().getStore().load({params:{idFattTe:a.idFattTe},callback:function(b,d,e){e&&(e=b.length-1,Ext.isEmpty(b)?(clearForm(a.getEditDocumentiForm()),a.getLabelFileAllegato().hide(),
a.getLinkFileAllegato().hide()):(d=a.getStoricoGridAllegatiAttiva(),selRecs=d.getSelectionModel().getSelection(),b=0==selRecs.length?b[e]:selRecs[0],d.getSelectionModel().select([b]),a.impostaDati(b)))}})},onLaunch:function(){var a=this,b=a.getEditDocumentiForm();a.idOrganizzazione=getIdOrg();a.idFattTe=a.cbaConfig.idFattTe;b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getStoricoGridAllegatiAttiva().getStore();b.controller=a;ImpostaUrl([a.getStoricoGridAllegatiAttiva().getStore()]);
var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salva(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){a.nuovo()},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||(controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore()}),a.getLabelFileAllegato().hide(),a.getLinkFileAllegato().hide())},esci_callback:function(){var b=a.getEditDocumentiForm().up("window");
controller_puoiUscire(b,a.getEditDocumentiForm(),function(){a.salva(!0)},function(){a.aggiornaStore();b.close()},function(){var a=b.down("grid").getStore(),c;c=!1;a.each(function(a){""==a.get("fileName")&&(c=!0)});c?Messaggio("GESTIONE_ALLEGATI","MSG_WARNING_MANCA_ALLEGATO","YESNO","QUESTION",null,function(){b.close()}):b.close()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(a.getBoxBottoni(),c);a.getBtnAllegaFile().disable();a.aggiornaStore();0==a.getStoricoGridAllegatiAttiva().getStore().count()&&
(a.getDescrizione().disable(),a.getDownloadDate().disable());if("L"==a.cbaConfig.permesso)containerSolaLettura(a.getEditDocumentiForm()),controller_bottoniSolaLettura(a.getBoxBottoni());else a.getEditDocumentiForm().on("dirtychange",function(b,c){controller_abilitaBottoni(a.getEditDocumentiForm())})},destroy:function(){this.callParent()}});
Ext.define("Generali.fatturazioneElettronica.controller.DescrizioneRifiuto",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"BtnElabora",selector:this.selContainer+"#BtnElabora"},{ref:"TxtTesto",selector:this.selContainer+"#TxtTesto"}]);this.control(this.selContainer+"#BtnElabora",{click:this.elaboraClick});this.control(this.selContainer+"#BtnEsci",
{click:this.esciClick})},elaboraClick:function(){var a=this.getBtnEsci(),b=this.getTxtTesto().getValue();""!=b&&b?(this.cbaConfig.callbackScrivi&&this.cbaConfig.callbackScrivi(b),a.up("window").close()):Messaggio("FATTURA_ELETTRONICA","MSG_NOTE_RIFIUTO_OBBLIGATORIE","OK","INFORMATION")},esciClick:function(){var a=this.getBtnEsci();this.cbaConfig.callbackAnnulla&&this.cbaConfig.callbackAnnulla();a.up("window").close()},onLaunch:function(){this.cbaConfig.readOnly&&(this.getBtnElabora().hide(),this.getTxtTesto().editable=
!1);this.getTxtTesto().setValue(this.cbaConfig.testo);this.idOrganizzazione=getIdOrg()},destroy:function(){this.callParent()}});
Ext.define("Generali.fatturazioneElettronica.controller.FEProtocollazioneMassiva",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TabPrincipale",selector:this.selContainer+"#TabPrincipale"},{ref:"PageParametri",selector:this.selContainer+"#PageParametri"},{ref:"PageSelezione",selector:this.selContainer+"#PageSelezione"},{ref:"CBFornitore",selector:this.selContainer+"#CBFornitore"},{ref:"RBCercaPer",
selector:this.selContainer+"#RBCercaPer"},{ref:"EdtDtDal",selector:this.selContainer+"#EdtDtDal"},{ref:"EdtDtAl",selector:this.selContainer+"#EdtDtAl"},{ref:"RBCercaPer",selector:this.selContainer+"#RBCercaPer"},{ref:"GridDettaglio",selector:this.selContainer+"#GridDettaglio"},{ref:"BtnProtocolla",selector:this.selContainer+"#BtnProtocolla"},{ref:"EdtDtProt",selector:this.selContainer+"#EdtDtProt"}]);this.control(this.selContainer+"#TabPrincipale",{beforetabchange:this.beforetabchangePaginatore,tabchange:this.tabchangeTabPaginatore});
this.control(this.selContainer+"#GridDettaglio",{selectionchange:this.cambioSelezione});this.control(this.selContainer+"#BtnProtocolla",{click:this.clickBtnProtocolla})},clickBtnProtocolla:function(a){var b=this;a=this.getListIdFatture();this.elabora(a.toString()).then(function(a){b.effettuaRicerca()})["catch"](function(a){return msgShowError("",a)})},elabora:function(a){var b=this;return new Promise(function(c,d){Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/fatturaElettronica/fatture/protocolListPassiveInvoice",
params:{elencoIdFatture:a,dataProtocollo:b.getEdtDtProt().getValue()},timeout:36E5,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c(a.data):d(a.message)}})})},getListIdFatture:function(){var a=[],b=this.getGridDettaglio().getSelectionModel().getSelection();if(!Ext.isEmpty(b))for(var b=$jscomp.makeIterator(b),c=b.next();!c.done;c=b.next())a.push(c.value.get("id"));return a},cambioSelezione:function(a,b,c){this.getBtnProtocolla().setDisabled(Ext.isEmpty(b))},effettuaRicerca:function(){var a=
this,b={},c=a.getGridDettaglio().getStore();Ext.apply(b,{tipoData:a.getRBCercaPer().getValue().tipo,dataProtocollo:a.getEdtDtProt().getValue()});if(a.getCBFornitore().getValue()){var d=a.getCBFornitore().getSelection(),e=d.get("extra").split(",")[0],d=d.get("extra").split(",")[1];Ext.apply(b,{partitaIva:"?"!=e?e:null,codFiscale:"?"!=d?d:null})}a.getEdtDtDal().getValue()&&Ext.apply(b,{dataDal:a.getEdtDtDal().getValue()});a.getEdtDtAl().getValue()&&Ext.apply(b,{dataAl:a.getEdtDtAl().getValue()});c.load({params:b,
callback:function(b,c,d){d?Ext.isEmpty(b)&&Messaggio("RICERCA","RISULTATO_VUOTO","OK","INFORMATION",function(){a.getTabPrincipale().setActiveTab(a.getPageParametri());a.gestioneNavigazione(a.getPageParametri())}):msgShowError("",c.getError(),function(){a.getTabPrincipale().setActiveTab(a.getPageParametri())})}})},verificaParamsRicerca:function(){var a=[];this.getEdtDtProt().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},gestioneNavigazione:function(a){var b=this.getTabPrincipale(),
c=[];b.items.each(function(a){c.push(a)});a=c.indexOf(a);-1==a&&(a=0);b.down("#BtnIndietro").setDisabled(0==a);b.down("#BtnAvanti").setDisabled(a==c.length-1);b.down("#BtnProtocolla").setVisible(a==c.length-1)},beforetabchangePaginatore:function(a,b,c,d){var e=this;a=!0;"PageSelezione"==b.getItemId()&&(a=this.verificaParamsRicerca());if(!a)this.on("afterNaviga",function(){e.gestioneNavigazione(c)},this,{single:!0});return a},tabchangeTabPaginatore:function(a,b,c,d){"PageSelezione"==b.getItemId()?
this.effettuaRicerca():"PageParametri"==b.getItemId()&&svuotaStore(this.getGridDettaglio().getStore())},loadData:function(){var a=this,b=a.getCBFornitore().getStore();a.idOrganizzazione=getIdOrg();b.load({params:{idOrganizzazione:a.idOrganizzazione},callback:function(b,d,e){e?(b=a.getEdtDtDal(),d=a.getEdtDtAl(),e=new Date,b.setValue(giornoInizioMese(e)),d.setValue(giornoFineMese(e))):msgShowError("",d.getError())}})},destroy:function(){this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronica",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.fnAggiorna=this.EffettuaRicerca;this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);
this.addRef([{ref:"CbxUfficio",selector:this.selContainer+"#CbxUfficio"},{ref:"CbxFornitore",selector:this.selContainer+"#CbxFornitore"},{ref:"GridRicerca",selector:this.selContainer+"#GridRicerca"},{ref:"RBCercaPer",selector:this.selContainer+"#RBCercaPer"},{ref:"RBVisitato",selector:this.selContainer+"#RBVisitato"},{ref:"EdtDtDal",selector:this.selContainer+"#EdtDtDal"},{ref:"EdtDtAl",selector:this.selContainer+"#EdtDtAl"},{ref:"BtnScaricaNonRegistrate",selector:this.selContainer+"#BtnScaricaNonRegistrate"},
{ref:"BtnImportaFatture",selector:this.selContainer+"#BtnImportaFatture"},{ref:"CbRifiuta",selector:this.selContainer+"#CbRifiuta"},{ref:"CbAccetta",selector:this.selContainer+"#CbAccetta"},{ref:"PnlRegistraFattEle",selector:this.selContainer+"#PnlRegistraFattEle"},{ref:"Paginatore",selector:this.selContainer+"#Paginatore"},{ref:"BtnAvanti",selector:this.selContainer+"#BtnAvanti"},{ref:"BtnIndietro",selector:this.selContainer+"#BtnIndietro"},{ref:"ParametriRicerca",selector:this.selContainer+"#ParametriRicerca"},
{ref:"PnlRisultato",selector:this.selContainer+"#PnlRisultato"},{ref:"BtnElabora",selector:this.selContainer+"#BtnElabora"},{ref:"PnlAnteprimaFattura",selector:this.selContainer+"#PnlAnteprimaFattura"},{ref:"RBStato",selector:this.selContainer+"#RBStato"},{ref:"ChkSoloAutofatture",selector:this.selContainer+"#ChkSoloAutofatture"},{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"ColAllegati",selector:this.selContainer+"#ColAllegati"},{ref:"RgbVersioneAnteprima",selector:this.selContainer+
"#RgbVersioneAnteprima"},{ref:"FldOperatore",selector:this.selContainer+"#FldOperatore"},{ref:"ColCodUfficio",selector:this.selContainer+"#ColCodUfficio"},{ref:"CbxControlloOrdini",selector:this.selContainer+"#CbxControlloOrdini"},{ref:"ChkScadPag",selector:this.selContainer+"#ChkScadPag"},{ref:"BtnStampaMultipla",selector:this.selContainer+"#BtnStampaMultipla"},{ref:"ChbxSelTutti",selector:this.selContainer+"#ChbxSelTutti"},{ref:"FsNoCig",selector:this.selContainer+"#FsNoCig"}]);this.control(this.selContainer+
"#BtnEsci",{click:this.esciClick});this.control(this.selContainer+"#Paginatore",{beforetabchange:this.beforetabchangePaginatore,render:this.rendertabPaginatore});this.control(this.selContainer+"#BtnAvanti",{click:this.avanti});this.control(this.selContainer+"#BtnIndietro",{click:this.indietro});this.control(this.selContainer+"#BtnElabora",{click:this.Elabora});this.control(this.selContainer+"#Paginatore",{tabchange:this.tabchangePaginatore});this.control(this.selContainer+"#GridRicerca",{beforeedit:this.beforeeditGridRicerca,
edit:this.editGridRicerca,canceledit:this.canceleditGridRicerca,validateedit:this.validateeditGridRicerca,select:this.selectGridRicerca});this.control(this.selContainer+"#BtnScaricaNonRegistrate",{click:this.ScaricaNonRegistrate});this.control(this.selContainer+"#BtnImportaFatture",{change:this.importaFatture});this.control(this.selContainer+"#CbRifiuta",{change:this.changeCbRifiuta});this.control(this.selContainer+"#RgbVersioneAnteprima",{change:this.selectGridRicerca});this.control(this.selContainer+
"#CbAccetta",{change:this.changeCbAccetta});this.control(this.selContainer+"#BtnStampaMultipla",{click:this.stampaMassiva})},stampaMassiva:function(){var a=[],b=this.getChbxSelTutti().selectedAll,c=this.getRgbVersioneAnteprima().getValue().radPreviewType;b||this.getGridRicerca().getStore().each(function(b){b.get("active")&&a.push(b.get("id"))});!Ext.isEmpty(a)||b?(c={versioneAnteprima:c},b&&Ext.apply(c,this.getParametriListPassive()),Ext.isEmpty(a)||Ext.apply(c,{elencoIdFattura:a.toString()}),StdSipcar.promisePostRequest("/cba/gen/ws/general/fatturaElettronica/fatture/preview/multipla",
c).then(function(a){return window.open(a.filePath,"_blank")})["catch"](function(a){return msgShowError("",a)})):msgShowError("",traduci("NESSUNA_SELEZIONE"))},esciClick:function(){var a=this.cbaConfig,b=this.getBtnEsci();if(1==this.cbaConfig.economato){var c=this.getGridRicerca().getSelectionModel().getSelection()[0];c&&a.callbackRitorno&&a.callbackRitorno(c)}else a.controllerFatturaHead.getForm().controller.aggiornaStore(),a.callbackRiapriStore&&a.callbackRiapriStore(),this.sbloccaFattura();b.up("window").close()},
segnaDaLeggere:function(){var a=this.getGridRicerca().getSelectionModel().getSelection()[0];a.data.letto="F";0>this.fattureNonLette.indexOf(a.data.id)&&this.fattureNonLette.push(a.data.id);0<=this.fattureLette.indexOf(a.data.id)&&this.fattureLette.splice(this.fattureLette.indexOf(a.data.id),1);this.getGridRicerca().getView().refreshNode(a)},segnaLetto:function(a,b){a.letto="T";0>this.fattureLette.indexOf(b)&&this.fattureLette.push(b);0<=this.fattureNonLette.indexOf(b)&&this.fattureNonLette.splice(this.fattureNonLette.indexOf(b),
1)},disabilitaClickTab:function(){var a=this.getPaginatore();a.items.each(function(b){if(!Ext.isDefined(b.tab.giaCreato))b.tab.on("click",function(){b.tab.giaCreato=!0;a.cambiaTab=!1})})},rendertabPaginatore:function(){this.disabilitaClickTab()},beforetabchangePaginatore:function(a,b,c,d){return a.cambiaTab},avanti:function(){this.naviga("next");this.SalvaLette()},indietro:function(){this.naviga("prev");this.SalvaLette()},naviga:function(a){var b=this,c=this.getPaginatore(),d=c.getLayout(),e=c.getActiveTab();
b.getPaginatore().cambiaTab=!0;if(a){if("F"==b.getRBStato().getValue().stato&&"next"==a&&e==b.getPnlRisultato()){Messaggio("ATTENZIONE","MSG_WARNING_REGISTRAZIONE_FATT_RIFIUTATA","YESNO","QUESTION",!1,function(){d[a]();b.predisponiDirection(a,e)});return}d[a]();b.predisponiDirection(a,e)}else b.abilitaPulsanti(!0);return!0},predisponiDirection:function(a,b){var c=0;"next"==a?(b==this.getParametriRicerca()&&(c=1),b==this.getPnlRisultato()&&(c=2),b==this.getPnlRegistraFattEle()&&(c=3)):"prev"==a&&(b==
this.getParametriRicerca()&&(c=10),b==this.getPnlRisultato()&&(c=20),b==this.getPnlRegistraFattEle()&&(c=30));1==c&&this.EffettuaRicerca();if(2==c){if(1==this.cbaConfig.economato)return 1!=this.getGridRicerca().getSelectionModel().getSelection().length?(Messaggio("FATTURA_ELETTRONICA","SELEZIONARE_UN_RECORD","OK","INFORMATION"),this.indietro()):this.esciClick(),!1;this.procediRegistraFattura()}30==c&&this.sbloccaFattura();this.abilitaPulsanti(!0)},abilitaPulsanti:function(a){var b=this.getPaginatore(),
c=b.getLayout(),d=this.cbaConfig,d=d&&"L"==d.permesso,e=this.getRBStato().getValue().stato;this.getBtnElabora().setDisabled("PnlRegistraFattEle"!=b.getActiveTab().itemId||d);"D"!=e?(this.getBtnScaricaNonRegistrate().setDisabled(!0),this.getBtnImportaFatture().setDisabled(!0)):(this.getBtnScaricaNonRegistrate().setDisabled("PnlRisultato"!=b.getActiveTab().itemId),this.getBtnImportaFatture().setDisabled("PnlRisultato"!=b.getActiveTab().itemId||d));a?(this.getBtnIndietro().setDisabled(!c.getPrev()),
this.getBtnAvanti().setDisabled(!c.getNext()),d&&this.getBtnAvanti().setDisabled("PnlRegistraFattEle"==c.getNext().itemId)):(this.getBtnIndietro().setDisabled(!0),this.getBtnAvanti().setDisabled(!0))},tabchangePaginatore:function(a,b,c,d){},beforeeditGridRicerca:function(a,b,c){c="ColAllegati"==b.column.getItemId();if(!0===a.editing||c||0==b.colIdx)return!1;c=b.record.getData();a=a.getEditor().getForm();isDecorrenzaTermini=!1;this.segnaLetto(c,c.id);a.findField("nonUtilizzareCigCup").setDisabled(c?
"T"!=c.nuovoCigCup:!1);var d=1==c.accettata||"T"==c.accettata||1==c.rifiutata||"T"==c.rifiutata;a.getFields().each(function(a){"scadenzaDaCondPagamento"!=a.getName()&&a.setReadOnly(d)});if(this.recordOrig=b.record.copy())this.recordOrig=this.recordOrig.getData();this.getCbAccetta().setDisabled(!this.persFe.codIpa);this.getCbRifiuta().setDisabled(!this.persFe.codIpa);this.getCbAccetta().isDisabled()||(Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/isDecorrenzaTermini",
async:!1,params:{dataArrivo:c.dataArrivo,dataCtrl:new Date},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?isDecorrenzaTermini=a.data:msgShowError("",a.message[0].testo)}}),this.getCbAccetta().setDisabled(1==isDecorrenzaTermini),this.getCbRifiuta().setDisabled(1==isDecorrenzaTermini))},canceleditGridRicerca:function(a,b,c){b.record.reject();this.getGridRicerca().getView().refresh()},accettaDocumento:function(a,b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/accettaDocumento",
async:!1,params:{sessionId:this.kTreeLocalSessionId,id:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b&&b():(c&&c(),msgShowError("",a.message[0].testo))}})},rifiutaDocumento:function(a,b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/rifiutaDocumento",async:!1,params:{sessionId:this.kTreeLocalSessionId,id:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b&&b():(c&&c(),msgShowError("",a.message[0].testo))}})},vistaDocumento:function(a,
b,c){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/setViewedStatus",async:!1,params:{status:"T",idFattura:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b&&b():(c&&c(),msgShowError("",a.message[0].testo))}})},editGridRicerca:function(a,b,c){var d=b.record.getData();c=a.getEditor().getForm();var e=!0;this.getGridRicerca().getStore();c.controller=this;c.store=b.view.getStore();Ext.apply(d,{nonUtilizzareCigCup:getBoolValue(d.nonUtilizzareCigCup),
accettata:getBoolValue(d.accettata),rifiutata:getBoolValue(d.rifiutata),visto:getBoolValue(d.visto),scadenzaDaCondPagamento:getBoolValue(d.scadenzaDaCondPagamento),letto:"T"});var g=d.id;delete d.clcDataRegistrazione;delete d.descTipoDocumento;delete d.esisteAllegati;delete d.active;controller_salvaRecord(c,d,!1,{forzaRegistrazione:!1})?("T"==d.accettata&&this.accettaDocumento(g,function(){Ext.apply(d,{accettata:"T",dataAccettazione:new Date,idUtenteAccRif:CBA.parametriGenerali.codUtente});e=!0},
function(){e=!1;Ext.apply(d,{accettata:"F"});delete d.dataAccettazione;delete d.idUtenteAccRif}),"T"==d.rifiutata?(d.rifiutata="F",this.rifiutaDocumento(g,function(){Ext.apply(d,{rifiutata:"T",dataRifiuto:new Date,idUtenteAccRif:CBA.parametriGenerali.codUtente});e=!0},function(){e=!1;Ext.apply(d,{rifiutata:"F"});delete d.dataRifiuto;delete d.idUtenteAccRif})):(delete d.motivoRifiutoEsteso,delete d.motivoRifiutoBreve),"T"==d.visto?(d.visto="F",this.vistaDocumento(g,function(){Ext.apply(d,{visto:"T",
dataVisto:new Date,vistoDa:CBA.parametriGenerali.nomeUtente});e=!0},function(){e=!1;Ext.apply(d,{visto:"F"});delete d.dataVisto;delete d.vistoDa})):(delete d.dataVisto,delete d.vistoDa),e?controller_salvaRecord(c,d,!1,{forzaRegistrazione:!1}):(delete this.recordOrig.clcDataRegistrazione,delete this.recordOrig.descTipoDocumento,delete this.recordOrig.esisteAllegati,delete d.active,controller_salvaRecord(c,this.recordOrig,!1,{forzaRegistrazione:!1})),this.EffettuaRicerca(d.id),this.getGridRicerca().getView().refresh()):
a.startEdit(b.record,0);this.getGridRicerca().getView().refresh()},segnaAccettataLocale:function(a){Ext.apply(a,{accettata:"T",rifiutata:"F",visto:getBoolValue(a.visto),letto:"T"});delete a.descTipoDocumento;Ext.Ajax.request({method:"POST",jsonData:a,url:"/cba/gen/ws/general/fatturaElettronica/fatture/update"})},Elabora:function(){var a=this.getPnlRegistraFattEle().down("#Form").controller;a.verificaCampi()&&(inizioAttesa(),a.UltimaImportazioneFattura(),fineAttesa())},aggiornaStore:function(a){},
validateeditGridRicerca:function(a,b,c){a=b.newValues;return a.accettata&&a.rifiutata?(Messaggio("ATTENZIONE","MSG_PUOI_SELEZIONARE_ACCETTATA_OPPURE_RIFIUTATA","OK","WARNING"),!1):msgShow("",[])},applicaDescrizioneRifiuto:function(a,b){var c=this;c.getGridRicerca();c.segnaLetto(a,a.data.id);Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.DescrizioneRifiuto",titolo:traduci("FATTURA_ELETTRONICA")+" - "+traduci("RIFIUTO"),dimensione:3,altezzaWin:300,larghezzaWin:500,configItem:{testo:a.get("motivoRifiutoEsteso"),
readOnly:b,callbackAnnulla:function(){b||(a.set("rifiutata",!1),c.getCbRifiuta().setValue(!1))},callbackScrivi:function(c){b||a.set("motivoRifiutoEsteso",c)}}}).show()},changeCbRifiuta:function(a,b,c,d){a=this.getGridRicerca();b&&this.applicaDescrizioneRifiuto(a.getSelectionModel().getSelection()[0])},changeCbAccetta:function(a,b,c,d){this.getGridRicerca();b&&msgShowWarning(this.titolo,"MSG_AVVISO_ACCETTAZIONE_FATTURE")},selectGridRicerca:function(a,b){var c=this,d=c.getGridRicerca(),e=d.menuShortcut.items.items,
g=c.getRBStato().getValue().stato,h,k=c.getFldOperatore(),l=c.getRgbVersioneAnteprima().getValue().radPreviewType;if(d.getSelection()){if(b=d.getSelection()[0]){h=b.getId();var m=StdSipcar.coalesce(b.get("descrUtente"),b.get("descrUtenteSelected"));k.setHidden(!m);k.setValue(m);if(c.cbaConfig&&"L"!=c.cbaConfig.permesso){e[1].setHidden(!Ext.isEmpty(b.get("dataRegistrazione")));e[2].setHidden(Ext.isEmpty(b.get("dataRegistrazione")));if(k=e.find(function(a){return"sbloccaFattura"==a.itemId}))k.setDisabled(!StdSipcar.isValidID(b.get("idUtenteSelected"))),
k.setHidden(!Ext.isEmpty(b.get("dataRegistrazione")));if(k=e.find(function(a){return"registraGriglia"==a.itemId}))k.setDisabled("D"!==g),k.setHidden("D"!==g);if(g=e.find(function(a){return"reinviaNotifica"==a.itemId}))k=e.indexOf(g),e.splice(k,1),g.destroy();var n="T"==b.get("rifiutata")||1==b.get("rifiutata"),e="T"==b.get("accettata")||1==b.get("accettata");!n&&!e||n&&e||d.menuShortcut.add(new Ext.menu.Item({itemId:"reinviaNotifica",text:"Reinvia notifica "+(n?"di rifiuto":"di accettazione"),handler:function(){c[n?
"rifiutaDocumento":"accettaDocumento"](h)}}))}Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/preview",params:{idFattura:c.getGridRicerca().getSelectionModel().getSelection()[0].data.id,versioneAnteprima:l},success:function(a){a=Ext.JSON.decode(a.responseText);if(a.success){var b="";a.data&&(b="<a href='"+a.data.filePath+"' target='_blank'>"+traduci("STAMPA_FATTURA")+"</a>",""!=b&&(b+=a.data.dataAsString));c.getPnlAnteprimaFattura().body.update(b)}else c.getPnlAnteprimaFattura().body.update(a.message[0].testo)}});
d=!1;Ext.isEmpty(b.get("dataRegistrazione"))||(d=1==b.get("accettata")||"T"==b.get("accettata"));c.getBtnAvanti().setDisabled(d);setTimeout(function(){var a=c.getGridRicerca().getSelectionModel().getSelection()[0];a&&a.data.id==b.data.id&&(b.set("letto","T"),0>c.fattureLette.indexOf(b.data.id)&&c.fattureLette.push(b.data.id),0<=c.fattureNonLette.indexOf(id)&&c.fattureNonLette.splice(c.fattureNonLette.indexOf(b.data.id),1))},700)}}else k.setHidden(!0)},SalvaLette:function(){var a=this;if(!a.fattureLette)return!1;
var b=a.fattureLette,c=a.fattureNonLette,b=b.toString();""!=b&&Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/fatturaElettronica/fatture/setReadStatus",params:{elencoIdFatture:b,status:"T"},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.fattureLette=[]:msgShowError("",b.message)}});c=c.toString();""!=c&&Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/fatturaElettronica/fatture/setReadStatus",params:{elencoIdFatture:c,status:"F"},success:function(b){b=
Ext.JSON.decode(b.responseText);b.success?a.fattureNonLette=[]:msgShowError("",b.message)}})},importaFatture:function(a,b,c){b=b.target.files;c=["xml","p7m"];for(var d=new FormData,e=!0,g=0;g<b.length;g++){var h=b[g],k=h.name.split(".").pop();k&&(k=k.toLowerCase());if(!c.includes(k)){Messaggio("FATTURA_ELETTRONICA","FORMATO_ERRATO","OK","INFORMATION");e=!1;break}d.append("fileData"+g,h)}e&&this.importaFatturePassive(d);a.fileInputEl.dom.value=null},importaFatturePassive:function(a,b){var c=this,d=
newIdElab(),e=c.cbaConfig.idOrganizzazione;StdSipcar.isValidID(e)||(e=getIdOrg());Ext.create("winElaborazione",{idElaborazione:d,alwaysOnTop:!0}).start();var g=c.persFe.fattPassivaNonAttiva&&"T"==c.persFe.fattPassivaNonAttiva;Ext.Ajax.request({url:"/cba/gen/ws/general/fatturaElettronica/fatture/importaFattElePassive",method:"POST",rawData:a,params:{idOrganizzazione:e,idAvanzamentoElaborazione:d,fattPassivaNonAttiva:g?"T":"F"},headers:{"Content-Type":null},success:function(a){a=Ext.JSON.decode(a.responseText);
var b=[],d=traduci("MSG_ELABORAZIONE_OK");a.success?(msgAdd(b,a.message),g&&c.EffettuaRicerca()):(d=traduci("MSG_ELABORAZIONE_KO"),msgAddError(b,a.message));msgShow(d,b)}})},ScaricaNonRegistrate:function(){var a=this;if(""==a.kTreeLocalSessionId)return!1;var b=function(b){inizioAttesa();Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/getPassiveNonRegistrate",timeout:36E5,params:{sessionId:b},success:function(b){var c=[];b=Ext.JSON.decode(b.responseText);fineAttesa();
b.success?msgAdd(c,b.message):msgAddError(c,b.message);msgShow("",c);a.EffettuaRicerca()}})};winRichiediDatiProtocolloMancanti().then(function(c){c?(c.on("close",function(c){c.down("form");c.down("form").erroreBloccante?Messaggio("ATTENZIONE",traduci("MSG_WARNING_MANCANO_DATI_OBBLIGATORI")+"!","OK","WARNING"):b(a.kTreeLocalSessionId)}),c.show()):b(a.kTreeLocalSessionId)})["catch"](function(a){msgShowError("",a)})},doPrint:function(a,b){this.esportaList();this.callParent([a,"excel"])},esportaList:function(a){a=
this.getParametriListPassive();Ext.apply(this.parametriStampa,{url:"/cba/gen/ws/general/fatturaElettronica/fatture/exportListPassive",titolo:this.titolo});this.getCbxUfficio().getValue()||this.parametriStampa&&delete this.parametriStampa.params.codIpaUfficio;var b=this.parametriStampa;Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params))},getParametriListPassive:function(){var a=
{},b="?",c="?",d;Ext.apply(a,{idModulo:CBA.moduli.moduloAttivo,tipoData:this.getRBCercaPer().getValue().tipo,stato:"",escludiNoteAccredito:getBoolValue(this.cbaConfig.economato),partitaIva:null,codFiscale:null});this.getCbxUfficio().getValue()&&(d=trovaRecord(this.getCbxUfficio().getStore(),"codice",this.getCbxUfficio().getValue()),Ext.apply(a,{codIpaUfficio:d.get("extra")}));this.getCbxFornitore().getValue()&&((d=trovaRecord(this.getCbxFornitore().getStore(),"codice",this.getCbxFornitore().getValue()))&&
d.get("extra")&&(b=d.get("extra").split(",")[0],c=d.get("extra").split(",")[1]),Ext.apply(a,{partitaIva:"?"!=b?b:null,codFiscale:"?"!=c?c:null}));this.getCbxFornitore().getValue()&&((d=trovaRecord(this.getCbxFornitore().getStore(),"codice",this.getCbxFornitore().getValue()))&&d.get("extra")&&(b=d.get("extra").split(",")[0],c=d.get("extra").split(",")[1]),Ext.apply(a,{partitaIva:"?"!=b?b:null,codFiscale:"?"!=c?c:null}));"T"!=this.getRBVisitato().getValue().visitato&&Ext.apply(a,{vistato:this.getRBVisitato().getValue().visitato});
this.getEdtDtDal().getValue()&&Ext.apply(a,{dataDal:this.getEdtDtDal().getValue()});this.getEdtDtAl().getValue()&&Ext.apply(a,{dataAl:this.getEdtDtAl().getValue()});this.getChkScadPag().getValue()&&Ext.apply(a,{scaDaCondPag:getBoolValue(this.getChkScadPag().getValue())});"T"!=this.getRBStato().getValue().stato&&Ext.apply(a,{stato:this.getRBStato().getValue().stato});Ext.isEmpty(this.getRBCercaPer().getValue().tipo)&&Ext.apply(a,{tipoData:"1"});this.cbaConfig.listaFornitori&&Ext.apply(a,{elencoParIva:this.cbaConfig.listaFornitori});
return a},removeSelectedStatus:function(){var a=this.getGridRicerca(),b=a.getSelectionModel();if(b=Ext.isEmpty(b.getSelection())?null:b.getSelection()[0]){var c=a.editingPlugin.getEditor().getForm();c.controller=this;c.store=a.getStore();b=b.getData();delete b.idUtenteSelected;delete b.clcDataRegistrazione;delete b.descTipoDocumento;delete b.esisteAllegati;delete b.active;controller_salvaRecord(c,b,!1,{forzaRegistrazione:!1})&&(this.EffettuaRicerca(b.id),this.getGridRicerca().getView().refresh())}},
EffettuaRicerca:function(a){var b=this;b.SalvaLette();var c=b.getFldOperatore(),d=b.getParametriListPassive(),e=b.getGridRicerca(),g=e.getStore(),h=Ext.create("Generali.fatturazioneElettronica.store.FePassive",{autoLoad:!1});!b.getEdtDtDal().getValue()&&g.cbaConfig.parametri&&(g.cbaConfig.parametri.dataDal=null);!b.getEdtDtAl().getValue()&&g.cbaConfig.parametri&&(g.cbaConfig.parametri.dataAl=null);!b.getChkScadPag().getValue()&&g.cbaConfig.parametri&&(g.cbaConfig.parametri.scaDaCondPag=null);b.getCbxUfficio().getValue()||
g.cbaConfig.parametri&&delete g.cbaConfig.parametri.codIpaUfficio;e.getSelectionModel().deselectAll();c.setHidden(!0);e.findPlugin("rowexpander").expanderColumn.setVisible("R"==b.getRBStato().getValue().stato);b.getPnlAnteprimaFattura().body.update("<center><br><br><i>nessuna selezione</i></center>");h.getProxy().extraParams={hideInizioAttesa:!0};g.cbaConfig.parametri||(g.cbaConfig.parametri={});c=g.cbaConfig.parametri;e.cbaConfig.paged.fromScroll||(svuotaStore(g),Ext.apply(e.cbaConfig.paged,{fromScroll:!1}),
Ext.apply(c,{firstResult:0}));b.getChkSoloAutofatture().getValue()?Ext.apply(d,{soloAutoFatture:"T"}):Ext.apply(d,{soloAutoFatture:"F"});var k=StdSipcar.isValidID(a)?g.getCount():e.cbaConfig.paged.maxResults;57==CBA.moduli.moduloAttivo&&(k=0);Ext.apply(d,{maxResults:k});Ext.apply(c,d);Ext.apply(c,{limit:c.maxResults,start:c.firstResult});delete c.maxResults;delete c.firstResult;var l=b.getRBStato().getValue().stato;g.getProxy().extraParams=d;h.load({params:c,callback:function(c,d,h){if(h){if(!Ext.isEmpty(c)){b.getFsNoCig().setVisible(!1);
h=57==CBA.moduli.moduloAttivo;var k=$jscomp.makeIterator(c);for(d=k.next();!d.done;d=k.next())d=d.value,h&&"T"==d.data.ecoControllato||g.add(d),"T"==b.persFe.visuFattNocig?b.getFsNoCig().isVisible()||b.getFsNoCig().setVisible("T"!=d.data.esisteCig):b.getFsNoCig().setVisible(!1);StdSipcar.isValidID(a)&&(d=trovaRecord(g,"id",a))&&e.getSelectionModel().select([d]);Ext.apply(e.cbaConfig.paged,{fromScroll:!1});if("D"==l){h=!1;k=$jscomp.makeIterator(c);for(d=k.next();!d.done;d=k.next())if(d=d.value.data,
"TD16"==d.codTipoDocumento||"TD17"==d.codTipoDocumento||"TD18"==d.codTipoDocumento||"TD19"==d.codTipoDocumento||"TD20"==d.codTipoDocumento||"TD21"==d.codTipoDocumento){h=!0;break}h&&Messaggio("ATTENZIONE","AUTOREGISTRA_AUTOFATTURE","YESNO","QUESTION",!1,function(){b.registraAutoFatture(c);b.EffettuaRicerca()},function(){})}}}else msgShowError("",d.getError())}})},registraAutoFatture:function(a){var b;if(a){b=null;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(c=c.value.data,"TD16"==
c.codTipoDocumento||"TD17"==c.codTipoDocumento||"TD18"==c.codTipoDocumento||"TD19"==c.codTipoDocumento||"TD20"==c.codTipoDocumento||"TD21"==c.codTipoDocumento)null!=b&&(b+=","),b+=c.id;null!=b&&Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/fatturaElettronica/fatture/registraAutoFatture",params:{listAutoFattId:b}})}},sbloccaFattura:function(a){var b=this.getGridRicerca();b.getSelectionModel().hasSelection()&&(a=(a=b.getSelectionModel().getSelection()[0])?a.get("id"):null);a&&0<a&&
Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/setSelected",params:{idFattura:a,selected:"F"}})},controlloCliFor:function(a){delete this.nuovoFornitore;if(a)return new Promise(function(b,c){var d=a[0],e=[],g={};Ext.apply(g,{tipoCliFor:"P"==d.get("attivaPassiva")?"F":"C",codFiscale:d.get("codiceFiscale"),partitaIva:d.get("partitaIva")});Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/anaCliFor/esisteCliFor",params:g,async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);
a.success?b(Ext.isEmpty(a.data)):(msgAdd(e,a.message),c(e))}})})},procediRegistraFattura:function(){var a=this,b=a.getGridRicerca().getSelectionModel().getSelection(),c={};a.SalvaLette();if(1!=b.length)return Messaggio("FATTURA_ELETTRONICA","SELEZIONARE_UN_RECORD","OK","INFORMATION"),a.indietro(),!1;a.controlloCliFor(b).then(function(d){a.nuovoFornitore=d;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/setSelected",params:{idFattura:b[0].get("id"),selected:"T"},
success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(Ext.apply(c,{sessionId:a.kTreeLocalSessionId,idEsercizio:a.cbaConfig.idEsercizio,recordCruscotto:a.getGridRicerca().getSelectionModel().getSelection()[0].data,controllerCruscotto:a,controllerFatturaHead:a.cbaConfig.controllerFatturaHead}),a.getPnlRegistraFattEle().removeAll(),a.getPnlRegistraFattEle().add(Ext.create(a.getPnlRegistraFattEle().cbaConfig.url,{cbaConfig:c})),a.getPnlRegistraFattEle().down("#Form").controller.ProcediImportazioneFattura()):
(a.indietro(),msgShowError("",b.message))}})})["catch"](function(b){a.indietro();msgShowError("",b)})},forzaScritturaFattura:function(a){var b=this;a=b.getGridRicerca().getSelectionModel().getSelection()[0];if(1!=b.getGridRicerca().getSelectionModel().getSelection().length)return Messaggio("FATTURA_ELETTRONICA","SELEZIONARE_UN_RECORD","OK","INFORMATION"),b.indietro(),!1;Ext.create("winCBA",{name:"CP.fatturazioneElettronica.view.ForzaScrittura",titolo:"FORZA_SCRITTURA_FATTURA",dimensione:3,altezzaWin:300,
larghezzaWin:400,configItem:{localSessionId:b.kTreeLocalSessionId,idFatturaEletronica:a.get("id"),idEsercizio:b.cbaConfig.idEsercizio,codFiscale:a.get("codiceFiscale"),partitaIva:a.get("partitaIva"),callbackRiapriStore:function(){b.EffettuaRicerca()},callbackAnnulla:function(){}}}).show()},forzaScritturaGriglia:function(){var a=this,b=a.cbaConfig;Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.ForzaScritturaGriglia",titolo:"FORZA_SCRITTURA_FATTURA",dimensione:3,altezzaWin:300,larghezzaWin:400,
configItem:{idOrganizzazione:b.idOrganizzazione,idEsercizio:b.idEsercizio,localSessionId:a.kTreeLocalSessionId,parametriScrittura:a.getParametriListPassive(),callbackRiapriStore:function(){a.EffettuaRicerca()}}}).show()},mostraAllegati:function(a){a=a?a:this.getGridRicerca().getSelectionModel().getSelection()[0].data.id;Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.Allegati",titolo:"ALLEGATI_FATTURA",dimensione:3,altezzaWin:400,larghezzaWin:500,configItem:{localSessionId:this.kTreeLocalSessionId,
idFatturaEletronica:a,callbackRiapriStore:function(){},callbackAnnulla:function(){}}}).show()},creaFileXml:function(a){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/creaFileXmlFattura",params:{idFattura:a},success:function(a){a=Ext.JSON.decode(a.responseText);if(a.success){a=a.data;var b=a.filePath.split("\\").pop().split("/").pop(),d=document.createElement("a");d.id="linkProva";d.href=a.filePath;d.download=b;document.body.appendChild(d);d.click();d.remove()}else msgShowError("",
a.message)}})},visualizzaControlloOrdini:function(){var a=!1;44==CBA.moduli.moduloAttivo&&CBA.moduli.modulo57.installato&&CBA.moduli.modulo57.abilitato&&Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/prszn/economato/visualizzaControlloOrdini",async:!1,params:{idEsercizio:this.cbaConfig.idEsercizio},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a="T"==b.data:msgShowError("",b.message)}});return a},menuShortcutFattElettronica:function(a,b){b=void 0===b?
!1:b;var c=this,d=[];d.push({text:traduci("CREA_FILE_XML"),handler:function(){selection=c.getGridRicerca().getSelectionModel().getSelection();Ext.isEmpty(selection)||c.creaFileXml(selection[0].get("id"))}});b||d.push({text:traduci("IMPOSTA_COME_REGISTRATA"),handler:function(){c.forzaScritturaFattura()}},{text:"Imposta come registrata tutta la griglia",itemId:"registraGriglia",handler:function(){c.forzaScritturaGriglia()}},{text:traduci("IMPOSTA_COME_DA_REGISTRARE"),handler:function(){var b={};selection=
c.getGridRicerca().getSelectionModel().getSelection();stato=c.getRBStato().getValue().stato;Ext.isEmpty(selection)||(Ext.apply(b,{idFatturaElettronica:selection[0].data.id}),a&&Ext.apply(b,{sessionId:a}),"F"!=stato?Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/fatture/riapriDocumento",params:b,success:function(a){a=Ext.JSON.decode(a.responseText);var b=[];a.success?msgAdd(b,a.message):msgAddError(b,a.message);msgShow("",b);c.EffettuaRicerca()}}):msgShowError("",traduci("MSG_AVVISO_FATT_RIFIUTATE_NON_MODIFICABILI")))}});
d.push({text:traduci("MOSTRA_ALLEGATI"),handler:function(){c.mostraAllegati()}});b||d.push({text:traduci("SBLOCCA_FATTURA"),itemId:"sbloccaFattura",handler:function(){c.removeSelectedStatus()}},{text:traduci("SEGNA_DA_LEGGERE"),handler:function(){c.segnaDaLeggere()}});return d},loadData:function(){var a=this;a.kTreeLocalSessionId="";""==a.kTreeLocalSessionId&&(a.kTreeLocalSessionId=LoginSysDocFattEle());a.fattureLette=[];a.fattureNonLette=[];a.getCbxUfficio().getStore().load({params:{idOperatore:CBA.parametriGenerali.codUtente},
callback:function(b,c,d){d&&1==b.length&&setValue(a.getCbxUfficio(),b[0].get("codice"))}});a.getCbxFornitore().getStore().load({params:{idOrganizzazione:getIdOrg()},callback:function(b,c,d){d&&!Ext.isEmpty(b)&&1==a.cbaConfig.economato&&(a.getCbxFornitore().setValue(a.cbaConfig.idFornitore),a.naviga("next"))}});a.getGridRicerca().menuShortcut=Ext.create("Ext.menu.Menu",{items:a.menuShortcutFattElettronica(a.kTreeLocalSessionId,a.cbaConfig&&"L"==a.cbaConfig.permesso)});a.getGridRicerca().controller=
a;a.getRBCercaPer().setValue({tipo:"1"});a.getRBVisitato().setValue({visitato:"T"});a.getRBStato().setValue({stato:"D"});a.getCbxFornitore().focus()},destroy:function(){this.SalvaLette();this.callParent()},onLaunch:function(){var a=this,b=a.cbaConfig.idOrganizzazione?a.cbaConfig.idOrganizzazione:getIdOrg();a.persFe=null;a.getBtnImportaFatture().setVisible(!1);Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/getListByIdOrg",async:!1,params:{idOrganizzazione:b},
success:function(b){b=Ext.JSON.decode(b.responseText);if(b.success){if(b.data){a.persFe=b.data[0];b=!1;a.persFe&&a.persFe.ei7AttivoDal&&(b=Ext.Date.parse(a.persFe.ei7AttivoDal,"Y-m-d H:i:s"),b=(new Date).getTime()>=b.getTime());var c=a.persFe.fattPassivaNonAttiva&&"T"==a.persFe.fattPassivaNonAttiva;a.getBtnImportaFatture().setVisible(c||!b);a.getBtnScaricaNonRegistrate().setVisible(!c);b=a.persFe.gestioneCodIpaOperatore&&"T"==a.persFe.gestioneCodIpaOperatore;a.getCbxUfficio().setVisible(b)}}else msgShowError("",
b.message[0].testo)}});a.getColCodUfficio().hidden=a.getCbxUfficio().isHidden();a.getCbxControlloOrdini().hidden=!a.visualizzaControlloOrdini();a.cbaConfig.economato&&a.getChkScadPag().setValue(a.cbaConfig.scaDaCondPag)}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaAttiva",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){var a="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"CntServizioDisattivato",selector:a+"#CntServizioDisattivato"},
{ref:"TabPrincipale",selector:a+"#TabPrincipale"},{ref:"TbTabPrincipale",selector:a+"#TbTabPrincipale"},{ref:"DalNumero",selector:a+"#DalNumero"},{ref:"AlNumero",selector:a+"#AlNumero"},{ref:"BoxCampiRicercaInviate",selector:a+"#BoxCampiRicercaInviate"},{ref:"RagSociale",selector:a+"#RagSociale"},{ref:"NameXml",selector:a+"#NameXml"},{ref:"TipoFattEleCercaPer",selector:a+"#TipoFattEleCercaPer"},{ref:"StatoRicerca",selector:a+"#StatoRicerca"},{ref:"AggiornaStato",selector:a+"#AggiornaStato"},{ref:"ValidaXML",
selector:a+"#ValidaXML"},{ref:"Registro",selector:a+"#Registro"},{ref:"BtnAvanti",selector:a+"#BtnAvanti"},{ref:"BtnIndietro",selector:a+"#BtnIndietro"},{ref:"BtnCrea",selector:a+"#BtnCrea"},{ref:"BtnInvia",selector:a+"#BtnInvia"},{ref:"PageParametri",selector:a+"#PageParametri"},{ref:"PageSedeReparto",selector:a+"#PageSedeReparto"},{ref:"PageAnteprima",selector:a+"#PageAnteprima"},{ref:"TipoDocFattura",selector:a+"#TipoDocFattura"},{ref:"TipoFattura",selector:a+"#TipoFattura"},{ref:"TipoDocContabile",
selector:a+"#TipoDocContabile"},{ref:"TipoDocRetta",selector:a+"#TipoDocRetta"},{ref:"TipoDocFatturaLibera",selector:a+"#TipoDocFatturaLibera"},{ref:"TabPeriodo",selector:a+"#TabPeriodo"},{ref:"CondizionePag",selector:a+"#CondizionePag"},{ref:"TreeServiziClass",selector:a+"#TreeServiziClass"},{ref:"ElencoCausali",selector:a+"#ElencoCausali"},{ref:"StatoDaContabilizzare",selector:a+"#StatoDaContabilizzare"},{ref:"TipoDocRettaFatt",selector:a+"#TipoDocRettaFatt"},{ref:"DataDal",selector:a+"#DataDal"},
{ref:"DataAl",selector:a+"#DataAl"},{ref:"Anno",selector:a+"#Anno"},{ref:"BtnStampa",selector:a+"#BtnStampa"},{ref:"BtnElabora",selector:a+"#BtnElabora"},{ref:"PanelFatture",selector:a+"#PanelFatture"},{ref:"StatoInvioCercaPer",selector:a+"#StatoInvioCercaPer"},{ref:"GridFatt",selector:a+"#GridFatt"},{ref:"BtnFaqMenu",selector:a+"#BtnFaqMenu"}]);this.control(a+"#BtnFaqMenu",{click:this.clickBtnFaq});this.control(a+"#StatoInvioCercaPer",{change:this.changeStatoInvioCerca});this.control(a+"#TipoFattEleCercaPer",
{change:this.changeTipoFattEleCerca});this.control(a+"#BtnCrea",{click:this.clickBtnCrea});this.control(a+"#BtnInvia",{click:this.clickBtnInvia});this.control(a+"#StatoDaContabilizzare",{change:this.changeStatoDaContabilizzare});this.control(a+"#DalNumero",{blur:this.blurchangeDalNumero});this.control(a+"#AlNumero",{blur:this.blurchangeAlNumero});this.control(a+"treepanel",{checkchange:treeCheckchange,beforeitemcontextmenu:this.beforeitemcontextmenu});this.control(a+"AggiornaStato",{doubleclick:this.enableValidaXML});
this.control(a+"#DataDal",{change:this.changeData});this.control(a+"#Registro",{expand:this.onExpandRegistro})},enableValidaXML:function(){var a=this.getValidaXML();validaXmlvalidaXml.setHidden(!1);a.setDisabled(!1)},onExpandRegistro:function(){var a=this.getDataDal().getValue().getFullYear();this.annoTb!==a&&((2==this.personContabili.tipoContabilitaAbilitata||this.tabelleAmm2)&&this.reloadRegistro(),this.annoTb=a)},changeData:function(a,b){if(2==this.personContabili.tipoContabilitaAbilitata||this.tabelleAmm2){var c=
this.getRegistro(),d=c.getStore(),e=this.getDataDal().getValue().getFullYear();this.annoTb!==e&&(c.setValue(),svuotaStore(d))}},changeStatoInvioCerca:function(a,b,c,d){a=this.getTipoFattEleCercaPer().getValue();c=this.getStatoRicerca();d=this.getAggiornaStato();var e=this.getValidaXML();this.getNameXml().setDisabled(1==b.tipoInvio);d.setDisabled(1==b.tipoInvio);e.setDisabled(2==b.tipoInvio);c.down("#StatoRicercaSx").setDisabled(1==b.tipoInvio);c.down("#StatoRicercaDx").setDisabled(1==b.tipoInvio||
"B2C"==a.tipoFattEle)},changeTipoFattEleCerca:function(a,b,c,d){a=this.getStatoInvioCercaPer().getValue();this.getStatoRicerca().down("#StatoRicercaDx").setDisabled(1==a.tipoInvio||"B2C"==b.tipoFattEle);this.getTipoDocContabile().setValue("B2C"!=b.tipoFattEle);this.getTipoFattura().setValue(!0)},beforeitemcontextmenu:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},blurchangeDalNumero:function(a){var b=this.getAlNumero();a.getValue()>b.getValue()&&b.setValue(a.getValue())},blurchangeAlNumero:function(a){var b=
this.getDalNumero();a.getValue()<b.getValue()&&b.setValue(a.getValue())},abilitaPulsanti:function(a){var b=this.getTabPrincipale().getLayout();a?(this.getBtnIndietro().setDisabled(!b.getPrev()),this.getBtnAvanti().setDisabled(!b.getNext())):(this.getBtnIndietro().setDisabled(!0),this.getBtnAvanti().setDisabled(!0))},getElencoTipiDoc:function(){var a=[],b=this.getTipoDocFattura(),c=this.getTipoDocRetta(),d=this.getTipoDocFatturaLibera();Ext.each(b.query("field"),function(b){b.getValue()&&(c.getValue()&&
a.push(3*c.valore+b.valore),d.getValue()&&a.push(3*d.valore+b.valore))});return a},selectAllRows:function(a){a.getSelectionModel().selectAll();a.getView().focusRow(0)},reloadCausali:function(a){var b=this;b.getElencoCausali().getStore().load({params:{tipoContabilita:2,elencotipiDoc:b.getElencoTipiDoc().toString()},callback:function(){b.selectAllRows(b.getElencoCausali())}})},reloadRegistro:function(a){var b=this.getRegistro().getStore(),c=this.getDataDal().getValue(),d={};Ext.isEmpty(c)&&(c=new Date);
this.tabelleAmm2?(b.getProxy().url="/cba/osp/co/ws/genAmmPers/registriIva/detail/cboxByDate",Ext.apply(d,{dataControllo:c,tipoDocumento:2,idOrganizzazione:null!=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg()}),this.annoTb=c.getFullYear()):(ImpostaUrl([b]),Ext.apply(d,{anno:a||c.getFullYear()}),this.annoTb=d.anno);b.load({params:d,callback:function(a,b,c){c||msgShowError("",b.getError())}})},filterPaganti:function(a){var b=this;a.getStore().clearFilter();a.getStore().filter({filterFn:function(a){return"4"==
b.personContabili.tipoContabilitaAbilitata&&a.data.extra&&a.data.extra.split(",")?"T"==a.data.extra.split(",")[1]?!0:!1:!0}})},reloadPaganti:function(){var a=this,b=a.getRagSociale(),c=b.getStore();c.getProxy().setExtraParam("tipoContabilita",a.personContabili.tipoContabilitaAbilitata);c.getProxy().setExtraParam("limit",0);c.load({callback:function(c,e,g){g&&a.filterPaganti(b)}})},clickBtnCrea:function(){this.gridFattEle.getController().gestisciFattureSelezionate("FE_SALVA_XML")},clickBtnInvia:function(){this.gridFattEle.getController().gestisciFattureSelezionate("FE_INVIA_XML")},
getFaqText:function(a){return"<DIV ID="+a+" ALIGN=JUSTIFY STYLE=\"line-height: 1.5; margin: 10px; font-size: 12px; font-family: sans-serif;\">\n\t\t\t\t<H1>FAQ - Domande frequenti relative alla Fatturazione Elettronica Attiva</H1>\n\t\t\t\t<OL>\n\t\t\t\t\t<LI><b>Se sbaglio una fattura all'ospite e l'ho gi inviata, che cosa devo fare?</B><BR>\n\t\t\t\t\tNota di credito ed una nuova fattura.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>Quali documenti vanno inviati?</B><BR>\n\t\t\t\t\t\tTD01 Fattura<BR>\n\t\t\t\t\t\tTDO2 Acconto/Anticipo su fattura<BR>\n\t\t\t\t\t\tTDO3 Acconto/Anticipo su parcella<BR>\n\t\t\t\t\t\tTD04 Nota di Credito<BR>\n\t\t\t\t\t\tTD05 Nota di Debito<BR>\n\t\t\t\t\t\tTDO6 Parcella<BR>\n\t\t\t\t\t\tTD20 Autofattura<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>E' necessario inviare le fatture in formato cartaceo?</B><BR>\n\t\t\t\t\tSdI recapita la fattura elettronica al cessionario/committente mettendola a disposizione nella sua area riservata del sito web dell'Agenzia delle entrate. Comunque, il cedente/prestatore consegna direttamente al cliente consumatore finale una copia informatica o analogica della fattura elettronica, comunicando contestualmente che il documento  messo a sua disposizione da Sdi nell'area riservata del sito web dell'Agenzia delle entrate.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>Gli enti pubblici continueranno ad utilizzare le notifiche (accettazione / rifiuto / decorrenza termini)?</B><BR>\n\t\t\t\t\tSi<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>Quali sono i termini per l'invio delle fatture attive a SdI?</B><BR>\n\t\t\t\t\tEntro 10 giorni.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>Se viene predisposta ed inviata al cliente una fattura in forma diversa dal quella dellxml cosa succede?</B><BR>\n\t\t\t\t\tIn questo caso le modalit sono diverse da quelle previste per il Sistema di interscambio, quindi, come previsto dal provvedimento del 30 aprile 2018, tale fattura si considera non emessa, con conseguenti sanzioni (art. 6 DLgs. 471/1997) a carico del fornitore e con limpossibilit di detrazione dellIVA a carico del cliente.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>Il processo di fatturazione elettronica come incide sulle fatture differite?</B><BR>\n\t\t\t\t\tNella guida del 27 settembre 2018, lAgenzia delle Entrate ha affermato che restano valide le regole che consentono di predisporre la c.d. fattura differita entro il 15 del mese successivo a quello di effettuazione delloperazione, nel rispetto delle disposizioni previste dallart.21 c.4 lett. a) del DPR 633/72. Da un punto di vista operativo, questa disposizione pu consentire allutente di avere pi tempo per predisporre e trasmettere allo SDI la fattura elettronica, fermo restando lobbligo di rilasciare al cliente  al momento delloperazione  un documento di trasporto o altro documento equipollente anche su carta.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>In caso di fattura scartata dallo Sdi come ci si pu comportare?</B><BR>\n\t\t\t\t\tLAgenzia delle Entrate si  espressa in merito nella circolare 13/E/2018, in particolare ha affermato che nel caso in cui la fattura precedentemente trasmessa sia stata scartata dal Sistema di interscambio, la fattura va inviata nuovamente, entro cinque giorni dalla notifica di scarto, preferibilmente con la medesima data e numero del documento originario.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t\t<LI><b>E obbligatorio applicare il bollo virtuale?</B><BR>\n\t\t\t\t\tS, ove previsto,  obbligatorio lassolvimento virtuale del bollo. Dal 1 gennaio 2015, i contribuenti che scelgono di assolvere il pagamento dellimposta di bollo in modo virtuale, sono tenuti a presentare una dichiarazione contenente il numero degli atti e documenti emessi, distinti per voce di tariffa, utilizzando il nuovo modello di autorizzazione.<BR>\n\t\t\t\t\t<BR>\n\t\t\t\t</OL>\n\t\t\t</DIV>"},
clickBtnFaq:function(a,b){var c=Ext.id(),d={},e=function(a,b){var d=Ext.get(c);if(d){var e=+d.dom.style.fontSize.replace("px",""),e=b?++e:--e;a.setValue(100*e/12);d.dom.style.fontSize=e+"px"}};Ext.apply(d,{xtype:"panel",flex:1,scrollable:!0,idHtml:c,html:this.getFaqText(c),dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"numberfield",itemId:"FontSize",reference:"FontSize",maxWidth:100,value:100,listeners:{change:function(a,b,d,e){b&&(a=Ext.get(c))&&(a.dom.style.fontSize=
12*b/100+"px")}}},{xtype:"button",text:"-",handler:function(){e(this.up("toolbar").queryById("FontSize"),!1)}},{xtype:"button",text:"+",handler:function(){e(this.up("toolbar").queryById("FontSize"),!0)}},{xtype:"button",text:traduci("RIPRISTINA"),handler:function(){this.up("toolbar").queryById("FontSize").setValue(100)}}]}]});Ext.create("winCBA",{name:d,titolo:this.cbaConfig.titolo,dimensione:1,closable:!0}).show()},leggiParametri:function(a){var b=this.cbaConfig;a={};if(!this.cbaConfig.eseguiStampa){var c=
this.getDalNumero().getValue(),d=this.getAlNumero().getValue(),e=this.getRagSociale().getValue(),g=[],h=this.getTipoFattEleCercaPer(),k=h.getValue(),l=this.getStatoRicerca(),m=this.getAggiornaStato(),n=this.getValidaXML(),p=this.getNameXml(),q=this.getElencoTipiDoc(),t=[],v=this.getCondizionePag();listServizi=[];treeServClass=this.getTreeServiziClass();var u=0,u=l.down("#StatoRicercaSx").items.length;l.down("#StatoRicercaSx").getChecked().forEach(function(a){u--;g.push(a.inputValue)});"B2C"!=k.tipoFattEle&&
(u+=l.down("#StatoRicercaDx").items.length,l.down("#StatoRicercaDx").getChecked().forEach(function(a){u--;g.push(a.inputValue)}));!Ext.isEmpty(g)&&0<u&&Ext.apply(a,{eleStato:g.toString()});Ext.each(v.getSelectionModel().getSelection(),function(a){t.push(a.get("codice"))});t=v.getStore().getCount()==t.length?"":t.toString();listServizi=getListCheckedTree(this.getTreeServiziClass(),!0,"idServizio",null,null,!0);Ext.apply(a,{reportId:b.id,numeroDocDal:c?c:-1,numeroDocAl:d?d:-1,pagante:e?e:-1,nameXml:p.getValue(),
tipoFattEle:h.getValue()?h.getValue():null,registro:this.getRegistro().getValue(),dataDal:this.getDataDal().getValue(),dataAl:this.getDataAl().getValue(),tipiDocumento:q.toString(),statoInvio:this.getStatoInvioCercaPer().getValue().tipoInvio,elencoCondizioniPagamento:t,elencoServizi:listServizi,updateState:m.getValue()?"T":"F"});this.cbaConfig.validaXML=n.getValue()?"T":"F"}this.cbaConfig.idFatture&&Ext.apply(a,{idFatture:this.cbaConfig.idFatture});b=Ext.apply(this.parametriStampa,{url:this.cbaConfig.url,
titolo:b.titolo,renderTo:this.getPageAnteprima(),winElaborazione:this.cbaConfig.winElaborazione,params:{reportId:b.id}});Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params));this.cbaConfig.fattExpired?(a.fattExpired=this.cbaConfig.fattExpired,a.expired="T",delete this.cbaConfig.fattExpired):a.expired="F";return a},loadFatture:function(){var a=this.leggiParametri(),
b=this.gridFattEle.down("cercaGrid");2==a.statoInvio?(this.getBtnInvia().setDisabled(!0),this.getBtnCrea().setDisabled(!0),this.gridFattEle.controller.getBtnImportaXml().hide(),b.show(),b.setEmptyText(traduci("NOME_FILE_XML")),b.setWidth(210)):(this.getBtnInvia().setDisabled(!1),this.getBtnCrea().setDisabled(!1),this.gridFattEle.controller.getBtnImportaXml().show(),b.hide());this.gridFattEle.controller.aggiornaStorePanelFatture(a)},naviga:function(a){this.getTabPrincipale().getActiveTab()==this.getPanelFatture()?
this.loadFatture():(this.getBtnInvia().setDisabled(!0),this.getBtnCrea().setDisabled(!0))},onLaunch:function(){var a=this,b=a.getTabPrincipale(),c=a.getCntServizioDisattivato();b.suspenTabChange=!1;if(43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo){var d=getPersonContabili(getIdOrg(),new Date,!0,null),d=d?4==d.tipoContabilitaAbilitata||5==d.tipoContabilitaAbilitata:!1;b.setVisible(d);c.setVisible(!d)}else b.setVisible(!1),c.setVisible(!0);a.loadGridFatture=!1;a.getCondizionePag().getStore().load({callback:function(){a.selectAllRows(a.getCondizionePag())}});
a.gridFattEle=Ext.create("Generali.fatturazioneElettronica.view.FattElettronicaAttivaGriglia",{controllerGen:a});a.getPanelFatture().add(a.gridFattEle);personContabili=getPersonContabili(getIdOrg(),new Date,!0,null);a.personContabili=personContabili;a.tabelleAmm2=4==a.personContabili.tipoContabilitaAbilitata||5==a.personContabili.tipoContabilitaAbilitata;a.getPageAnteprima().tab.setVisible(!1);a.getBtnStampa().setVisible(!1);b.down("tabbar").add([{xtype:"button",margin:"0 5 0 5",itemId:"BtnCrea",
reference:"BtnCrea",iconCls:"icon-zip",scale:"large",text:traduci("SCARICA_DOCUMENTI")},{xtype:"button",itemId:"BtnInvia",reference:"BtnInvia",iconCls:"icon-elabora32",scale:"large",text:traduci("INVIA_DOCUMENTI")}]);a.getBtnAvanti().setVisible(!0);a.getBtnIndietro().setVisible(!0);Ext.create("Generali.person_fe.store.AccountFe").load({params:{idOrganizzazione:getIdOrg()},callback:function(b,c,d){d?0<b.length?(a.personFe=b[0],""==b[0].get("userName")+b[0].get("password")?a.getBtnInvia().hide():"T"!=
b[0].get("enableExportXml")&&a.getBtnCrea().hide()):a.getBtnInvia().hide():(a.getBtnCrea().hide(),a.getBtnInvia().hide())}});a.getBtnInvia().setDisabled(!0);a.getBtnCrea().setDisabled(!0);a.reloadPaganti();a.reloadRegistro();b.cbaConfig.naviga=function(b){a.naviga(b)};b.down("toolbar").insert(0,{xtype:"button",itemId:"BtnFaqMenu",reference:"BtnFaqMenu",iconCls:"icon-faq32",text:traduci("FAQ"),scale:"large"});var e=a.getTreeServiziClass();e.getStore().load({params:{tipo:1,conClassNull:"T",soloServizi:"T"},
callback:function(a,b,c){c?e.expandAll():msgShowError("",b.getError())}});a.naviga();a.aggiornaStato=!1;a.checkFattDaFirmareExpired()},checkFattDaFirmareExpired:function(){var a=this,b=Ext.create("Generali.fatturazioneElettronica.store.FeAttive");b.getProxy().api.read="/cba/osp/co/ws/general/fatturaElettronica/attiva/listWarning";b.getProxy().url="/cba/osp/co/ws/general/fatturaElettronica/attiva/listWarning";b.getProxy().timeout=3E5;b.load({params:{updateState:a.aggiornaStato?"T":"F"},callback:function(b,
d,e){e&&null!=b&&0<b.length&&(d=traduci("MSG_AVVISO_FATT_ELE_EXPIRED")+"<BR>",d=a.aggiornaStato?d+(traduci("MSG_AVVISO_FATT_ELE_EXPIRED_CONTATTACBA")+"<BR>"+traduci("MSG_AVVISO_FATT_ELE_EXPIRED_VISUALIZZA")):d+traduci("MSG_AVVISO_FATT_ELE_EXPIRED_AGGIORNA"),Messaggio("ATTENZIONE",d,"YESNO","WARNING",null,function(){a.aggiornaStato?(a.getStatoInvioCercaPer().setValue({tipoInvio:2}),a.cbaConfig.fattExpired=b,a.getTabPrincipale().setActiveTab(1),a.aggiornaStato=!1):(a.aggiornaStato=!0,a.checkFattDaFirmareExpired())}))}})}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaAttivaAnteprima",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"PnlAnteprimaFatturaAttiva",selector:this.selContainer+"#PnlAnteprimaFatturaAttiva"}])},loadPreviewFatturaXml:function(){var a=this.getPnlAnteprimaFatturaAttiva();idFattTe=this.cbaConfig.idFattTe;idFattTe=idFattTe.replace(",","");Ext.Ajax.request({method:"GET",
url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/stampaXml",params:{idFattTe:idFattTe,stampaCompatta:"FE_STAMPA_XML_COMPATTA"==this.cbaConfig.tipo?"T":"F",cfSalvati:this.cbaConfig.cFsalvati?"T":"F",valida:this.cbaConfig.validaXML},success:function(b){b=Ext.JSON.decode(b.responseText);if(b.success){var c="<a href='"+b.data.filePath+"' target='_blank'>"+traduci("STAMPA_FATTURA")+"</a>";""!=c&&(c+=b.data.dataAsString);msgShowText("",traduci("MSG_OPERAZIONE_OK"));a.setHtml(c)}else msgShowError("",
b.message)}})},loadLinkDownloadXml:function(a){var b=this.getPnlAnteprimaFatturaAttiva(),c="FE_SALVA_XML"==a&&this.cbaConfig.saveStato,d=newIdElab(),e=2<this.cbaConfig.idFattTe.split(",").length;Ext.Ajax.request({method:"POST",timeout:18E5,url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/getXml",params:{id:this.cbaConfig.idFattTe,idAvanzamentoElaborazione:d,save:c?"T":"F",cfSalvati:this.cbaConfig.cFsalvati?"T":"F",valida:this.cbaConfig.validaXML},success:function(c){var d=Ext.JSON.decode(c.responseText);
if(d.success){c=getPathServer()+d.data.filePath;var e=d.data.filePath,d=d.data.fileType?d.data.fileType.toLowerCase():"",e=e.replace(/^.*[\\\/]/,"");item=creaItemDownload("icon-"+d,c,e,traduci("FATTURA_ELETTRONICA"));b.add(item);b.setTitle(traduci("SCARICA_DOCUMENTI"));"FE_SALVA_XML"==a&&b.up().up().show()}else msgShowError("",d.message)}});e&&Ext.create("winElaborazione",{idElaborazione:d}).start()},onLaunch:function(){var a=this,b;b=a.cbaConfig.tipo;a.cbaConfig.saveStato=!1;"FE_STAMPA_XML"==b||
"FE_STAMPA_XML_COMPATTA"==b?a.loadPreviewFatturaXml():"FE_CREA_XML"==b?a.loadLinkDownloadXml(b):"FE_SALVA_XML"==b&&("T"==a.cbaConfig.personFe.get("enableExportXml")?Messaggio(traduci("FATTURA"),"MSG_CONFERMA_IMPOSTA_DOCUMENTI_SCARICATI_INVIATI","YESNO","QUESTION",null,function(){a.cbaConfig.saveStato=!0;a.loadLinkDownloadXml(b)},function(){a.cbaConfig.saveStato=!1;a.loadLinkDownloadXml(b)}):(a.cbaConfig.saveStato=!0,a.loadLinkDownloadXml(b)))}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaAttivaCF",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GrigliaCampiAggEdit",selector:this.selContainer+"#GrigliaCampiAggEdit"},{ref:"BtnRiprGrid",selector:this.selContainer+"#BtnRiprGrid"},{ref:"BtnConfGrid",selector:this.selContainer+"#BtnConfGrid"}]);this.control(this.selContainer+"#BtnConfGrid",{click:this.salvaGrid});this.control(this.selContainer+
"#BtnRiprGrid",{click:this.annullaInvio});this.control(this.selContainer+"#GrigliaCampiAggEdit",{beforeedit:this.onGrigliaCampiAggBeforeEdit,edit:this.onGrigliaCampiAggEditEdit})},onGrigliaCampiAggBeforeEdit:function(a,b,c){a=a.grid;c=b.record;if("valore_predefinito"==b.field){b=b.column.getEditor();if(!Ext.isEmpty(c.get("lunghezzamassima"))){var d=c.get("lunghezzamassima");b.rendered?b.inputEl.set({maxLength:d}):b.maxLength=d}Ext.isEmpty(c.get("tipodato"))||"D"!=c.get("tipodato")||(b.rendered?b.inputEl.set({regex:new RegExp(/^(0[1-9]|[12][0-9]|3[01])[-](0[1-9]|1[012])[-](19|20)\d\d+$/)}):
b.regex=new RegExp(/^(0[1-9]|[12][0-9]|3[01])[-](0[1-9]|1[012])[-](19|20)\d\d+$/))}a.getSelectionModel().select([c],!0,!0)},onGrigliaCampiAggEditEdit:function(a,b,c){a=this.getGrigliaCampiAggEdit().getStore();b=a.getModifiedRecords();a.getData().length==b.length&&this.getBtnConfGrid().setDisabled(!1)},annullaInvio:function(){this.getGrigliaCampiAggEdit().up("window").close()},salvaGrid:function(){var a=this,b;b=a.getGrigliaCampiAggEdit();var c=[];b.cfCompleti=!0;b.annulla=!1;b=a.getGrigliaCampiAggEdit().getStore().getRange();
Ext.each(b,function(a){c.push({id:a.get("id"),idfatt_te:a.get("idFattTe"),idfatt_de:a.get("idFattDe"),idCampo:a.get("idCampo"),valore_predefinito:a.get("valore_predefinito"),idOrganizzazione:getIdOrg()})});Ext.Ajax.request({url:"/cba/gen/ws/general/fatturaElettronica/prszn/feCaHistory/saveGrid",method:"POST",jsonData:c,async:!1,success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.getGrigliaCampiAggEdit().up("window").close():msgShowError("",b.message)},failure:function(a){a=Ext.JSON.decode(a.responseText);
msgShowError("",a.message)}})},aggiornaStore:function(){var a=this.getGrigliaCampiAggEdit().getStore(),b=[],c=[];Ext.each(this.cbaConfig.recordsFatt,function(a){c.push(a.getData())});Ext.Ajax.request({url:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/list",method:"POST",jsonData:c,async:!1,success:function(c){c=Ext.JSON.decode(c.responseText);c.success&&(b=c.data,a.loadData(b))}});this.getBtnConfGrid().setDisabled(!0)},onLaunch:function(){var a=this.getGrigliaCampiAggEdit();this.idOrganizzazione=
getIdOrg();this.recsIncompleti=this.cbaConfig.recordsFattIncomplete;this.recsDaReInviare=this.cbaConfig.recordsFattDaReInviare;this.recsAll=this.cbaConfig.recsAll;this.aggiornaStore(this.recInput);a.cfCompleti=!1;a.annulla=!0;a.getStore();this.getBtnRiprGrid().setDisabled(!1);this.getBtnConfGrid().setDisabled(!1);a.getStore().on({update:function(){}})},destroy:function(){this.callParent()}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaAttivaGridStorico",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridHistory",selector:a+"#GridHistory"}]);this.callParent(arguments)},aggiornaStore:function(a){var b=[],c=this.getGridHistory().getStore();Ext.apply(b,{idOrganizzazione:getIdOrg(),dataDoc:a.data,numeroDoc:a.numero});a.registro&&Ext.apply(b,{registro:a.registro});
c.load({params:b})},onLaunch:function(){var a=this.getGridHistory(),b=this.cbaConfig.record.getData();a.setTitle(this.cbaConfig.title);this.aggiornaStore(b)}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaAttivaGriglia",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"PanelFatture",selector:a+"#PanelFatture"},{ref:"GridFatt",selector:a+"#GridFatt"},{ref:"fieldsInvio",selector:a+"#fieldsInvio"},{ref:"PivaCf",selector:a+"#PivaCf"},{ref:"impInviata",selector:a+"#impInviata"},{ref:"menuShortcut",selector:a+"#menuShortcut"},
{ref:"LblTotaleFA",selector:a+"#LblTotaleFA"},{ref:"LblSceltoFA",selector:a+"#LblScelto"},{ref:"LblSceltoImpFA",selector:a+"#LblSceltoImpFA"},{ref:"BtnImportaXml",selector:a+"#BtnImportaXml"},{ref:"BtnStampaGriglia",selector:a+"#BtnStampaGriglia"}]);this.control(a+"#GridFatt",{selectionchange:this.cambioSelezioneGridFatt,beforeselect:this.beforeSelectGrid});this.control(a+"#BtnElabora",{click:this.clickBtnElabora});this.control(a+"#BtnImportaXml",{click:this.clickBtnImportaXml});this.control(a+"#BtnStampaGriglia",
{click:this.clickBtnStampaGriglia})},beforeSelectGrid:function(a,b,c){if(999==b.get("stato"))return msgShowWarning("","MSG_FATTELE_DACONTABILIZZARE"),!1},importaXmlCallback:function(){},clickBtnImportaXml:function(a,b){var c=this;config={};Ext.create("winCBA",{titolo:traduci("IMPORTA_XML"),name:"Generali.fatturazioneElettronica.view.ImportaXml",dimensione:7,configItem:{idOrganizzazione:c.idOrganizzazione,callbackConferma:c.importaXmlCallback.bind(this),enableImportXml:c.controllerGen.personFe.get("enableImportXml")},
closable:!0,maximizable:!1}).show().on("close",function(){c.aggiornaStorePanelFatture(c.filtroParam)})},clickBtnStampaGriglia:function(a,b){var c={};c.url=getUrlGen()+"/ws/general/fatturaElettronica/attiva/prtReportList";c.params=this.filtroParam;stampaEsporta(this.getBtnStampaGriglia(),c,null)},cambioSelezioneGridFatt:function(a,b,c){a=this.getGridFatt();var d=0,e=0,g=0;Ext.each(a.getSelectionModel().getSelection(),function(a){Ext.isEmpty(a.get("totale"))||(e+=a.get("totale"),d+=1)});Ext.each(this.getGridFatt().getStore().getRange(),
function(a){Ext.isEmpty(a.get("totale"))||(g+=a.get("totale"))});this.getLblTotaleFA().setText(Ext.util.Format.number(g-e,"0.00,"));this.getLblSceltoImpFA().setText(Ext.util.Format.number(e,"0.00,"));this.getLblSceltoFA().setText(traduci("SCELTO")+" ("+d+")")},aggiornaStorePanelFatture:function(a){var b=this,c=newIdElab(),d=b.getGridFatt(),e=2==a.statoInvio;b.filtroParam=a;Ext.apply(a,{idAvanzamentoElaborazione:c});store=d.getStore();svuotaStore(store);e?(d.setTitle(traduci("DOCUMENTI")+" "+traduci("INVIATE")),
b.getFieldsInvio().show()):(d.setTitle(traduci("DOCUMENTI")+" "+traduci("DA_INVIARE")),b.getFieldsInvio().hide());d=b.getPivaCf();"PA"==a.tipoFattEle.tipoInvio?d.setText(traduci("PIVA")):d.setText(traduci("CODICE_FISCALE"));void 0==a.fattExpired?(b.gridColFattExpired(!1),store.getProxy().setTimeout(6E5),store.load({params:a,callback:function(a,c,d){a=Ext.JSON.decode(c.getResponse().responseText);d?(b.cambioSelezioneGridFatt(),c=a.message[0],0<c.tipo&&msgShowError("",c.testo)):msgShowError("",c.getError())}}),
Ext.create("winElaborazione",{idElaborazione:c}).start()):(d.setText(traduci("PIVA")+"/"+traduci("CODICE_FISCALE")),b.gridColFattExpired(!0),store.loadData(a.fattExpired))},gridColFattExpired:function(a){var b=this.getGridFatt();[4,5,9,10,12,13].forEach(function(c){c=b.getColumns()[c];a?c.hide():c.show()})},gestisciFattureSelezionate:function(a){var b=this,c=b.getGridFatt(),d=[];Ext.each(c.getSelectionModel().getSelection(),function(a){d.push(a)});if(0<d.length){var c="INVIA_DOCUMENTI",e="MSG_CONFERMA_INVIO_DOCUMENTI";
"FE_SALVA_XML"==a&&(c="SCARICA_DOCUMENTI",e=traduci("MSG_CONFERMA_SCARICA_DOCUMENTI"));Messaggio(c,e,"YESNO","QUESTION",null,function(){b.verificaDatiProtocollo(d,a)})}else return Messaggio("ATTENZIONE",traduci("SELEZIONARE_ALMENO_UN_RECORD")+"!","OK","WARNING"),!1},verificaDatiProtocollo:function(a,b){var c=this;c.protocolloCodEnteInterno=-1;winRichiediDatiProtocolloMancanti().then(function(d){d?(d.on("close",function(d){var e=d.down("form").codEnteInterno;d=d.down("form").erroreBloccante;""!=e&&
null!=e&&(c.protocolloCodEnteInterno=e);d?Messaggio("ATTENZIONE",traduci("MSG_WARNING_MANCANO_DATI_OBBLIGATORI")+"!","OK","WARNING"):c.gestisciFatture(a,b)}),d.show()):c.gestisciFatture(a,b)})["catch"](function(a){msgShowError("",a)})},gestisciFatture:function(a,b){var c=this,d,e=[],g=[],h=[];d="T";var k=c.controllerGen&&"B2C"==c.controllerGen.getTipoFattEleCercaPer().getValue().tipoFattEle;0<a.length&&null!=a&&Ext.each(a,function(a){var b;b=!1;"F"==a.getData().completa&&(d="F",g.push(a.getData()),
e.push(a.getData()),b=!0);d="F";h.push(a.getData());b||e.push(a.getData())});"F"!=d||k?c.impostaElencoFattureDaInviare(a,b):(k=Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.FattElettronicaAttivaCF",titolo:"CAMPI VUOTI DA COMPILARE",dimensione:1,closable:!0,configItem:{permesso:"S",recordsFatt:a,recordsFattIncomplete:g,recordsFattDaReInviare:h,recsAll:e}}),k.on("close",function(d){d=d.down("grid");var e=d.getStore().getRange(),g=d.cfCompleti;annulla=d.annulla;c.recsCF=g?e:null;annulla||
c.impostaElencoFattureDaInviare(a,b)}),0==k.down("grid").getStore().count()?c.impostaElencoFattureDaInviare(a,b):k.show())},impostaElencoFattureDaInviare:function(a,b){var c="";null!=a&&0<a.length&&Ext.each(a,function(a){var b=a.get("idFattTe");"T"==a.get("manuale")&&(c+="M");c+=b+","});""!=c&&this.doXmlFatture(c,b)},doXmlFatture:function(a,b){var c=this;if("FE_INVIA_XML"==b){var d=newIdElab();Ext.Ajax.request({method:"POST",timeout:12E5,url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/inviaFattEle",
params:{idAvanzamentoElaborazione:d,listIdFatt:a,codEnteInternoProtocollo:c.protocolloCodEnteInterno,cfSalvati:null==c.recsCF?"F":"T"},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgShowText("",traduci("MSG_OPERAZIONE_OK")),msgShowWarning(traduci("ATTENZIONE"),traduci("MSG_AVVISO_RACCOMANDAZIONI"))):msgShowError("",a.message);c.aggiornaStorePanelFatture(c.filtroParam)}});Ext.create("winElaborazione",{idElaborazione:d}).start()}else if("FE_STAMPA_XML"==b||"FE_STAMPA_XML_COMPATTA"==
b||"FE_CREA_XML"==b||"FE_SALVA_XML"==b)d=Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.FattElettronicaAttivaAnteprima",dimensione:1,closable:!0,configItem:{idFattTe:a,tipo:b,cFsalvati:null!=c.recsCF,personFe:c.controllerGen.personFe,validaXML:c.controllerGen.cbaConfig.validaXML}}),d.on("close",function(a){"FE_SALVA_XML"==b&&c.aggiornaStorePanelFatture(c.filtroParam)}),"FE_SALVA_XML"!=b&&d.show()},fattModificaStato:function(a,b){var c=this,d=a.get("manuale"),e=a.get("idFattTe");
Ext.Ajax.request({method:"POST",url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/cambiaStato",params:{idFatt:e,xmlImported:d,stato:b},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?msgShowText("",traduci("MSG_OPERAZIONE_OK")):msgShowError("",a.message);c.aggiornaStorePanelFatture(c.filtroParam)}});c.aggiornaStorePanelFatture(c.filtroParam)},initCostanti:function(){this._fattImportedDaContabilizzare=999},onLaunch:function(){this.initCostanti();this.protocolloCodEnteInterno=-1;
this.checkEnableMenu()},gestisciAllegati:function(a){var b=this;a=a.get("idFattTe");a=Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.AllegatiAttiva",titolo:"ALLEGATI_FATTURA",dimensione:3,altezzaWin:400,larghezzaWin:800,configItem:{idFattTe:a,callbackRiapriStore:function(){},callbackAnnulla:function(){}}});a.on("close",function(a){b.aggiornaStorePanelFatture(b.filtroParam)});a.show()},isManuale:function(a,b){b=void 0===b?!1:b;a.get("manuale");var c=!1;"T"!=a.get("manuale")||null!=
a.get("idFattTe")&&!b||(c=!0,Messaggio("FUNZIONE_FASE_SVILUPPO",traduci("FUNZIONE_FASE_SVILUPPO")+" per fatture/xml importate ","OK","ERROR"));999==a.get("stato")&&(c=!0,Messaggio("","Fattura da contabilizzare","OK","ERROR"));return c},openGridStorico:function(a){var b=a.get("ragioneSociale")+" - "+traduci("NUM_DOC")+" "+a.get("numero")+"/"+a.get("registro")+" - "+traduci("DATA")+" "+FormattaData(a.get("data"));a=Ext.create("winCBA",{name:"Generali.fatturazioneElettronica.view.FattElettronicaAttivaGridStorico",
titolo:"STORICO_INVII",dimensione:2,closable:!0,configItem:{permesso:"S",record:a,title:b}});a.on("close",function(a){a.down("grid")});a.show()},checkEnableMenu:function(){var a=this,b={ElabFattElettAttMenu_Crea:!0,ElabFattElettAttMenu_GestioneAll:!0,ElabFattElettAttMenu_ImpostaInvia:!0,ElabFattElettAttMenu_StampaXml:!0,ElabFattElettAttMenu_StampaXmlC:!0,ElabFattElettAttMenu_Storico:!0},c=Object.keys(b),d=c.join();Ext.Ajax.request({method:"GET",url:"/cba/gen/auth/permesso/videata",params:{idModulo:CBA.moduli.moduloAttivo,
idVideata:d},success:function(d){d=Ext.JSON.decode(d.responseText);if(d.success){if((d=d.data)&&d.length==c.length){d=d.split("");for(var e=0;e<d.length;e++)b[c[e]]="V"==d[e]}}else msgShowError("",d.message);a.addShortCut(b)},failure:function(){a.addShortCut(!0)}})},addShortCut:function(a){var b=this;a||(a={ElabFattElettAttMenu_Crea:!0,ElabFattElettAttMenu_GestioneAll:!0,ElabFattElettAttMenu_ImpostaInvia:!0,ElabFattElettAttMenu_StampaXml:!0,ElabFattElettAttMenu_StampaXmlC:!0,ElabFattElettAttMenu_Storico:!0});
var c=Ext.create("Ext.menu.Menu",{items:[{text:traduci("CREA_FILE_XML"),disabled:!a.ElabFattElettAttMenu_Crea,handler:function(a){a=this.up("menu").record;var c=[];c.push(a);b.isManuale(a)||b.gestisciFatture(c,"FE_CREA_XML")}},{text:traduci("GESTIONE_ALLEGATI"),disabled:!a.ElabFattElettAttMenu_GestioneAll,handler:function(){var a=this.up("menu").record;b.isManuale(a,!0)||b.gestisciAllegati(a)}},{itemId:"ModificaStato",disabled:!a.ElabFattElettAttMenu_ImpostaInvia,handler:function(){var a=this.up("menu").record,
c,g=b.filtroParam.statoInvio;2==g?(c=traduci("IMPOSTARE_COME_DA_INVIARE")+"?",g=0):(c=traduci("IMPOSTARE_COME_INVIATA_ALTRO")+"?",g=100);b.isManuale(a)||Messaggio(traduci("FATTURA"),c,"YESNO","QUESTION",null,function(){b.fattModificaStato(a,g)})}},{text:traduci("STAMPA_XML"),disabled:!a.ElabFattElettAttMenu_StampaXml,handler:function(){var a=this.up("menu").record,c=[];c.push(a);b.isManuale(a)||b.gestisciFatture(c,"FE_STAMPA_XML")}},{text:traduci("STAMPA_XML_COMPATTA"),disabled:!a.ElabFattElettAttMenu_StampaXmlC,
handler:function(){var a=this.up("menu").record,c=[];c.push(a);b.isManuale(a)||b.gestisciFatture(c,"FE_STAMPA_XML_COMPATTA")}},{text:traduci("STORICO_INVII"),disabled:!a.ElabFattElettAttMenu_Storico,handler:function(){var a=this.up("menu").record;b.openGridStorico(a,"STORICO_INVII")}}]});c.on("beforeshow",function(a){a=a.record.get("stato");null!=a&&0!=a&&998!=a&&999!=a?c.down("#ModificaStato").setText(traduci("IMPOSTA_COME_DA_INVIARE")):c.down("#ModificaStato").setText(traduci("IMPOSTA_COME_INVIATA_ALTRO"));
c.setDisabled(999==a)});b.getGridFatt().menuShortcut=c}});
Ext.define("Generali.fatturazioneElettronica.controller.FattElettronicaDatiProtocollo",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"codiceFiscale",selector:a+"#codiceFiscale"},{ref:"codiceEnteInterno",selector:a+"#codiceEnteInterno"},{ref:"boxBottoni",selector:a+"#bBoxBottoni"}])},salvaForm:function(a){var b=this.getForm();a=b.getValues();var c=[],d=traduci("PR_DATI_PER_PROTOCOLLO_MANCANTI");
b.codEnteInterno=a.codiceEnteInterno;a.codiceFiscale!=this.codFiscUtente&&Ext.Ajax.request({url:"/cba/gen/ws/general/fatturaElettronica/prot/saveCodFiscUtente",method:"POST",jsonData:a.codiceFiscale.toUpperCase(),async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgAdd(c,a.message),msgShow(d,c)):(msgAdd(c,a.message),msgShowError("",a.message),b.erroreBloccante=!0)},failure:function(a){Ext.JSON.decode(a.responseText)}})},verificaCampiForm:function(){var a=[],b=this.getForm();
b.getValues();b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},esci:function(){this.getForm();this.getBoxBottoni().up("window").close()},gestioneForm:function(){var a=this,b=a.getForm();b.erroreBloccante=!1;b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(c){a.salvaForm(c);b.up("window").close()},annulla_callback:function(){b.erroreBloccante=
!0},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){b.erroreBloccante=!0;a.esci()}}});inserisciBottoni(b.boxBottoni,c,!0,"start");b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnElimina").hide();b.boxBottoni.queryById("btnAnnulla").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},onLaunch:function(){var a=this.getForm(),b=this.getCodiceEnteInterno();b.getStore();this.gestioneForm();
this.recListEnti=this.cbaConfig.recListEnti;this.codFiscUtente=this.cbaConfig.codFiscUtente;""!=this.codFiscUtente&&null!=this.codFiscUtente&&1==ControllaCF(this.codFiscUtente)&&this.getCodiceFiscale().setEditable(!1);if(this.recListEnti&&2>this.recListEnti.length)this.getCodiceEnteInterno().hide(),this.getCodiceEnteInterno().allowBlank=!0;else{var c=Ext.create("Ext.data.Store",{fields:["codice","valore"],data:this.recListEnti});b.store=c}a.getForm().setValues({codiceFiscale:this.codFiscUtente})}});
Ext.define("Generali.fatturazioneElettronica.controller.ForzaScritturaGriglia",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"BtnElabora",selector:this.selContainer+"#BtnElabora"},{ref:"CbxRegistro",selector:this.selContainer+"#CbxRegistro"},{ref:"EdtNumero",selector:this.selContainer+"#EdtNumero"},{ref:"EdtData",selector:this.selContainer+"#EdtData"}]);
this.control(this.selContainer+"#BtnElabora",{click:this.elaboraClick});this.control(this.selContainer+"#BtnEsci",{click:this.esciClick})},elaboraClick:function(a){var b=this;if(!b.getEdtNumero().isValid()||!b.getCbxRegistro().isValid()||!b.getEdtData().isValid())return msgShowError("",traduci("MSG_CAMPI_OBBLIGATORI")),!1;a={numRegistrazione:b.getEdtNumero().getValue(),registro:b.getCbxRegistro().getRawValue(),dataRegistrazione:b.getEdtData().getValue(),sendKtreeConfirm:"T"};if(b.cbaConfig.parametriScrittura)Ext.applyIf(a,
b.cbaConfig.parametriScrittura),Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/fatturaElettronica/fatture/confermaDocumentiGriglia",params:a,timeout:36E5,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgShowText(b.cbaConfig.titolo,a.message),b.esciClick(b.getBtnEsci())):msgShowText(b.cbaConfig.titolo,a.message)}});else return msgShowError("",traduci("NESSUNA_SELEZIONE")),!1},esciClick:function(a){this.cbaConfig.callbackRiapriStore&&this.cbaConfig.callbackRiapriStore();
a.up("window").close()},onLaunch:function(){var a=this.cbaConfig;this.idOrganizzazione=a.idOrganizzazione?a.idOrganizzazione:getIdOrg();this.localSessionId=a.localSessionId;this.getCbxRegistro().getStore().load({params:{tipoDocumento:1,idEsercizio:a.idEsercizio}});this.getEdtNumero().validate();this.getCbxRegistro().validate();this.getEdtData().validate()},destroy:function(){this.callParent()}});
Ext.define("Generali.fatturazioneElettronica.controller.ImportaXml",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this._OK=0;this._WARN=1;this._ERR=2;this.callParent(arguments);this.addRef([{ref:"TabPrincipale",selector:a+"#TabPrincipale"},{ref:"PagePerson",selector:a+"#PagePerson"},{ref:"FormParamGen",selector:a+"#FormParamGen"},{ref:"CkbForceData",selector:a+"#CkbForceData"},{ref:"DataReg",selector:a+"#DataReg"},{ref:"tipoDocumento",selector:a+"#tipoDocumento"},
{ref:"causale",selector:a+"#causale"},{ref:"Registro",selector:a+"#Registro"},{ref:"CkbNumeroDocDaXml",selector:a+"#CkbNumeroDocDaXml"},{ref:"ChkSplitPayment",selector:a+"#ChkSplitPayment"},{ref:"FormInput",selector:a+"#FormInput"},{ref:"BtnSelectFileXml",selector:a+"#BtnSelectFileXml"},{ref:"BtnImportFileXml",selector:a+"#BtnImportFileXml"},{ref:"BtnAnnullaImportFileXml",selector:a+"#BtnAnnullaImportFileXml"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"GridImportFile",selector:a+"#GridImportFile"},
{ref:"ToolBarTitle",selector:a+"#ToolBarTitle"},{ref:"BtnExportResultGrid",selector:a+"#BtnExportResultGrid"}]);this.control(a+"#CkbForceData",{change:this.onCkbForceDataChange});this.control(a+"#DataReg",{change:this.onDatefieldChange});this.control(a+"#tipoDocumento",{change:this.onTipoDocumentoChange});this.control(a+"#cbxConto",{change:this.onContoChange});this.control(a+"#BtnSelectFileXml",{change:this.selectFile});this.control(a+"#BtnImportFileXml",{click:this.importFile});this.control(a+"#BtnAnnullaImportFileXml",
{click:this.annullaImport});this.control(a+"#BtnEsci",{click:this.onClickEsci});this.control(a+"#BtnExportResultGrid",{click:this.onClickExportResultGrid})},onClickEsci:function(){var a=this.getFormInput();this.recordDati?Messaggio("ATTENZIONE","MSG_FORM_DIRTY","YESNO","WARNING",!1,function(){clearForm(a);a.up("window").close()}):(clearForm(a),a.up("window").close())},onClickExportResultGrid:function(){var a=this.getGridImportFile();null==a.store||0==a.store.getCount()?msgShow("","NESSUN_DATO_DA_STAMPARE"):
(a=Ext.create("Generali.standard.EsportaXls",{grid:a,file_name:"ResultGrid "+FormattaData(new Date,"Y-m-d_H.i.s")}),a.esportaXls(),Ext.destroy(a),msgShow("","FINE_ESPORTAZIONE"))},onCkbForceDataChange:function(a,b){this.getDataReg().setDisabled(!b)},onDatefieldChange:function(a,b,c,d){c=this.getFormParamGen().getForm();d=c.findField("tipoDocumento");isValidDate(a)&&(this.gestisciRegistro(c),d.getValue()||d.setValue(1));this.storeConto&&this.loadConto(b)},onTipoDocumentoChange:function(a,b,c,d){d=
this.getFormParamGen().getForm();Ext.isNumber(a.value)&&(b!=c&&null!=c&&(d.findField("registro").clearValue(),d.findField("causale").clearValue()),this.aggiornaStoreCausali(a.value),this.gestisciRegistro(d))},onContoChange:function(a,b,c,d){},loadStoreCausali:function(a){var b=this;b.getFormParamGen().getForm();b.storeCausaleContabilita.load({params:{tipoContabilita:b.personContabili.tipoContabilitaAbilitata,tipoDocOspiti:a?a:b.personContabili.tipoDocumento,idOrganizzazione:getIdOrg()},callback:function(c,
d,e){4==b.personContabili.tipoContabilitaAbilitata&&b.filterCausaliFattura(a);b.impostaCausale(a,b.storeCausaleContabilita.data.items)}})},aggiornaStoreCausali:function(a){0!=this.storeCausaleContabilita.getTotalCount()&&4==this.personContabili.tipoContabilitaAbilitata||this.loadStoreCausali(a)},impostaCausale:function(a,b){var c=this.getFormParamGen().getForm();c.findField("causale").getValue()||b&&1<=b.length&&c.setValues({causale:b[0]});1==a&&Ext.each(b,function(a){"FATTURA CLIENTE"==a.get("valore").toUpperCase()&&
c.setValues({causale:a})})},filterCausaliFattura:function(a){var b=this;b.storeCausaleContabilita.clearFilter();b.storeCausaleContabilita.filter({filterFn:function(c){return"4"==b.personContabili.tipoContabilitaAbilitata?"1"==a||"4"==a?"FV"==c.data.extra.split(",")[1]||"FVS"==c.data.extra.split(",")[1]||"AV"==c.data.extra.split(",")[1]||"AVS"==c.data.extra.split(",")[1]?!0:!1:"2"==a||"5"==a?"A"==c.data.extra.split(",")[2]?!0:!1:"3"==a||"6"==a?"CO"==c.data.extra.split(",")[1]?!0:!1:!0:!0}})},gestisciRegistro:function(a){var b=
this.personContabili.tipoContabilitaAbilitata,c=a.findField("tipoDocumento").getValue(),d=a.findField("data");a=a.findField("registro");1!=b&&2!=c&&5!=c?(a.setVisible(!0),isValidDate(d)&&c&&this.loadRegistro(d.getValue().getFullYear(),c,!1)):a.setVisible(!1);this.personContabili.vediRegistroMan?(a.setReadOnly(!1),a.maxLength=2,a.setEditable(!0),a.cbaConfig.valida=!1,a.forceSelection=!1,a.setHideTrigger(!0)):(a.setEditable(!1),a.setHideTrigger(!1),a.cbaConfig.valida=!0,a.maxLength=Number.MAX_VALUE,
a.forceSelection=!0)},loadRegistro:function(a,b,c){var d=this,e=d.getFormParamGen().getForm();c||(c=d.personContabili.registro?d.personContabili.registro:null);if(3==d.personContabili.tipoContabilitaAbilitata)e.setValues({registro:c}),e.findField("registro").setRawValue(c);else{if(1==d.personContabili.tipoContabilitaAbilitata||2==b||5==b)return!1;var g={};4==d.personContabili.tipoContabilitaAbilitata?(a=(e.findField("tipoDocumento").getValue()-1)%3+1,d.storeRegistro.getProxy().url="/cba/osp/co/ws/genAmmPers/registriIva/detail/cboxByDate",
Ext.apply(g,{dataControllo:e.findField("data").getValue(),tipoDocumento:3==a?a:2,idOrganizzazione:getIdOrg()})):(ImpostaUrl([d.storeRegistro]),Ext.apply(g,{anno:a,tipoDocOspiti:b}));d.storeRegistro.load({params:g,callback:function(){4!=d.personContabili.tipoContabilitaAbilitata||Ext.isNumber(c)||Ext.each(this.data.items,function(a){a.get("valore")==c&&(c=a.get("codice"))});c&&(e.setValues({registro:c}),Ext.isNumber(c)||e.findField("registro").setRawValue(c))}})}},loadConto:function(a){var b=this.getFormParamGen().getForm(),
c={};this.personContabili.idEsercizio=getIdEsercizioByDate(this.idOrganizzazione,null!=a?a:new Date);this.storeConto.getProxy().url="/cba/gen/ws/general/pianoDeiConti/leaf/cbox";Ext.apply(c,{idOrganizzazione:this.idOrganizzazione,idEsercizio:this.personContabili.idEsercizio});this.storeConto.load({params:c,callback:function(a,c,g){0<a.length&&b.setValues({conto:a[0].get("codice")})}})},abilitaBottoniImport:function(a){this.getBtnSelectFileXml().setDisabled(a);this.getBtnAnnullaImportFileXml().setDisabled(!a);
this.getBtnImportFileXml().setDisabled(!a);this.getGridImportFile().setHidden(!a)},annullaImport:function(){this.getBtnSelectFileXml();var a=this.getFormInput(),b=this.getGridImportFile().getStore();delete this.recordDati;clearForm(a);this.abilitaBottoniImport(!1);svuotaStore(b)},selectFile:function(a,b,c){this.getFormInput();b=this.getFormParamGen().getForm();a=b.getFieldValues();b=b.findField("registro");var d=this.getGridImportFile().getStore();delete this.recordDati;a.idRegistro=a.registro;a.registro=
b.getRawValue();a.forceData=a.forceData?"T":"F";a.numDocFromXml=a.numDocFromXml?"T":"F";a.splitPayment=a.splitPayment?"T":"F";var e=new FormData;b=JSON.stringify(a);a=this.getBtnSelectFileXml().fileInputEl;b=new Blob([b],{type:"application/json"});e.append("allegato",b);var g=1,h=0;errors=!1;Ext.each(a.dom.files,function(a){var b="OK",c=a.name.toUpperCase();".XML"!=c.substring(c.length,c.length-4)?(b='ERR - Estensione del file deve essere ".XML", non importo ',errors=!0,h++):0==a.stato?(b="ERR - file vuoto, non importo ",
errors=!0,h++):e.append("fileData",a);a={numero:g++,nomeFile:c,stato:"OK"==b?traduci("DA_IMPORTARE"):traduci("ERRORE"),size:a.size,note:b};d.add(a)});errors&&msgShowWarning("",traduci("MSG_ERRORI_TROVATI")+":"+h);this.recordDati={formData:e};this.abilitaBottoniImport(!0)},updateGridImportFile:function(a){var b=1,c=this.getGridImportFile().getStore();svuotaStore(c);this.getToolBarTitle().setHtml("RISULTATO IMPORT FILE XML");Ext.each(a,function(a){var d=a.motivoRifiutoBreve?a.motivoRifiutoBreve:null,
g=a.fileName;a="T"==a.manuale?traduci(null==d?"IMPORTATO":"IMPORTATO_CON_ANOMALIE"):traduci("SCARTATO");d={numero:b++,nomeFile:g,stato:a,note:d};c.add(d)});clearForm(this.getFormInput());this.recordDati=null;this.getBtnImportFileXml().setDisabled(!0)},importFile:function(){var a=this,b=a.getFormInput(),c=a.recordDati,d=getUrlGen()+"/ws/general/fatturaElettronica/attiva/xml/import";Ext.Ajax.request({url:d,ctrl:a,method:"POST",rawData:c.formData,params:{},async:!1,headers:{"Content-Type":null},success:function(c){c=
Ext.JSON.decode(c.responseText);if(c.success){var d=!1;0==c.data.length?msgShowText("TRASFERIMENTO_FILE","nessuna fattura importata"):Ext.each(c.data,function(a){Ext.isEmpty(a.motivoRifiutoBreve)||(d=!0)});d?(msgShowWarning("TRASFERIMENTO_FILE","Rilevate anomalie verifica note in elenco"),a.updateGridImportFile(c.data)):c.message&&(msgShowText("TRASFERIMENTO_FILE",c.message),b.up("window").close())}else msgShowError("",c.message)},failure:function(b){b=Ext.JSON.decode(b.responseText);msgShowError("",
b.message);a.abilitaBottoniImport(!1)}})},loadData:function(){},onLaunch:function(){var a=this,b="T"==a.cbaConfig.enableImportXml,c=a.getFormParamGen().getForm(),d=c.findField("tipoDocumento"),e=c.findField("idModelloFattura");a.idOrganizzazione=getIdOrg();a.personContabili=getPersonContabili(a.idOrganizzazione,new Date,!0,null);a.getFormParamGen().setDisabled(!b);c.findField("causale").bindStore(Ext.create("Generali.store.CausaleContabilita"));a.storeCausaleContabilita=c.findField("causale").getStore();
c.findField("registro").bindStore(Ext.create("Generali.store.Registro"));a.storeRegistro=c.findField("registro").getStore();d.bindStore(Ext.create("Generali.store.TipoDocRette"));d.getStore().load({params:{},callback:function(b,d,e){d=b[0].data.codice;c.setValues({tipoDocumento:b[0].data.codice});a.aggiornaStoreCausali(d)}});e.bindStore(Ext.create("Generali.store.CboxModelliFattura"));a.storeCboxModelliFattura=e.getStore();e.getStore().load({params:{idOrg:getIdOrg()},callback:function(a,b,d){1<=this.count()&&
c.setValues({idModelloFattura:a[0]})}});c.findField("conto").bindStore(Ext.create("Generali.store.Conto"));a.storeConto=c.findField("conto").getStore();a.loadConto(new Date);a.getDataReg().setValue(new Date);a.loadRegistro(new Date,c.findField("tipoDocumento").getValue(),!1)}});
Ext.define("Generali.fatturazioneElettronica.store.FeAttive",{extend:"Ext.data.Store",fields:[{name:"idFattTe"},{name:"idCodFocl"},{name:"idCodUfficio"},{name:"ragioneSociale"},{name:"pIva"},{name:"tipoDoc"},{name:"data",type:"date"},{name:"numero"},{name:"registro"},{name:"imponibile"},{name:"iva"},{name:"bollo"},{name:"totale"},{name:"cig"},{name:"desCodUfficio"},{name:"stato"},{name:"dataInvio",type:"date"},{name:"eleSiglaServizi"},{name:"completo"},{name:"conAllegati"},{name:"motivoScarto"}],
proxy:{type:"ajax",url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/osp/co/ws/general/fatturaElettronica/attiva/list"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FeAttiveAllegati",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"id_cofatture_te"},{name:"fileName"},{name:"descrizione"},{name:"downloadDate",type:"date"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/list",create:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/save",
update:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/save",destroy:"/cba/osp/co/ws/general/fatturaElettronica/attiva/allegati/delete"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FeAttiveCF",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"codFoCl"},{name:"idCampo"},{name:"idCodIpa"},{name:"valore_predefinito"},{name:"idcampoTe"},{name:"idcampoTeFormat"},{name:"nometagTe"},{name:"idcampoDe"},{name:"idcampoDeFormat"},{name:"versionetracciato"},{name:"nometag"},{name:"tipodato"},{name:"lunghezzamassima"},{name:"obbligatorio"},{name:"flagattivo"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/notcompl",
reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/prszn/feCa/notcompl"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FeAttiveStorico",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"idDocumento"},{name:"partitaIva"},{name:"codiceFiscale"},{name:"ragioneSociale"},{name:"codTipoDocumento"},{name:"dataDocumento",type:"date"},{name:"numDocumento"},{name:"importoDocumento"},{name:"attivaPassiva"},{name:"numRegistrazione"},{name:"dataRegistrazione",type:"date"},{name:"dataImportazione",type:"date"},{name:"dataArrivo",type:"date"},
{name:"accettata"},{name:"dataAccettazione",type:"date"},{name:"rifiutata"},{name:"dataRifiuto",type:"date"},{name:"idUtenteAccRif"},{name:"motivoRifiutoBreve"},{name:"motivoRifiutoEsteso"},{name:"workFlowState"},{name:"selected"},{name:"idUtenteSelected"},{name:"fileName"},{name:"letto"},{name:"visto"},{name:"vistoDa"},{name:"dataVisto",type:"date"},{name:"codUfficio"},{name:"scadenzaDaCondPagamento"},{name:"sdiStatoInviato"},{name:"sdiDataInvioStato",type:"date"},{name:"sdiIdUtenteInvioStato"},
{name:"sdiRispostaStatusCode"},{name:"sdiRispostaMessage"},{name:"descrUtenteAccRif"},{name:"descrUtenteSelected"},{name:"descTipoDocumento"},{name:"modalitaCondPag"},{name:"esisteAllegati"},{name:"ecoDataControllo",type:"date"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:getUrlGen()+"/ws/general/fatturaElettronica/attiva/listHistory"}},a)])},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FePassive",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"idDocumento"},{name:"partitaIva"},{name:"codiceFiscale"},{name:"ragioneSociale"},{name:"codTipoDocumento"},{name:"dataDocumento",type:"date"},{name:"numDocumento"},{name:"importoDocumento"},{name:"attivaPassiva"},{name:"numRegistrazione"},{name:"dataRegistrazione",type:"date"},{name:"dataImportazione",type:"date"},{name:"dataArrivo",type:"date"},{name:"accettata"},
{name:"dataAccettazione",type:"date"},{name:"rifiutata"},{name:"dataRifiuto",type:"date"},{name:"idUtenteAccRif"},{name:"motivoRifiutoBreve"},{name:"motivoRifiutoEsteso"},{name:"workFlowState"},{name:"selected"},{name:"idUtenteSelected"},{name:"fileName"},{name:"letto"},{name:"visto"},{name:"vistoDa"},{name:"dataVisto",type:"date"},{name:"codUfficio"},{name:"scadenzaDaCondPagamento"},{name:"sdiStatoInviato"},{name:"sdiDataInvioStato",type:"date"},{name:"sdiIdUtenteInvioStato"},{name:"sdiRispostaStatusCode"},
{name:"sdiRispostaMessage"},{name:"descrUtenteAccRif"},{name:"descrUtenteSelected"},{name:"descTipoDocumento"},{name:"modalitaCondPag"},{name:"esisteAllegati"},{name:"ecoDataControllo",type:"date"},{name:"nonUtilizzareCigCup"},{name:"clcDataRegistrazione",convert:function(a,b){return a=FormattaData(b.get("dataRegistrazione"))}},{name:"active"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/fatture/listPassive",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/fatture/listPassive",
create:"/cba/gen/ws/general/fatturaElettronica/fatture/insert",update:"/cba/gen/ws/general/fatturaElettronica/fatture/update",destroy:"/cba/gen/ws/general/fatturaElettronica/fatture/delete"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FePassiveAllegati",{extend:"Ext.data.Store",fields:[{name:"filePath"},{name:"realFilePath"},{name:"fileType"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/fatture/allegati/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FePassiveDettagliIva",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idFattura"},{name:"aliquota"},{name:"imponibile"},{name:"imposta"},{name:"esigibilita"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/fatture/righeIva/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.FeProtocollo",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/osp/co/ws/general/fatturaElettronica/prot/getDatiProt",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/osp/co/ws/general/fatturaElettronica/prot/getDatiProt"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.cboxFeCigCup",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/fatturaElettronica/fatture/cigCup/cbox"},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.cboxFeCodIpaByOperatore",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/cboxByOperatore",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.cboxFeFornitori",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/anagrafica/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.store.cboxRaccordoCodiciExt",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/cboxCodiciSipcar",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.fatturazioneElettronica.view.Allegati",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,autoScroll:!0,flex:1,bodyPadding:0,layout:{align:"stretch",type:"hbox"},dockedItems:[{xtype:"toolbar",dock:"top",height:48,items:[{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"CHIUDI"}]}],items:[{xtype:"gridpanel",autoScroll:!0,itemId:"GridAllegati",reference:"GridAllegati",
flex:1,border:0,store:Ext.create("Generali.fatturazioneElettronica.store.FePassiveAllegati",{autoLoad:!1}),hideHeaders:!0,viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",dataIndex:"filePath",flex:1,renderer:function(a){var b=a.split("/");return'<a href="'+a+'" target="_blank">'+b[4]+"</a>"}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.AllegatiAttiva",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,itemId:"EditAllegati",reference:"EditAllegati",layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",title:"DOC_ELENCO",itemId:"Container",reference:"Container",layout:"fit",width:300,items:[{xtype:"gridpanel",autoScroll:!0,itemId:"StoricoGridAllegatiAttiva",reference:"StoricoGridAllegatiAttiva",flex:1,border:0,
store:Ext.create("Generali.fatturazioneElettronica.store.FeAttiveAllegati",{autoLoad:!1}),columns:[{xtype:"gridcolumn",dataIndex:"id",text:"ID",flex:1,hidden:!0},{xtype:"datecolumn",width:80,dataIndex:"downloadDate",text:"DATA",format:"d/m/Y"},{xtype:"gridcolumn",dataIndex:"fileName",text:"FILE",flex:1,renderer:function(a,b,c,d,e,g,h){""==a&&(a=" [ no-file ] ",b.tdCls="labelErrore");return a}},{xtype:"gridcolumn",dataIndex:"id_cofatture_te",flex:1,hidden:!0}]}]},{xtype:"form",autoScroll:!0,border:0,
itemId:"EditDocumentiForm",reference:"EditDocumentiForm",layout:{type:"vbox",align:"stretch"},flex:1,bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",width:450,fieldLabel:"ID",labelClsExtra:"cbaLabel",name:"id",maxLength:100,enforceMaxLength:!0,editable:!1,hidden:!0},{xtype:"textfield",width:450,fieldLabel:"ID_FATT",labelClsExtra:"cbaLabel",name:"id_cofatture_te",maxLength:100,enforceMaxLength:!0,editable:!1,hidden:!0},{xtype:"datefield",fieldLabel:"DATA",width:300,labelAlign:"left",itemId:"DownloadDate",
reference:"DownloadDate",name:"downloadDate",labelClsExtra:"cbaLabel",allowblank:!1},{xtype:"textfield",width:300,fieldLabel:"DESCRIZIONE",itemId:"Descrizione",reference:"Descrizione",labelClsExtra:"cbaLabel",name:"descrizione",maxLength:100,enforceMaxLength:!0},{xtype:"textfield",width:300,fieldLabel:"FILE",labelClsExtra:"cbaLabel",name:"fileName",maxLength:100,enforceMaxLength:!0,editable:!1,disable:!0,hidden:!0},{xtype:"container",layout:{type:"vbox"},items:[{xtype:"image",cls:"cbaLabelLink",height:32,
itemId:"LinkFileAllegato",reference:"LinkFileAllegato",margin:"0 0 5 0",width:32},{xtype:"label",cls:"cbaLabel",itemId:"LabelFileAllegato",reference:"LabelFileAllegato",text:"DOC_ALLEGATO",margin:"0 0 5 0"},{xtype:"form",border:0,itemId:"docFormAllegato",reference:"docFormAllegato",layout:{type:"vbox"},items:[{xtype:"filefield",formBind:!1,cls:"cba-stdbutton-25",itemId:"btnAllegaFile",reference:"btnAllegaFile",fieldLabel:"",hideLabel:!0,name:"f_allegato",buttonConfig:{iconCls:"icon-allegato",width:100,
height:25},buttonOnly:!0,buttonText:traduci("DOC_ALLEGA_FILE"),listeners:{afterrender:function(a){a.fileInputEl.set({accept:StdSipcar.getValidExtensions()})}}}]}]}]},{xtype:"panel",itemId:"boxBottoni",reference:"boxBottoni"}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.DescrizioneRifiuto",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,autoScroll:!0,flex:1,bodyPadding:5,layout:{align:"stretch",type:"hbox"},dockedItems:[{xtype:"toolbar",dock:"top",height:48,items:[{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",
scale:"large",text:"ANNULLA"}]}],items:[{xtype:"textarea",itemId:"TxtTesto",reference:"TxtTesto",maxLength:255,enforceMaxLength:!0,flex:1,grow:!0,anchor:"100%",emptyText:traduci("MSG_AVVISO_RIFIUTO_FATTURE")}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FEProtocollazioneMassiva",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_FATT_ELE",nomeFunzioneDaAttivare:"Fatturazione Elettronica",codiceFunzione:"CP_FATT_ELE",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"stampaCBA",showAnteprima:!1,border:0,itemId:"TabPrincipale",reference:"TabPrincipale",items:[{xtype:"panel",itemId:"PageParametri",reference:"PageParametri",bodyPadding:5,layout:{type:"vbox",
align:"stretch"},tabConfig:{hidden:!0},border:0,flex:1,items:[{xtype:"combobox",itemId:"CBFornitore",reference:"CBFornitore",store:Ext.create("Generali.fatturazioneElettronica.store.cboxFeFornitori",{autoLoad:!1}),fieldLabel:"FORNITORE",labelClsExtra:"cbaLabel",displayField:"valore",valueField:"codice",queryMode:"local",maxWidth:420,listConfig:{tpl:'<tpl for="."><tpl if="extra.split(\',\')[2] == \'F\'"><div class="x-boundlist-item non_attivi">{valore}</div></tpl><tpl if="extra.split(\',\')[2] != \'F\'"><div class="x-boundlist-item">{valore}</div></tpl></tpl>'}},
{xtype:"datefield",itemId:"EdtDtProt",reference:"EdtDtProt",fieldLabel:"DATA_PROTOCOLLO",labelClsExtra:"cbaLabel",maxWidth:250,allowBlank:!1,listeners:{afterrender:function(a){a.validate()}}},{xtype:"fieldset",title:"CERCA_PER",layout:{type:"hbox",align:"stretch"},maxWidth:420,items:[{xtype:"radiogroup",itemId:"RBCercaPer",reference:"RBCercaPer",columns:1,vertical:!0,labelClsExtra:"cbaLabel",cls:"cbaLabel",items:[{boxLabel:"DATA_DOCUMENTO",name:"tipo",inputValue:"1",checked:!0},{boxLabel:"DATA_ARRIVO",
name:"tipo",inputValue:"2",margin:"5 auto auto auto"}]},{xtype:"container",flex:1},{xtype:"container",items:[{xtype:"datefield",itemId:"EdtDtDal",reference:"EdtDtDal",fieldLabel:"DATA_DAL",labelClsExtra:"cbaLabel",width:220,labelWidth:70},{xtype:"datefield",itemId:"EdtDtAl",reference:"EdtDtAl",fieldLabel:"DATA_AL",labelClsExtra:"cbaLabel",width:220,labelWidth:70}]}]}]},{xtype:"panel",itemId:"PageSelezione",reference:"PageSelezione",tabConfig:{hidden:!0},border:0,layout:"fit",items:[{xtype:"CBAShortcutGrid",
itemId:"GridDettaglio",reference:"GridDettaglio",title:traduci("SELEZIONE"),leadingBufferZone:50,trailingBufferZone:50,store:Ext.create("Generali.fatturazioneElettronica.store.FePassive",{proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/fatture/listPassiveNonProtocollate",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/fatture/listPassiveNonProtocollate"}},autoLoad:!1}),selModel:Ext.create("Ext.selection.CheckboxModel",
{checkOnly:!0}),columns:{defaults:{variableRowHeight:!0},items:[{xtype:"gridcolumn",dataIndex:"ragioneSociale",align:"left",text:"RAGIONE_SOCIALE",lockable:!1,sortable:!1,minWidth:350,flex:2},{xtype:"gridcolumn",dataIndex:"partitaIva",align:"left",text:"PARTITA_IVA",lockable:!1,sortable:!1,minWidth:100,flex:1},{xtype:"gridcolumn",dataIndex:"descTipoDocumento",align:"left",text:"TIPO_DOC",lockable:!1,sortable:!1,minWidth:80,flex:1},{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataArrivo",align:"center",
text:"DATA_ARRIVO",lockable:!1,sortable:!1,minWidth:80,flex:.33},{text:"DOCUMENTO",flex:1,minWidth:240,columns:[{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataDocumento",text:"DATA",lockable:!1,sortable:!1,align:"center",minWidth:80,flex:1},{xtype:"gridcolumn",dataIndex:"numDocumento",text:"NUMERO",sortable:!1,align:"right",renderer:cell_renderer_numero,lockable:!1,minWidth:80,flex:1},{xtype:"numbercolumn",dataIndex:"importoDocumento",text:"IMPORTO",lockable:!1,format:"0.00,",sortable:!1,align:"right",
renderer:cell_renderer_importo,minWidth:80,flex:1}]},{xtype:"gridcolumn",width:40,align:"center",sortable:!1,style:"text-align:center",dataIndex:"accettata",text:"ACC",renderer:function(a,c,d){"T"==d.get("accettata")&&(d="<b>Accettata</b><br>da "+Ext.String.htmlEncode(d.get("descrUtenteAccRif"))+" ("+Ext.Date.format(d.get("dataAccettazione"),"d/m/Y")+")",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)}},{xtype:"gridcolumn",width:40,align:"center",sortable:!1,
style:"text-align:center",dataIndex:"rifiutata",text:"RIF",renderer:function(a,c,d){"T"==d.get("rifiutata")&&(d="<b>Rifiutata</b><br>da "+Ext.String.htmlEncode(d.get("descrUtenteAccRif"))+" ("+Ext.Date.format(d.get("dataRifiuto"),"d/m/Y")+")<br><br><i>"+Ext.String.htmlEncode(d.get("motivoRifiutoEsteso"))+"</i>",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)}},{xtype:"gridcolumn",width:40,align:"center",sortable:!1,style:"text-align:center",dataIndex:"visto",
text:"VISTO",renderer:function(a,c,d){"T"==d.get("visto")&&(d="<b>Visto</b><br>da "+Ext.String.htmlEncode(d.get("vistoDa"))+" ("+Ext.Date.format(d.get("dataVisto"),"d/m/Y")+")",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)}},{xtype:"gridcolumn",width:105,align:"center",sortable:!1,style:"text-align:center",dataIndex:"scadenzaDaCondPagamento",text:"SCAD_DA_COND_PAG",renderer:function(a,c){renderCheckColumn(c,a)}}]},viewConfig:{border:0,loadMask:!1,stripeRows:!0,
preserveScrollOnRefresh:!0,forceFit:!1}}]}],listeners:{afterrender:function(a){a.down("#BtnStampa").setVisible(!1);a.down("#BtnAvanti").setVisible(!0);a.down("#BtnIndietro").setVisible(!0);a.down("toolbar").add([{xtype:"button",itemId:"BtnProtocolla",reference:"BtnProtocolla",iconCls:"icon-elabora",scale:"large",hidden:!0,disabled:!0,text:traduci("PROTOCOLLA")}])}},navigaTab:function(b){this.getLayout();var c=[];this.items.each(function(a){c.push(a)});var d=c.indexOf(this.getActiveTab());-1==d&&(d=
0);this.suspenTabChange=!0;b&&("next"==b?d++:d--,this.setActiveTab(c[d]),this.down("#BtnProtocolla").setVisible(d==c.length-1));this.suspenTabChange=!1;-1==d&&(d=0);this.down("#BtnIndietro").setDisabled(0==d);this.down("#BtnAvanti").setDisabled(d==c.length-1);a.controller.fireEvent("afterNaviga")}}]});a.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronica",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_FATT_ELE",nomeFunzioneDaAttivare:"Fatturazione Elettronica",codiceFunzione:"CP_FATT_ELE",initComponent:function(){var a=this;a.altezza=80;a.larghezza=600;Ext.applyIf(a,{items:[{xtype:"tabpanel",border:0,itemId:"Paginatore",reference:"Paginatore",layout:{align:"stretch",type:"vbox"},tabBar:{height:48,items:[{xtype:"tbfill"},{xtype:"toolbar",
border:0,items:[{xtype:"button",itemId:"BtnScaricaNonRegistrate",reference:"BtnScaricaNonRegistrate",iconCls:"icon-change32",scale:"large",text:"SCARICA_DOCUMENTI",tooltip:"SCARICA_NUOVE_FATTURE_NON_REGISTRATE",disabled:!0},{xtype:"filebutton",itemId:"BtnImportaFatture",reference:"BtnImportaFatture",iconCls:"icon-inserisci",scale:"large",text:"IMPORTA_FATTURE",listeners:{afterrender:function(a,c){a.fileInputEl.dom.setAttribute("multiple",!0)}},disabled:!0},{xtype:"button",itemId:"BtnIndietro",reference:"BtnIndietro",
iconCls:"icon-indietro",scale:"large",tooltip:"INDIETRO",disabled:!0},{xtype:"tbspacer",width:10},{xtype:"button",itemId:"BtnAvanti",reference:"BtnAvanti",iconCls:"icon-avanti",tooltip:"AVANTI",scale:"large"},{xtype:"tbspacer",width:10},{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-elabora32",scale:"large",text:"REGISTRA",disabled:!0},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"ANNULLA"}]}]},items:[{xtype:"panel",itemId:"ParametriRicerca",
reference:"ParametriRicerca",bodyPadding:10,border:0,tabConfig:{title:"RICERCA",hidden:!0,height:44},fieldDefaults:{margin:"5 5 5 5"},layout:{type:"vbox"},noModificaDati:!0,nonDisabilitare:!0,trackResetOnLoad:!0,items:[{xtype:"container",padding:0,height:60,width:a.larghezza,margin:5,layout:{type:"vbox",align:"stretch"},fieldDefaults:{margin:"0 5 5 0"},items:[{xtype:"combobox",store:Ext.create("Generali.fatturazioneElettronica.store.cboxFeCodIpaByOperatore",{autoLoad:!1}),itemId:"CbxUfficio",reference:"CbxUfficio",
forceSelection:!1,labelWidth:100,fieldLabel:"COD_IPA",displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel"},{xtype:"combobox",store:Ext.create("Generali.fatturazioneElettronica.store.cboxFeFornitori",{autoLoad:!1}),itemId:"CbxFornitore",reference:"CbxFornitore",minChars:3,forceSelection:!0,labelWidth:100,fieldLabel:"FORNITORE",displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel",listConfig:{tpl:'<tpl for="."><tpl if="extra.split(\',\')[2] == \'F\'"><div class="x-boundlist-item non_attivi">{valore}</div></tpl><tpl if="extra.split(\',\')[2] != \'F\'"><div class="x-boundlist-item">{valore}</div></tpl></tpl>'}}]},
{xtype:"fieldset",title:"RICERCA_PER",padding:5,margin:5,height:90,width:a.larghezza,layout:{type:"hbox",align:"stretch"},fieldDefaults:{margin:"0 5 5 0"},items:[{xtype:"radiogroup",width:220,itemId:"RBCercaPer",reference:"RBCercaPer",columns:1,vertical:!0,labelClsExtra:"cbaLabel",height:35,cls:"cbaLabel",items:[{boxLabel:"DATA_DOCUMENTO",name:"tipo",inputValue:"1"},{boxLabel:"DATA_ARRIVO",name:"tipo",inputValue:"2"}]},{xtype:"container",flex:1,layout:{type:"vbox"},items:[{xtype:"datefield",itemId:"EdtDtDal",
reference:"EdtDtDal",width:170,fieldLabel:"DATA_DAL",labelClsExtra:"cbaLabel",labelWidth:55},{xtype:"datefield",itemId:"EdtDtAl",reference:"EdtDtAl",width:170,fieldLabel:"DATA_AL",labelClsExtra:"cbaLabel",labelWidth:55}]}]},{xtype:"fieldset",title:"STATO",padding:5,margin:5,height:90,width:a.larghezza,layout:{type:"vbox",align:"stretch"},fieldDefaults:{margin:"0 5 5 0"},items:[{xtype:"radiogroup",width:220,columns:2,vertical:!0,itemId:"RBVisitato",reference:"RBVisitato",labelClsExtra:"cbaLabel",height:35,
cls:"cbaLabel",items:[{boxLabel:"TUTTI",name:"visitato",inputValue:"T"},{boxLabel:"SOLO_VISTATI",name:"visitato",inputValue:"V"},{boxLabel:"NON_VISTATI",name:"visitato",inputValue:"N"}]}]},{xtype:"fieldset",title:"VISUALIZZA",padding:5,margin:5,height:130,width:a.larghezza,layout:{type:"vbox",align:"stretch"},fieldDefaults:{margin:"0 5 5 0"},items:[{xtype:"radiogroup",width:220,columns:2,vertical:!0,itemId:"RBStato",reference:"RBStato",labelClsExtra:"cbaLabel",height:35,cls:"cbaLabel",items:[{boxLabel:"DA_REGISTRARE",
name:"stato",inputValue:"D"},{boxLabel:"REGISTRATI",name:"stato",inputValue:"R"},{boxLabel:"RIFIUTATI",name:"stato",inputValue:"F"},{boxLabel:"TUTTI",name:"stato",inputValue:"T"}]},{xtype:"checkboxfield",margin:"30 0 0 5",boxLabel:"MOSTRA_SOLO_AUTOFATTURE",itemId:"ChkSoloAutofatture",reference:"ChkSoloAutofatture",inputValue:"T",uncheckedValue:"F",labelClsExtra:"cbaLabel",cls:"cbaLabel"}]},{xtype:"fieldset",title:"PARAMETRI",itemId:"FsParametri",reference:"FsParametri",padding:5,margin:5,height:60,
width:a.larghezza,layout:{align:"stretch",type:"vbox"},fieldDefaults:{margin:"0 5 5 0"},items:[{xtype:"checkboxfield",boxLabel:"SCADENZA_DA_CONDIZIONE_PAGAMENTO",itemId:"ChkScadPag",reference:"ChkScadPag",inputValue:"T",uncheckedValue:"F",flex:1,labelClsExtra:"cbaLabel",cls:"cbaLabel"}]}]},{xtype:"panel",itemId:"PnlRisultato",reference:"PnlRisultato",border:0,layout:{align:"stretch",type:"vbox"},tabConfig:{title:"SELEZIONE",hidden:!0,height:44},items:[{xtype:"displayfield",itemId:"FsNoCig",reference:"FsNoCig",
labelWidth:400,isFormField:!1,hidden:!0,labelClsExtra:"cbaLabel",renderer:function(a){return'<span style="color:red; font-weight: bold;">'+traduci("ASSENZA_CIG_FATTURA")+"</span>"}},{xtype:"CBAShortcutGrid",flex:1,border:0,autoScroll:"vertical",scrollable:!0,cbaPaged:!0,leadingBufferZone:50,trailingBufferZone:30,itemId:"GridRicerca",reference:"GridRicerca",store:Ext.create("Generali.fatturazioneElettronica.store.FePassive",{autoLoad:!1}),columns:{defaults:{variableRowHeight:!0},items:[{xtype:"checkcolumn",
sortable:!1,dataIndex:"active",itemId:"ChbxSelTutti",reference:"ChbxSelTutti",selectedAll:!1,width:35,listeners:{afterrender:function(a){Ext.create("Ext.container.Container",{items:[{xtype:"checkbox",listeners:{afterrender:function(b){a.checkHeaderCmp=b},change:function(b,d){(a.selectedAll=d)&&a.getView().getStore().each(function(a){return a.set("active",!1)})}}}],renderTo:a.textInnerEl.dom})},checkchange:function(a,c,d,e,g,h){a.selectedAll&&a.checkHeaderCmp.setValue(!1)}}},{xtype:"gridcolumn",dataIndex:"codUfficio",
itemId:"ColCodUfficio",reference:"ColCodUfficio",align:"left",text:"COD_UFFICIO",lockable:!1,sortable:!1,width:80},{xtype:"actioncolumn",itemId:"ColAllegati",reference:"ColAllegati",text:"ALL",width:25,items:[{iconCls:"icon-allegato",isDisabled:function(a,c,d,e,g){return"T"==g.get("esisteAllegati")?!1:!0},handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.mostraAllegati(b.get("id"))},getClass:function(a,c,d,e,g,h){return"T"==d.get("esisteAllegati")?"icon-allegato":"cba-item-hidden"}}]},
{xtype:"gridcolumn",dataIndex:"ragioneSociale",align:"left",text:"RAGIONE_SOCIALE",lockable:!1,sortable:!1,flex:1},{xtype:"gridcolumn",dataIndex:"partitaIva",align:"left",text:"PARTITA_IVA",lockable:!1,sortable:!1,width:100},{xtype:"gridcolumn",dataIndex:"descTipoDocumento",align:"left",text:"TIPO_DOC",lockable:!1,sortable:!1,width:175,renderer:function(a,c,d,e,g,h){return cmp=a+this.rendererShortcutColumn(null,!0)}},{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataArrivo",align:"left",text:"DATA_ARRIVO",
lockable:!1,sortable:!1,width:80},{text:"DOCUMENTO",columns:[{xtype:"datecolumn",format:"d/m/Y",dataIndex:"dataDocumento",text:"DATA",lockable:!1,sortable:!1,width:80,align:"center"},{xtype:"gridcolumn",dataIndex:"numDocumento",text:"NUMERO",sortable:!1,align:"right",renderer:cell_renderer_numero,lockable:!1,width:120},{xtype:"numbercolumn",dataIndex:"importoDocumento",text:"IMPORTO",lockable:!1,format:"0.00,",sortable:!1,align:"right",renderer:cell_renderer_importo,width:80,renderer:function(a,c,
d){0>Ext.util.Format.round(d.get("importoDocumento"),2)&&(c.tdCls="bgOrange");return a=cell_renderer_importo(a,c,d)}}]},{xtype:"gridcolumn",width:40,align:"center",sortable:!1,style:"text-align:center",dataIndex:"accettata",text:"ACC",renderer:function(a,c,d){"T"==d.get("accettata")&&(d="<b>Accettata</b><br>da "+Ext.String.htmlEncode(d.get("descrUtenteAccRif"))+" ("+Ext.Date.format(d.get("dataAccettazione"),"d/m/Y")+")",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,
a)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",checked:!0,inputValue:"T",uncheckedValue:"F",itemId:"CbAccetta",reference:"CbAccetta"}},{text:"RIFIUTO",columns:[{xtype:"gridcolumn",width:40,align:"center",sortable:!1,style:"text-align:center",dataIndex:"rifiutata",text:"RIF",renderer:function(a,c,d){"T"==d.get("rifiutata")&&(d="<b>Rifiutata</b><br>da "+Ext.String.htmlEncode(d.get("descrUtenteAccRif"))+" ("+Ext.Date.format(d.get("dataRifiuto"),"d/m/Y")+")<br><br><i>"+Ext.String.htmlEncode(d.get("motivoRifiutoEsteso"))+
"</i>",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",checked:!0,inputValue:"T",uncheckedValue:"F",itemId:"CbRifiuta",reference:"CbRifiuta"}},{xtype:"actioncolumn",width:40,text:"NOTE",items:[{iconCls:"icon-edit16",isDisabled:function(a,c,d,e,g){return!g.get("rifiutata")||"F"==g.get("rifiutata")},handler:function(b,c,d){b=b.getStore().getAt(c);b.get("rifiutata")&&a.controller.applicaDescrizioneRifiuto(b,
!0)}}]}]},{xtype:"gridcolumn",width:40,align:"center",sortable:!1,style:"text-align:center",dataIndex:"visto",text:"VISTO",renderer:function(a,c,d){"T"==d.get("visto")&&(d="<b>Visto</b><br>da "+Ext.String.htmlEncode(d.get("vistoDa"))+" ("+Ext.Date.format(d.get("dataVisto"),"d/m/Y")+")",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",checked:!0,inputValue:"T",uncheckedValue:"F"}},{xtype:"gridcolumn",
width:105,align:"center",sortable:!1,style:"text-align:center",dataIndex:"scadenzaDaCondPagamento",text:"SCAD_DA_COND_PAG",renderer:function(a,c){renderCheckColumn(c,a)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",checked:!0,inputValue:"T",uncheckedValue:"F"}},{xtype:"gridcolumn",width:70,align:"center",sortable:!1,style:"text-align:center",dataIndex:"ecoControllato",itemId:"CbxControlloOrdini",reference:"CbxControlloOrdini",text:"CONTROLLO_ORDINI",renderer:function(a,c,d){"T"==
d.get("ecoControllato")&&(d="<b>Controllato</b><br>da "+Ext.String.htmlEncode(d.get("ecoControllatoDa"))+" ("+Ext.Date.format(d.get("ecoDataControllo"),"d/m/Y")+")",c.tdAttr='data-qtip="'+d+'"',c.style="text-align:right !important");renderCheckColumn(c,a)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",inputValue:"T",uncheckedValue:"F"}},{xtype:"gridcolumn",width:105,align:"center",sortable:!1,style:"text-align:center",dataIndex:"nonUtilizzareCigCup",text:"NON_UTILIZZARE_CIG_CUP",
renderer:function(b,c,d){var e=d?"T"==d.get("nuovoCigCup"):!1;c.tdStyle+=e?"background-color: #ffc04d":"T"==a.getController().persFe.visuFattNocig?"T"!=d.get("esisteCig")?c.tdStyle="background-color: red":"":"";var g="";e?g="<b>CIG non presente in anagrafica</b><br>":"T"==a.getController().persFe.visuFattNocig&&"T"!=d.get("esisteCig")&&(g="<b>CIG non presente in fattura</b><br>");c.tdAttr='data-qtip="'+g+'"';renderCheckColumn(c,b)},editor:{xtype:"checkboxfield",boxLabelCls:"pudding: 0px!important",
inputValue:"T",uncheckedValue:"F"}}]},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1}),{ptype:"rowexpander",expandOnDblClick:!1,rowBodyTpl:new Ext.XTemplate("<p><b>"+traduci("NUM_REG")+":</b> {numRegistrazione}<br>","\t<b>"+traduci("DATA_REG")+":</b> {clcDataRegistrazione}<br>","</p>")}],viewConfig:{border:0,loadMask:!1,stripeRows:!0,preserveScrollOnRefresh:!0,forceFit:!1,getRowClass:function(a,c){var b="";"F"==a.get("letto")&&(b+="in_grassetto");57!=CBA.moduli.moduloAttivo&&
"T"==a.get("esisteDdt")&&(b+=(Ext.isEmpty(b)?"":" ")+"bgGreenEconomato");return b}},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"displayfield",width:220,labelWidth:70,fieldLabel:"OPERATORE",fieldStyle:"font-weight: bold;",itemId:"FldOperatore",reference:"FldOperatore",labelClsExtra:"cbaLabel"},{xtype:"tbfill"},{xtype:"newButtonStampa",itemId:"BtnStampa",reference:"BtnStampa",text:"ESPORTA",scale:"small",width:85,listeners:{afterrender:function(b){b.setIconCls("icon-xls");a.controller.configurePrintButton(b,
"preview")}}}]}]},{xtype:"panel",height:300,itemId:"PnlAnteprimaFattura",reference:"PnlAnteprimaFattura",split:!0,collapsible:!0,autoScroll:!0,collapseDirection:"bottom",html:"",header:{title:{hidden:!0},items:[{xtype:"button",itemId:"BtnStampaMultipla",reference:"BtnStampaMultipla",text:traduci("STAMPA_SELEZIONATI"),iconCls:"icon-stampa"},{xtype:"title",text:traduci("ANTEPRIMA_FATTURA"),style:"text-align:center",flex:1},{xtype:"radiogroup",columns:0,vertical:!1,itemId:"RgbVersioneAnteprima",reference:"RgbVersioneAnteprima",
items:[{name:"radPreviewType",id:"radPreviewTypeSogei",boxLabel:traduci("VERSIONE_SOGEI"),inputValue:"S",margin:"0 30 0 0",checked:!0},{name:"radPreviewType",id:"radPreviewTypeCompact",boxLabel:traduci("VERSIONE_COMPATTA"),inputValue:"C"}],labelClsExtra:"cbaLabel"}]}}]},{xtype:"panel",tabConfig:{title:"PnlRegistraFattEle",hidden:!0,height:44},itemId:"PnlRegistraFattEle",reference:"PnlRegistraFattEle",border:0,layout:{type:"fit"},cbaConfig:{url:"CP.fatturazioneElettronica.view.RegistrazioneDocumento"}}]}]});
a.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaAttiva",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",border:0,itemId:"CntServizioDisattivato",reference:"CntServizioDisattivato",layout:{align:"stretch",type:"vbox"},title:"",hidden:!0,items:[{xtype:"panel",cls:"pannelloBiancoBordato",margin:3,layout:{align:"stretch",type:"vbox"},height:120,border:0,items:[{xtype:"label",
margin:"30 15 0 15",cls:"cbaLabelDatiUtente",html:traduci("MSG_ATTIVAZIONE_FE"),style:"text-align:center"}]}]},{xtype:"stampaCBA",useNewButtonStampa:!0,border:0,itemId:"TabPrincipale",reference:"TabPrincipale",hidden:!0,items:[{xtype:"panel",itemId:"PageParametri",reference:"PageParametri",tabConfig:{title:"PARAMETRI_GENERALI",height:44},layout:{type:"hbox",align:"stretch"},bodyPadding:5,title:"",items:[{xtype:"container",padding:5,layout:{align:"stretch",type:"vbox"},autoScroll:!0,width:350,items:[{xtype:"fieldset",
margin:"0 0 4 0",title:"CERCA_PER",itemId:"FiltroData",reference:"FiltroData",items:[{xtype:"tabPeriodo",itemId:"TabPeriodo",reference:"TabPeriodo",margin:7}]},{xtype:"fieldset",margin:"0 0 4 0",title:"Tipologia",itemId:"StatoInvio",reference:"StatoInvio",items:[{xtype:"radiogroup",itemId:"StatoInvioCercaPer",reference:"StatoInvioCercaPer",vertical:!0,margin:"0 0 0 5",items:[{formId:this.getItemId()+"-form",boxLabel:"DA_INVIARE",name:"tipoInvio",cls:"cbaLabel",inputValue:1,checked:!0},{formId:this.getItemId()+
"-form",boxLabel:"INVIATE",name:"tipoInvio",cls:"cbaLabel",inputValue:2}]}]},{xtype:"fieldset",margin:"0 0 4 0",title:"Tipo FE",itemId:"TipoFattEle",reference:"TipoFattEle",items:[{xtype:"radiogroup",itemId:"TipoFattEleCercaPer",reference:"TipoFattEleCercaPer",vertical:!0,margin:"0 0 0 5",items:[{formId:this.getItemId()+"-form",boxLabel:"PA/B2B",name:"tipoFattEle",cls:"cbaLabel",inputValue:"PA",checked:!0},{formId:this.getItemId()+"-form",boxLabel:"B2C",name:"tipoFattEle",cls:"cbaLabel",inputValue:"B2C"}]}]},
{xtype:"fieldset",itemId:"TipoDocFattura",reference:"TipoDocFattura",title:"TIPO_DOC_FATTURA",layout:{type:"hbox"},height:50,items:[{xtype:"checkboxfield",itemId:"TipoFattura",reference:"TipoFattura",cls:"cbaLabel",fieldLabel:"",boxLabel:"FATTURA",checked:!0,inputValue:"T",uncheckedValue:"F",valore:1},{xtype:"checkboxfield",itemId:"TipoDocContabile",reference:"TipoDocContabile",cls:"cbaLabel",fieldLabel:"",boxLabel:"DOCUMENTO_CONTABILE",checked:!0,inputValue:"T",uncheckedValue:"F",valore:2,margin:"0 0 0 50"}]},
{xtype:"fieldset",itemId:"TipoDocRettaFatt",reference:"TipoDocRettaFatt",layout:{type:"hbox"},height:35,items:[{xtype:"checkboxfield",itemId:"TipoDocRetta",reference:"TipoDocRetta",cls:"cbaLabel",fieldLabel:"",boxLabel:"RETTE",checked:!0,inputValue:"T",uncheckedValue:"F",margin:"5 0 0 0 ",valore:1},{xtype:"checkboxfield",itemId:"TipoDocFatturaLibera",reference:"TipoDocFatturaLibera",cls:"cbaLabel",fieldLabel:"",boxLabel:"FATTURE_LIBERE",checked:!0,inputValue:"T",uncheckedValue:"F",valore:0,margin:"5 0 0 60"}]},
{xtype:"fieldset",itemId:"DatiFattura",reference:"DatiFattura",title:"DATI_FATTURA",layout:{type:"vbox"},items:[{xtype:"container",itemId:"BoxNumerazione",reference:"BoxNumerazione",layout:{type:"hbox"},items:[{xtype:"combobox",itemId:"Registro",reference:"Registro",labelClsExtra:"cbaLabel",fieldLabel:"REGISTRO",labelAlign:"top",width:130,margin:"0 5 5 5",displayField:"valore",valueField:"codice",queryMode:"local",emptyText:"TUTTI_REGISTRI",store:Ext.create("Generali.store.Registro",{autoLoad:!1})},
{xtype:"numberfield",allowDecimals:!1,fieldLabel:"DAL",itemId:"DalNumero",reference:"DalNumero",labelClsExtra:"cbaLabel",labelWidth:30,width:60,margin:"0 5 5 5",labelAlign:"top"},{xtype:"numberfield",allowDecimals:!1,fieldLabel:"AL",itemId:"AlNumero",reference:"AlNumero",labelClsExtra:"cbaLabel",labelWidth:30,width:60,margin:"0 5 5 5",labelAlign:"top"}]},{xtype:"combobox",itemId:"RagSociale",reference:"RagSociale",fieldLabel:"RAGIONE_SOCIALE",labelClsExtra:"cbaLabel",name:"ricPagante",displayField:"valore",
minChars:3,queryParam:"valore",store:Ext.create("GestioneFatture.store.FattListaPaganti",{autoLoad:!1}),valueField:"codice"},{xtype:"container",itemId:"BoxCampiRicercaInviate",reference:"BoxCampiRicercaInviate",layout:{type:"vbox"},items:[{xtype:"textfield",itemId:"NameXml",reference:"NameXml",fieldLabel:"NOME_FILE_XML",name:"NameXml",flex:1,disabled:!0,enforceMaxLength:!0,maxLength:2E3,labelClsExtra:"cbaLabel"},{xtype:"container",itemId:"StatoRicerca",reference:"StatoRicerca",layout:{type:"hbox"},
items:[{xtype:"checkboxgroup",itemId:"StatoRicercaSx",reference:"StatoRicercaSx",columns:1,disabled:!0,items:[{boxLabel:"DA INVIARE SDI",inputValue:"7,10,99",cls:"cbaLabel",checked:!0},{boxLabel:"SCARTATO_DA_SDI",inputValue:"2",cls:"cbaLabel",checked:!0},{boxLabel:"CONSEGNATO_AL_DESTINATARIO",inputValue:"3,8",cls:"cbaLabel",checked:!0}]},{xtype:"checkboxgroup",itemId:"StatoRicercaDx",reference:"StatoRicercaDx",columns:1,disabled:!0,items:[{boxLabel:"ACCETTATO",inputValue:"4",cls:"cbaLabel",checked:!0},
{boxLabel:"RIFIUTATO",inputValue:"5",cls:"cbaLabel",checked:!0},{boxLabel:"DECORRENZA_DEI_TERMINI",inputValue:"6",cls:"cbaLabel",checked:!0}]}]},{xtype:"checkboxfield",itemId:"AggiornaStato",reference:"AggiornaStato",cls:"cbaLabel",fieldLabel:"",boxLabel:"AGGIORNA_STATI",disabled:!0,checked:!0,inputValue:"T",uncheckedValue:"F",valore:0,margin:"5 0 0 4"}]}]},{xtype:"checkboxfield",itemId:"ValidaXML",reference:"ValidaXML",cls:"cbaLabel",hidden:!0,fieldLabel:"",boxLabel:"VALIDA_XML",checked:!0,inputValue:"T",
uncheckedValue:"F",valore:0,margin:"5 0 0 4"}]},{xtype:"container",padding:5,layout:{type:"hbox",align:"stretch"},width:570,margin:"0 0 0 15",items:[{xtype:"container",layout:{type:"fit"},flex:1,margin:"5 0 10 0",items:[{xtype:"gridpanel",itemId:"CondizionePag",reference:"CondizionePag",disabled:!1,autoScroll:!0,title:"",hidden:!1,store:Ext.create("Generali.store.CondizioniPagamento"),columns:[{xtype:"gridcolumn",dataIndex:"valore",text:"CONDIZIONE_PAGAMENTO",flex:1}],viewConfig:{loadMask:!1},selModel:Ext.create("Ext.selection.CheckboxModel",
{checkOnly:!0})}]},{xtype:"treepanel",flex:2,text:"SERVIZI",margin:"5 0 10 5",itemId:"TreeServiziClass",reference:"TreeServiziClass",rootVisible:!1,useArrows:!0,store:Ext.create("GeneraliOSP.store.Albero",{sorters:[]}),columns:[{xtype:"treecolumn",dataIndex:"text",text:"SERVIZI",flex:1}],viewConfig:{loadMask:!1}}]}]},{xtype:"panel",itemId:"PanelFatture",reference:"PanelFatture",tabConfig:{title:"DOCUMENTI",height:44},layout:{type:"fit"},bodyPadding:5}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaAttivaAnteprima",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",height:300,title:"ANTEPRIMA_FATTURA",itemId:"PnlAnteprimaFatturaAttiva",reference:"PnlAnteprimaFatturaAttiva",split:!0,collapsible:!0,autoScroll:!0,collapseDirection:"bottom",html:""}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaAttivaCF",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",flex:1,title:"FE_CAMPI_AGGIUNTIVI",scrollable:!0,itemId:"GrigliaCampiAggEdit",reference:"GrigliaCampiAggEdit",store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"strRaggFatt"},{name:"id"},{name:"idcodipa"},{name:"idcampoDeFormat"},{name:"nometag"}],groupField:"strRaggFatt"}),collapsible:!0,columns:[{xtype:"gridcolumn",
text:"NUM_FATTURA",dataIndex:"strRaggFatt",hidden:!0},{xtype:"gridcolumn",dataIndex:"id",width:100,hidden:!0},{xtype:"gridcolumn",dataIndex:"idcodipa",width:100,hidden:!0},{xtype:"gridcolumn",dataIndex:"idOrganizzazione",width:100,hidden:!0},{xtype:"gridcolumn",text:"CODICE",dataIndex:"idcampoDeFormat",width:100},{xtype:"gridcolumn",text:"CODICE",dataIndex:"idCampo",width:100,hidden:!0},{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"nometag",width:200},{xtype:"gridcolumn",dataIndex:"valore_predefinito",
text:"Valore",flex:1,width:200,editor:"textfield",renderer:function(a,b,c,d,e,g,h){d="";e=c.get("tipodato");g=c.get("tipoSez");h=c.get("nometag");e&&(d="D"==e?d+traduci("TOOLTIP_FORMATO_FECA_DATA"):"N"==e?d+traduci("TOOLTIP_FORMATO_FECA_NUM"):"S"==e?d+Ext.String.format(traduci("TOOLTIP_FORMATO_FECA_STR"),c.get("lunghezzamassima")):null,"RiferimentoNumeroLinea"==h&&"M"==g&&(d+=traduci("TOOLTIP_FORMATO_FECA_RIFNUMLINEA")),"CodicePagamento"==h&&(d+=" - "+traduci("TOOLTIP_FORMATO_FECA_CODICEPAGAMENTO")),
d&&(b.tdAttr='data-qtip="'+d+'"'));return a}}],features:[Ext.create("Ext.grid.feature.Grouping",{})],hideGroupedHeader:!0,plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfGrid",reference:"BtnConfGrid",iconCls:"icon-conferma",text:"Conferma",disabled:!0},{xtype:"button",itemId:"BtnRiprGrid",reference:"BtnRiprGrid",iconCls:"icon-eliminaGriglia",text:"Annulla",disabled:!0}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaAttivaGridStorico",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"CBAShortcutGrid",viewConfig:{loadMask:!1,enableTextSelection:!0},scrollable:!0,itemId:"GridHistory",reference:"GridHistory",store:Ext.create("Generali.fatturazioneElettronica.store.FeAttiveStorico"),flex:1,columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",
text:traduci("ID")+" "+traduci("CU_DOCUMENTO"),flex:1,dataIndex:"idDocumento",align:"center",renderer:function(a,b,c,d,e,g,h){c=c.get("idDocumentoEi7");""!=c&&null!=c&&(a=c);return a}},{xtype:"gridcolumn",flex:2,text:"FILE",dataIndex:"fileName",align:"center"},{xtype:"datecolumn",text:"DATA_INVIO",flex:1,dataIndex:"dataArrivo",format:"d/m/Y H:i",align:"center"},{xtype:"gridcolumn",text:"STATO",flex:2,dataIndex:"workFlowState",align:"center"},{xtype:"gridcolumn",flex:4,text:traduci("MOTIVO")+" "+traduci("RIFIUTO"),
dataIndex:"motivoRifiutoEsteso",align:"left"}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaAttivaGriglia",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"CBAShortcutGrid",viewConfig:{loadMask:!1,enableTextSelection:!0,getRowClass:function(a,b){return 999==a.get("stato")?"non_attivi":""}},title:"Griglia Fatture",scrollable:!0,itemId:"GridFatt",reference:"GridFatt",store:Ext.create("Generali.fatturazioneElettronica.store.FeAttive"),
flex:1,selModel:Ext.create("Ext.selection.CheckboxModel",{checkOnly:!0}),features:[{ftype:"summary",dock:"bottom"}],columns:[{xtype:"gridcolumn",text:"",width:10,dataIndex:"checkboxRow",sortable:!1},{xtype:"actioncolumn",text:"ALL",width:30,items:[{getClass:function(a,b,c){if("T"==c.get("conAllegati"))return"icon-attachment"},handler:function(a,b,c){c=a.up().up().controller;var d=a.getStore().getAt(b);"T"==a.getStore().getAt(b).get("conAllegati")&&c.gestisciAllegati(d)}}],sortable:!1},{xtype:"gridcolumn",
flex:2,text:"RAGIONE_SOCIALE",dataIndex:"ragioneSociale",align:"center",renderer:function(a,b,c,d,e,g,h){c=c.get("nomeFileXML");b.style="text-align:left !important";""!=c&&null!=c&&(a+="<BR><em>"+c+"</em>");return a+" "+this.rendererShortcutColumn()}},{xtype:"gridcolumn",flex:1,itemId:"PivaCf",reference:"PivaCf",text:"PIVA",dataIndex:"pIva",align:"center"},{xtype:"gridcolumn",flex:1,text:"TIPO_DOCUMENTO",dataIndex:"tipoDoc",align:"center",renderer:function(a,b,c,d,e,g,h){c=c.get("nomeFileXML");b.style=
"text-align:left !important";""!=c&&null!=c&&(b.tdAttr='data-qtip="'+c+'"');return a}},{xtype:"gridcolumn",flex:5,text:"Documento",columns:[{xtype:"datecolumn",text:"DATA",flex:1,dataIndex:"data",format:"d/m/Y",align:"center",summaryRenderer:function(a,b){var c;c=this.up("grid").getStore().count();c="N "+traduci("DOCUMENTI")+": "+c;return'<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>'.replace("[STRDASOSTITUIRE]",c)}},{xtype:"gridcolumn",text:"NUMERO",flex:1,dataIndex:"numero",
renderer:function(a,b,c,d,e,g,h){a=c.get("numero");null!=c.get("registro")&&""!=c.get("registro")&&(a+="/"+c.get("registro"));b.style="text-align:right !important";return a},align:"center",summaryRenderer:function(a,b){return'<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>'.replace("[STRDASOSTITUIRE]",traduci("TOTALI")+":")}},{xtype:"numbercolumn",flex:1,align:"center",dataIndex:"imponibile",text:"IMPONIBILE",summaryType:"sum",renderer:cell_renderer_importo,summaryRenderer:function(a,
b){return'<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>'.replace("[STRDASOSTITUIRE]",cell_renderer_importo(a,b))}},{xtype:"numbercolumn",flex:1,text:"IVA",dataIndex:"iva",align:"center",summaryType:"sum",renderer:cell_renderer_importo,summaryRenderer:function(a,b){return'<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>'.replace("[STRDASOSTITUIRE]",cell_renderer_importo(a,b))}},{xtype:"numbercolumn",flex:1,text:"BOLLO",dataIndex:"bollo",align:"center",
summaryType:"sum",renderer:cell_renderer_importo,summaryRenderer:function(a,b){var c,d='<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>',e=0;this.up("grid").getStore().each(function(a){0<a.get("bollo")&&e++});d='<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>';c="("+e+") "+cell_renderer_importo(a,b);return d.replace("[STRDASOSTITUIRE]",c)}},{xtype:"numbercolumn",flex:1,text:"TOTALE",dataIndex:"totale",align:"center",summaryType:"sum",renderer:cell_renderer_importo,
summaryRenderer:function(a,b){return'<div class="cbaGrassetto" style= "text-align: right">[STRDASOSTITUIRE]</div>'.replace("[STRDASOSTITUIRE]",cell_renderer_importo(a,b))}}]},{xtype:"gridcolumn",flex:1,text:"SERVIZI",dataIndex:"eleSiglaServizi",align:"center"},{xtype:"gridcolumn",flex:1,text:"CIG",dataIndex:"cig",align:"center"},{xtype:"gridcolumn",flex:1,text:"CODICE_UFFICIO",dataIndex:"desCodUfficio",align:"center"},{xtype:"gridcolumn",flex:2,text:"INVIO",itemId:"fieldsInvio",reference:"fieldsInvio",
hidden:!0,columns:[{xtype:"datecolumn",text:"DATA",flex:1,dataIndex:"dataInvio",format:"d/m/Y H:i",align:"center"},{xtype:"gridcolumn",text:"STATO",flex:1,dataIndex:"stato",align:"center",renderer:function(a,b,c,d,e,g,h){e=d="";c=c.get("motivoScarto");""!=c&&null!=c&&(b.tdAttr='data-qtip="'+c+'"',"Consegnato all'Agenzia delle Entrate"!=a&&(d="color:red;"),e='<img src= "" style="border:0; !important; margin-top:2px; margin-left:2px;" class="icon-info"></img> ');b.style=d+"text-align:left !important";
return e+a}}]},{xtype:"gridcolumn",text:"COMPLETA_temporaneo",dataIndex:"completa",hidden:!0},{xtype:"gridcolumn",text:"IDCODUFF_temporaneo",dataIndex:"idCodUfficio",hidden:!0}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"cercaGrid",cbaConfig:{searchField:"nomeFileXML",ricercaIniziaPer:!0}},{xtype:"tbfill"},{xtype:"button",itemId:"BtnImportaXml",reference:"BtnImportaXml",nonDisabilitare:!0,width:125,iconCls:"icon-xml",scale:"small",text:"IMPORTA_XML"},{xtype:"button",itemId:"BtnStampaGriglia",
reference:"BtnStampaGriglia",nonDisabilitare:!0,width:125,iconCls:"icon-stampa32",scale:"small",text:"ESPORTA"}]},{xtype:"toolbar",dock:"bottom",items:[{xtype:"container",layout:{type:"vbox"},items:[{xtype:"panel",height:20,width:300,layout:{type:"hbox",pack:"middle"},items:[{xtype:"label",text:"TOTALE_DOCUMENTI",flex:1},{xtype:"label",width:120,itemId:"LblTotaleFA",reference:"LblTotaleFA",style:{"text-align":"right"}}]},{xtype:"panel",height:20,width:300,layout:{type:"hbox",pack:"middle"},items:[{xtype:"label",
text:"SCELTO",itemId:"LblSceltoFA",reference:"LblSceltoFA",flex:1},{xtype:"label",itemId:"LblSceltoImpFA",reference:"LblSceltoImpFA",width:120,style:{"font-weight":"bold","text-align":"right"}}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.FattElettronicaDatiProtocollo",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"form",flex:1,border:0,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",width:320,validator:function(a){return ControllaCF(a)},fieldLabel:traduci("CODICE_FISCALE")+" "+traduci("UTENTE")+
" ("+CBA.parametriGenerali.nomeUtente+")",name:"codiceFiscale",itemId:"codiceFiscale",reference:"codiceFiscale",maxLength:16,enforceMaxLength:!0,allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"combobox",width:320,margin:"10 0 0 0",valueField:"codice",displayField:"valore",queryMode:"local",fieldLabel:"PR_CODICE_ENTE_INTERNO",itemId:"codiceEnteInterno",reference:"codiceEnteInterno",name:"codiceEnteInterno",emptyText:"PR_CODICE_ENTE_INTERNO",allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"container",
itemId:"boxBottoni",reference:"boxBottoni"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.ForzaScritturaGriglia",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,autoScroll:!0,flex:1,bodyPadding:10,layout:{align:"stretch",type:"hbox"},dockedItems:[{xtype:"toolbar",dock:"top",height:48,items:[{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",
scale:"large",text:"ANNULLA"}]}],items:[{xtype:"fieldset",title:"INFORMAZIONI_REGISTRAZIONE",flex:1,items:[{xtype:"combobox",itemId:"CbxRegistro",reference:"CbxRegistro",fieldLabel:"REGISTRO",displayField:"registro",queryMode:"local",valueField:"id",labelWidth:70,width:200,allowBlank:!1,store:Ext.create("GeneraliAM.store.SelezionaAttivita",{autoLoad:!1,sorters:[{property:"registro",direction:"ASC"}]}),listeners:{afterrender:function(a){a.focus(!1,1E3)}}},{xtype:"textfield",itemId:"EdtNumero",reference:"EdtNumero",
width:200,labelWidth:70,allowBlank:!1,fieldLabel:"NUMERO"},{xtype:"datefield",itemId:"EdtData",reference:"EdtData",width:200,labelWidth:70,allowBlank:!1,fieldLabel:"DATA"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.fatturazioneElettronica.view.ImportaXml",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_XMLFE_IMPORT",nomeFunzioneDaAttivare:"CU_XMLFE_IMPORT",codiceFunzione:"CU_XMLFE_IMPORT",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"form",itemId:"FormParamGen",reference:"FormParamGen",border:0,flex:1,margin:"5 0 0 5",
trackResetOnLoad:!0,items:[{xtype:"fieldset",margin:"0 0 4 0",title:"PERSON_FATTURE",itemId:"StatoInvio",reference:"StatoInvio",items:[{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"container",layout:{type:"vbox"},items:[{xtype:"checkboxfield",itemId:"CkbForceData",reference:"CkbForceData",cls:"cbaLabel",name:"forceData",fieldLabel:"",boxLabel:"FORZA_DATA",checked:!0,inputValue:"T",uncheckedValue:"F",valore:0},{xtype:"datefield",width:105,itemId:"DataReg",reference:"DataReg",
labelAlign:"top",labelClsExtra:"cbaLabel",name:"data",allowBlank:!1}]},{xtype:"checkboxfield",itemId:"CkbNumeroDocDaXml",reference:"CkbNumeroDocDaXml",cls:"cbaLabel",name:"numDocFromXml",fieldLabel:"",boxLabel:"USA_NUMDOC_XML",checked:!1,inputValue:"T",uncheckedValue:"F",valore:0},{xtype:"checkboxfield",margin:"0 0 0 5",itemId:"ChkSplitPayment",reference:"ChkSplitPayment",cls:"cbaLabel",name:"splitPayment",fieldLabel:"",boxLabel:"SPLIT_PAYMENT",inputValue:"T",uncheckedValue:"F"}]},{xtype:"container",
flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"combobox",margin:0,width:300,fieldLabel:"TIPO_DOCUMENTO",itemId:"tipoDocumento",reference:"tipoDocumento",labelAlign:"top",forceSelection:!1,labelClsExtra:"cbaLabel",labelPad:2,name:"tipoDocumento",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"combobox",flex:1,padding:"0 0 0 5",fieldLabel:"CAUSALE",itemId:"causale",reference:"causale",labelAlign:"top",forceSelection:!1,labelClsExtra:"cbaLabel",labelPad:2,
name:"causale",allowBlank:!1,displayField:"valore",queryMode:"local",valueField:"codice"}]},{xtype:"container",margin:"5 0 5 0",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"combobox",itemId:"idModelloFattura",reference:"idModelloFattura",width:300,forceSelection:!1,fieldLabel:"MODELLO_FATTURA",labelAlign:"top",labelClsExtra:"cbaLabel",name:"idModelloFattura",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"combobox",itemId:"registro",reference:"registro",width:70,
margin:"0 0 0 5",fieldLabel:"REGISTRO",forceSelection:!1,labelAlign:"top",labelClsExtra:"cbaLabel",name:"registro",editable:!1,displayField:"valore",queryMode:"local",valueField:"codice",listeners:{change:{fn:this.onRegistroChange,scope:this}}}]}]},{xtype:"fieldset",margin:"10 0 4 0",title:"PERSON_FATTURE_DETTAGLIO",items:[{xtype:"combobox",itemId:"cbxConto",reference:"cbxConto",width:500,margin:"0 0 5 5",fieldLabel:"CONTO",forceSelection:!1,labelAlign:"top",labelClsExtra:"cbaLabel",name:"conto",
editable:!1,displayField:"valore",queryMode:"local",valueField:"codice",listeners:{change:{fn:this.onContoChange,scope:this}}},{xtype:"cda",annoData:"annoCda",labelWidth:100,flex:1,margin:"0 0 5 5",hideCodice:!0,showDesCda:!0,hideAnno:!1,itemId:"cntCda",reference:"cntCda",cbaConfig:{tipoContabilita:4}}]}]},{xtype:"container",margin:10,width:130,layout:{type:"vbox"},items:[{xtype:"form",border:0,width:125,layout:"hbox",itemId:"FormInput",reference:"FormInput",layout:{type:"vbox"},trackResetOnLoad:!0,
items:[{xtype:"filefield",itemId:"BtnSelectFileXml",reference:"BtnSelectFileXml",id:"BtnSelectFileXml",baseCls:"cba-button-25",buttonOnly:!0,formBind:!1,width:125,multiple:!0,name:"f_allegato",buttonConfig:{xtype:"filebutton",cls:"cba-button-25",width:125,alwaysOnTop:!0,text:traduci("SELEZIONA_FILE"),iconCls:"icon-xml"},listeners:{change:{fn:this.importFile,scope:this},afterrender:function(a,b){if(fileButton=a.button.fileInputEl)fileButton.dom.multiple=!0}}}]},{xtype:"button",itemId:"BtnImportFileXml",
reference:"BtnImportFileXml",width:125,iconCls:"icon-upload",scale:"small",text:"IMPORTA_XML",disabled:!0},{xtype:"button",margin:"2 0 0 0",itemId:"BtnAnnullaImportFileXml",reference:"BtnAnnullaImportFileXml",width:125,iconCls:"icon-elimina",scale:"small",text:"RIPRISTINA",hidden:!0,disabled:!0},{xtype:"button",margin:"2 0 0 0",itemId:"BtnEsci",reference:"BtnEsci",width:125,iconCls:"icon-esciGriglia",text:"ESCI",scale:"small"}]}]},{xtype:"CBAShortcutGrid",hidden:!0,viewConfig:{loadMask:!1,enableTextSelection:!0},
scrollable:!0,itemId:"GridImportFile",reference:"GridImportFile",flex:1,store:Ext.create("Ext.data.Store",{fields:["numero","nomeFile","size"]}),columns:[{xtype:"gridcolumn",width:40,text:"N",dataIndex:"numero",align:"right"},{xtype:"gridcolumn",flex:1,text:"FILE",dataIndex:"nomeFile",align:"left"},{xtype:"gridcolumn",width:100,text:"STATO",dataIndex:"stato",align:"center",renderer:function(a,b,c,d,e,g,h){if(a==traduci("IMPORTATO")||a==traduci("DA_IMPORTARE"))c="color:green;";else if(a==traduci("IMPORTATO_CON_ANOMALIE"))c=
"color:orange;";else if(a==traduci("SCARTATO")||a==traduci("ERRORE"))c="color:red;";else return a;b.tdAttr='data-qtip="'+a.toUpperCase()+'"';b.style=c+"text-align:center !important";return a.toUpperCase()}},{xtype:"gridcolumn",flex:1,text:"NOTE",dataIndex:"note",align:"left",renderer:function(a,b,c,d,e,g,h){if(c.stato==traduci("IMPORTATO")||c.stato==traduci("DA_IMPORTARE"))c="color:green;";else if(c.stato==traduci("IMPORTATO_CON_ANOMALIE"))c="color:orange;";else if(c.stato==traduci("SCARTATO")||c.stato==
traduci("ERRORE"))c="color:red;";else return a;"OK"!=a?b.tdAttr='data-qtip="'+(null==a?"ERR - generico":a)+'"':c="color:green;";b.style=c+"text-align:left !important";return a}}],dockedItems:[{xtype:"toolbar",dock:"top",cls:"baseBgColor",height:36,items:[{xtype:"tbfill"},{xtype:"label",itemId:"ToolBarTitle",reference:"ToolBarTitle",html:traduci("ELENCO_FILE_PREVERIFICA"),cls:"cbaLabel"},{xtype:"tbfill"},{xtype:"button",itemId:"BtnExportResultGrid",reference:"BtnExportResultGrid",width:75,iconCls:"icon-xls16",
scale:"small",text:"ESPORTA"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestBckBackup.controller.GestioneBackup",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Grid",selector:this.selContainer+"#Grid"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnAnnulla",selector:this.selContainer+"#BtnAnnulla"},{ref:"BtnDetails",selector:this.selContainer+"#BtnDetails"},{ref:"Form",selector:this.selContainer+
"#Form"},{ref:"BtnChiudi",selector:this.selContainer+"#BtnChiudi"},{ref:"BtnSalva",selector:this.selContainer+"#BtnSalva"},{ref:"CbEnteBck",selector:this.selContainer+"#CbEnteBck"},{ref:"ChkDb",selector:this.selContainer+"#ChkDb"}]);this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnAnnulla",{click:this.clickBtnAnnulla});this.control(this.selContainer+"#BtnDetails",{click:this.clickBtnDetails});this.control(this.selContainer+"#BtnChiudi",{click:this.clickBtnChiudi});
this.control(this.selContainer+"#BtnSalva",{click:this.clickBtnSalva});this.control(this.selContainer+"#Grid",{select:this.selectGrid})},selectGrid:function(a,b){this.getBtnAnnulla().setDisabled("START"!==b.get("stato")&&"PROGRESS"!==b.get("stato"))},clickBtnDetails:function(a){var b=(a=this.getGrid().getSelectionModel().getSelection()[0])?a.get("traceLog"):"";Ext.create("Ext.window.Window",{title:"Log backup ID: "+a.get("id"),height:600,width:1E3,layout:"fit",items:{xtype:"panel",border:!1,html:b.replace(/\n/g,
"<br/>"),renderTo:Ext.getBody()}}).show()},clickBtnNuovo:function(a){var b=this;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/bckbackup/test-graph-api-connection",params:{},success:function(a){Ext.JSON.decode(a.responseText).success?(b.getGrid().hide(),b.getForm().show()):(b.getBtnNuovo().setDisabled(!0),msgShowError("","Impossibile collegarsi alle API per l'upload dei backup"))}})},clickBtnChiudi:function(a){this.getForm().hide();this.getGrid().show()},clickBtnSalva:function(a){a=this.getForm();
var b=a.getForm().getFieldValues(),c=[];this.getChkDb().getChecked().forEach(function(a){c.push(a.inputValue)});var d=b.destinatari.split(";");Ext.apply(b,{idOrganizzazione:getIdOrg(),codEnte:parseInt(b.codEnte),databases:c,destinatari:d});this.getForm().hide();this.getGrid().show();controller_salvaRecord(a,b)},clickBtnAnnulla:function(a){var b=this;a=b.getGrid();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{idBckBackup:c?c.get("id"):"",codEnte:c?c.get("codEnte"):
""},function(){b.aggiornaStore(c?c.get("id"):"")})},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnAnnulla().setDisabled(!a)},aggiornaStore:function(a){var b=this.getGrid(),c=b.getStore();c.load({callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},setChkdbItems:function(a){var b=this.getChkDb();b.removeAll();Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/enti/get",
params:{id:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(a=a.data,b.add({xtype:"checkbox",boxLabel:"Password",name:"databases",inputValue:"DBPASSWORD"}),null!=a.cbaDatiIb&&""!=a.cbaDatiIb&&b.add({xtype:"checkbox",boxLabel:"Dati",name:"databases",inputValue:"CBADATIIB"}),null!=a.cbaOspitiIb&&""!=a.cbaOspitiIb&&b.add({xtype:"checkbox",boxLabel:"Ospiti",name:"databases",inputValue:"CBAOSPITIB"}),null!=a.cbaEconIb&&""!=a.cbaEconIb&&b.add({xtype:"checkbox",boxLabel:"Economato",name:"databases",
inputValue:"CBAECONIB"}),null!=a.cbaPagheIb&&""!=a.cbaPagheIb&&b.add({xtype:"checkbox",boxLabel:"Paghe",name:"databases",inputValue:"CBAPAGHEIB"}),null!=a.cbaAllegati&&""!=a.cbaAllegati&&b.add({xtype:"checkbox",boxLabel:"Allegati",name:"databases",inputValue:"CBAALLEGATI"}),null!=a.cbaTerapie&&""!=a.cbaTerapie&&b.add({xtype:"checkbox",boxLabel:"Terapie",name:"databases",inputValue:"CBATERAPIE"}),null!=a.dbFarmaci&&""!=a.dbFarmaci&&b.add({xtype:"checkbox",boxLabel:"Farmaci",name:"databases",inputValue:"DBFARMACI"}),
null!=a.cbaFeAllegati&&""!=a.cbaFeAllegati&&b.add({xtype:"checkbox",boxLabel:"Fe Allegati",name:"databases",inputValue:"CBAFEALLEGATI"})):msgShowError("",a.message)}})},onLaunch:function(){var a=this,b=a.getCbEnteBck();b.on("change",function(){a.setChkdbItems(this.getValue())});var c=b.getStore();c.load({callback:function(a,d,h){h?b.setValue(c.getAt("0").get("codice")):msgShowError("",d.getError())}});a.getGrid().controller=a;a.aggiornaStore();var d=new Ext.util.TaskRunner;a.task=d.newTask({run:function(){var b=
a.getGrid().getSelectionModel().getSelection()[0];a.aggiornaStore(b?b.get("id"):"")},interval:1E4});a.task.start()},destroy:function(){this.task.destroy();this.callParent()}});
Ext.define("Generali.gestBckBackup.store.GestioneBackup",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idThread"},{name:"codEnte"},{name:"ente"},{name:"databases"},{name:"destinatariNotifica"},{name:"percentualeCompletamento"},{name:"stato"},{name:"descrizioneStato"},{name:"oraInizio"},{name:"oraFine"}],proxy:{type:"ajax",url:"/cba/gen/ws/bckbackup/getall",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/bckbackup/getall",create:"/cba/gen/ws/bckbackup/new",
destroy:"/cba/gen/ws/bckbackup/cancel"}},autoDestroy:!0});
Ext.define("Generali.gestBckBackup.view.GestioneBackup",{extend:"Generali.standard.ControlledContainer",uses:["Generali.gestBckBackup.store.GestioneBackup"],initComponent:function(){var a=this;a.labelSolalettura=traduci("SOLA_LETTURA");a.labelDettagli=traduci("CLICK_VEDI_DET");Ext.applyIf(a,{items:[{xtype:"panel",border:0,layout:"fit",items:[{xtype:"gridpanel",itemId:"Grid",reference:"Grid",store:Ext.create("Generali.gestBckBackup.store.GestioneBackup"),columns:[{xtype:"gridcolumn",width:20,renderer:function(b,
c,d,e,g,h,k){"START"!==d.get("stato")&&"PROGRESS"!==d.get("stato")&&(c.tdCls="icon-solalettura16",c.tdAttr='data-qtip="'+a.labelSolalettura+'"')}},{xtype:"gridcolumn",text:"ID",dataIndex:"id",width:50},{xtype:"gridcolumn",text:"ENTE",dataIndex:"ente",flex:1},{xtype:"gridcolumn",text:"PERCENTUALE_COMPLETAMENTO",dataIndex:"percentualeCompletamento"},{xtype:"gridcolumn",text:"STATO",dataIndex:"descrizioneStato"},{xtype:"gridcolumn",text:"ORA_INIZIO",dataIndex:"oraInizio",width:120},{xtype:"gridcolumn",
text:"ORA_FINE",dataIndex:"oraFine",width:120}],viewConfig:{width:200,loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnAnnulla",reference:"BtnAnnulla",iconCls:"icon-eliminaGrtiglia",text:"Annulla"},{xtype:"button",itemId:"BtnDetails",reference:"BtnDetails",iconCls:"icon-search",text:"Vedi Log"}]}]},{xtype:"form",border:0,itemId:"Form",reference:"Form",store:Ext.create("Generali.gestBckBackup.store.GestioneBackup"),
hidden:!0,layout:{type:"vbox"},padding:"20 20 20 20",bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"combobox",itemId:"CbEnteBck",reference:"CbEnteBck",name:"codEnte",fieldLabel:"ENTE",hideLabel:!1,displayField:"valore",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.Enti"),valueField:"codice",allowBlank:!1},{xtype:"checkboxgroup",itemId:"ChkDb",reference:"ChkDb",fieldLabel:"DATABASES",columns:1,vertical:!0},{xtype:"textfield",fieldLabel:"DESTINATARI",name:"destinatari",value:"CANALE",
hidden:!0},{xtype:"textfield",fieldLabel:"ORGANIZZAZIONE",name:"idOrganizzazione",value:"",hidden:!0},{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnSalva",reference:"BtnSalva",iconCls:"icon-inserisciGriglia",text:"Avvia"},{xtype:"button",itemId:"BtnChiudi",reference:"BtnChiudi",iconCls:"icon-eliminaGriglia",text:"Annulla"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:500}]}]});a.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.controller.AggiornaPassword",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnAnnulla",selector:a+"#BtnAnnulla"},{ref:"TxtNuovaPwd",selector:a+"#TxtNuovaPwd"},{ref:"TxtConfermaNuovaPwd",selector:a+"#TxtConfermaNuovaPwd"},{ref:"ContainerMex",selector:a+"#ContainerMex"}]);this.control(a+"#BtnConferma",
{click:this.onClickBtnConferma});this.control(a+"#BtnAnnulla",{click:this.onClickBtnAnnulla});this.control(a+"#TxtConfermaNuovaPwd",{specialkey:this.onTxtConfermaSpecialkey})},onClickBtnConferma:function(){this.cambioPwd()},cambioPwd:function(){if(!0===this.controllaCampi())this.salvaForm();else return!1},onClickBtnAnnulla:function(){clearForm(this.getForm())},controllaCampi:function(){var a=[],b=this.getTxtNuovaPwd(),c=this.getTxtConfermaNuovaPwd();this.getForm();b.getValue()!=c.getValue()?msgAddError(a,
"CHECK_NEWPWD"):(b=validatePassword(c.getValue()))&&msgAddError(a,b);return msgShow("",a)},salvaForm:function(){var a=this,b=a.getForm();newRecord=b.getForm().getFieldValues();Ext.apply(newRecord,{codUtente:a.cbaConfig.codUtente});delete newRecord.pwdTemp;Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/utentipwd/updatepwd",jsonData:Ext.JSON.encode(newRecord),writer:{type:"json"},success:function(c){c=Ext.JSON.decode(c.responseText);var d=[];c.success?(msgAdd(d,c.message),a.cbaConfig.esitoPwd=
!0,b.up("window").close(),msgShow("MSG_SALVATAGGIO_DATI",d)):msgShowError("ATTENZIONE",c.message)}})},onTxtConfermaSpecialkey:function(a,b,c){b.getKey()==Ext.event.Event.ENTER&&this.cambioPwd()},gestioneForm:function(){var a=this.getForm();a.controller=this;a.permesso="S"},onLaunch:function(){this.gestioneForm();var a=this.getContainerMex(),b=this.cbaConfig.dataAttivazionePwd;a.setHtml("<p align='center'>"+traduci("DATA_MOD_PWD")+" "+FormattaData(b)+"</p>");CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione&&
(this.getTxtNuovaPwd().minLength=10,this.getTxtConfermaNuovaPwd().minLength=10)},destroy:function(){eliminaStore(this.storeImpostazioni);this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ComunicazioniServ",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.control(this.selContainer+"#GridComunicazioni",{select:this.onSelectComunicazione})},aggiornaForm:function(a){if(!a)return!1;var b=this.lookup("Form");clearForm(b);b.store.load({params:{id:a},callback:function(a,d,e){e&&!Ext.isEmpty(a)&&(d=a[0],Ext.apply(d.data,{oraInizio:FormattaOra(d.get("dal")),oraFine:FormattaOra(d.get("al"))}),
b.loadRecord(a[0]))}})},onSelectComunicazione:function(a,b){if(!b)return!1;this.aggiornaForm(b.get("codice"))},aggiornaStore:function(a){var b=this,c=this.lookup("GridComunicazioni"),d=c.getStore();d.load({callback:function(e,g,h){h?Ext.isEmpty(e)?clearForm(b.lookup("Form")):(e=0,a&&(e=trovaRecord(d,"codice",a)),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(e)):msgShowError("",g.getError());IsolaCmp(b.lookup("Form"),!1)}})},ripristina:function(){var a=this.lookup("GridComunicazioni").getSelectionModel().getSelection()[0];
this.aggiornaStore(a?a[0]:null)},gestioneForm:function(){var a=this,b=this.lookup("Form");b.boxBottoni=this.lookup("BoxBottoni");b.controller=this;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.ComunicazioniServ");var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},
verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(a,c){IsolaCmp(b,c);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=this.lookup("GridComunicazioni").getSelectionModel().getSelection()[0];b?controller_eliminaRecord(this.lookup("Form").store,{id:b.get("codice")},function(){return a.aggiornaStore()}):Messaggio("ERRORE","NESSUNA_REGISTRAZIONE_SELEZIONATA",
"OK","QUESTION")},salvaForm:function(a){var b=this.lookup("Form");this.lookup("DtDal").getValue().setHours(Ext.util.Format.date(this.lookup("TmDal").getValue(),"H"),Ext.util.Format.date(this.lookup("TmDal").getValue(),"i"));this.lookup("DtAl").getValue().setHours(Ext.util.Format.date(this.lookup("TmAl").getValue(),"H"),Ext.util.Format.date(this.lookup("TmAl").getValue(),"i"));var c=b.getForm().getFieldValues();delete c.oraInizio;delete c.oraFine;controller_salvaRecord(b,c,a)},controllaCampi:function(){return this.lookup("Form").isValid()?
!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},onLaunch:function(){this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.CopiaRegolaRaccordo",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.control(a+"#BtnAnnullaCopia",{click:this.onClickBtnAnnullaCopia});this.control(a+"#BtnConfermaCopia",{click:this.onClickBtnConfermaCopia})},onClickBtnAnnullaCopia:function(){this.getView().up("window").close()},onClickBtnConfermaCopia:function(){var a=this,b=this.getIdEsterniSelezionati();if(!b)return Messaggio("",
"Selezionare almeno una voce","OK","ERROR"),!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/regole/copy",params:{idRegola:a.cbaConfig.regola.get("id"),idEsterni:b},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(msgShow("MSG_SALVATAGGIO_DATI",b.message),a.cbaConfig.controllerRegole.aggiornaGridRegole(a.cbaConfig.regola.get("id")),a.getView().up("window").close()):msgShowError("ERROR",b.message)}})},getIdEsterniSelezionati:function(){var a="";Ext.each(this.lookup("GridToCopy").getSelectionModel().getSelection(),
function(b){a+=b.get("codice")+","});return a},regolaEsistente:function(a){var b=this,c=!1;this.cbaConfig.storeRegole.each(function(d){d.get("tipoCodifica")===b.cbaConfig.regola.get("tipoCodifica")&&d.get("idEsterno")===a.get("codice")&&(c=!0)});return c},onLaunch:function(){var a=this;this.cbaConfig.storeEsterno.clearFilter();this.cbaConfig.storeEsterno.load({params:{idEnte:this.cbaConfig.regola.get("idEnte"),idOrg:this.cbaConfig.regola.get("idOrganizzazione"),tipoCod:this.cbaConfig.regola.get("tipoCodifica")},
callback:function(b,c,d){a.cbaConfig.storeEsterno.filterBy(function(b){return!a.regolaEsistente(b)});a.lookup("GridToCopy").bindStore(a.cbaConfig.storeEsterno)}})}});
Ext.define("Generali.gestPwdNew.controller.CopiaTipologiaSpecial",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CbProfilo",selector:a+"#CbProfilo"},{ref:"CbProfiloDett",selector:a+"#CbProfiloDett"},{ref:"CbTipologia",selector:a+"#CbTipologia"}]);this.control(a+"#BtnAnnullaCopia",{click:this.onClickBtnAnnullaCopia});this.control(a+"#BtnConfermaCopia",{click:this.onClickBtnConfermaCopia});this.control(a+"#CbProfilo",
{change:this.changeCbProfilo});this.control(a+"#CbProfiloDett",{change:this.changeCbProfiloDett})},changeCbProfiloDett:function(a,b,c,d){this.getCbTipologia().getStore().load({params:{idOrganizzazione:this.getCbProfiloDett().selection.data.idOrganizzazione,idPwd:b},callback:function(a,b,c){}})},changeCbProfilo:function(a,b,c,d){var e=this,g=e.getCbProfiloDett().getStore();g.load({params:{codProfilo:b},callback:function(a,b,c){c&&!Ext.isEmpty(a)&&(g.clearFilter(),g.filterBy(function(a){return a.get("codEnte")==
e.cbaConfig.codEnte}))}})},onClickBtnAnnullaCopia:function(a){this.getView().up("window").close()},onClickBtnConfermaCopia:function(a){var b=this;if(null==this.getCbProfilo().getValue())return msgShowError("","Il profilo  obbilgatorio!"),!1;if(null==this.getCbProfiloDett().getValue())return msgShowError("","Organizzazione  obbilgatoria!"),!1;if(null==this.getCbTipologia().getValue())return msgShowError("","La tipologia  obbilgatoria!"),!1;a={idProfiloPwdDe:this.getCbProfiloDett().getValue(),idProfiloCss:this.getCbTipologia().getValue(),
idProfiloCssCopy:this.cbaConfig.tipologiaSource,idProfiloPwdDeCopy:this.cbaConfig.profiloPwdDeSource};Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/profilipwddecss/new",jsonData:Ext.JSON.encode(a),success:function(a){a=Ext.JSON.decode(a.responseText);var c=[];a.success?(msgAdd(c,a.message),msgShow("MSG_SALVATAGGIO_DATI",c),b.getView().up("window").close()):msgShowError("",a.message)}})},onLaunch:function(){var a=this,b=a.getCbProfilo().getStore();b.load({callback:function(c,d,e){e&&!Ext.isEmpty(c)&&
(b.clearFilter(),b.filterBy(function(b){return b.get("codProfilo")!=a.cbaConfig.codProfiloPwd}))}})}});
Ext.define("Generali.gestPwdNew.controller.CreazioneRegolaRaccordo",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"CbTipoCod",selector:a+"#CbTipoCod"},{ref:"CbEsterno",selector:a+"#CbEsterno"},{ref:"CbApertura",selector:a+"#CbApertura"},{ref:"CbChiusura",selector:a+"#CbChiusura"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnAnnulla",selector:a+"#BtnAnnulla"}]);this.control(a+
"#BtnConferma",{click:this.onClickBtnConferma});this.control(a+"#BtnAnnulla",{click:this.onClickBtnAnnulla});this.control(a+"#CbTipoCod",{change:this.changeTipoCodifica})},onClickBtnAnnulla:function(a){clearForm(this.getForm());this.nascondiVociComboRegole()},onClickBtnConferma:function(a){var b=this;b.getForm().getForm().isValid()?(a=b.getForm().getForm().getFieldValues(),Ext.apply(a,{idEnte:b.cbaConfig.codEnte,idOrganizzazione:b.cbaConfig.idOrg}),Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/regole/new",
jsonData:Ext.JSON.encode(a),success:function(a){a=Ext.JSON.decode(a.responseText);var c=[];a.success?(msgShow("MSG_SALVATAGGIO_DATI",c),b.cbaConfig.controllerRegole.aggiornaGridRegole(a.data.id),b.getForm().up("window").close()):msgShowError("ATTENZIONE",a.message[0].testo)}})):msgShowError("","Compilare campi obbligatori!")},changeTipoCodifica:function(a,b,c){if(Ext.isEmpty(b))return!1;a=this.getCbEsterno().getStore();c=this.getCbApertura();var d=this.getCbChiusura();this.getCbEsterno().setValue("");
c.setValue("");d.setValue("");this.cbaConfig.controllerRegole.loadRegolaByCodifica(b,c.getStore(),d.getStore());svuotaStore(a);a.load({params:{idEnte:this.cbaConfig.codEnte,idOrg:this.cbaConfig.idOrg,tipoCod:b},callback:function(a,b,c){c||msgShowError("",b.getError())}})},nascondiVociComboRegole:function(){this.getCbApertura().setValue("");this.getCbApertura().getStore().clearFilter();this.getCbApertura().getStore().filter(function(a){return!1});this.getCbChiusura().setValue("");this.getCbChiusura().getStore().clearFilter();
this.getCbChiusura().getStore().filter(function(a){return!1})},onLaunch:function(){this.getCbTipoCod().bindStore(this.cbaConfig.storeTipoCod);this.getCbEsterno().bindStore(this.cbaConfig.storeEsterno);this.getCbApertura().bindStore(this.cbaConfig.storeRegApertura);this.getCbChiusura().bindStore(this.cbaConfig.storeRegChiusura);this.nascondiVociComboRegole()}});
Ext.define("Generali.gestPwdNew.controller.DBEDettaglio",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FldIDTBL",selector:this.selContainer+"#FldIDTBL"},{ref:"FldTipoOperazione",selector:this.selContainer+"#FldTipoOperazione"},{ref:"FldNumeroInvii",selector:this.selContainer+"#FldNumeroInvii"},{ref:"FldSendRevece",selector:this.selContainer+"#FldSendRevece"},{ref:"FldStato",selector:this.selContainer+
"#FldStato"},{ref:"FldMessage",selector:this.selContainer+"#FldMessage"},{ref:"FldData",selector:this.selContainer+"#FldData"},{ref:"FldResponse",selector:this.selContainer+"#FldResponse"}])},jsonify:function(a){try{return JSON.stringify(JSON.parse(a),null,"\t")}catch(b){return a}},getDetails:function(){var a=this,b=a.cbaConfig.evento;a.getFldIDTBL().setValue(b.tableAndId);a.getFldTipoOperazione().setValue(b.tipoOperazione);a.getFldNumeroInvii().setValue(b.numeroTentativi);a.getFldSendRevece().setValue(b.sendReceive);
a.getFldStato().setValue(b.statoInvio);a.getFldData().setValue(b.dataCreazioneEvento.toLocaleString());Ext.Ajax.request({method:"GET",url:"/cba/dashboardEvents/ws/dashboard/getDetailsById",params:{id:b.idEvent,dbId:b.dbId},writer:{type:"json"},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?b.data&&(a.getFldData().setValue(b.data.dateTime),a.getFldMessage().setValue(a.jsonify(b.data.message)),a.getFldResponse().setValue(a.jsonify(b.data.responseBody))):msgShowError("ATTENZIONE",b.message)}})},
gestioneForm:function(){},onLaunch:function(){this.getDetails()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.DBEImpostazioni",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"TabDb",selector:this.selContainer+"#TabDb"},{ref:"BtnDelConferma",selector:this.selContainer+"#BtnDelConferma"},{ref:"BtnDelRipristina",selector:this.selContainer+"#BtnDelRipristina"},{ref:"GridNotifiche",selector:this.selContainer+"#GridNotifiche"},
{ref:"TxtNMesi",selector:this.selContainer+"#TxtNMesi"},{ref:"BtnNotificaNuovo",selector:this.selContainer+"#BtnNotificaNuovo"},{ref:"BtnNotificaElimina",selector:this.selContainer+"#BtnNotificaElimina"},{ref:"BtnNotificaRipristina",selector:this.selContainer+"#BtnNotificaRipristina"},{ref:"PnlDbPWD",selector:this.selContainer+"#PnlDbPWD"},{ref:"PnlDbDati",selector:this.selContainer+"#PnlDbDati"},{ref:"PnlDbOspiti",selector:this.selContainer+"#PnlDbOspiti"},{ref:"PnlDbEco",selector:this.selContainer+
"#PnlDbEco"},{ref:"PnlDbPaghe",selector:this.selContainer+"#PnlDbPaghe"},{ref:"FieldSetCodifiche",selector:this.selContainer+"#FieldSetCodifiche"}]);this.control(this.selContainer+"#GridNotifiche",{beforeedit:this.beforeeditGrid,canceledit:this.canceleditGrid,edit:this.editGrid,validateedit:this.validateeditGrid});this.control(this.selContainer+"#BtnNotificaNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnNotificaElimina",{click:this.clickBtnElimina});this.control(this.selContainer+
"#BtnNotificaRipristina",{click:this.clickBtnRipristina});this.control(this.selContainer+"#BtnDelConferma",{click:this.impostaNMesi});this.control(this.selContainer+"#BtnDelRipristina",{click:this.setNMesi});this.control(this.selContainer+"#TxtNMesi",{change:this.isDirtyMesi})},abilitaBottoniGrid:function(a){this.getBtnNotificaNuovo().setDisabled(!a);this.getBtnNotificaElimina().setDisabled(!a)},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null},this.getGridNotifiche())},clickBtnElimina:function(a){var b=
this;a=b.getGridNotifiche();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGrid:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},editGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGrid:function(a,
b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGrid:function(a,b,c){return msgShow("",[])},clickBtnRipristina:function(){var a=this.getGridNotifiche().getSelectionModel();Ext.each(a.getSelection(),function(a){a.reject()})},aggiornaStore:function(a){var b=this.getGridNotifiche(),c=b.getStore();c.load({params:{},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",
e.getError())}})},abilitaBottoniMesi:function(a){var b=this.getBtnDelConferma(),c=this.getBtnDelRipristina();b.setDisabled(a);c.setDisabled(a)},isDirtyMesi:function(){this.abilitaBottoniMesi(!1)},impostaNMesi:function(){var a=this,b=a.getTxtNMesi();a.getForm();a.verificaCampimesi()&&Ext.Ajax.request({method:"GET",url:"/cba/dashboardEvents/ws/dashboard/autoDel/update",params:{nMesi:b.getValue()},writer:{type:"json"},success:function(c){c=Ext.JSON.decode(c.responseText);c.success?(b.setValue(c.data),
a.abilitaBottoniMesi(!0)):msgShowError("ATTENZIONE",c.message)}})},verificaCampimesi:function(){return 0<this.getTxtNMesi().getValue()},setNMesi:function(){var a=this,b=a.getTxtNMesi();Ext.Ajax.request({method:"GET",url:"/cba/dashboardEvents/ws/dashboard/autoDel/get",writer:{type:"json"},success:function(c){c=Ext.JSON.decode(c.responseText);c.success?(b.setValue(c.data),a.abilitaBottoniMesi(!0)):msgShowError("ATTENZIONE",c.message)}})},visualizzaTabs:function(a){containerSolaLettura(this.getPnlCalendario(),
!a);this.getPnlAllegati().tab.setVisible(a);this.getPnlCollegamenti().tab.setVisible(a)},loadCodifiche:function(){var a=this;Ext.Ajax.request({method:"GET",url:"/cba/dashboardEvents/ws/dashboard/codifiche/dblist",success:function(b){var c=Ext.JSON.decode(b.responseText);b=[];if(c.success)if(c=c.data){var d=-1;c.dbPwd?0>d&&(d=0):a.getPnlDbPWD().tab.hide();c.dbDati?0>d&&(d=1):a.getPnlDbDati().tab.hide();if(c.dbOspiti){var e=Ext.create("Generali.gestPwdNew.view.DbeCodificheOspiti",{});a.getPnlDbOspiti().add(e);
0>d&&(d=2)}else a.getPnlDbOspiti().tab.hide();c.dbEconomato?0>d&&(d=3):a.getPnlDbEco().tab.hide();c.dbPaghe?0>d&&(d=4):a.getPnlDbPaghe().tab.hide();a.getTabDb().setActiveTab(d)}else a.getFieldSetCodifiche().hide();else msgAddError(b,c.message);msgShow("COPIA",b)}})},gestioneForm:function(){},onLaunch:function(){var a=this.getGridNotifiche();a.getSelectionModel();this.setNMesi();this.gestioneForm();a.controller=this;this.aggiornaStore();this.loadCodifiche()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.DashboardEvents",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridEventi",selector:this.selContainer+"#GridEventi"},{ref:"PTEventi",selector:this.selContainer+"#PTEventi"},{ref:"EdtDtDal",selector:this.selContainer+"#EdtDtDal"},{ref:"EdtDtAl",selector:this.selContainer+"#EdtDtAl"},{ref:"BtnCerca",selector:this.selContainer+"#BtnCerca"},{ref:"BtnImpostazioni",
selector:this.selContainer+"#BtnImpostazioni"},{ref:"RgbFiltroStato",selector:this.selContainer+"#RgbFiltroStato"},{ref:"CBTipoEventi",selector:this.selContainer+"#CBTipoEventi"},{ref:"DescrizioneRicerca",selector:this.selContainer+"#DescrizioneRicerca"},{ref:"CbxCercaIn",selector:this.selContainer+"#CbxCercaIn"}]);this.control(this.selContainer+"#BtnCerca",{click:this.caricaEventi});this.control(this.selContainer+"#BtnImpostazioni",{click:this.winImpostazioni});this.control(this.selContainer+"#GridEventi",
{itemdblclick:this.rowdblclickGrid})},winImpostazioni:function(){Ext.create("winCBA",{titolo:traduci("DBE_IMPOSTAZIONI"),name:"Generali.gestPwdNew.view.DBEImpostazioni",dimensione:7,configItem:{},closable:!0,maximizable:!1}).show()},winDettaglio:function(a){Ext.create("winCBA",{titolo:traduci("DBE_TITOLO_DETTAGLIO")+a.get("tableAndId"),name:"Generali.gestPwdNew.view.DBEDettaglio",dimensione:1,configItem:{evento:a.data},closable:!0,maximizable:!1}).show()},rowdblclickGrid:function(a,b,c,d,e,g){b&&
Ext.create("winCBA",{titolo:traduci("DBE_TITOLO_DETTAGLIO")+b.get("tableAndId"),name:"Generali.gestPwdNew.view.DBEDettaglio",dimensione:1,configItem:{evento:b.data},closable:!0,maximizable:!1}).show()},reinviaRecord:function(a){var b=this,c=a.data;Messaggio("ATTENZIONE","DBE_RE_SEND_QUESTION","YESNO","QUESTION","WARNING",function(){c.notifyStatus=0;c.statoInvio=1;c.id=c.idEvent;c.numeroTentativi=0;Ext.Ajax.request({url:"/cba/dashboardEvents/ws/dashboard/update",method:"POST",jsonData:Ext.JSON.encode(c),
success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.caricaEventi():msgShowError("",a.message)}})})},eliminaRecord:function(a){var b=this,c=a.data;Messaggio("ATTENZIONE","DBE_DELETE_QUESTION","YESNO","QUESTION","WARNING",function(){c.id=c.idEvent;Ext.Ajax.request({url:"/cba/dashboardEvents/ws/dashboard/delete",method:"POST",jsonData:Ext.JSON.encode(c),success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.caricaEventi():msgShowError("",a.message)}})})},getParamRicerca:function(){var a=
{};this.getEdtDtDal().getValue()&&Ext.apply(a,{dataDal:this.getEdtDtDal().getValue()});this.getEdtDtAl().getValue()&&Ext.apply(a,{dataAl:this.getEdtDtAl().getValue()});this.getRgbFiltroStato().getValue()&&Ext.apply(a,{statoEventi:this.getRgbFiltroStato().getValue()});this.getCBTipoEventi().getValue()&&""!=this.getCBTipoEventi().getValue()&&Ext.apply(a,{tipoEventi:this.getCBTipoEventi().getValue()});this.getCbxCercaIn().getValue()&&Ext.apply(a,this.getCbxCercaIn().getValue());this.getDescrizioneRicerca().getValue()&&
Ext.apply(a,{testo:this.getDescrizioneRicerca().getValue()});return a},caricaEventi:function(){var a=this.getGridEventi().getStore();a.isLoaded()&&svuotaStore(a);this.getPTEventi().bindStore(a);a.getProxy().extraParams=this.getParamRicerca();a.load({callback:function(a,c,d){d||msgShowError("",c.getError())}})},onLaunch:function(){var a=new Date;a.setDate(a.getDate()-7);this.getEdtDtDal().setValue(a);this.caricaEventi()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.DbeCodificheOspiti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridCodifiche",selector:this.selContainer+"#GridCodifiche"},{ref:"BtnCodificaNuovo",selector:this.selContainer+"#BtnCodificaNuovo"},{ref:"BtnCodificaElimina",selector:this.selContainer+"#BtnCodificaElimina"},{ref:"BtnCodificaCerca",selector:this.selContainer+"#BtnCodificaCerca"},{ref:"TxtIdTipoDato",
selector:this.selContainer+"#TxtIdTipoDato"},{ref:"TxtTipoDato",selector:this.selContainer+"#TxtTipoDato"},{ref:"TxtCodiceEsterno",selector:this.selContainer+"#TxtCodiceEsterno"},{ref:"TxtCodiceSipcar",selector:this.selContainer+"#TxtCodiceSipcar"}]);this.control(this.selContainer+"#GridCodifiche",{beforeedit:this.beforeeditGrid,canceledit:this.canceleditGrid,edit:this.editGrid,validateedit:this.validateeditGrid});this.control(this.selContainer+"#BtnCodificaNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+
"#BtnCodificaElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#BtnCodificaCerca",{click:this.aggiornaStore})},abilitaBottoniGrid:function(a){this.getBtnCodificaNuovo().setDisabled(!a);this.getBtnCodificaElimina().setDisabled(!a)},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null},this.getGridCodifiche())},clickBtnElimina:function(a){var b=this;a=b.getGridCodifiche();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):
""},function(){b.aggiornaStore()})},beforeeditGrid:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},editGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGrid:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGrid:function(a,b,c){return msgShow("",
[])},getParamRicerca:function(){var a={};this.getTxtIdTipoDato().getValue()&&Ext.apply(a,{idTipoDato:this.getTxtIdTipoDato().getValue()});this.getTxtTipoDato().getValue()&&Ext.apply(a,{tipoDato:this.getTxtTipoDato().getValue()});this.getTxtCodiceEsterno().getValue()&&Ext.apply(a,{codiceEsterno:this.getTxtCodiceEsterno().getValue()});this.getTxtCodiceSipcar().getValue()&&""!=this.getTxtCodiceSipcar().getValue()&&Ext.apply(a,{codiceSipcar:this.getTxtCodiceSipcar().getValue()});return a},aggiornaStore:function(a){var b=
this.getGridCodifiche(),c=b.getStore();c.load({params:this.getParamRicerca(),callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},gestioneForm:function(){},onLaunch:function(){},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.EntiImpostazioni",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"GridEnti",selector:a+"#GridEnti"},{ref:"TxtRagSoc",selector:a+"#TxtRagSoc"},{ref:"TxtID",selector:a+"#TxtID"},{ref:"TxtCBADATIIB",selector:a+"#TxtCBADATIIB"},{ref:"TxtCBAOSPITIB",selector:a+"#TxtCBAOSPITIB"},{ref:"TxtCBAECONIB",
selector:a+"#TxtCBAECONIB"},{ref:"TxtCBAPAGHEIB",selector:a+"#TxtCBAPAGHEIB"},{ref:"TxtCBAALLEGATI",selector:a+"#TxtCBAALLEGATI"},{ref:"TxtCBATERAPIE",selector:a+"#TxtCBATERAPIE"},{ref:"TxtDBFARMACI",selector:a+"#TxtDBFARMACI"},{ref:"TxtDBFARMACI",selector:a+"#TxtDBFARMACI"},{ref:"TxtCBAFEALLEGATI",selector:a+"#TxtCBAFEALLEGATI"},{ref:"TxtCBARPALLEGATI",selector:a+"#TxtCBARPALLEGATI"},{ref:"TabOrganizzazioni",selector:a+"#TabOrganizzazioni"},{ref:"TabPanel",selector:a+"#TabPanel"},{ref:"PnlImpostazioni",
selector:a+"#PnlImpostazioni"},{ref:"TabModuli",selector:a+"#TabModuli"},{ref:"CheckSipcar2",selector:a+"#CheckSipcar2"}]);this.control(a+"#GridEnti",{selectionchange:this.caricaDatiEnteSel});this.control(a+"#TabPanel",{tabchange:this.changeTabPanel})},changeTabPanel:function(a,b){var c=this.getGridEnti();0<c.getSelection().length&&(c=c.getSelectionModel().getSelection()[0],"TabOrganizzazioni"===b.getItemId()?(c=Ext.create("Generali.gestPwdNew.view.Organizzazioni",{cbaConfig:{idEnte:c.get("codice"),
controllerEntiImp:this}}),b.removeAll(),b.add(c)):"TabModuli"===b.getItemId()&&(b.removeAll(),this.creaWidgetPsw(b,c)))},creaWidgetPsw:function(a,b){var c=this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(d){d?(d=Ext.create("Generali.gestPwdNew.view.Moduli",{cbaConfig:{idEnte:b.get("codice"),controllerEntiImp:c}}),a.add(d),a.show()):(msgShowError("",traduci("PASSWORD_ERRATA")),a.up("tabpanel").setActiveTab("PnlImpostazioni"))}}).show()},caricaDatiEnteSel:function(a,
b){var c=this.getTabPanel();this.cbaConfig.id=!1;0<b.length&&(this.cbaConfig.id=b[0].get("codice"),this.getForm().setHidden(!1),c.setActiveTab("PnlImpostazioni"),this.aggiornaStore(),this.abilitaTabOrgMod(!0))},aggiornaStore:function(a){var b=this;clearForm(b.getForm());b.getForm().store.load({params:{id:a?a:b.cbaConfig.id},callback:function(a,d,e){e&&(Ext.isEmpty(a)||b.getForm().loadRecord(a[0]))}})},inserimentoNuovoEnte:function(){this.getForm().show();var a=this.getTxtID(),b=this.getTxtRagSoc();
IsolaCmp(this.getPnlImpostazioni(),!0);clearForm(this.getForm());a.hide();b.setReadOnly(!1);this.getCheckSipcar2().setValue(!0)},ripristina:function(){var a=this.getGridEnti(),b=this.getTxtID(),c=this.getTxtRagSoc();IsolaCmp(this.getPnlImpostazioni(),!1);c.setReadOnly(!0);b.show();Ext.isEmpty(a.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):this.aggiornaStore()},controllaCampi:function(){return this.getForm().isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK",
"INFORMATION"),!1)},salvaForm:function(a){var b=this.getForm(),c=b.getValues(),d=this.getTxtID(),e=this.getTxtRagSoc();if(a=controller_salvaRecord(b,c,a))IsolaCmp(this.getPnlImpostazioni(),!1),d.show(),e.setReadOnly(!0),this.aggiornaEnti(a.id)},eliminaRecord:function(){var a=this,b=a.getForm(),c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaEnti();clearForm(b);b.hide();a.abilitaTabOrgMod(!1)})},abilitaTabOrgMod:function(a){this.getTabOrganizzazioni().setDisabled(!a);
this.getTabModuli().setDisabled(!a)},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=this.getBoxBottoni();b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.EnteSel",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina()},nuovo_callback:function(){a.inserimentoNuovoEnte()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},
verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPnlImpostazioni(),e);controller_abilitaBottoni(b)})},aggiornaEnti:function(a){var b=this.getGridEnti(),c=b.getStore();c.load({params:{onlySipcar2:"F"},callback:function(d,e,g){if(g&&a){var h;a&&((h=trovaRecord(c,"codice",a))||(h=0));b.getSelectionModel().deselectAll();b.getSelectionModel().select(h)}}})},onLaunch:function(){this.gestioneForm();
this.aggiornaEnti()},destroy:function(){eliminaStore(this.storeImpostazioni);this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.FiltriReparti",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"TreeSedRep",selector:a+"#TreeSedRep"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",
{click:this.ripristinaTree})},changeFiltro:function(a,b){if(0==b.length)return!1;this.aggiornaStore()},gestioneForm:function(){this.getForm()},ripristinaTree:function(){this.ripristina(this.getTreeSedRep())},editTree:function(){var a=this,b=[],c=a.getGridFiltri().getSelectionModel().getSelection()[0].get("id");a.getTreeSedRep().getChecked().forEach(function(a){if(a.getData().leaf){var d={};d.codRepart=a.getData().idReparto;d.codSede=a.getData().idSede;d.idFiltriTe=c;b.push(d)}});if(1>b.length){var d=
{};d.idFiltriTe=c;b.push(d)}IsolaCmp(a.getTreeSedRep(),!1);a.disabilitaBtnAlbero(!0);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtrireparti/new",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.aggiornaStore():msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){this.getTreeSedRep().getRootNode();IsolaCmp(this.getTreeSedRep(),!0);this.disabilitaBtnAlbero(!1);Ext.isEmpty(a.childNodes)||a.isLeaf()?b||a.parentNode.set("checked",b):
(this.contaNodiPadre=b?++this.contaNodiPadre:--this.contaNodiPadre,a.totaleFigliCheck=b?a.totaleFigliCheck=0:a.totaleFigliCheck,this.ciclaFigli(a,b))},ciclaFigli:function(a,b){b?a.childNodes.forEach(function(a){a.set("checked",!0)}):a.childNodes.forEach(function(a){a.set("checked",!1)})},aggiornaStore:function(){var a=this,b=a.getGridFiltri().getSelectionModel().getSelection()[0];b&&(clearForm(a.getForm()),a.getForm().store.load({params:{id:b.get("id")},callback:function(b,d,e){e&&!Ext.isEmpty(b)&&
(a.getForm().show(),a.getForm().loadRecord(b[0]))}}),a.getTreeSedRep().getStore().load({params:{idEnte:b.get("idEnte"),idOrganizzazione:b.get("idOrganizzazione"),idFiltroTe:b.get("id")},callback:function(b,d,e){e?(a.getTreeSedRep().show(),a.getTreeSedRep().expandAll()):msgShowError("",d.getError())}}))},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaFiltri();this.disabilitaBtnAlbero(!0)},
destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.GestioneSedi",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CbEnti",selector:this.selContainer+"#CbEnti"},{ref:"CbOrg",selector:this.selContainer+"#CbOrg"},{ref:"PanelSedi",selector:this.selContainer+"#PanelSedi"}]);this.control(this.selContainer+"#CbEnti",{change:this.changeEnte});this.control(this.selContainer+"#CbOrg",{change:this.changeOrg})},changeEnte:function(a,
b){var c=this.getCbOrg();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeOrg:function(a,b){var c=this.getCbEnti().getValue(),d={};this.getPanelSedi().removeAll();b&&(d.permesso="S",d.idModulo=43,d.codEnte=c,d.idOrganizzazione=b,c=Ext.create("Generali.sediReparti.view.SediReparti",{cbaConfig:d,flex:1,title:"sometitle"}),this.getPanelSedi().add(c))},onLaunch:function(){this.getCbEnti().getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()}})},
destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriAttivita",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeAttivita",selector:a+"#TreeAttivita"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",selector:a+
"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeAttivita",{checkchange:this.setCheckTreePanel})},
changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=
Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);
b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.TreeAttivita().hide()}))},aggiornaStore:function(a){var b=this.getGridFiltri(),
c=b.getStore();c.load({params:{tipoFiltro:6,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?d:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeAttivita().hide();this.getCmbOrganizzazioni().getStore().removeAll();
a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?
(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreeAttivita().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},salvaForm:function(a){var b=this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:6});controller_salvaRecord(b,
record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeAttivita())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id;a.getTreeAttivita().getChecked().forEach(function(a){var d={};d.idAttivita=a.getData().id;d.idFiltriTe=c;b.push(d)});if(1>b.length){var d={};d.idFiltriTe=c;b.push(d)}IsolaCmp(a.getTreeAttivita(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtriattivita/update",jsonData:Ext.JSON.encode(b),
success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){IsolaCmp(this.getTreeAttivita(),!0);this.disabilitaBtnAlbero(!1);b||a.parentNode.set("checked",b)},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(a.filtroTeSelezionato){var b="F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),
b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]))}});var c=a.getTreeAttivita(),d=c.getStore();c.setDisabled(b);d.load({params:{idEnte:a.filtroTeSelezionato.data.idEnte,idOrganizzazione:a.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d?(a.getTreeAttivita().show(),a.getTreeAttivita().expandAll()):msgShowError("",c.getError())}})}},
disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriEcoCdcDepositi",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeCdcDepositi",selector:a+"#TreeCdcDepositi"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",
selector:a+"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbEnti"},{ref:"CmbAnnoEsercizio",selector:a+"#CmbAnnoEsercizio"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#CmbOrganizzazioni",{change:this.changeOrganizzazione});this.control(a+"#CmbAnnoEsercizio",{change:this.changeAnnoEsercizio});
this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeCdcDepositi",{checkchange:this.setCheckTreePanel});this.control(a+"#BtnEspandiTutto",{click:this.btnClickEspandiTutto});this.control(a+"#BtnCollassaTutto",{click:this.btnClickCollassaTutto})},btnClickCollassaTutto:function(a){this.getTreeCdcDepositi().collapseAll()},btnClickEspandiTutto:function(a){this.getTreeCdcDepositi().expandAll()},changeEnte:function(a,
b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeOrganizzazione:function(a,b){var c=this,d=c.getCmbAnnoEsercizio();if(!b)return!1;SvuotaCombo(d);d.getStore().load({params:{idOrganizzazione:b},callback:function(a,b,h){h?1==a.length?d.setValue(a):d.setValue(c.idEseDefault):msgShowError("",b.getError())}})},changeAnnoEsercizio:function(a,
b){if(!b)return!1;this.aggiornaTree()},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.FiltriTe",{autoLoad:!1});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.ripristina(a.getPanel())},
nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(c,e){a.getCmbAnnoEsercizio().isDirty();IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();a.filtroTeSelezionato&&
a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.getTreeCdcDepositi().hide()}))},aggiornaStore:function(a){var b=this,c=b.getGridFiltri(),d=c.getStore();d.load({params:{tipoFiltro:5,filtraOrgAutor:isAmministratoreOrg()},callback:function(e,g,h){if(h){var k;a?k=trovaRecord(d,"id",a):e&&0<e.length?
k=e[0]:(clearForm(b.getForm()),b.getTreeCdcDepositi().hide());c.getSelectionModel().deselectAll();c.getSelectionModel().select(k?k:0)}else msgShowError("",g.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();delete this.filtroTeSelezionato;this.getForm().show();containerSolaLettura(this.getForm(),!1);this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeCdcDepositi().hide();this.getCmbOrganizzazioni().getStore().removeAll();a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},
callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):
(this.aggiornaForm(),this.getTreeCdcDepositi().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));if(!a.isValid()){Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR");var b="";Ext.each(a.getForm().getFields().items,function(a){a.validate()||(""!=b&&(b+=", "),b+=a.fieldLabel)});msgAddError(messaggi,b);return!1}return!0},salvaForm:function(a){var b=
this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:5});delete record.idEsercizio;controller_salvaRecord(b,record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeCdcDepositi())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id,d=a.getCmbAnnoEsercizio().getValue();null==d&&(d=a.idEseDefault);a.getTreeCdcDepositi().getChecked().forEach(function(a){if(a.getData().leaf){var e={};a=a.getData();e.idEsercizio=
d;e.idFiltriTe=c;e.idEcoAnaCda=a.id;e.tipoArea=null;e.deposito=null;b.push(e)}});if(1>b.length){var e={};e.idFiltriTe=c;e.idEsercizio=d;b.push(e)}IsolaCmp(a.getTreeCdcDepositi(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtriecocdc/update",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){this.getTreeCdcDepositi().getRootNode();
IsolaCmp(this.getTreeCdcDepositi(),!0);this.disabilitaBtnAlbero(!1);Ext.isEmpty(a.childNodes)||a.isLeaf()?b||a.parentNode.set("checked",b):(this.contaNodiPadre=b?++this.contaNodiPadre:--this.contaNodiPadre,a.totaleFigliCheck=b?a.totaleFigliCheck=0:a.totaleFigliCheck,this.ciclaFigli(a,b))},ciclaFigli:function(a,b){b?a.childNodes.forEach(function(a){a.set("checked",!0)}):a.childNodes.forEach(function(a){a.set("checked",!1)})},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(a.filtroTeSelezionato){var b=
"F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,d,e){e&&(a.getForm().show(),Ext.isEmpty(b)||a.getForm().loadRecord(b[0]))}});a.aggiornaTree(b)}},aggiornaTree:function(a){var b=this,c=b.getTreeCdcDepositi(),d=c.getStore(),e=b.getCmbAnnoEsercizio(),e=StdSipcar.isValidID(e.getValue())?e.getValue():b.idEseDefault;b.filtroTeSelezionato&&(c.setDisabled(a),d.load({params:{idEnte:b.filtroTeSelezionato.data.idEnte,
idOrganizzazione:b.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:b.filtroTeSelezionato.data.id,idEsercizio:e},callback:function(a,c,d){d?(b.getTreeCdcDepositi().show(),Ext.isEmpty(a)||b.getTreeCdcDepositi().expandAll()):msgShowError("",c.getError())}}))},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.idEseDefault=getIdEsercizioByDate(getIdOrg(),new Date);this.gestioneForm();this.aggiornaStore();this.disabilitaBtnAlbero(!0)},
destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriPerReparti",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreePerReparti",selector:a+"#TreePerReparti"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",
selector:a+"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"},{ref:"IdGruppo",selector:a+"#IdGruppo"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});
this.control(a+"#TreePerReparti",{checkchange:this.setCheckTreePanel})},changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();
b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});
inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();
a.getForm().hide();a.getTreePerReparti().hide()}))},aggiornaStore:function(a){var b=this.getGridFiltri(),c=b.getStore();c.load({params:{tipoFiltro:4,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),
!0);clearForm(this.getForm());this.getTreePerReparti().hide();this.getCmbOrganizzazioni().getStore().removeAll();a.getStore().load({params:{dbPaghe:"T",filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},
ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreePerReparti().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI",
"OK","ERROR"),!1)},salvaForm:function(a){var b=this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:4});controller_salvaRecord(b,record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreePerReparti())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id;a.getTreePerReparti().getChecked().forEach(function(a){var d={};d.idReparto=a.getData().id;d.idFiltriTe=c;b.push(d)});if(1>b.length){var d={};d.idFiltriTe=
c;b.push(d)}IsolaCmp(a.getTreePerReparti(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtriperreparti/update",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){this.getTreePerReparti().getRootNode();IsolaCmp(this.getTreePerReparti(),!0);this.disabilitaBtnAlbero(!1)},ciclaFigli:function(a,b){a.cascadeBy(function(a){a.set("checked",
b)})},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);var b=a.getTreePerReparti(),c=b.getStore();if(a.filtroTeSelezionato){var d="F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),d);b.setDisabled(d);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,d,h){h&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]),b=b[0].get("idGruppo"),Ext.isEmpty(b)?msgShowError("","IdGruppo non valido!"):c.load({params:{idEnte:a.filtroTeSelezionato.data.idEnte,
idGruppo:b,idFiltroTe:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d?(a.getTreePerReparti().show(),a.getTreePerReparti().expandAll()):msgShowError("",c.getError())}}))}})}},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriReparti",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeSedRep",selector:a+"#TreeSedRep"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",selector:a+
"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeSedRep",{checkchange:this.setCheckTreePanel});
this.control(a+"#BtnEspandiTutto",{click:this.btnClickEspandiTutto});this.control(a+"#BtnCollassaTutto",{click:this.btnClickCollassaTutto})},btnClickCollassaTutto:function(a){this.getTreeSedRep().getRootNode().cascadeBy(function(a){"sede"==a.get("iconCls")&&a.collapse()})},btnClickEspandiTutto:function(a){this.getTreeSedRep().expandAll()},changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},
callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},
annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();
a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.getTreeSedRep().hide()}))},aggiornaStore:function(a){var b=this.getGridFiltri(),c=b.getStore();c.load({params:{tipoFiltro:1,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),
b.getSelectionModel().select(d?d:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeSedRep().hide();this.getCmbOrganizzazioni().getStore().removeAll();a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);
this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreeSedRep().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),
this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},salvaForm:function(a){var b=this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:1});controller_salvaRecord(b,record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeSedRep())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id;a.getTreeSedRep().getChecked().forEach(function(a){if(a.getData().leaf){var d=
{};d.codRepart=a.getData().idReparto;d.codSede=a.getData().idSede;d.idFiltriTe=c;b.push(d)}});if(1>b.length){var d={};d.idFiltriTe=c;b.push(d)}IsolaCmp(a.getTreeSedRep(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtrireparti/update",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){this.getTreeSedRep().getRootNode();
IsolaCmp(this.getTreeSedRep(),!0);this.disabilitaBtnAlbero(!1);Ext.isEmpty(a.childNodes)||a.isLeaf()?b||a.parentNode.set("checked",b):(this.contaNodiPadre=b?++this.contaNodiPadre:--this.contaNodiPadre,a.totaleFigliCheck=b?a.totaleFigliCheck=0:a.totaleFigliCheck,this.ciclaFigli(a,b))},ciclaFigli:function(a,b){b?a.childNodes.forEach(function(a){a.set("checked",!0)}):a.childNodes.forEach(function(a){a.set("checked",!1)})},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(a.filtroTeSelezionato){var b=
"F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]))}});var c=a.getTreeSedRep(),d=c.getStore();c.setDisabled(b);d.load({params:{idEnte:a.filtroTeSelezionato.data.idEnte,idOrganizzazione:a.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:a.filtroTeSelezionato.data.id},callback:function(b,
c,d){d?(a.getTreeSedRep().show(),a.getTreeSedRep().expandAll()):msgShowError("",c.getError())}})}},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore();this.disabilitaBtnAlbero(!0)},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriServizi",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeServizi",selector:a+"#TreeServizi"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",selector:a+
"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeServizi",{checkchange:this.setCheckTreePanel})},
changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=
Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);
b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.getTreeServizi().hide()}))},aggiornaStore:function(a){var b=this.getGridFiltri(),
c=b.getStore();c.load({params:{tipoFiltro:2,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?d:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeServizi().hide();this.getCmbOrganizzazioni().getStore().removeAll();
a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?
(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreeServizi().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},salvaForm:function(a){var b=this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:2});controller_salvaRecord(b,
record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeServizi())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id;a.getTreeServizi().getChecked().forEach(function(a){var d={};d.idServizio=a.getData().idServizio;d.idFiltriTe=c;b.push(d)});if(1>b.length){var d={};d.idFiltriTe=c;b.push(d)}IsolaCmp(a.getTreeServizi(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtriservizi/update",jsonData:Ext.JSON.encode(b),
success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){IsolaCmp(this.getTreeServizi(),!0);this.disabilitaBtnAlbero(!1);b||a.parentNode.set("checked",b)},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(a.filtroTeSelezionato){var b="F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),
b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]))}});var c=a.getTreeServizi(),d=c.getStore();c.setDisabled(b);d.load({params:{idEnte:a.filtroTeSelezionato.data.idEnte,idOrganizzazione:a.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d?(a.getTreeServizi().show(),a.getTreeServizi().expandAll()):msgShowError("",c.getError())}})}},
disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriSettori",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeSedRepStanzLett",selector:a+"#TreeSedRepStanzLett"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",
selector:a+"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeSedRepStanzLett",
{checkchange:this.setCheckTreePanel});this.control(a+"#BtnEspandiTutto",{click:this.btnClickEspandiTutto});this.control(a+"#BtnCollassaTutto",{click:this.btnClickCollassaTutto})},btnClickCollassaTutto:function(a){this.getTreeSedRepStanzLett().getRootNode().cascadeBy(function(a){"root"!=a.get("id")&&a.collapse()})},btnClickEspandiTutto:function(a){this.getTreeSedRepStanzLett().expandAll()},changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,
filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},
annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();
a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.getTreeSedRepStanzLett().hide()}))},aggiornaStore:function(a){var b=this.getGridFiltri(),c=b.getStore();c.load({params:{tipoFiltro:3,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),
b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?d:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeSedRepStanzLett().hide();this.getCmbOrganizzazioni().getStore().removeAll();a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):
msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreeSedRepStanzLett().show())},
controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},salvaForm:function(a){var b=this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:3});controller_salvaRecord(b,record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeSedRepStanzLett())},
editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id,d,e;a.getTreeSedRepStanzLett().getChecked().forEach(function(a){if(!a.parentNode.get("checked")||"root"==a.parentNode){if("sede"==a.getData().iconCls)d=a.getData().idSede,e=1;else if("reparto"==a.getData().iconCls)d=a.getData().idReparto,e=2;else if("stanza"==a.getData().iconCls)d=a.getData().idStanza,e=3;else if("letto"==a.getData().iconCls)d=a.getData().idLetto,e=4;else return;a={};a.idFiltriTe=c;a.cod=d;a.tipoCod=e;b.push(a)}});
if(1>b.length){var g={};g.idFiltriTe=c;b.push(g)}IsolaCmp(a.getTreeSedRepStanzLett(),!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtrisettori/update",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){this.getTreeSedRepStanzLett().getRootNode();IsolaCmp(this.getTreeSedRepStanzLett(),!0);this.disabilitaBtnAlbero(!1);
Ext.isEmpty(a.childNodes)||a.isLeaf()||(this.contaNodiPadre=b?++this.contaNodiPadre:--this.contaNodiPadre,a.totaleFigliCheck=b?a.totaleFigliCheck=0:a.totaleFigliCheck,this.ciclaFigli(a,b));b||a.parentNode.set("checked",b)},ciclaFigli:function(a,b){b?a.childNodes.forEach(function(a){a.set("checked",!0);a.childNodes.forEach(function(a){a.set("checked",!0);a.childNodes.forEach(function(a){a.set("checked",!0)})})}):a.childNodes.forEach(function(a){a.set("checked",!1);a.childNodes.forEach(function(a){a.set("checked",
!1);a.childNodes.forEach(function(a){a.set("checked",!1)})})})},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(!a.filtroTeSelezionato)return!1;var b="F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,d,e){e&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]))}});a.aggiornaTree(b)},aggiornaTree:function(a){var b=this,c=b.getTreeSedRepStanzLett(),
d=c.getStore();c.setDisabled(a);d.load({params:{idEnte:b.filtroTeSelezionato.data.idEnte,idOrganizzazione:b.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:b.filtroTeSelezionato.data.id},callback:function(a,c,d){d?(b.getTreeSedRepStanzLett().show(),b.getTreeSedRepStanzLett().expandAll()):msgShowError("",c.getError())}})},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore();
this.disabilitaBtnAlbero(!0)},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaFiltriUfficiManutenz",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"TreeManutentore",selector:a+"#TreeManutentore"},{ref:"GridFiltri",selector:a+"#GridFiltri"},{ref:"TxtOrganizzazione",selector:a+"#TxtOrganizzazione"},{ref:"CmbOrganizzazioni",selector:a+"#CmbOrganizzazioni"},{ref:"TxtEnte",
selector:a+"#TxtOrganizzazione"},{ref:"CmbEnti",selector:a+"#CmbOrganizzazioni"},{ref:"Panel",selector:a+"#Panel"},{ref:"BtnConfermaTree",selector:a+"#BtnConfermaTree"},{ref:"BtnRipristinaTree",selector:a+"#BtnRipristinaTree"}]);this.control(a+"#GridFiltri",{selectionchange:this.changeFiltro});this.control(a+"#CmbEnti",{change:this.changeEnte});this.control(a+"#BtnConfermaTree",{click:this.editTree});this.control(a+"#BtnRipristinaTree",{click:this.ripristinaTree});this.control(a+"#TreeManutentore",
{checkchange:this.setCheckTreePanel})},changeEnte:function(a,b){var c=this.getCmbOrganizzazioni();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeFiltro:function(a,b){if(0==b.length)return delete this.filtroTeSelezionato,!1;this.filtroTeSelezionato=b[0];this.aggiornaForm()},gestioneForm:function(){var a=this,b=a.getForm();b.boxBottoni=a.getBoxBottoni();
b.controller=a;b.permesso="S";b.store=Ext.create("Generali.gestPwdNew.store.FiltriTe",{});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina(a.getPanel())},nuovo_callback:function(){a.inserimentoFiltro()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,
c,!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);b.getForm().on("dirtychange",function(c,e){IsolaCmp(a.getPanel(),e);controller_abilitaBottoni(b)})},eliminaRecord:function(){var a=this,b=a.getGridFiltri();a.filtroTeSelezionato&&a.filtroTeSelezionato.get("id")&&("F"==a.filtroTeSelezionato.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_FILTRO","OK","ERROR"):controller_eliminaRecord(b.getStore(),{id:a.filtroTeSelezionato.data.id},function(){a.aggiornaStore();a.getForm().hide();a.TreeManutentore().hide()}))},
aggiornaStore:function(a){var b=this.getGridFiltri(),c=b.getStore();c.load({params:{tipoFiltro:7,filtraOrgAutor:isAmministratoreOrg()},callback:function(d,e,g){g?a&&(d=trovaRecord(c,"id",a),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?d:0)):msgShowError("",e.getError())}})},inserimentoFiltro:function(){var a=this.getCmbEnti();containerSolaLettura(this.getForm(),!1);this.getForm().show();this.visualizzaCombo(!0);IsolaCmp(this.getPanel(),!0);clearForm(this.getForm());this.getTreeManutentore().hide();
this.getCmbOrganizzazioni().getStore().removeAll();a.getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(b,c,d){d?1==b.length&&a.setValue(b[0]):msgShowError("",c.getError())}})},visualizzaCombo:function(a){this.getTxtOrganizzazione().setHidden(a);this.getCmbOrganizzazioni().setHidden(!a);this.getTxtEnte().setHidden(a);this.getCmbEnti().setHidden(!a);this.getCmbEnti().setValue("");this.getCmbOrganizzazioni().setValue("")},ripristina:function(a){var b=this.getGridFiltri();
IsolaCmp(a,!1);this.visualizzaCombo(!1);Ext.isEmpty(b.getSelection())?(clearForm(this.getForm()),this.getForm().setHidden(!0)):(this.aggiornaForm(),this.getTreeManutentore().show())},controllaCampi:function(){var a=this.getForm();a.getValues().id||(this.lookup("TxtIdEnte").setValue(this.getCmbEnti().getValue()),this.lookup("TxtIdOrg").setValue(this.getCmbOrganizzazioni().getValue()));return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","ERROR"),!1)},salvaForm:function(a){var b=
this.getForm();record=b.getValues();Ext.apply(record,{tipoFiltro:7});controller_salvaRecord(b,record,a)&&(IsolaCmp(this.getPanel(),!1),this.visualizzaCombo(!1))},ripristinaTree:function(){this.ripristina(this.getTreeManutentore())},editTree:function(){var a=this,b=[],c=a.filtroTeSelezionato.data.id;a.getTreeManutentore().getChecked().forEach(function(a){var d={};d.idManutentore=a.getData().id;d.idFiltriTe=c;b.push(d)});if(1>b.length){var d={};d.idFiltriTe=c;b.push(d)}IsolaCmp(a.getTreeManutentore(),
!1);Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/filtrimanutentore/update",jsonData:Ext.JSON.encode(b),success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaForm()):msgShowError("",b.message)}})},setCheckTreePanel:function(a,b,c){IsolaCmp(this.getTreeManutentore(),!0);this.disabilitaBtnAlbero(!1);b||a.parentNode.set("checked",b)},aggiornaForm:function(){var a=this;a.disabilitaBtnAlbero(!0);if(a.filtroTeSelezionato){var b=
"F"==a.filtroTeSelezionato.get("visibile");clearForm(a.getForm());containerSolaLettura(a.getForm(),b);a.getForm().store.load({params:{id:a.filtroTeSelezionato.data.id},callback:function(b,c,d){d&&!Ext.isEmpty(b)&&(a.getForm().show(),a.getForm().loadRecord(b[0]))}});var c=a.getTreeManutentore(),d=c.getStore();c.setDisabled(b);d.load({params:{idEnte:a.filtroTeSelezionato.data.idEnte,idOrganizzazione:a.filtroTeSelezionato.data.idOrganizzazione,idFiltroTe:a.filtroTeSelezionato.data.id},callback:function(b,
c,d){d?(a.getTreeManutentore().show(),a.getTreeManutentore().expandAll()):msgShowError("",c.getError())}})}},disabilitaBtnAlbero:function(a){this.getBtnConfermaTree().setDisabled(a);this.getBtnRipristinaTree().setDisabled(a)},onLaunch:function(){this.gestioneForm();this.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ImpostaProfili",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Grid",selector:this.selContainer+"#Grid"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"CntDettaglio",selector:this.selContainer+"#CntDettaglio"},{ref:"ColRegione",selector:this.selContainer+"#ColRegione"},{ref:"BtnSblocca",
selector:this.selContainer+"#BtnSblocca"}]);this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#Grid",{beforeedit:this.beforeeditGrid,edit:this.onEditGrid,canceledit:this.canceleditGrid,validateedit:this.validateeditGrid,select:this.selectGrid,itemdblclick:this.messggioModifica});this.control(this.selContainer+"#BtnSblocca",{click:this.clickBtnSblocca})},clickBtnSblocca:function(){var a=
this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(b){b?(a.lookup("BtnNuovo").show(),a.lookup("BtnElimina").show(),a.lookup("BtnSblocca").hide()):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()},messggioModifica:function(a,b,c,d){var e=this;Messaggio("ATTENZIONE","MSG_MODIFICA_TIPOLOGIA","YESNO","QUESTION",!1,!1,function(){e.aggiornaStore(b.get("id"))})},svuotaStore:function(){svuotaStore(this.controllerDe.getGridDet().getStore())},selectGrid:function(a,b){if(Ext.isEmpty(b))return this.getCntDettaglio().setDisabled(!0),
!1;this.getCntDettaglio().setDisabled(!1);var c=this.controllerDe.getGridDet();c.setDisabled(Ext.isEmpty(b));c.setTitle(traduci("Menu")+" "+b.get("descrizione"));this.svuotaStore();b.get("id")&&this.controllerDe.aggiornaStore()},canceleditGrid:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},onEditGrid:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();this.salvaRecord(d,c)||a.startEdit(b.record,0)},beforeeditGrid:function(a,
b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1);this.lookup("CbTipoAbilitazione").setReadOnly(this.lookup("BtnNuovo").isHidden());this.lookup("CbTipoAbilitazione").bindStore(this.storeEnumsTipo);this.lookup("CbProfiloFrom").bindStore(this.storeProfiliCssForCopy)},clickBtnElimina:function(a){var b=this;a=b.getGrid();var c=a.getSelectionModel().getSelection()[0];if(!c)return!1;controller_eliminaRecord(a.getStore(),{id:c.get("id"),codEntePwd:b.cbaConfig.codEntePwd},function(){b.aggiornaStore()})},
clickBtnNuovo:function(a){a=this.getGrid();a.getStore().insert(0,{});this.lookup("ColProfiloFrom").show();this.edit=!1;a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0)},abilitaBottoniGrid:function(a){IsolaCmp(this.getGrid(),!a);this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},aggiornaStore:function(a){var b=this.cbaConfig.idPwd,c=this.getGrid(),d=c.getStore();this.lookup("ColProfiloFrom").hide();d.load({params:{idOrganizzazione:getIdOrg(),idPwd:b?b:-1},callback:function(b,
g,h){h?(b=0,a&&((b=trovaRecord(d,"id",a))||(b=0)),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(b)):msgShowError("",g.getError())}})},validateeditGrid:function(a,b,c){return msgShow("",[])},salvaRecord:function(a,b){Ext.apply(b,{id:b.id,idOrganizzazione:this.cbaConfig.idOrg,stpColori:getBoolValue(b.stpColori),codProfiloPwd:this.cbaConfig.idPwd?this.cbaConfig.idPwd:-1,codEntePwd:this.cbaConfig.codEntePwd});var c,d=null;b.id||(c=!0,(d=a.findField("_tmp_idProfiloFrom").getValue())||
Ext.apply(b,{flagImportVociDefault:!0}));var e=controller_salvaRecord(a,b,!1,!1,!0);e&&c&&(this.abilitaBottoniGrid(!0),c=e.id,Ext.Ajax.request({method:"POST",url:"/cba/css/cs/ws/quartz/scheduler/profili",jsonData:Ext.JSON.encode(c),writer:{type:"json"},success:function(a){}}),d&&this.copiaFromProfilo(c,d));return e},copiaFromProfilo:function(a,b){var c=newIdElab(49);Ext.create("winElaborazione",{height:135,idElaborazione:c,alwaysOnTop:!0,urlGen:getPathGeneralModulo(null,49)}).start();Ext.Ajax.request({url:"/cba/css/cs/ws/profili/copy",
method:"GET",params:{idProfiloNew:a,idProfiloFrom:b,codEntePwd:this.cbaConfig.codEntePwd,idAvanzamentoElaborazione:c},timeout:36E5,success:function(a){controllaWinElaborazione();a=Ext.JSON.decode(a.responseText);a.success?this.controllerDe&&this.controllerDe.aggiornaStore():msgShowError("",a.messagge)}})},onLaunch:function(){var a=this;a.edit=!0;a.getGrid().controller=a;a.getCntDettaglio().add(Ext.create("Generali.gestPwdNew.view.ImpostaProfiliDe",{cbaConfig:{controllerTestata:a,idPwd:a.cbaConfig.idPwd}}));
a.controllerDe=a.getCntDettaglio().down("grid").controller;a.controllerDe.getColTipoBottone().editor.store.load({callback:function(b,c,d){d?a.aggiornaStore():msgShowError("",c.getError())}});a.getColRegione().editor.store.load();a.storeEnumsTipo=Ext.create("Generali.gestPwdNew.store.EnumTipologieCartellaTipi");a.storeProfiliCssForCopy=Ext.create("Generali.gestPwdNew.store.ImpostaProfili");a.storeEnumsTipo.load();a.storeProfiliCssForCopy.load({params:{codEntePwd:a.cbaConfig.codEntePwd},callback:function(a,
c,d){d||msgShowError("",c.getError())}})}});
Ext.define("Generali.gestPwdNew.controller.ImpostaProfiliDe",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridDet",selector:this.selContainer+"#GridDet"},{ref:"BtnNuovoBottone",selector:this.selContainer+"#BtnNuovoBottone"},{ref:"BtnEliminaBottone",selector:this.selContainer+"#BtnEliminaBottone"},{ref:"BtnMoveDown",selector:this.selContainer+"#BtnMoveDown"},{ref:"BtnMoveUp",selector:this.selContainer+
"#BtnMoveUp"},{ref:"ColTipoBottone",selector:this.selContainer+"#ColTipoBottone"},{ref:"ColTipoIcona",selector:this.selContainer+"#ColTipoIcona"}]);this.control(this.selContainer+"#BtnMoveDown",{click:this.clickBtnDown});this.control(this.selContainer+"#BtnMoveUp",{click:this.clickBtnMoveUp});this.control(this.selContainer+"#BtnNuovoBottone",{click:this.clickBtnNuovoBottone});this.control(this.selContainer+"#BtnEliminaBottone",{click:this.clickBtnEliminaBottoni});this.control(this.selContainer+"#GridDet",
{beforeedit:this.beforeeditGridDet,edit:this.editGridDet,canceledit:this.canceleditGridDet,validateedit:this.validateeditGridDet,select:this.controllaSelezione})},clickBtnEliminaBottoni:function(a){var b=this;a=b.getGridDet();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},clickBtnNuovoBottone:function(a){a=this.getGridDet();a.getSelectionModel().getSelection();a.getStore().insert(0,{idProfilo:this.cbaConfig.controllerTestata.getGrid().getSelectionModel().getSelection()[0].get("id"),
codEnte:this.cbaConfig.controllerTestata.getGrid().getSelectionModel().getSelection()[0].get("codEntePwd")});a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0);this.abilitaBottoniGridDet(!1)},controllaSelezione:function(a,b){var c=a.getStore(),d=c.indexOf(b);this.getBtnMoveUp().setDisabled(0==d);this.getBtnMoveDown().setDisabled(d==c.getCount()-1)},spostaRiga:function(a,b){var c=this;a.getStore();var d=a.getSelectionModel().getSelection()[0],e=d.get("id"),d=d.get("ordine");"down"==b?d++:
"up"==b&&d--;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/menuprofilibottoni/move",params:{id:e,pos:d},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c.aggiornaStore(e):msgShowError("",a.message)}})},clickBtnDown:function(){this.spostaRiga(this.getGridDet(),"down")},clickBtnMoveUp:function(){this.spostaRiga(this.getGridDet(),"up")},aggiornaStore:function(a){var b=this.cbaConfig.idPwd,c=this.getGridDet(),d=c.getStore();d.load({params:{idProfilo:this.cbaConfig.controllerTestata.getGrid().getSelectionModel().getSelection()[0].get("id"),
idPwd:b?b:-1},callback:function(b,g,h){h?(b=0,a&&((b=trovaRecord(d,"id",a))||(b=0)),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(b)):msgShowError("",g.getError())}})},droppa:function(a,b,c,d){var e=this;a=b.records[0].data.id;b=b.records[0].data.ordine;c=c.get("ordine");b>c?"after"==d&&c++:c>b&&"before"==d&&c--;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/menuprofilibottoni/move",params:{id:a,pos:c},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?e.aggiornaStore():
msgShowError("",a.message)}})},beforeeditGridDet:function(a,b,c){this.abilitaBottoniGridDet(!1);if(!0===a.editing)return!1},canceleditGridDet:function(a,b,c){this.abilitaBottoniGridDet(!0);this.aggiornaStore(b.record.get("id"))},abilitaBottoniGridDet:function(a){IsolaCmp(this.getGridDet(),!a);this.getBtnNuovoBottone().setDisabled(!a);this.getBtnEliminaBottone().setDisabled(!a);this.getBtnMoveDown().setDisabled(!a);this.getBtnMoveUp().setDisabled(!a)},editGridDet:function(a,b,c){c=b.record.getData();
var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();Ext.apply(c,{id:c.id});controller_salvaRecord(d,c,!1,!1,!1)?this.abilitaBottoniGridDet(!0):a.startEdit(b.record,0)},validateeditGridDet:function(a,b,c){return msgShow("",[])},onLaunch:function(){var a=this,b=a.getGridDet();b.getStore();b.controller=a;a.getGridDet().getView().addListener("drop",function(b,d,e,g){a.droppa(b,d,e,g)})}});
Ext.define("Generali.gestPwdNew.controller.ImpostazioniModuloCSS",{extend:"Generali.standard.ViewController",init:function(){var a=this,b="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridTipologiaCartella",selector:b+"#GridTipologiaCartella"},{ref:"BtnEsci",selector:b+"#BtnEsci"},{ref:"TabPanel",selector:b+"#TabPanel"},{ref:"FormProfilo",selector:b+"#FormProfilo"},{ref:"TreePermessi",selector:b+"#TreePermessi"},{ref:"BtnAggiungi",selector:b+"#BtnAggiungi"},{ref:"BtnEliminaPnlTipo",
selector:b+"#BtnEliminaPnlTipo"},{ref:"BtnCopiaSpecial",selector:b+"#BtnCopiaSpecial"},{ref:"CmbProfili",selector:b+"#CmbProfili"},{ref:"BtnCollassaTutto",selector:b+"#BtnCollassaTutto"},{ref:"BtnEspandiTutto",selector:b+"#BtnEspandiTutto"},{ref:"TreePortletNonAssociati",selector:b+"#TreePortletNonAssociati"},{ref:"CmbBottoni",selector:b+"#CmbBottoni"},{ref:"BtnAssocia",selector:b+"#BtnAssocia"},{ref:"BtnDissocia",selector:b+"#BtnDissocia"},{ref:"BtnCollassaTuttoPNA",selector:b+"#BtnCollassaTuttoPNA"},
{ref:"BtnEspandiTuttoPNA",selector:b+"#BtnEspandiTuttoPNA"}]);a.control(b+"#BtnEsci",{click:a.clickBtnEsci});a.control(b+"#BtnEliminaPnlTipo",{click:a.clickBtnEliminaTipo});a.control(b+"#TabPanel",{tabchange:a.changeTabPanel});a.control(b+"#BtnCollassaTutto",{click:a.btnClickCollassaTutto});a.control(b+"#BtnEspandiTutto",{click:a.btnClickEspandiTutto});a.control(b+"#BtnCollassaTuttoPNA",{click:a.btnClickCollassaTutto});a.control(b+"#BtnEspandiTuttoPNA",{click:a.btnClickEspandiTutto});a.control(b+
"#GridTipologiaCartella",{selectionchange:a.selectProfiloCs,beforeedit:a.beforeEditGrid,canceledit:a.canceleditGrid,edit:a.editGrid});a.control(b+"#BtnAggiungi",{click:a.clickBtnAggiungi});a.control(b+"#BtnCopiaSpecial",{click:a.clickBtnCopia});a.control(b+"#TreePermessi",{beforeedit:a.beforeeditTree,edit:a.editTree,canceledit:a.canceleditTree,selectionchange:a.selectTreePermessi});a.control(b+"#TreePortletNonAssociati",{checkchange:a.checkChangeTree});a.control(b+"#CmbBottoni",{change:a.changeCmbBottoni});
a.control(b+"#BtnAssocia",{click:a.clickBtnAssocia});a.control(b+"#BtnDissocia",{click:a.clickBtnDissocia});a.control(b+"#TxtSearchDescrizione",{change:Ext.Function.createBuffered(function(b,d){a.changeTxtSearch(d)},400,a)})},changeTxtSearch:function(a){var b=this.getTreePermessi();a&&0<a.length?this.filterByString(b,a):this.expandAll(b)},filterStore:function(a){var b=this.getTreePermessi().getStore();a=a.toLowerCase();var c=function(a){var b=a.childNodes,e=b&&b.length,k;if(a=d.test(a.get("text")))for(k=
0;k<e;k++)b[k].set("visible",!0);else for(k=0;k<e&&!(a=b[k].isLeaf()?b[k].get("visible"):c(b[k]));k++);return a},d;1>a.length?b.clearFilter():(d=new RegExp(a,"i"),b.getFilters().replaceAll({filterFn:c}))},selectTreePermessi:function(a,b,c){a=b[0];if(Ext.isEmpty(a))return!1;2!==a.get("livello")||a.get("leaf")?this.getBtnDissocia().setDisabled(!0):this.getBtnDissocia().setDisabled(!1)},clickBtnAssocia:function(){var a=this,b=a.getTreePortletNonAssociati();a.getCmbBottoni();var c="";b.getRootNode().cascadeBy(function(a){2===
a.get("livello")&&!0===a.get("checked")&&(c+=a.get("nodeId")+",")});if(!Ext.isEmpty(c)){var d=a.getGridTipologiaCartella().getSelectionModel().getSelection(),b=d[0].get("id"),e=a.getCmbBottoni().getValue();permesso=a.lookup("CmbPermesso").getValue()?a.lookup("CmbPermesso").getValue():"N";Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/portletprofili/associa",params:{idPortletEnteList:c,idProfiloPwdDeCss:b,idBottoneDest:e,permesso:permesso},success:function(b){b=Ext.JSON.decode(b.responseText);
var c=[];b.success?(msgAdd(c,b.message),msgShow("MSG_SALVATAGGIO_DATI",c),a.aggiornaTrees(d,b.data,permesso)):msgShowError("",b.message)}})}},clickBtnDissocia:function(){var a=this,b=a.getTreePermessi().getSelectionModel().getSelection()[0];Ext.isEmpty(b)||Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/portletprofili/dissocia",params:{idPortletEnte:b.get("nodeId"),idProfiloPwdDe:a.cbaConfig.idPwd,idBottone:b.parentNode.get("nodeId")},success:function(b){b=Ext.JSON.decode(b.responseText);var c=
[];b.success?(msgAdd(c,b.message),msgShow("MSG_ELIMINAZIONE_DATI",c),a.aggiornaTrees(a.getGridTipologiaCartella().getSelectionModel().getSelection())):msgShowError("",b.message)}})},changeCmbBottoni:function(a,b,c,d){Ext.isEmpty(b)?this.getBtnAssocia().setDisabled(!0):this.getBtnAssocia().setDisabled(!1)},afterCheckChangeTree:function(a,b){var c=this;c.contatore++;1===c.contatore&&c.getCmbBottoni().getStore().load({params:{codEnte:c.cbaConfig.codEnte,tipo:a.get("tipo"),idProfiloPwdDeCss:c.cbaConfig.idProfiloPwdDeCss},
callback:function(a,b,g){g&&!Ext.isEmpty(a)&&(c.getCmbBottoni().setDisabled(!1),1===a.length&&c.getCmbBottoni().setValue(a[0]))}});b.getRootNode().cascadeBy(function(b){2===b.get("livello")&&a.get("tipo")!==b.get("tipo")&&b.set("checked",null)})},checkChangeTree:function(a,b){var c=this.getTreePortletNonAssociati();if(b)this.afterCheckChangeTree(a,c);else{this.contatore--;var d=!0;c.getRootNode().cascadeBy(function(a){2===a.get("livello")&&!0===a.get("checked")&&(d=!1)});d&&(this.contatore=0,c.getRootNode().cascadeBy(function(a){2===
a.get("livello")&&a.set("checked",!1)}),this.getCmbBottoni().getStore().clearData(),this.getCmbBottoni().setValue(""),this.getCmbBottoni().setDisabled(!0),this.getBtnAssocia().setDisabled(!0))}},changeTabPanel:function(a,b){if("TabProfiliBottoni"===b.getItemId()){b.removeAll();var c=Ext.create("Generali.gestPwdNew.view.ImpostaProfili",{cbaConfig:{idPwd:this.cbaConfig.idPwd,idOrg:this.cbaConfig.idOrg,codEntePwd:this.cbaConfig.codEnte}});b.add(c)}else this.aggiornaStore()},selectProfiloCs:function(a,
b){if(!b[0])return!1;this.espandi=!1;this.aggiornaTrees(b)},aggiornaTrees:function(a){var b=this;a=a[0].get("id");if(Ext.isEmpty(a))return!1;var c=b.lookup("TxtSearchDescrizione");b.getCmbBottoni().getStore().clearData();b.getCmbBottoni().setValue("");b.getCmbBottoni().setDisabled(!0);b.getBtnAssocia().setDisabled(!0);b.contatore=0;b.cbaConfig.idProfiloPwdDeCss=a;svuotaStore(b.getTreePermessi().getStore());svuotaStore(b.getTreePortletNonAssociati().getStore());b.getTreePermessi().getStore().load({params:{idProfiloPwdDeCss:b.cbaConfig.idProfiloPwdDeCss},
callback:function(a,e,g){g?(Ext.suspendLayouts(),Ext.isEmpty(c.getValue())||b.changeTxtSearch(c.getValue()),b.collapsePortlet(b.getTreePermessi()),Ext.resumeLayouts()):msgShowError("",e.getError())}});b.getTreePortletNonAssociati().getStore().load({params:{idProfiloPwdDeCss:b.cbaConfig.idProfiloPwdDeCss},callback:function(a,c,g){g?(Ext.suspendLayouts(),b.collapsePortlet(b.getTreePortletNonAssociati()),Ext.resumeLayouts()):msgShowError("",c.getError())}})},canceleditTree:function(){this.storeTipoPermesso.clearFilter()},
beforeeditTree:function(a,b,c){if(!0===a.editing||null!=b.record.getData().iconCls)return!1;var d=""+b.record.getData().tipo;this.storeTipoPermesso=a.getEditor().getForm().findField("tipoPermesso").getStore();this.storeTipoPermesso.filterBy(function(a){return-1!=a.get("extra").indexOf(d)})},editTree:function(a,b,c){var d=this,e=d.lookup("TxtSearchDescrizione");d.canceleditTree();a=b.record.getData();Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/videatepwd/setpermesso",params:{id:a.nodeId,tipoPermesso:b.newValues.tipoPermesso},
success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(svuotaStore(d.getTreePermessi().getStore()),d.getTreePermessi().getStore().load({params:{idProfiloPwdDeCss:d.cbaConfig.idProfiloPwdDeCss},callback:function(a,c,g){g?(Ext.suspendLayouts(),Ext.isEmpty(e.getValue())?!1===d.espandi?d.collapsePortlet(d.getTreePermessi(),b.record):d.expandAll(d.getTreePermessi()):d.changeTxtSearch(e.getValue()),Ext.resumeLayouts()):msgShowError("",c.getError())}})):msgShowError("",a.message)}})},clickBtnEsci:function(a){a.up("window").close()},
onLaunch:function(){var a=this;a.storeTipoBottone=Ext.create("Generali.gestPwdNew.store.TipoBottone");a.getBtnCopiaSpecial().setVisible("T"==CBA.parametriGenerali.amministratore);a.aggiornaStore();a.contatore=0;a.getTreePermessi().getView().addListener({beforedrop:function(b,d,e,g,h,k){a.beforeDrop(b,d,e,g,h,k)}});var b=a.getTabPanel().queryById("TabProfiliBottoni");a.changeTabPanel(null,b);a.lookup("CmbPermesso").getStore().filterBy(function(a){return-1!=a.get("extra").indexOf(1)});a.lookup("CmbPermesso").setValue("N")},
aggiornaStore:function(a){var b=this,c=b.getGridTipologiaCartella(),d=c.getStore();svuotaStore(d);d.load({params:{idProfiloPwdDe:b.cbaConfig.idPwd,filtraTipAbilitate:!1},callback:function(e,g,h){h&&a&&(e=0,a&&((e=trovaRecord(d,"id",a))||(e=0)),c.getSelectionModel().deselectAll(),c.getSelectionModel().select(e));b.winCopy&&b.winCopy.close()}})},beforeDrop:function(a,b,c,d,e,g){if(2!=b.records[0].get("livello"))return msgShow("","E' possibile trascinare solo i Portlet!"),e.cancelDrop(),!1;if(1!=c.get("livello")&&
(2!=c.get("livello")||"after"!=d&&"before"!=d))return msgShow("","Non  possibile trascinare i Portlet sotto questo livello!"),e.cancelDrop(),!1;if(-1!=c.get("tipo")&&b.records[0].get("tipo")!=c.get("tipo"))return msgShow("","Il tipo di Portlet ed il tipo di Bottone non coincidono!"),e.cancelDrop(),!1;var h=this;a=h.cbaConfig.idPwd;e=b.records[0].get("nodeId");g=c.get("nodeId");var k=b.records[0].parentNode.data.nodeId,l=0,m=0;if(2==c.get("livello"))if(l=c.get("ordine"),m=b.records[0].get("ordine"),
m>l)"after"==d&&l++;else if(m<l)"before"==d&&l--;else return;else 1==c.get("livello")&&(l=1);2==c.get("livello")&&(g=c.parentNode.data.nodeId);Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/portletprofili/move",params:{idProfiloPwdDe:a,idPortletEnte:e,idBottoneDest:g,idBottoneSource:k,ordine:l},success:function(a){a=Ext.JSON.decode(a.responseText);a.success||msgShowError("",a.message);h.getTreePermessi().getStore().load({params:{idProfiloPwdDeCss:h.cbaConfig.idProfiloPwdDeCss},callback:function(a,
b,c){c?(Ext.suspendLayouts(),!1===h.espandi?h.collapsePortlet(h.getTreePermessi()):h.expandAll(h.getTreePermessi()),Ext.resumeLayouts()):msgShowError("",b.getError())}})}})},beforeEditGrid:function(a,b,c){this.abilitaBottoniGrid(!1);if(!0===a.editing)return!1},editGrid:function(a,b){var c=b.newValues,d=this.getGridTipologiaCartella().getStore();1<d.getData().length?this.openWinCopy(d,c):this.salvaNuovaTipologia(c)},openWinCopy:function(a,b){var c=this,d=Ext.create("Generali.gestPwdNew.store.ProfiliPwdDeCss");
d.loadData(a.getData().items);c.winCopy=Ext.create("winCBA",{larghezzaWin:420,altezzaWin:200,layout:"fit",maximizable:!1,titolo:traduci("Nuova associazione"),closable:!1,name:[{xtype:"form",layout:{type:"hbox"},html:traduci("MSG_COPY_PROFILOCSS"),flex:1,labelClsExtra:"cbaLabel",bodyPadding:15,items:[{xtype:"fieldcontainer",fieldLabel:"Copiare impostazioni?",labelAlign:"top",defaultType:"radiofield",margin:"40 0 0 0",width:150,layout:"hbox",items:[{boxLabel:"Si",inputValue:"T",margin:"0 0 0 0",cls:"cbaLabel",
name:"radiof",listeners:{change:function(a,b){var c=a.up("form").down("combobox");c.setHidden(!b);c.setDisabled(!b)}}},{boxLabel:"No",inputValue:"F",cls:"cbaLabel",checked:!0,margin:"0 0 0 5",name:"radiof"}]},{xtype:"combobox",valueField:"idProfiloCss",displayField:"descProfiloCss",queryMode:"local",store:d,labelAlign:"top",fieldLabel:"Tipoogia Cartella",disabled:!0,hidden:!0,margin:"40 0 0 0",flex:1,labelClsExtra:"cbaLabel",allowBlank:!1}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},
{xtype:"button",cls:"cbaCssBtnFunzione",text:traduci("CONFERMA"),iconCls:"icon-conferma",handler:function(a){a=a.up("form");a.isValid()?(a.down("combobox").getValue()&&Ext.apply(b,{idProfiloCssCopy:a.down("combobox").getValue()}),c.salvaNuovaTipologia(b)):Messaggio("ERROR","MSG_CAMPI_OBBLIGATORI","OK")}},{xtype:"button",cls:"cbaCssBtnFunzione",text:traduci("ANNULLA"),iconCls:"icon-elimina",handler:function(a){c.ripristinaGrid()}}]}]}]}).show()},salvaNuovaTipologia:function(a){var b=this.getGridTipologiaCartella();
Ext.apply(a,{idProfiloPwdDe:this.cbaConfig.idPwd});controller_salvaRecord(b,a,!1,!1,!0)?this.abilitaBottoniGrid(!0):this.ripristinaGrid()},canceleditGrid:function(a,b,c){this.ripristinaGrid(b.record.get("id"))},ripristinaGrid:function(a){this.abilitaBottoniGrid(!0);this.aggiornaStore(a)},clickBtnAggiungi:function(a){var b=this,c=b.getGridTipologiaCartella(),d=b.getCmbProfili().getStore();d.load({params:{idPwd:b.cbaConfig.idPwd},callback:function(a,g,h){if(h){var e=c.getStore();d.clearFilter();d.filterBy(function(a){return!trovaRecord(e,
"idProfiloCss",a.get("codice"))});e.insert(0,{});b.edit=!1;c.getSelectionModel().select(0);c.getPlugin().startEdit(0,0)}else msgShowError("ERRORE",g.getError())}})},clickBtnCopia:function(a){a=this.getGridTipologiaCartella();if(Ext.isEmpty(a.getSelection()))return msgShow("","Selezionare una Tipologia Cartella..."),!1;Ext.create("winCBA",{name:"Generali.gestPwdNew.view.CopiaTipologiaSpecial",larghezzaWin:420,altezzaWin:170,layout:"fit",maximizable:!1,titolo:traduci("Selezionare il Profio e la Tipologia di destinazione"),
closable:!1,configItem:{codEnte:this.cbaConfig.codEnte,codProfiloPwd:this.cbaConfig.codProfiloPwd,tipologiaSource:a.getSelectionModel().getSelection()[0].get("idProfiloCss"),profiloPwdDeSource:this.cbaConfig.idPwd}}).show()},clickBtnEliminaTipo:function(a){a=this.getGridTipologiaCartella();var b=a.getSelectionModel().getSelection()[0];if(!b)return!1;var c=null;b.get("id")==CBA.parametriGenerali.idProfiloPwdDeCss&&(c="MSG_ELIM_TPG_CRT_PWD");this.eliminaTipologiaCartellaAssociata(a.getStore(),b,c)},
eliminaTipologiaCartellaAssociata:function(a,b,c){var d=this;controller_eliminaRecord(a,{id:b.get("id")},function(){b.get("id")==CBA.parametriGenerali.idProfiloPwdDeCss&&doLogout();svuotaStore(d.getTreePermessi().getStore());svuotaStore(d.getTreePortletNonAssociati().getStore());d.aggiornaStore()},null,c)},abilitaBottoniGrid:function(a){IsolaCmp(this.getGridTipologiaCartella(),!a);this.getBtnAggiungi().setDisabled(!a);this.getBtnEliminaPnlTipo().setDisabled(!a)},btnClickCollassaTutto:function(a){a=
a.up().up();"TreePermessi"===a.getItemId()&&(this.espandi=!1);Ext.suspendLayouts();this.collapsePortlet(a);Ext.resumeLayouts()},btnClickEspandiTutto:function(a){a=a.up().up();"TreePermessi"===a.getItemId()&&(this.espandi=!0);Ext.suspendLayouts();this.expandAll(a);Ext.resumeLayouts()},destroy:function(){eliminaStore(this.storeVideate);this.callParent()},updateTreeView:function(a,b){var c=a.getView(),d=b(a.getRootNode());d&&0<d.length&&(svuotaStore(c.getStore()),c.getStore().loadRecords(d),a.getSelectionModel().deselectAll(),
a.ensureVisible=Ext.emptyFn,c.refresh())},collapsePortlet:function(a,b){var c=this,d=a.getView(),e=[];a.getRootNode().childNodes.forEach(function(a){var d=c.setExpandedFalse(a,b);e.push(a);d.forEach(function(a){e.push(a);!0===a.get("expanded")&&a.childNodes.forEach(function(a){e.push(a)})})});svuotaStore(d.getStore());a.getSelectionModel().deselectAll();d.getStore().loadRecords(e);a.ensureVisible=Ext.emptyFn;d.refresh()},setExpandedFalse:function(a,b){var c=[],d=Ext.isEmpty(b)?-999:b.parentNode.get("nodeId");
a.cascadeBy(function(a){2===a.get("livello")&&(a.set("expanded",!1),a.get("nodeId")===d&&a.set("expanded",!0),c.push(a))});return c},expandAll:function(a){this.updateTreeView(a,function(b){var c=[];b.cascadeBy(function(b){if(!b.isRoot()||a.rootVisible)b.data.expanded=!0,c.push(b)});return c})},filterByString:function(a,b){var c=new RegExp(b,"i");this.updateTreeView(a,function(b){var d=[],g=null,h=[];b.cascadeBy(function(b){if(!b.isRoot()||a.rootVisible)b.data.expanded=!0,g&&g.id==b.parentNode.id||
(0<h.length&&(d.push(g),d=d.concat(h)),g=b.parentNode,h=[]),(b.isLeaf()||1!=b.get("livello"))&&c.test(b.get("text"))&&h.push(b)});return d})}});
Ext.define("Generali.gestPwdNew.controller.ModificaPwd",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnRipristina",selector:a+"#BtnRipristina"},{ref:"TxtVecchiaPwd",selector:a+"#TxtVecchiaPwd"},{ref:"TxtNuovaPwd",selector:a+"#TxtNuovaPwd"},{ref:"TxtConfermaPwd",selector:a+"#TxtConfermaPwd"},{ref:"Form",selector:a+"#Form"}]);this.control(a+"#BtnConferma",{click:this.clickBtnConferma});
this.control(a+"#BtnRipristina",{click:this.clickBtnRipristina});this.control(a+"#TxtConfermaPwd",{specialkey:this.onTxtConfermaSpecialkey})},onTxtConfermaSpecialkey:function(a,b,c){b.getKey()==Ext.event.Event.ENTER&&this.clickBtnConferma()},clickBtnRipristina:function(){clearForm(this.getForm());this.getTxtVecchiaPwd().focus()},clickBtnConferma:function(){var a=this;if(a.controllaModifica()){var b={codice:a.getTxtVecchiaPwd().getValue(),valore:a.getTxtNuovaPwd().getValue(),extra:a.getTxtConfermaPwd().getValue()};
Ext.isEmpty(b)||Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/utentipwd/editPwd",jsonData:Ext.JSON.encode(b),writer:{type:"json"},success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?(msgAdd(c,b.message),a.getForm().up("window").close(),msgShow("MSG_SALVATAGGIO_DATI",c)):(b.message?msgAddError(c,b.message):msgAddError(c,"INVALID_NEWPWD"),msgShowError("",c),clearForm(a.getForm()),a.getTxtVecchiaPwd().focus())}})}},controllaModifica:function(){if(!this.getForm().isValid())return!1;
if(this.getTxtNuovaPwd().getValue()!==this.getTxtConfermaPwd().getValue())return msgShowError("","MSG_CORRETTEZZA_CAMPI"),!1;var a=validatePassword(this.getTxtConfermaPwd().getValue());return a?(msgShowError("",a),!1):!0},onLaunch:function(){CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione&&(this.getTxtNuovaPwd().minLength=10,this.getTxtConfermaPwd().minLength=10)}});
Ext.define("Generali.gestPwdNew.controller.Moduli",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"Panel",selector:a+"#Panel"},{ref:"Container",selector:a+"#Container"},{ref:"GridMod",selector:a+"#GridMod"},{ref:"CheckBox",selector:a+"#CheckBox"}]);this.control(a+"#GridMod",{edit:this.modifica});this.control(a+"#BtnEsci",{click:this.clickEsci})},clickEsci:function(a){a.up("window").close()},
ripristina:function(){IsolaCmp(this.getForm(),!1);this.aggiornaStore()},gestioneGrid:function(){var a=this.getGridMod();this.getPanel();a.permesso="S";a.controller=this},modifica:function(a,b){var c=this.getGridMod();b.record.set("idEnte",this.cbaConfig.idEnte);controller_salvaRecord(c,b.record.data,!1,!1,!0,!1,"codModulo")},aggiornaStore:function(){var a=this;this.getGridMod().getStore().load({params:{idEnte:a.cbaConfig.idEnte},callback:function(b,c,d){d||(msgShowError("",c.getError()),a.cbaConfig.controllerEntiImp.getTabPanel().setActiveTab("PnlImpostazioni"))}})},
onLaunch:function(){this.getContainer().controller=this;this.gestioneGrid();this.aggiornaStore()},destroy:function(){eliminaStore(this.storeImpostazioni);this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ModuliProfiliPwd",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Container",selector:a+"#Container"},{ref:"GridEntiOrg",selector:a+"#GridEntiOrg"},{ref:"GridModuli",selector:a+"#GridModuli"}]);this.control(a+"#GridEntiOrg",{selectionchange:this.caricaModuliOrgEnte});this.control(a+"#GridModuli",{edit:this.modifica})},gestioneVideata:function(){var a=
this,b=this.getGridEntiOrg();b.permesso="S";b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{esci_callback:function(){b.up("window").close()},nuovo_callback:function(){a.inserimentoNuovoProfiloEnteOrg()},elimina_callback:function(){a.eliminaRecordEnteOrg()}}});inserisciBottoni(a.getBoxBottoni(),c,!0);a.getBoxBottoni().queryById("btnConferma").setHidden(!0);a.getBoxBottoni().queryById("btnAnnulla").setHidden(!0);a.getBoxBottoni().queryById("btnEsci").setHidden(!0);
a.getBoxBottoni().queryById("btnNuovo").setDisabled(!0);a.getBoxBottoni().queryById("btnElimina").setDisabled(!0)},caricaModuliOrgEnte:function(a,b){if(!Ext.isEmpty(b)&&0<b.length){var c=b[0],d="F"==c.get("visibile");this.cbaConfig.idEnte=c.get("codEnte");this.cbaConfig.idOrg=c.get("idOrganizzazione");this.cbaConfig.idPwd=c.get("id");this.aggiornaModuli(d)}},aggiornaModuli:function(a){var b=this.getGridModuli(),c=b.getStore();b.setDisabled(a);c.load({params:{idEnte:this.cbaConfig.idEnte,idOrg:this.cbaConfig.idOrg,
codProfilo:this.codProfilo},callback:function(a,b,c){c||msgShowError("",b.error[0].testo)}})},modifica:function(a,b){var c=this.getGridModuli();b.record.set("modAttivoPerOrg",b.newValues.modAttivoPerOrg);b.record.set("idPwd",this.cbaConfig.idPwd);controller_salvaRecord(c,b.record.data,!1,!1,!0,!1,"codModulo")},caricaOrgEnte:function(a,b){if(b){var c=a.up("window").queryById("CbxOrg").getStore();c.removeAll();c.load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,c){}})}},
inserimentoNuovoProfiloEnteOrg:function(){var a=this;a.getGridEntiOrg();var b=Ext.create("Ext.window.Window",{title:"Aggiungi un ente al profilo "+a.descrizioneProfilo,itemId:"WinEnteOrg",reference:"WinEnteOrg",height:200,width:400,modal:!0,layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"form",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"combobox",itemId:"CbxEnti",queryMode:"local",fieldLabel:"Ente",name:"codEnte",valueField:"codice",displayField:"valore",store:Ext.create("Generali.gestPwdNew.store.Enti"),
margin:"25 10 5 10",allowBlank:!1,listeners:{change:a.caricaOrgEnte}},{xtype:"combobox",itemId:"CbxOrg",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),fieldLabel:"Organizzazione",name:"idOrganizzazione",valueField:"codice",displayField:"valore",margin:"5 10 5 10",allowBlank:!1}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"container",itemId:"BoxBottoniWinEnteOrg"}]}]}],closable:!0});b.on("show",function(a){a.down("form").getForm().findField("codEnte").focus(!0);
a.queryById("CbxEnti").store.load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(a,b,c){}})});b.on("close",function(){a.getBoxBottoni().queryById("btnNuovo").setDisabled(!1);a.getBoxBottoni().queryById("btnElimina").setDisabled(!1);a.getBoxBottoni().queryById("btnEsci").setDisabled(!1)});a.gestioneWin(b);b.show()},gestioneWin:function(a){var b=this;a.boxBottoni=a.queryById("BoxBottoniWinEnteOrg");var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(c){b.salvaForm(!0,
a.down("form"))},annulla_callback:function(){b.ripristina(a)},verificaCampiForm_callback:function(){return b.controllaCampi(a.down("form"))}}});inserisciBottoni(a.boxBottoni,c,!0);a.boxBottoni.queryById("btnNuovo").setHidden(!0);a.boxBottoni.queryById("btnElimina").setHidden(!0);a.boxBottoni.queryById("btnEsci").setHidden(!0);a.boxBottoni.queryById("btnConferma").setDisabled(!1);a.boxBottoni.queryById("btnAnnulla").setDisabled(!1)},controllaCampi:function(a){return a.isValid()?!0:(Messaggio("ATTENZIONE",
"MSG_CAMPI_OBBLIGATORI","OK","INFORMATION"),!1)},ripristina:function(a){clearForm(a.down("form"));a.down("form").getForm().findField("codEnte").focus(!0);a.boxBottoni.queryById("btnConferma").setDisabled(!1);a.boxBottoni.queryById("btnAnnulla").setDisabled(!1)},salvaForm:function(a,b){grid=this.getGridEntiOrg();var c=b.getForm().getFieldValues();Ext.apply(c,{id:"",codProfilo:this.codProfilo});controller_salvaRecord(grid,c,!1,!1,!0,!1)?b.up("window").close():(b.up("window").boxBottoni.queryById("btnConferma").setDisabled(!1),
b.up("window").boxBottoni.queryById("btnAnnulla").setDisabled(!1))},eliminaRecordEnteOrg:function(){var a=this,b=a.getGridEntiOrg();if(!b.selection)return!1;var c=b.getSelectionModel().getSelection()[0];c&&c.get("id")&&("F"==c.get("visibile")?Messaggio("ERRORE","NO_PERMESSI_PROFILI","OK","ERROR"):controller_eliminaRecord(b.store,{id:c.get("id")},function(){a.getGridModuli().getStore().removeAll();a.aggiornaStore()}))},aggiornaStore:function(){var a=this,b=a.getGridEntiOrg().getStore();b.load({params:{codProfilo:a.codProfilo,
filtraOrgAutor:isAmministratoreOrg()},callback:function(c,d,e){e?(a.getBoxBottoni().queryById("btnNuovo").setDisabled(!1),0<b.count()?a.getBoxBottoni().queryById("btnElimina").setDisabled(!1):a.getBoxBottoni().queryById("btnElimina").setDisabled(!0)):(msgShowError("",d.getError()),svuotaStore(b))}})},winModificaPermessi:function(a){a.get("modAttivoPerOrg")&&(49===a.get("codModulo")?Ext.create("winCBA",{name:"Generali.gestPwdNew.view.ImpostazioniModuloCSS",maximizable:!1,larghezzaWin:1500,altezzaWin:850,
layout:"fit",configItem:{rec:a,idPwd:this.cbaConfig.idPwd,codProfiloPwd:this.codProfilo,codEnte:this.cbaConfig.idEnte,idOrg:this.cbaConfig.idOrg}}):Ext.create("winCBA",{name:"Generali.gestPwdNew.view.PermessiModuli",maximizable:!1,closable:!0,larghezzaWin:900,altezzaWin:600,configItem:{rec:a,idPwd:this.cbaConfig.idPwd}})).show()},onLaunch:function(){this.getContainer().controller=this;this.gestioneVideata()}});
Ext.define("Generali.gestPwdNew.controller.Organizzazioni",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"Form",selector:a+"#Form"},{ref:"Container",selector:a+"#Container"},{ref:"GridOrg",selector:a+"#GridOrg"},{ref:"CbxProvince",selector:a+"#CbxProvince"},{ref:"CbxComuni",selector:a+"#CbxComuni"},{ref:"CbxOrgAmm",selector:a+"#CbxOrgAmm"},{ref:"ContainerForm",selector:a+
"#ContainerForm"},{ref:"PnlPersAdHoc",selector:a+"#PnlPersAdHoc"},{ref:"OrgPtlPers",selector:a+"#OrgPtlPers"},{ref:"BtnOrgEnti",selector:a+"#BtnOrgEnti"},{ref:"CkbEsterno",selector:a+"#CkbEsterno"},{ref:"TPDatiAgg",selector:a+"#TPDatiAgg"},{ref:"TxtGruppo",selector:a+"#TxtGruppo"},{ref:"PersonStampe_logoSx",selector:a+"#PersonStampe_logoSx"},{ref:"PersonStampe_logoDx",selector:a+"#PersonStampe_logoDx"},{ref:"PersonStampe_uploadLogoDx",selector:a+"#PersonStampe_uploadLogoDx"},{ref:"PersonStampe_uploadLogoSx",
selector:a+"#PersonStampe_uploadLogoSx"},{ref:"CbxComuniFiscale",selector:a+"#CbxComuniFiscale"},{ref:"CbxProvinceFiscale",selector:a+"#CbxProvinceFiscale"},{ref:"PnlParamFatt",selector:a+"#PnlParamFatt"},{ref:"OrgZucchetti",selector:a+"#OrgZucchetti"}]);this.control(a+"#BtnOrgEnti",{click:this.clickBtnOrgEnti});this.control(a+"#GridOrg",{selectionchange:this.caricaDatiOrgSel});this.control(a+"#CbxProvince",{change:this.caricaComuni});this.control(a+"#CbxProvinceFiscale",{change:this.caricaComuni});
this.control(a+"#PersonStampe_logoSx",{afterrender:this.onImageAfterRenderImgSx});this.control(a+"#PersonStampe_logoDx",{afterrender:this.onImageAfterRenderImgDx});this.control(a+"#PersonStampe_uploadLogoSx",{change:this.onFilefieldChangePersonStampe_uploadLogoSx});this.control(a+"#PersonStampe_uploadLogoDx",{change:this.onFilefieldChangePersonStampe_uploadLogoDx})},uploadLogo:function(a,b,c){var d=this,e=CBA.parametriGenerali.codEntePwd,g=b.lastIndexOf("\\")||b.lastIndexOf("/");b=b.substring(g+1);
""!==b&&(a=a.fileInputEl.dom.files[0],b=new FormData,b.append("file",a),Ext.Ajax.request({url:"/cba/gen/ws/general/reports/design/"+c+"/upload?idPwdEnte="+e+"&idOrganizzazione="+d.cbaConfig.id,method:"POST",rawData:b,headers:{"Content-Type":null},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgShow("TRASFERIMENTO_FILE",a.message),a="logoSx"==c?d.getPersonStampe_logoSx():d.getPersonStampe_logoDx(),setSrcImage(a,"/cba/gen/ws/general/reports/design/"+c+"/download?idPwdEnte="+e+"&idOrganizzazione="+
d.cbaConfig.id+"&date="+(new Date).getTime())):msgShowError("",a.message)}}))},onFilefieldChangePersonStampe_uploadLogoSx:function(a,b,c){this.uploadLogo(a,b,"logoSx")},onFilefieldChangePersonStampe_uploadLogoDx:function(a,b,c){this.uploadLogo(a,b,"logoDx")},onImageAfterRenderImgDx:function(a,b){"L"!=this.permesso&&(a.urlDelete="/cba/gen/ws/general/reports/design/logoDx/delete?idPwdEnte="+CBA.parametriGenerali.codEntePwd+"&idOrganizzazione="+this.cbaConfig.id,getPopupMenuFoto(a))},onImageAfterRenderImgSx:function(a,
b){"L"!=this.permesso&&(a.urlDelete="/cba/gen/ws/general/reports/design/logoSx/delete?idPwdEnte="+CBA.parametriGenerali.codEntePwd+"&idOrganizzazione="+this.cbaConfig.id,getPopupMenuFoto(a))},clickBtnOrgEnti:function(){Ext.create("winCBA",{name:"GeneraliPE.personalizzazioni.view.RaccordoEnteOrg",titolo:"RACCORDO_ENTI_ORG",dimensione:2,closable:!0,configItem:{permesso:"S"}}).show()},caricaDatiOrgSel:function(a,b){Ext.isEmpty(b)||(this.getForm().setHidden(!1),this.cbaConfig.id=!1,0<b.length&&(this.cbaConfig.id=
b[0].get("codice"),this.aggiornaStore()),setSrcImage(this.getPersonStampe_logoSx(),"/cba/gen/ws/general/reports/design/logoSx/download?idPwdEnte="+CBA.parametriGenerali.codEntePwd+"&idOrganizzazione="+this.cbaConfig.id+"&date="+(new Date).getTime()),setSrcImage(this.getPersonStampe_logoDx(),"/cba/gen/ws/general/reports/design/logoDx/download?idPwdEnte="+CBA.parametriGenerali.codEntePwd+"&idOrganizzazione="+this.cbaConfig.id+"&date="+(new Date).getTime()))},caricaComuni:function(a,b){Ext.isEmpty(b)||
(cbox="CbxProvince"==a.getItemId()?this.getCbxComuni():this.getCbxComuniFiscale(),cbox.getStore().load({params:{siglaProv:b},callback:function(a,b,e){}}))},inserimentoNuovaOrg:function(){this.getForm().setHidden(!1);IsolaCmp(this.getContainerForm(),!0);clearForm(this.getForm());var a=this.getForm().store;0<a.getCount()&&this.getTxtGruppo().setValue(a.first().get("idGruppoPer"))},ripristina:function(){var a=this.getGridOrg();IsolaCmp(this.getContainerForm(),!1);Ext.isEmpty(a.getSelection())?(clearForm(this.getForm()),
this.getForm().setHidden(!0)):this.aggiornaStore()},controllaCampi:function(){return this.getForm().isValid()?!0:(Messaggio(this.titolo,"MSG_CAMPI_OBBLIGATORI","OK","INFORMATION"),!1)},salvaForm:function(a){this.getGridOrg();var b=this.getForm(),c=this.cbaConfig.idEnte?this.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd,d=b.getValues();d.idEnte=c;delete d.idOrganizzazione;delete d.codiceCliente;delete d.chiaveFatturazione;delete d.dataUltimoInvio;if(a=controller_salvaRecord(b,d,a))IsolaCmp(this.getContainerForm(),
!1),this.aggiornaOrg(a.id)},eliminaRecord:function(){var a=this,b=a.getForm(),c=b.getForm().findField("id").getValue(),d=a.cbaConfig.idEnte?a.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd;Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c,idEnte:d},function(){a.aggiornaOrg();clearForm(b);b.setHidden(!0)})},gestioneForm:function(){var a=this,b=this.getForm();b.boxBottoni=a.getBoxBottoni();b.controller=a;b.store=Ext.create("Generali.gestPwdNew.store.OrganizzEnte");b.permesso="S";var c=Ext.create("Generali.standard.controller_PannelloBottoni",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.ripristina()},nuovo_callback:function(){a.inserimentoNuovaOrg()},elimina_callback:function(){a.eliminaRecord()},esci_callback:function(){b.up("window").close()},verificaCampiForm_callback:function(){return a.controllaCampi()}}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnElimina").setHidden(!0);b.boxBottoni.queryById("btnNuovo").setHidden(!0);b.on("afterrender",function(a){return b.boxBottoni.queryById("btnEsci").setHidden(!a.up("window"))});
b.boxBottoni.down("panel").add({xtype:"button",itemId:"BtnPersonAdHoc",reference:"BtnPersonAdHoc",cls:"cba-button-25",iconCls:"icon-locked",tooltip:"SBLOCCA",width:25,margin:"0 0 0 20",handler:function(b){a.apriPersonAdHoc(b)}});b.getForm().on("dirtychange",function(c,d){IsolaCmp(a.getContainerForm(),d);controller_abilitaBottoni(b)});if(a.storeModuliAttivi.areaPersonale){var c=a.getCkbEsterno(),d=a.getBtnOrgEnti(),e=a.getTxtGruppo(),g=a.getOrgPtlPers(),h=a.getOrgZucchetti();c.show();g.show();d.show();
h.show();e.show();e.allowBlank=!1;e.validateValue(e.getValue())}},sbloccaTacPanel:function(a,b,c){b=Ext.create(b,{cbaConfig:c});a.add(b);a.tab.show();a.show();return b},apriPersonAdHoc:function(a){var b=this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(c){c?(a.hide(),b.getBoxBottoni().down("#btnNuovo").show(),b.getTxtGruppo().setReadOnly(!1),b.getCkbEsterno().setReadOnly(!1),b.getOrgPtlPers().setReadOnly(!1),b.getBtnOrgEnti().setDisabled(!1),c=b.sbloccaTacPanel(b.getPnlParamFatt(),
"Generali.organizzazioni.view.ParametriFatturazione",b.cbaConfig),b.parametriFatturazione=c.controller,b.caricaParametriFatturazione(),b.sbloccaTacPanel(b.getPnlPersAdHoc(),"Generali.organizzazioni.view.PersonAdHoc",{storeModuliAttivi:b.storeModuliAttivi})):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()},caricaParametriFatturazione:function(){this.parametriFatturazione&&this.parametriFatturazione.caricaOrganizzazione(this.cbaConfig.id)},aggiornaStore:function(a){var b=this;clearForm(b.getForm());
var c=b.cbaConfig.idEnte?b.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd;b.getForm().store.load({params:{idEnte:c,idOrg:a?a:b.cbaConfig.id},callback:function(a,c,g){g&&!Ext.isEmpty(a)&&(b.caricaComuni(b.getCbxProvince(),a[0].get("provincia")),b.getForm().loadRecord(a[0]),b.caricaParametriFatturazione())}})},caricaOrgEnte:function(a){if(a){var b=this.getCbxOrgAmm().getStore();b.removeAll();b.load({params:{idEnte:a},callback:function(a,b,e){}})}},aggiornaOrg:function(a){var b=this,c=b.cbaConfig.idEnte?
b.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd;b.caricaOrgEnte(c);b.getBoxBottoni().setHidden(!1);var d=this.getGridOrg(),e=d.getStore();e.load({params:{idEnte:c},callback:function(c,h,k){if(k){if(a){var g;a&&((g=trovaRecord(e,"codice",a))||(g=0))}else g=0;d.getSelectionModel().deselectAll();d.getSelectionModel().select("object"==typeof g?[g]:g)}else msgShowError("",h.getError()),(c=b.cbaConfig.controllerEntiImp)&&c.getTabPanel().setActiveTab("PnlImpostazioni")}})},onLaunch:function(){var a=
this,b=Sipcar.app.getController("Login");a.storeModuliAttivi=Ext.create("Generali.store.CodiceValoreExtra");a.storeModuliAttivi.areaPersonale=!1;b.storeModuli.each(function(b){b&&b.data&&b.data.abilitato&&0<b.data.codice&&(a.storeModuliAttivi.add({codice:b.get("codice"),valore:b.get("valore").replace("&agrave;","")}),a.storeModuliAttivi.areaPersonale||"Personale"!=b.get("area")||(a.storeModuliAttivi.areaPersonale=!0))});a.getContainer().controller=this;this.gestioneForm();this.aggiornaOrg()},destroy:function(){delete this.parametriFatturazione;
eliminaStore(this.storeImpostazioni);this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.PermessiModuli",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CntBottoni",selector:a+"#CntBottoni"},{ref:"BtnImposta",selector:a+"#BtnImposta"},{ref:"Grid",selector:a+"#Grid"},{ref:"PanelVideata",selector:a+"#PanelVideata"}]);this.control(a+"#Grid",{beforeedit:this.beforeeditGrid,edit:this.editGrid});this.control(a+"#MenuScrittura",{click:this.clickMenuPermessi});this.control(a+
"#MenuLettura",{click:this.clickMenuPermessi});this.control(a+"#MenuNessunPerm",{click:this.clickMenuPermessi})},beforeeditGrid:function(a,b,c){if(!0===a.editing)return!1;a=a.getEditor().getForm();var d="T"===b.record.get("isStampa");b=a.findField("tipoPermesso").getStore();b.clearFilter();b.filter([{filterFn:function(a){return d?"V"===a.get("codice")||"N"===a.get("codice"):"V"!=a.get("codice")}}])},editGrid:function(a,b,c){c=b.record.getData();a=a.getEditor().getForm();a.controller=this;a.store=
b.view.getStore();Ext.apply(c,{tipoPermesso:b.newValues.tipoPermesso});delete c.videate;delete c.voceMenu;controller_salvaRecord(a,c,!1,!1)},clickMenuPermessi:function(a){var b=this,c=traduci("MSG_MODIFICA_PERMESSI_BOTTONE"),c=c.replace(":desButton",b.desButton),c=c.replace(":permesso",a.text);Messaggio("MODIFICA_PERMESSI",c,"YESNO","QUESTION",!1,function(){b.modificaPermessiBottone(a.getValue())},!1)},modificaPermessiBottone:function(a){if(Ext.isEmpty(a))return!1;var b=this;Ext.Ajax.request({method:"GET",
url:"/cba/gen/ws/pwd/videatepwd/button/setpermesso",params:{codModulo:b.cbaConfig.rec.get("codModulo"),idProfiloPwdDe:b.cbaConfig.idPwd,bottone:b.desButton,tipoPermesso:a},success:function(a){a=Ext.JSON.decode(a.responseText);a.success&&b.aggiornaStore();msgShow("MSG_SALVATAGGIO_DATI",a.message)}})},onLaunch:function(){var a=this,b=this.getCntBottoni();a.getBtnImposta().hide();a.storeVideate=Ext.create("Generali.gestPwdNew.store.BottoniModulo");a.storeVideate.load({params:{codModulo:a.cbaConfig.rec.get("codModulo")},
callback:function(c,d,e){e?0<c.length&&(Ext.suspendLayouts(),c.forEach(function(c){c=Ext.create("Ext.button.Button",{text:c.get("valore"),cls:"cbaCssBtnFunzione",handler:Ext.bind(a.clickButtonVideata,a)});b.add(c)}),Ext.resumeLayouts(!0)):msgShowError("",d.getError())}})},clickButtonVideata:function(a){var b=this.getPanelVideata();this.getBtnImposta().show();this.desButton=a.getText();b.setTitle("Gestione permessi "+this.desButton);this.aggiornaStore()},aggiornaStore:function(){this.getGrid().getStore().load({params:{codModulo:this.cbaConfig.rec.get("codModulo"),
idProfiloPwdDe:this.cbaConfig.idPwd,bottone:this.desButton}})},destroy:function(){eliminaStore(this.storeVideate);this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.ProfiliPwd",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"BoxBottoni2",selector:a+"#BoxBottoni2"},{ref:"PanelProfili",selector:a+"#PanelProfili"},{ref:"GridProfili",selector:a+"#GridProfili"},{ref:"PanelModuliProfili",selector:a+"#PanelModuliProfili"},{ref:"CbTipoScad",selector:a+"#CbTipoScad"}]);this.control(a+"#GridProfili",
{selectionchange:this.caricaProfiliEnti,beforeedit:this.beforeEditGridProfili,edit:this.editGridProfili,canceledit:this.ripristinaGridProfili})},ripristinaGridProfili:function(){this.aggiornaStore();IsolaCmp(this.getGridProfili(),!1)},beforeEditGridProfili:function(a,b,c){if(!0===a.editing)return!1;IsolaCmp(this.getGridProfili(),!0)},editGridProfili:function(a,b,c){var d=this;Ext.apply(b.record.data,b.newValues);b.record.set("filtraOrgLogin",getBoolValue(b.record.data.filtraOrgLogin));Ext.Ajax.request({method:"POST",
url:"/cba/gen/ws/pwd/profilipwd/update",jsonData:Ext.JSON.encode(b.record.data),success:function(c){c=Ext.JSON.decode(c.responseText);var e=[];c.success?(msgAdd(e,c.message),msgShow("MSG_SALVATAGGIO_DATI",e),d.aggiornaStore(),IsolaCmp(d.getGridProfili(),!1)):(a.startEdit(b.record,0),msgShowError("",c.message[0].testo))}})},caricaProfiliEnti:function(a,b){if(!Ext.isEmpty(b)&&0<b.length){var c=this.getPanelModuliProfili(),d=b[0];c.down("#Container").controller.codProfilo=d.get("codProfilo");c.down("#Container").controller.descrizioneProfilo=
d.get("descrizione");c.down("#Container").controller.aggiornaStore();c.down("#Container").queryById("GridModuli").getStore().removeAll()}},gestioneVideata:function(){var a=this,b=a.getGridProfili();b.permesso="S";b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{esci_callback:function(){b.up("window").close()},nuovo_callback:function(){a.inserimentoNuovoProfilo()},elimina_callback:function(){a.eliminaRecordProfilo()}}});inserisciBottoni(a.getBoxBottoni(),c,
!0);a.getBoxBottoni().queryById("btnConferma").setHidden(!0);a.getBoxBottoni().queryById("btnAnnulla").setHidden(!0)},eliminaRecordProfilo:function(){var a=this,b=a.getGridProfili(),c=b.getSelectionModel().getSelection()[0].get("codProfilo");Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore();a.getPanelModuliProfili().down("#Container").queryById("btnNuovo").setDisabled(!0)})},inserimentoNuovoProfilo:function(){var a=this;a.getGridProfili();var b=Ext.create("winCBA",
{titolo:"Nuovo Profilo",itemId:"WinProfilo",reference:"WinProfilo",altezzaWin:280,larghezzaWin:480,name:[{xtype:"form",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"textfield",fieldLabel:"Titolo",name:"titolo",margin:"25 10 5 10",allowBlank:!1},{xtype:"textfield",fieldLabel:"Descrizione",name:"descrizione",margin:"5 10 5 10",allowBlank:!1},{xtype:"textfield",hidden:!0,name:"gestscadenzapwd",value:"S"},{xtype:"combobox",id:"cmbMese",fieldLabel:"Rinnova ogni",maxWidth:200,name:"tiposcad",
margin:"5 10 5 10",allowBlank:!1,queryMode:"local",valueField:"codice",displayField:"valore",store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"codice"},{name:"valore"}],data:[["3","3 mesi"],["6","6 mesi"]]})},{xtype:"combobox",id:"copiaProfilo",fieldLabel:"Copia dal Profilo:",labelWidth:150,name:"idProfiloPwdCopy",itemId:"CbCopiaProfilo",margin:"5 10 5 10",queryMode:"local",valueField:"codice",displayField:"valore",store:Ext.create("Generali.gestPwdNew.store.ElencoProfiliPwd")},{xtype:"checkbox",
fieldLabel:traduci("PROFILIPWD_FILRA_ORG_LOGIN"),labelWidth:275,name:"filtraOrgLogin",margin:"5 10 5 10"}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"container",itemId:"BoxBottoniWinProfilo"}]}]}],closable:!0});b.on("show",function(){b.down("form").getForm().findField("titolo").focus(!0);b.queryById("CbCopiaProfilo").getStore().load({params:{filtraAmmOrg:isAmministratoreOrg(),ancheSenzaDett:!1},callback:function(a,b,e){e||msgShowError("",b.getError())}})});b.on("close",function(){a.getBoxBottoni().queryById("btnNuovo").setDisabled(!1);
a.getBoxBottoni().queryById("btnElimina").setDisabled(!1);a.getBoxBottoni().queryById("btnEsci").setDisabled(!1)});a.gestioneWin(b);b.show()},gestioneWin:function(a){var b=this;a.boxBottoni=a.queryById("BoxBottoniWinProfilo");var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(c){b.salvaForm(!0,a.down("form"))},annulla_callback:function(){b.ripristina(a)},verificaCampiForm_callback:function(){return b.controllaCampi(a.down("form"))}}});inserisciBottoni(a.boxBottoni,
c,!0);a.boxBottoni.queryById("btnNuovo").setHidden(!0);a.boxBottoni.queryById("btnElimina").setHidden(!0);a.boxBottoni.queryById("btnEsci").setHidden(!0);a.boxBottoni.queryById("btnConferma").setDisabled(!1);a.boxBottoni.queryById("btnAnnulla").setDisabled(!1)},controllaCampi:function(a){return a.isValid()?!0:(Messaggio("ATTENZIONE","MSG_CAMPI_OBBLIGATORI","OK","WARNING"),!1)},ripristina:function(a){clearForm(a.down("form"));a.down("form").getForm().findField("titolo").focus(!0);a.boxBottoni.queryById("btnConferma").setDisabled(!1);
a.boxBottoni.queryById("btnAnnulla").setDisabled(!1)},salvaForm:function(a,b){var c=this,d=c.getGridProfili(),e=b.getForm().getFieldValues();Ext.apply(e,{codProfilo:"",filtraOrgLogin:getBoolValue(e.filtraOrgLogin)});inizioAttesa();Ext.defer(function(){controller_salvaRecord(d,e,!1,!1,!0,!1,"codProfilo")?b.up("window").close():c.ripristina(b.up("window"));fineAttesa()},500)},aggiornaStore:function(a){var b=this.getGridProfili(),c=b.getStore();c.load({params:{filtraAmmOrg:isAmministratoreOrg(),ancheSenzaDett:!0},
callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},onLaunch:function(){this.gestioneVideata();this.aggiornaStore()}});
Ext.define("Generali.gestPwdNew.controller.RegoleRaccordi",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridRegole",selector:a+"#GridRegole"},{ref:"GridEntiCUCSS",selector:a+"#GridEntiCUCSS"},{ref:"BtnNuovaRegola",selector:a+"#BtnNuovaRegola"},{ref:"BtnEliminaRegola",selector:a+"#BtnEliminaRegola"},{ref:"CbChiusura",selector:a+"#CbChiusura"},{ref:"CbApertura",selector:a+"#CbApertura"},{ref:"CbEsternoDett",selector:a+
"#CbEsternoDett"},{ref:"GridRegoleDett",selector:a+"#GridRegoleDett"},{ref:"BtnNuovaRegolaDett",selector:a+"#BtnNuovaRegolaDett"},{ref:"BtnEliminaRegolaDett",selector:a+"#BtnEliminaRegolaDett"},{ref:"BtnOpenWinCopy",selector:a+"#BtnOpenWinCopy"}]);this.control(a+"#GridEntiCUCSS",{selectionchange:this.selectionChangeEnteOrg});this.control(a+"#GridRegole",{beforeedit:this.beforeEditGridRegole,canceledit:this.cancelEditGridRegole,edit:this.salvaRecordGridRegole,validateedit:this.validaRecordGridRegole,
selectionchange:this.selectGridRegole});this.control(a+"#BtnNuovaRegola",{click:this.clickBtnNuovaRegola});this.control(a+"#BtnEliminaRegola",{click:this.clickBtnEliminaRegola});this.control(a+"#GridRegoleDett",{beforeedit:this.beforeEditGridRegoleDett,canceledit:this.cancelEditGridRegoleDett,edit:this.salvaRecordGridRegoleDett,validateedit:this.validaRecordGridRegoleDett,selectionchange:this.selectGridRegoleDett});this.control(a+"#BtnNuovaRegolaDett",{click:this.clickBtnNuovaRegolaDett});this.control(a+
"#BtnEliminaRegolaDett",{click:this.clickBtnEliminaRegolaDett});this.control(a+"#BtnOpenWinCopy",{click:this.clickBtnOpenWinCopy})},clickBtnOpenWinCopy:function(){var a=this.getRegolaSelezionata();a&&(svuotaStore(this.storeIdEsterno),Ext.create("winCBA",{larghezzaWin:350,altezzaWin:500,name:"Generali.gestPwdNew.view.CopiaRegolaRaccordo",titolo:"Copia Regola",maximizable:!1,configItem:{storeRegole:this.getGridRegole().getStore(),storeEsterno:this.storeIdEsterno,controllerRegole:this,regola:a}}).show())},
aggiornaGridRegoleDett:function(){var a=this;if(Ext.isEmpty(a.codEnte)||Ext.isEmpty(a.idOrg)||Ext.isEmpty(a.idPadre))return!1;a.getGridRegoleDett().getStore().load({params:{idEnte:a.codEnte,idOrg:a.idOrg,idPadre:a.idPadre},callback:function(b,c,d){a.getBtnNuovaRegolaDett().setDisabled(!d)}})},selectGridRegole:function(a,b){if(Ext.isEmpty(b)||Ext.isEmpty(b[0]))return this.getBtnEliminaRegola().setDisabled(!0),this.getBtnOpenWinCopy().hide(),!1;var c=b[0];this.tipoCodificaPadre=c.get("tipoCodifica");
this.idPadre=c.get("id");this.getBtnEliminaRegola().setDisabled(!1);this.aggiornaGridRegoleDett();this.getBtnOpenWinCopy().setHidden(!("A"==this.tipoCodificaPadre||"H"==this.tipoCodificaPadre))},getRegolaSelezionata:function(){return 0<this.getGridRegole().getSelectionModel().getSelection().length?this.getGridRegole().getSelectionModel().getSelection()[0]:null},selectGridRegoleDett:function(a,b){if(Ext.isEmpty(b)||Ext.isEmpty(b[0]))return this.getBtnEliminaRegolaDett().setDisabled(!0),!1;this.getBtnEliminaRegolaDett().setDisabled(!1)},
clickBtnEliminaRegola:function(a){this.eliminaRegola(this.idPadre,"GridRegole")},clickBtnEliminaRegolaDett:function(a){a=this.getGridRegoleDett().getSelectionModel().getSelection()[0];this.eliminaRegola(a.get("id"),"GridRegoleDett")},eliminaRegola:function(a,b){var c=this;if(Ext.isEmpty(a))return!1;Messaggio("Elimina","MSG_ELIMINA","YESNO","QUESTION","",function(){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/regole/delete",params:{id:a},success:function(a){a=Ext.JSON.decode(a.responseText);
var d=[];a.success?(msgAdd(d,a.message),msgShow("MSG_ELIMINAZIONE_DATI",d),"GridRegole"===b?c.aggiornaGridRegole():"GridRegoleDett"===b&&c.aggiornaGridRegoleDett()):msgShow("",d)}})},!1)},validaRecordGridRegole:function(a,b){b.newValues.idEnte=this.codEnte;b.newValues.idOrganizzazione=this.idOrg;b.record.set(b.newValues)},validaRecordGridRegoleDett:function(a,b){b.newValues.idEnte=this.codEnte;b.newValues.idOrganizzazione=this.idOrg;b.newValues.idPadre=this.idPadre;b.record.set(b.newValues)},salvaRecordGridRegole:function(a,
b){var c=this,d=b.record.getData(),e=c.getGridRegole();if(Ext.isEmpty(d))return!1;Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/regole/update",jsonData:Ext.JSON.encode(d),success:function(d){d=Ext.JSON.decode(d.responseText);var g=[];d.success?(msgAdd(g,d.message),msgShow("MSG_SALVATAGGIO_DATI",g),IsolaCmp(e,!1),c.aggiornaGridRegole(d.data.id)):(a.startEdit(b.record,0),msgShowError("ERROR",d.message[0].testo))}})},salvaRecordGridRegoleDett:function(a,b){var c=this,d=b.record.getData(),e=c.getGridRegoleDett();
if(Ext.isEmpty(d))return!1;Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/regole/new",jsonData:Ext.JSON.encode(d),success:function(d){d=Ext.JSON.decode(d.responseText);var g=[];d.success?(msgAdd(g,d.message),msgShow("MSG_SALVATAGGIO_DATI",g),IsolaCmp(e,!1),c.aggiornaGridRegoleDett()):(a.startEdit(b.record,0),msgShowError("ERROR",d.message[0].testo))}})},loadRegolaByCodifica:function(a,b,c){var d=" ";Ext.isEmpty(b)&&(b=this.getCbApertura().getStore());Ext.isEmpty(c)&&(c=this.getCbChiusura().getStore());
if("S"==a||"T"==a)d="1";else if("H"==a||"A"==a)d="2";b.clearFilter();b.filter(function(a){return a.get("codiceRecord").includes(d)?!0:!1});c.clearFilter();c.filter(function(a){return a.get("codiceRecord").includes(d)?!0:!1})},clickBtnNuovaRegola:function(a){svuotaStore(this.storeIdEsterno);Ext.create("winCBA",{permesso:"S",larghezzaWin:420,altezzaWin:250,name:"Generali.gestPwdNew.view.CreazioneRegolaRaccordo",titolo:"Nuova Regola",maximizable:!1,closable:!0,configItem:{storeTipoCod:this.storeTipoCod,
storeEsterno:this.storeIdEsterno,storeRegApertura:this.storeApertura,storeRegChiusura:this.storeChiusura,controllerRegole:this,codEnte:this.codEnte,idOrg:this.idOrg}}).show()},clickBtnNuovaRegolaDett:function(a){this.openEditGridDett()},openEditGridDett:function(){var a=this.getGridRegoleDett();a.getStore().insert(0,{});IsolaCmp(a,!0);a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0)},beforeEditGridRegole:function(a,b,c){if(!0===a.editing||Ext.isEmpty(b.record.get("id")))return!1;this.getCbApertura().bindStore(this.storeApertura);
this.getCbChiusura().bindStore(this.storeChiusura);this.loadRegolaByCodifica(b.record.get("tipoCodifica"),this.storeApertura,this.storeChiusura)},beforeEditGridRegoleDett:function(a,b,c){if(Ext.isEmpty(this.tipoCodificaPadre)||!0===a.editing||!Ext.isEmpty(b.record.get("id")))return!1;this.getCbEsternoDett().bindStore(this.storeIdEsterno);var d;a=this.getCbEsternoDett().getStore();switch(this.tipoCodificaPadre){case "S":d="T";break;case "T":d="S";break;case "A":d="H";break;case "H":d="A"}b.record.set("tipoCodifica",
d);svuotaStore(a);a.load({params:{idEnte:this.codEnte,idOrg:this.idOrg,tipoCod:d},callback:function(a,b,c){c||msgShowError("",b.getError())}})},cancelEditGridRegole:function(a,b,c){a=this.getGridRegole();this.aggiornaGridRegole(b.record.get("id"));IsolaCmp(a,!1)},cancelEditGridRegoleDett:function(a,b,c){a=this.getGridRegoleDett();this.aggiornaGridRegoleDett();IsolaCmp(a,!1)},selectionChangeEnteOrg:function(a,b){if(!Ext.isEmpty(b)&&!Ext.isEmpty(b[0])){var c=b[0];this.codEnte=c.get("codEnte");this.idOrg=
c.get("idOrganizzazione");this.aggiornaGridRegole()}},aggiornaGridRegole:function(a){var b=this;if(Ext.isEmpty(b.codEnte)||Ext.isEmpty(b.idOrg))return!1;var c=b.getGridRegole().getStore(),d=b.getGridRegoleDett().getStore();svuotaStore(d);b.getBtnNuovaRegolaDett().setDisabled(!0);b.getBtnEliminaRegolaDett().setDisabled(!0);c.clearFilter();c.load({params:{idEnte:b.codEnte,idOrg:b.idOrg},callback:function(d,e,k){k&&(a&&(record=trovaRecord(c,"id",a),b.getGridRegole().getSelectionModel().deselectAll(),
b.getGridRegole().getSelectionModel().select(record?[record]:0)),b.getBtnNuovaRegola().setDisabled(!k))}});var d=b.getCbApertura().getStore(),e=b.getCbChiusura().getStore();Ext.isEmpty(d)||d.clearFilter();Ext.isEmpty(e)||e.clearFilter()},onLaunch:function(){this.lookup("GridEntiCUCSS").getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()}});this.getBtnNuovaRegola().setDisabled(!0);this.getBtnEliminaRegola().setDisabled(!0);this.getBtnNuovaRegolaDett().setDisabled(!0);this.getBtnEliminaRegolaDett().setDisabled(!0);
this.storeTipoCod=Ext.create("Generali.gestPwdNew.store.RegTipCod");this.storeApertura=Ext.create("Generali.gestPwdNew.store.RegApertura");this.storeChiusura=Ext.create("Generali.gestPwdNew.store.RegChiusura");this.storeIdEsterno=Ext.create("Generali.gestPwdNew.store.CboxValoreEsterno")},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.StampePwd",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideXml:!0,hideCsv:!0,hidePdf:!0,hideExcel:!0,hideText:!0,hideBtnStampaOnSecondaryWin:!0},init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnStampa",selector:a+"#BtnStampa"},{ref:"CbTipoStampa",selector:a+"#CbTipoStampa"},{ref:"FormParam",selector:a+"#FormParam"},{ref:"CbEnti",selector:a+"#CbEnti"},{ref:"CntTipoStampa",selector:a+"#CntTipoStampa"},
{ref:"RgbTipoOperazione",selector:a+"#RgbTipoOperazione"},{ref:"CntData",selector:a+"#CntData"},{ref:"EdtDtDal",selector:a+"#EdtDtDal"}]);this.control(a+"#CbTipoStampa",{change:this.changeCbTipoStampa});this.control(a+"#CbEnti",{change:this.changeCbEnti});this.control(a+"#CbOrg",{change:this.changeCbOrg});this.control(a+"#RgbTipoOperazione",{change:this.changeRgbTipoOperazione})},changeRgbTipoOperazione:function(a,b){this.getEdtDtDal().hide();this.getCntData().hide();this.getEdtDtDal().setVisible("C"===
b.rbVisualizzaPer||"P"===b.rbVisualizzaPer);this.getCntData().setVisible("O"===b.rbVisualizzaPer||"D"===b.rbVisualizzaPer)},changeCbOrg:function(a,b){var c=this.lookup("CbTipCart");SvuotaCombo(c);if(!b)return!1;c.getStore().load({params:{codEntePwd:this.lookup("CbEnti").getValue(),idOrg:b}})},changeCbEnti:function(a,b){var c=this.lookup("CbOrg");SvuotaCombo(c);if(!b)return!1;c.getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,g){g?1==a.length&&c.setValue(a[0]):
msgShowError("",b.getError())}})},changeCbTipoStampa:function(a,b,c){Ext.isEmpty(b)||(a=b.split(";")[0],this.lookup("CntStampaPermessiCss").setHidden(3!=a),this.lookup("CntStampaOperatori").setHidden(1!=a),this.lookup("CntStampaContatori").setHidden(4!=a))},doPrint:function(a,b){if(!this.getCbTipoStampa().isValid())return!1;this.stampa();this.callParent([a,b])},stampa:function(a){var b=this.getCbTipoStampa().getValue().split(";");a=b[1];var c={};switch(b[0]){case "1":Ext.apply(c,{soloAttivi:getBoolValue(this.lookup("CkSoloAttivi").getValue()),
ordine:this.lookup("RadioOrdine").getValue().ordine,filtroAmmOrg:isAmministratoreOrg()});break;case "2":Ext.apply(c,{filtroAmmOrg:isAmministratoreOrg()});break;case "3":Ext.apply(c,{codEntePwd:this.lookup("CbEnti").getValue()||-1,idOrg:this.lookup("CbOrg").getValue()||-1});this.lookup("CbTipCart").getValue()&&Ext.apply(c,{idProfiloCss:this.lookup("CbTipCart").getValue()});break;case "4":b=this.lookup("RgbTipoOperazione").getValue().rbVisualizzaPer,Ext.apply(c,{idOrg:this.lookup("CbOrganizzazioni").getValue(),
data:this.lookup("EdtDtDal").getValue(),dataDal:this.lookup("DataDal").getValue(),dataAl:this.lookup("DataAl").getValue(),assunioni:"P"==b?"T":"F",ricoveri:"C"==b?"T":"F",ospitiGg:"O"==b?"T":"F",dipendentiGg:"D"==b?"T":"F",idEnte:CBA.parametriGenerali.codEntePwd})}Ext.apply(this.parametriStampa,{url:a,params:c})},sbloccaMonitorClient:function(a){var b=this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(c){c?(c=new Date,c=c.getTime()-(new Date(c.getFullYear(),c.getMonth(),
1)).getTime(),StdSipcar.promisePostRequest("/cba/gen/auth/extraFn/monitorClient/enable",{crc:c}).then(function(){a.hide();b.addTipoStampaMonitorClient()})["catch"](function(a){return msgShowError("",a)})):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()},addMonitorClientButton:function(){var a=this;StdSipcar.promiseGetRequest("/cba/gen/auth/extraFn/monitorClient/isEnabled").then(function(b){b?a.addTipoStampaMonitorClient():a.getCntTipoStampa().add({xtype:"button",itemId:"BtnMonitorClient",reference:"BtnMonitorClient",
cls:"cba-button-25",iconCls:"icon-locked",tooltip:traduci("SBLOCCA_CONTATORI_FATTURAZIONE"),width:25,margin:"0 0 0 20",handler:a.sbloccaMonitorClient.bind(a)})})},addTipoStampaMonitorClient:function(){var a=this.getCbTipoStampa().getStore();a.insert(a.getCount(),{codice:"4;/cba/gen/ws/report/contatori/fatturazione",valore:traduci("CONTATORI_FATTURAZIONE")})},onLaunch:function(){this.lookup("CbEnti").getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()}});this.lookup("CbOrganizzazioni").getStore().load({params:{idEnte:CBA.parametriGenerali.codEntePwd,
filtraOrgAutor:isAmministratoreOrg()}});this.addMonitorClientButton()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.TabFiltri",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TabPanelFiltri",selector:a+"#TabPanelFiltri"},{ref:"TabFiltriReparti",selector:a+"#TabFiltriReparti"},{ref:"TabFiltriServizi",selector:a+"#TabFiltriServizi"},{ref:"TabFiltriEcoCdc",selector:a+"#TabFiltriEcoCdc"},{ref:"TabFiltriPerReparti",selector:a+"#TabFiltriPerReparti"},{ref:"TabFiltriAttivita",selector:a+"#TabFiltriAttivita"},
{ref:"TabFiltriAttivita",selector:a+"#TabFiltriAttivita"}]);this.control(a+"#TabPanelFiltri",{tabchange:this.changeTabPanel})},changeTabPanel:function(a,b){var c;"TabFiltriReparti"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriReparti",{}):"TabFiltriServizi"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriServizi",{}):"TabFiltriSettori"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriSettori",{}):"TabFiltriEcoCdc"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriEcoCdcDepositi",
{}):"TabFiltriPerReparti"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriPerReparti",{}):"TabFiltriAttivita"===b.getItemId()?c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriAttivita",{}):"TabFiltriUfficiManutenz"===b.getItemId()&&(c=Ext.create("Generali.gestPwdNew.view.ImpostaFiltriUfficiManutenz",{}));b.removeAll();b.add(c)},onLaunch:function(){this.changeTabPanel(null,this.getTabFiltriReparti())},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.Utenti",{extend:"Generali.standard.stampe.Controller",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridUtenti",selector:this.selContainer+"#GridUtenti"},{ref:"TabPersUtenti",selector:this.selContainer+"#TabPersUtenti"},{ref:"TabPersEconomato",selector:this.selContainer+"#TabPersEconomato"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},
{ref:"BtnNuovaPwd",selector:this.selContainer+"#BtnNuovaPwd"},{ref:"fsModificaPwd",selector:this.selContainer+"#fsModificaPwd"},{ref:"TxtNuovaPwd",selector:this.selContainer+"#TxtNuovaPwd"},{ref:"TxtNomeUtente",selector:this.selContainer+"#TxtNomeUtente"},{ref:"Abilitato",selector:this.selContainer+"#Abilitato"},{ref:"GridTipologie",selector:this.selContainer+"#GridTipologie"},{ref:"GridFiltriUtente",selector:this.selContainer+"#GridFiltriUtente"},{ref:"CmbEnti",selector:this.selContainer+"#CmbEnti"},
{ref:"CmbOrg",selector:this.selContainer+"#CmbOrg"},{ref:"CmbFiltroRep",selector:this.selContainer+"#CmbFiltroRep"},{ref:"CmbFiltroServ",selector:this.selContainer+"#CmbFiltroServ"},{ref:"CmbFiltroAttivita",selector:this.selContainer+"#CmbFiltroAttivita"},{ref:"CmbFiltroUffManutenz",selector:this.selContainer+"#CmbFiltroUffManutenz"},{ref:"CmbFiltroSett",selector:this.selContainer+"#CmbFiltroServ"},{ref:"CmbFiltroPerRep",selector:this.selContainer+"#CmbFiltroPerRep"},{ref:"CmbFiltroEcoCdc",selector:this.selContainer+
"#CmbFiltroEcoCdc"},{ref:"BtnAggiungiFiltro",selector:this.selContainer+"#BtnAggiungiFiltro"},{ref:"BtnEliminaFiltro",selector:this.selContainer+"#BtnEliminaFiltro"},{ref:"CbProfilo",selector:this.selContainer+"#CbProfilo"},{ref:"TxtPwd",selector:this.selContainer+"#TxtPwd"},{ref:"CbFigProf",selector:this.selContainer+"#CbFigProf"},{ref:"GridCartella",selector:this.selContainer+"#GridCartella"},{ref:"DirtyCartella",selector:this.selContainer+"#DirtyCartella"},{ref:"DatiCartella",selector:this.selContainer+
"#DatiCartella"},{ref:"FieldsetFiltri",selector:this.selContainer+"#FieldsetFiltri"},{ref:"Contenuto",selector:this.selContainer+"#Contenuto"},{ref:"FieldsetForm",selector:this.selContainer+"#FieldsetForm"},{ref:"BtnAbilitaMod",selector:this.selContainer+"#BtnAbilitaMod"},{ref:"GridProfiliAutorizzati",selector:this.selContainer+"#GridProfiliAutorizzati"},{ref:"FieldSetGridProfAut",selector:this.selContainer+"#FieldSetGridProfAut"},{ref:"CbFigProfEditor",selector:this.selContainer+"#CbFigProfEditor"},
{ref:"BtnAggiungiAutor",selector:this.selContainer+"#BtnAggiungiAutor"},{ref:"BtnEliminaAutor",selector:this.selContainer+"#BtnEliminaAutor"},{ref:"CheckAmministratore",selector:this.selContainer+"#CheckAmministratore"},{ref:"CheckAutorizzatore",selector:this.selContainer+"#CheckAutorizzatore"},{ref:"CheckAmmOrg",selector:this.selContainer+"#CheckAmmOrg"},{ref:"FieldSetPrivilegi",selector:this.selContainer+"#FieldSetPrivilegi"},{ref:"TxtConfermaNuovaPwd",selector:this.selContainer+"#TxtConfermaNuovaPwd"},
{ref:"BtnAggiungiAdminOrg",selector:this.selContainer+"#BtnAggiungiAdminOrg"},{ref:"BtnEliminaAdminOrg",selector:this.selContainer+"#BtnEliminaAdminOrg"},{ref:"GridOrgAutorizzate",selector:this.selContainer+"#GridOrgAutorizzate"},{ref:"FieldSetGridAmmOrg",selector:this.selContainer+"#FieldSetGridAmmOrg"},{ref:"EditorGridAmmOrgCmbEnti",selector:this.selContainer+"#EditorGridAmmOrgCmbEnti"},{ref:"EditorGridAmmOrgCmbOrg",selector:this.selContainer+"#EditorGridAmmOrgCmbOrg"}]);this.control(this.selContainer+
"#GridUtenti",{selectionchange:this.selectGriglia});this.control(this.selContainer+"#TabPersUtenti",{tabchange:this.tabchangeTabPersUtenti});this.control(this.selContainer+"#GridCartella",{edit:this.editGridCartella,validateedit:this.validateeditGridCartella,selectionchange:this.selectGridCartella,beforeedit:this.beforeeditGridCartella});this.control(this.selContainer+"#BtnNuovaPwd",{click:this.clickBtnNuovaPwd});this.control(this.selContainer+"#CmbEnti",{change:this.changeCmbEnti});this.control(this.selContainer+
"#CmbOrg",{change:this.changeCmbOrg});this.control(this.selContainer+"#GridFiltriUtente",{beforeedit:this.beforeeditGrid,edit:this.editGrid,canceledit:this.canceleditGrid,validateedit:this.validateeditGrid});this.control(this.selContainer+"#BtnAggiungiFiltro",{click:this.clickBtnAggiungiFiltro});this.control(this.selContainer+"#BtnEliminaFiltro",{click:this.clickBtnEliminaFiltro});this.control(this.selContainer+"#CbProfilo",{select:this.selectProfilo});this.control(this.selContainer+"#BtnAbilitaMod",
{click:this.avvisoAbilitaMod});this.control(this.selContainer+"#GridTipologie",{beforeedit:this.beforeeditGridTipologie,canceledit:this.togliFiltriStore,edit:this.editGridTipologie});this.control(this.selContainer+"#BtnAggiungiAutor",{click:this.clickBtnAggiungiAutor});this.control(this.selContainer+"#BtnEliminaAutor",{click:this.clickBtnEliminaAutor});this.control(this.selContainer+"#GridProfiliAutorizzati",{beforeedit:this.beforeeditGridProfiliAutorizzati,edit:this.editGridProfiliAutorizzati,canceledit:this.canceleditGridProfiliAutorizzati,
validateedit:this.validateeditGrid});this.control(this.selContainer+"#CheckAmministratore",{change:this.changeCheckAmministratore});this.control(this.selContainer+"#CheckAutorizzatore",{change:this.changeCheckAutorizzatore});this.control(this.selContainer+"#CheckAmmOrg",{change:this.changeCheckAmmOrg});this.control(this.selContainer+"#BtnAggiungiAdminOrg",{click:this.clickBtnAggiungiAdminOrg});this.control(this.selContainer+"#BtnEliminaAdminOrg",{click:this.clickBtnEliminaAdminOrg});this.control(this.selContainer+
"#GridOrgAutorizzate",{beforeedit:this.beforeeditGridOrgAutorizzate,edit:this.salvaGridOrgAutorizzate,canceledit:this.canceleditGridOrgAutorizzate,validateedit:this.validateeditGridOrgAutorizzate});this.control(this.selContainer+"#EditorGridAmmOrgCmbEnti",{change:this.changeGridAmmOrgCmbEnti})},validateeditGridOrgAutorizzate:function(a,b){var c=this.getGridUtenti().getSelectionModel().getSelection()[0].get("codice");b.record.set(b.newValues);b.record.set("codUtentePwd",c);return msgShow("",[])},salvaGridOrgAutorizzate:function(a,
b,c){var d=this;Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/amministratoriOrg/new",jsonData:Ext.JSON.encode(b.record.data),success:function(c){c=Ext.JSON.decode(c.responseText);var e=[];c.success?(msgAdd(e,c.message),msgShow("MSG_SALVATAGGIO_DATI",e),d.aggiornaGridOrgAutorizzate(),IsolaCmp(d.getGridOrgAutorizzate(),!1)):(a.startEdit(b.record,0),msgShowError("ATTENZIONE",c.message[0].testo))}})},canceleditGridProfiliAutorizzati:function(a,b,c){this.aggiornaGridProfiliAutor();IsolaCmp(this.getGridProfiliAutorizzati(),
!1);this.abilitaBottoniGridAutor(!0)},canceleditGridOrgAutorizzate:function(){this.aggiornaGridOrgAutorizzate();IsolaCmp(this.getGridOrgAutorizzate(),!1)},gestisciColonneGridOrgAutorizzate:function(a){this.getGridOrgAutorizzate().getColumns().forEach(function(b){switch(b.cbaConfig.idColonna){case "codEnte":b.setHidden(a);break;case "idOrganizzazione":b.setHidden(a);break;case "descEnteOrg":b.setHidden(!a)}})},beforeeditGridOrgAutorizzate:function(a,b){if(a.editing||b.record.get("id"))return!1;var c=
this;svuotaStore(c.getEditorGridAmmOrgCmbEnti().getStore());svuotaStore(c.getEditorGridAmmOrgCmbOrg().getStore());c.getEditorGridAmmOrgCmbEnti().getStore().load({params:{filtroAmmOrg:isAmministratoreOrg()},callback:function(a,b,g){g&&1===a.length&&c.getEditorGridAmmOrgCmbEnti().setValue(a[0])}})},changeGridAmmOrgCmbEnti:function(a,b,c){if(b){var d=this;d.getEditorGridAmmOrgCmbOrg().getStore().load({params:{idEnte:b,filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,c){c&&1===a.length&&d.getEditorGridAmmOrgCmbOrg().setValue(a[0])}})}},
eliminaOrgAutorizzata:function(a){a||(a=this);var b=a.getGridOrgAutorizzate().getSelectionModel().getSelection()[0];if(!b)return!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/amministratoriOrg/delete",params:{id:b.get("id")},success:function(b){Ext.JSON.decode(b.responseText).success&&(a.aggiornaGridOrgAutorizzate(),IsolaCmp(a.getGridOrgAutorizzate(),!1));msgShow("",[])}})},clickBtnEliminaAdminOrg:function(a){var b=this;if(!this.getGridOrgAutorizzate().getSelectionModel().getSelection()[0])return!1;
this.avvisoCancellazione(function(){return b.eliminaOrgAutorizzata(b)})},clickBtnAggiungiAdminOrg:function(a){a=this.getGridOrgAutorizzate();var b=a.getStore();this.gestisciColonneGridOrgAutorizzate(!1);b.insert(0,{});IsolaCmp(a,!0);a.getPlugin().startEdit(0,0);this.abilitaBottoniGridOrgAutorizzate(!1)},changeCheckAmministratore:function(a,b){this.esciDalChange||!0!==b||(this.getCheckAutorizzatore().setValue(!1),this.getCheckAmmOrg().setValue(!1))},changeCheckAutorizzatore:function(a,b){this.esciDalChange||
!0!==b||(this.getCheckAmministratore().setValue(!1),this.getCheckAmmOrg().setValue(!1))},changeCheckAmmOrg:function(a,b){this.esciDalChange||!0!==b||(this.getCheckAmministratore().setValue(!1),this.getCheckAutorizzatore().setValue(!1))},beforeeditGridTipologie:function(a,b,c){var d=b.record.getData().idProfilo;a.getEditor().getForm().findField("codAreaAnalisiPAI").bindStore(this.storeAreePAI);this.storeAreePAI.filterBy(function(a){return a.get("idProfilo")==d});a.getEditor().getForm().findField("codAreaAnalisiPRI").bindStore(this.storeAreePRI);
this.storeAreePRI.filterBy(function(a){return a.get("idProfilo")==d})},editGridTipologie:function(a,b,c){var d=this;d.togliFiltriStore();a=b.newValues;a.riapertura=getBoolValue(a.riapertura);a.abilitato=getBoolValue(a.abilitato);a.codEntePwd=d.codEnte;Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/tipologie/update",jsonData:Ext.JSON.encode(a),writer:{type:"json"},success:function(a){d.aggiornaGridTipologie()}})},togliFiltriStore:function(){this.storeAreePAI.clearFilter();this.storeAreePRI.clearFilter()},
selectGridCartella:function(a,b,c,d){if(Ext.isEmpty(b))return!1;this.getGridTipologie().controller=this;this.codEnte=b[0].getData().idEntePwd;this.codProfilo=this.getCbProfilo().getValue();this.progr=b[0].getData().progr;this.storeAreePAI=Ext.create("Generali.gestPwdNew.store.Risposte");this.storeAreePAI.load({params:{codEnte:this.codEnte,codArea:7,codDomanda:50}});this.storeAreePRI=Ext.create("Generali.gestPwdNew.store.Risposte");this.storeAreePRI.load({params:{codEnte:this.codEnte,codArea:19,codDomanda:40}});
this.aggiornaGridTipologie()},aggiornaGridTipologie:function(){var a=this;a.getGridTipologie().getStore().clearData();Ext.isEmpty(a.progr)||Ext.isEmpty(a.codEnte)||Ext.isEmpty(a.codProfilo)||a.getGridTipologie().getStore().load({params:{progr:a.progr,codEnte:a.codEnte,codProfilo:a.codProfilo},callback:function(b,c,d){d&&(0<b.length?a.getGridTipologie().setHidden(!1):a.getGridTipologie().setHidden(!0))}})},validateeditGridCartella:function(a,b){b.record.set(b.newValues);return msgShow("",[])},beforeeditGridCartella:function(a,
b,c){if(!0===a.editing)return!1;c=b.record.getData().idEntePwd;switch(b.field){case "tipo":this.getBtnAggiungiFiltro().setDisabled(!0);a=a.grid.columns[4].getEditor().getStore();a.clearData();a.load({params:{idEntePwd:c}});break;case "idTimbro":a=a.grid.columns[6].getEditor().getStore(),a.clearData(),a.load({params:{idEntePwd:c}})}},editGridCartella:function(a,b){var c=!1;switch(b.field){case "tipo":var d=b.record.getData().tipo;if(Ext.isEmpty(d))return!1;d=a.grid.columns[4].getEditor().getStore().findRecord("codice",
d).getData().valore;b.record.set("figuraProfessionale",d);b.grid.getStore().each(function(a){a.dirty&&(c=!0)});this.getDirtyCartella().setValue(c);case "idTimbro":d=b.record.getData().idTimbro;if(Ext.isEmpty(d))return!1;b.grid.getStore().each(function(a){a.dirty&&(c=!0)});this.getDirtyCartella().setValue(c)}},selectProfilo:function(a,b){var c=this,d=c.getGridCartella(),e=c.getForm().queryById("TxtCodUtente").value;d.getStore().load({params:{codUtente:e,codProfilo:b.getData().codProfilo},callback:function(a,
b,d){d&&(c.visualizzaFieldCss(0<a.length),c.getGridTipologie().setHidden(!0))}})},beforeeditGrid:function(a,b,c){var d=this,e=b.record.get("idEnte");d.idOrg=b.record.get("idOrganizzazione");d.idFiltriRep=b.record.get("idFiltroReparti");d.idFiltriServ=b.record.get("idFiltroServizi");d.idFiltriSett=b.record.get("idFiltroSettori");d.idFiltriAtt=b.record.get("idFiltroAttivita");d.idFiltriUffManut=b.record.get("idFiltroUfficiManutenz");if(!0===a.editing)return!1;null!=b.record.getData().id&&(d.getCmbEnti().setReadOnly(!0),
d.getCmbOrg().setReadOnly(!0),d.getCmbEnti().getStore().load({params:{codProfilo:d.getCbProfilo().getValue()},callback:function(a,b,c){c&&d.getCmbEnti().setValue(e)}}))},beforeeditGridProfiliAutorizzati:function(a,b,c){if(!0===a.editing)return!1;this.getCbFigProfEditor().getStore().load()},editGrid:function(a,b,c){var d=this;c=b.record.getData();var e=a.getEditor().getForm();e.controller=this;e.store=b.view.getStore();Ext.apply(c,{idUtente:d.getGridUtenti().getSelectionModel().getSelection()[0].get("codice"),
idEnte:c.idEnte,idOrganizzazione:c.idOrganizzazione,idFiltroTe:c.idFiltroTe});Ext.Ajax.request({method:"POST",url:null!=c.id?"/cba/gen/ws/pwd/filtriutente/update":"/cba/gen/ws/pwd/filtriutente/new",jsonData:Ext.JSON.encode(c),success:function(c){c=Ext.JSON.decode(c.responseText);var e=[];c.success?(msgAdd(e,c.message),msgShow("MSG_SALVATAGGIO_DATI",e),d.aggiornaGridFiltriUtenti(),IsolaCmp(d.getGridFiltriUtente(),!1),d.getCmbEnti().setReadOnly(!1),d.getCmbOrg().setReadOnly(!1)):(a.startEdit(b.record,
0),msgShowError("ATTENZIONE",c.message[0].testo))}})},editGridProfiliAutorizzati:function(a,b,c){var d=this;c=b.record.getData();Ext.apply(c,{codUtente:d.getGridUtenti().getSelectionModel().getSelection()[0].get("codice")});Ext.Ajax.request({method:"POST",url:null!=c.id?"/cba/gen/ws/pwd/utentiautorizzatipwd/update":"/cba/gen/ws/pwd/utentiautorizzatipwd/new",jsonData:Ext.JSON.encode(c),success:function(c){c=Ext.JSON.decode(c.responseText);var e=[];c.success?(msgAdd(e,c.message),msgShow("MSG_SALVATAGGIO_DATI",
e),d.aggiornaGridProfiliAutor(),IsolaCmp(d.getGridProfiliAutorizzati(),!1),d.abilitaBottoniGridAutor(!0)):(a.startEdit(b.record,0),msgShowError("ATTENZIONE",c.message[0].testo))}})},validateeditGrid:function(a,b){b.record.set(b.newValues);return msgShow("",[])},canceleditGrid:function(a,b,c){this.aggiornaGridFiltriUtenti();IsolaCmp(this.getGridFiltriUtente(),!1);this.getCmbEnti().setReadOnly(!1);this.getCmbOrg().setReadOnly(!1)},canceleditGridProfiliAutorizzati:function(a,b,c){this.aggiornaGridProfiliAutor();
IsolaCmp(this.getGridProfiliAutorizzati(),!1);this.abilitaBottoniGridAutor(!0)},clickBtnNuovaPwd:function(a){var b=this.getTxtNuovaPwd(),c=this.getTxtConfermaNuovaPwd(),d=this.getFsModificaPwd();d.isHidden()?(d.show(),b.show(),b.allowBlank=!1,b.validate(),a.setText(traduci("ANNULLA_PASSWORD")),c.allowBlank=!1,c.show()):(d.hide(),b.hide(),b.allowBlank=!0,b.setValue(""),a.setText(traduci("MODIFICA_PASSWORD")),c.allowBlank=!0,c.hide(),c.setValue(""))},caricaDatiUtenteSelezionato:function(a){this.getTabPersUtenti().enable(!0);
this.getContenuto().setHidden(!a);this.abilitaBottoniGridFiltri(a);this.aggiornaForm(a[0].get("codice"));if(this.getTabPersEconomato().down("grid")){var b=this.getTabPersEconomato().down("grid").controller;b&&(b.cbaConfig.codUtente=a[0].get("codice"),b.cbaConfig.nomeUtente=a[0].get("valore"));b.aggiornaStore();b.aggiornaGridDepositi()}},selectGriglia:function(a,b,c,d){var e=this;if(Ext.isEmpty(b))return!1;isAmministratoreOrg()&&isOperatoreCBA(b[0].get("valore"))?Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,
callBackSbloccoPwd:function(a){if(a)e.caricaDatiUtenteSelezionato(b);else return msgShowError("",traduci("PASSWORD_ERRATA")),!1}}).show():this.caricaDatiUtenteSelezionato(b)},hidePrivilegi:function(a){this.lookup("CheckAmministratore").setHidden(a||"T"!=CBA.parametriGenerali.amministratore);this.lookup("CheckAutorizzatore").setHidden(a||"T"!=CBA.parametriGenerali.amministratore);this.lookup("CheckAmmOrg").setHidden(a||!("T"==CBA.parametriGenerali.amministratore||"T"==CBA.parametriGenerali.amministratoreOrg))},
aggiornaForm:function(a){var b=this;b.utenteSel!=a&&(b.utenteSel=a,b.readOnly=!0);b.esciDalChange=!0;b.getContenuto().setHidden(!1);var c=b.getGridUtenti();this.lookup("GridCartella");null==a&&(a=c.getSelectionModel().getSelection()[0].get("codice"));b.getForm().store.load({params:{codUtente:a,collegaTeAna:"T",collegaEcoPers:"T",filtriVisibili:"T"},callback:function(c,e,g){g?Ext.isEmpty(c)||(b.getFieldSetGridAmmOrg().hide(),b.getFieldSetGridProfAut().hide(),svuotaStore(b.getGridOrgAutorizzate().getStore()),
svuotaStore(b.getGridProfiliAutorizzati().getStore()),b.hidePrivilegi(!0),b.dataPwd=new Date(c[0].data.dataAttivazionePwd),b.getBtnNuovaPwd().setDisabled(b.readOnly),b.getBtnAbilitaMod().setDisabled(!b.readOnly),containerSolaLettura(b.getForm(),b.readOnly),b.getTxtPwd().setReadOnly(!0),b.getBtnNuovaPwd().setText(traduci("MODIFICA_PASSWORD")),b.visualizzaNuovaPwd(!1,!1),b.getTxtNuovaPwd().validate(),b.getTxtConfermaNuovaPwd().setValue(""),b.getForm().show(),b.getForm().loadRecord(c[0]),b.esciDalChange=
!1,b.getFieldsetFiltri().hide(),b.getFieldsetForm().setTitle("Utente "+b.getTxtNomeUtente().getValue()),b.getFieldsetFiltri().setTitle("Filtri per "+b.getTxtNomeUtente().getValue()),b.aggiornaGridFiltriUtenti(a),b.getGridUtenti().setDisabled(!1),b.caricamentoGridCartella(c[0].data.listTeAnaPers),b.txtNomeUtenteCampiato=!1,b.inserimentoNuovoUtente=!1,b.settingPrivilegi(a)):msgShowError("",e.getError())}});b.getDirtyCartella().setValue(!1);this.lookup("TabPersEconomato").setDisabled(!1)},aggiornaGridOrgAutorizzate:function(a){var b=
this;b.gestisciColonneGridOrgAutorizzate(!0);null==a&&(a=this.getGridUtenti().getSelectionModel().getSelection()[0].get("codice"));b.getGridOrgAutorizzate().getStore().load({params:{codUtente:a},callback:function(a,d,e){e?b.abilitaBottoniGridOrgAutorizzate("T"==CBA.parametriGenerali.amministratore||"T"==CBA.parametriGenerali.amministratoreOrg):msgShowError("",d.getError())}});b.getFieldSetGridAmmOrg().show()},settingPrivilegi:function(a){this.hidePrivilegi(!1);!0===this.getCheckAmmOrg().getValue()?
this.aggiornaGridOrgAutorizzate(a):!0===this.getCheckAutorizzatore().getValue()?this.aggiornaGridProfiliAutor(a):(this.getFieldSetGridProfAut().hide(),this.getFieldSetGridAmmOrg().hide())},caricamentoGridCartella:function(a){this.visualizzaFieldCss(!Ext.isEmpty(a));if(Ext.isEmpty(a))return svuotaStore(this.getGridCartella().getStore()),svuotaStore(this.getGridTipologie().getStore()),!1;svuotaStore(this.getGridCartella().getStore());this.getGridCartella().getStore().loadData(a);this.getGridCartella().getSelectionModel().deselectAll();
this.getGridTipologie().setHidden(!0);svuotaStore(this.getGridTipologie().getStore());0<this.getGridCartella().getStore().getData().length?this.getDatiCartella().show():this.getDatiCartella().hide();this.getGridCartella().getSelectionModel().select(0)},gestioneForm:function(){var a=this,b=a.getForm();b.store=Ext.create("Generali.gestPwdNew.store.Utenti");b.dirtyGridCartella=!1;b.boxBottoni=a.getBoxBottoni();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},
annulla_callback:function(){var b;0<a.getGridUtenti().getSelectionModel().getSelection().length?(b=a.getGridUtenti().getSelectionModel().getSelection()[0].get("codice"),a.aggiornaForm(b),a.getFieldsetFiltri().show()):(a.getContenuto().setHidden(!0),a.getGridUtenti().setDisabled(!1))},nuovo_callback:function(){a.getContenuto().show();a.getFieldsetForm().show();a.getGridUtenti().setDisabled(!0);a.getFieldsetFiltri().hide();b.setHidden(!1);a.visualizzaNuovaPwd(!0,!0);a.getTxtNuovaPwd().validate();controller_nuovoRecord(b);
a.getAbilitato().setValue(!0);a.getFieldsetForm().setTitle("Nuovo Utente");a.getTxtConfermaNuovaPwd().setValue("");containerSolaLettura(a.getForm(),!1);a.getBtnAbilitaMod().setDisabled(!0);a.getFieldSetGridProfAut().hide();a.getFieldSetGridAmmOrg().hide();a.visualizzaFieldCss(!1);svuotaStore(a.getGridCartella().getStore());svuotaStore(a.getGridTipologie().getStore());a.lookup("TabPersEconomato").setDisabled(!0)},elimina_callback:function(){var c=b.getForm().findField("id").getValue(),e="";a.getGridCartella().getStore().each(function(a){var b=
a.getData().idEntePwd;a=a.getData().progr;Ext.isEmpty(b)||Ext.isEmpty(a)||(e+=b+";"+a+",")});Ext.isEmpty(c)?Messaggio("ATTENZIONE","NESSUN_UTENTE_SELEZIONATO","OK","QUESTION"):controller_eliminaRecord(b.store,{id:c,listaIdUtili:e},function(){a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},classeBottoni:"cbaCssBtnFunzione"}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnEsci").hide();b.getForm().on("dirtychange",function(c,e){a.getGridUtenti().setDisabled(e);
controller_abilitaBottoni(b)})},visualizzaNuovaPwd:function(a,b){this.getFsModificaPwd().setHidden(!a);this.getTxtNuovaPwd().setHidden(!a);this.getTxtNuovaPwd().allowBlank=!a;this.getTxtConfermaNuovaPwd().setHidden(!b);this.getTxtConfermaNuovaPwd().allowBlank=!b;this.getTxtPwd().setHidden(a);this.getBtnNuovaPwd().setHidden(a);a?this.getTxtNuovaPwd().setFieldLabel(traduci("PASSWORD")):this.getTxtNuovaPwd().setFieldLabel(traduci("MODIFICA_PASSWORD"))},verificaCampiForm:function(){var a=[],b=this.getForm(),
c=b.queryById("TxtCodiceFiscale").getValue();if(!Ext.isEmpty(this.getTxtNuovaPwd().getValue())){var d=this.controllaPwd();d&&(msgAddError(a,d),this.getTxtNuovaPwd().setValue(""),this.getTxtConfermaNuovaPwd().setValue(""))}b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");Ext.isEmpty(c)||(b=controllaCF(c),Ext.isEmpty(b)||msgAddError(a,b));return msgShow("",a)},controllaPwd:function(){return this.getTxtNuovaPwd().getValue()!==this.getTxtConfermaNuovaPwd().getValue()?"Controllare la password inserita":
validatePassword(this.getTxtConfermaNuovaPwd().getValue(),this.getTxtNomeUtente().getValue())},salvaForm:function(a){var b=this.getForm(),c=this.getGridCartella(),d=b.getForm().getFieldValues(),d=this.convertiBool(d),e=d.cognome;""!=e&&(e+=" ");var e=e+d.nome,g=[];c.getStore().each(function(a){g.push({progr:a.getData().progr,descr:""!=e?e:d.nomeUtente,tipo:a.getData().tipo,altro:a.getData().altro,idEntePwd:a.getData().idEntePwd,descEnte:a.getData().descEnte,idTimbro:a.getData().idTimbro})});Ext.apply(d,
{listTeAnaPers:g});Ext.apply(d,{dataAttivazionePwd:Ext.isEmpty(this.getTxtNuovaPwd().getValue())||Ext.isEmpty(this.getTxtConfermaNuovaPwd().getValue())?this.dataPwd:new Date(0)});delete d.dirtyCartella;(a=controller_salvaRecord(b,d,a))&&this.aggiornaStore(a.codUtente)},aggiornaStore:function(a){var b=this,c=b.getGridUtenti(),d=c.getStore();d.load({params:{filtraAutorizz:b.isAutorizzatoreUtenti(),filtraAmmOrg:isAmministratoreOrg()},callback:function(e,g,h){h?a?(e=trovaRecord(d,"codice",a),c.getSelectionModel().deselectAll(),
c.getSelectionModel().select(e?e:0)):b.getContenuto().setHidden(!0):msgShowError("",g.getError())}})},aggiornaGridFiltriUtenti:function(a){var b=this;null==a&&(a=b.getGridUtenti().getSelectionModel().getSelection()[0].get("codice"));b.getGridFiltriUtente().getStore().load({params:{codUtente:a},callback:function(a,d,e){b.layoutTabellaFiltri();b.abilitaBottoniGridFiltri(!0)}})},layoutTabellaFiltri:function(){var a=trovaRecord(this.getForm().store,"codUtente",this.getForm().queryById("TxtCodUtente").value),
b=(Ext.isEmpty(a)?"":a.get("filtriVisibili")).split(",");0<b.length&&""!=b&&(this.getFieldsetFiltri().show(),this.getGridFiltriUtente().getColumns().forEach(function(a){if(!Ext.isEmpty(a.tipoFiltro)){for(var c=!1,e=0;e<b.length&&!1===c;e++)if(a.tipoFiltro==b[e]){c=!0;break}a.setHidden(!c)}}))},aggiornaGridProfiliAutor:function(a){var b=this;null==a&&(a=b.getGridUtenti().getSelectionModel().getSelection()[0].get("codice"));b.getGridProfiliAutorizzati().getStore().load({params:{codUtentePwd:a},callback:function(a,
d,e){e?b.abilitaBottoniGridAutor("T"==CBA.parametriGenerali.amministratore):msgShowError("",d.getError())}});b.getFieldSetGridProfAut().show()},abilitaBottoniGridFiltri:function(a){this.getBtnAggiungiFiltro().setDisabled(!a);this.getBtnEliminaFiltro().setDisabled(!a)},abilitaBottoniGridAutor:function(a){this.readOnly&&(a=!1);this.getBtnAggiungiAutor().setDisabled(!a);this.getBtnEliminaAutor().setDisabled(!a)},abilitaBottoniGridOrgAutorizzate:function(a){this.readOnly&&(a=!1);this.getBtnAggiungiAdminOrg().setDisabled(!a);
this.getBtnEliminaAdminOrg().setDisabled(!a)},changeCmbEnti:function(a,b,c){if(!b)return!1;var d=this;d.cbaConfig.idEnteCbox=b;SvuotaCombo(d.getCmbOrg());d.getCmbOrg().getStore().load({params:{idEnte:b,codProfilo:d.getCbProfilo().getValue(),filtraOrgAutor:isAmministratoreOrg()},callback:function(a,b,c){c&&(d.idOrg?(d.getCmbOrg().setValue(d.idOrg),d.idOrg=null):1==a.length&&d.getCmbOrg().setValue(a[0]))}})},changeCmbOrg:function(a,b,c){if(!b)return!1;var d=this;d.getCmbFiltroRep().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),
idOrg:b,tipoFiltro:1},callback:function(a,b,c){c&&(d.idFiltriRep&&-1!=d.idFiltriRep?(d.getCmbFiltroRep().setValue(d.idFiltriRep),d.idFiltriRep=-1):Ext.isEmpty(d.getCmbFiltroRep().getValue())&&d.getCmbFiltroRep().setValue(-1))}});d.getCmbFiltroServ().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:2},callback:function(a,b,c){c&&(d.idFiltriServ&&-1!=d.idFiltriServ?(d.getCmbFiltroServ().setValue(d.idFiltriServ),d.idFiltriServ=-1):Ext.isEmpty(d.getCmbFiltroServ().getValue())&&
d.getCmbFiltroServ().setValue(-1))}});d.getCmbFiltroAttivita().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:6},callback:function(a,b,c){c&&(d.idFiltriAtt&&-1!=d.idFiltriAtt?(d.getCmbFiltroAttivita().setValue(d.idFiltriAtt),d.idFiltriAtt=-1):Ext.isEmpty(d.getCmbFiltroAttivita().getValue())&&d.getCmbFiltroAttivita().setValue(-1))}});d.getCmbFiltroUffManutenz().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:7},callback:function(a,b,c){c&&
(d.idFiltriUffManut&&-1!=d.idFiltriUffManut?(d.getCmbFiltroUffManutenz().setValue(d.idFiltriUffManut),d.idFiltriUffManut=-1):Ext.isEmpty(d.getCmbFiltroUffManutenz().getValue())&&d.getCmbFiltroUffManutenz().setValue(-1))}});d.getCmbFiltroSett().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:3},callback:function(a,b,c){c&&(d.idFiltriSett&&-1!=d.idFiltriSett?(d.getCmbFiltroSett().setValue(d.idFiltriSett),d.idFiltriSett=-1):Ext.isEmpty(d.getCmbFiltroSett().getValue())&&d.getCmbFiltroSett().setValue(-1))}});
d.getCmbFiltroPerRep().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:4},callback:function(a,b,c){c&&(d.idFiltriPerRep&&-1!=d.idFiltriPerRep?(d.getCmbFiltroPerRep().setValue(d.idFiltriPerRep),d.idFiltriPerRep=-1):Ext.isEmpty(d.getCmbFiltroPerRep().getValue())&&d.getCmbFiltroPerRep().setValue(-1))}});d.getCmbFiltroEcoCdc().getStore().load({params:{idEnte:d.getCmbEnti().getValue(),idOrg:b,tipoFiltro:5},callback:function(a,b,c){c&&(d.idFiltriEcoCdc&&-1!=d.idFiltriEcoCdc?
(d.getCmbFiltroEcoCdc().setValue(d.idFiltriEcoCdc),d.idFiltriEcoCdc=-1):Ext.isEmpty(d.getCmbFiltroEcoCdc().getValue())&&d.getCmbFiltroEcoCdc().setValue(-1))}})},clickBtnAggiungiFiltro:function(a){var b=this;a=b.getGridFiltriUtente();var c=a.getStore();b.abilitaBottoniGridFiltri(!1);c.insert(0,{});b.edit=!1;IsolaCmp(a,!0);a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0);b.getCmbEnti().getStore().load({params:{codProfilo:b.getCbProfilo().getValue(),filtroAmmOrg:isAmministratoreOrg()},callback:function(a,
c,g){g&&1===a.length&&b.getCmbEnti().setValue(a[0])}})},avvisoCancellazione:function(a){var b=traduci("MSG_ELIMINA");Ext.MessageBox.show({title:"Elimina",msg:b,buttons:Ext.MessageBox.YESNO,buttonText:{yes:"SI",no:"NO"},fn:function(b){if("no"==b)return!1;a()}})},clickBtnAggiungiAutor:function(a){a=this.getGridProfiliAutorizzati();var b=a.getStore();this.abilitaBottoniGridAutor(!1);b.insert(0,{});this.edit=!1;IsolaCmp(a,!0);a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0)},clickBtnEliminaAutor:function(a){var b=
this;if(!this.getGridProfiliAutorizzati().getSelectionModel().getSelection()[0])return!1;this.avvisoCancellazione(function(){return b.eliminaProfiloAutorizzato()})},eliminaProfiloAutorizzato:function(){var a=this,b=this.getGridProfiliAutorizzati().getSelectionModel().getSelection()[0];if(!b)return!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/utentiautorizzatipwd/delete",params:{id:b.get("id")},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(a.aggiornaGridProfiliAutor(),IsolaCmp(a.getGridProfiliAutorizzati(),
!1),msgShow("MSG_SALVATAGGIO_DATI",b.message)):msgShowError("",b.message)}})},avvisoAbilitaMod:function(a){var b=this;Ext.MessageBox.show({title:"Attenzione",msg:"Abilitare modifiche ai dati dell' Utente?",buttons:Ext.MessageBox.YESNO,closable:!1,buttonText:{yes:"SI",no:"NO"},fn:function(a){if("no"==a)return!1;b.abilitaModificheForm()}})},abilitaModificheForm:function(){containerSolaLettura(this.getForm(),!1);this.getBtnNuovaPwd().setDisabled(!1);this.getBtnAbilitaMod().setDisabled(!0);this.readOnly=
!1;this.getTxtPwd().setReadOnly(!0)},eliminaFiltroUtente:function(a){a||(a=this);grid=a.getGridFiltriUtente();rec=grid.getSelectionModel().getSelection()[0];if(!rec)return!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/pwd/filtriutente/delete",params:{id:rec.get("id")},success:function(b){Ext.JSON.decode(b.responseText).success&&(a.aggiornaGridFiltriUtenti(),IsolaCmp(a.getGridFiltriUtente(),!1));msgShow("",[])}})},clickBtnEliminaFiltro:function(){var a=this;if(!this.getGridFiltriUtente().getSelectionModel().getSelection()[0])return!1;
this.avvisoCancellazione(function(){return a.eliminaFiltroUtente(a)})},convertiBool:function(a){var b=[],c,d;for(c in a)b.push(c);b.forEach(function(b){d=a[b];"boolean"==typeof d&&(a[b]=getBoolValue(d))});return a},tabchangeTabPersUtenti:function(a,b,c,d){a={};a.idOrganizzazione=this.cbaConfig.idOrganizzazione;a.permesso=this.cbaConfig.permesso;a.codUtente=this.getGridUtenti().getSelectionModel().getSelection()[0].get("codice");0==b.items.getCount()&&b.add(Ext.create(b.cbaConfig.url,{cbaConfig:a}));
(b=b.down("grid"))&&!b.getSelectionModel().getSelection()[0]&&0<b.getStore().getCount()&&b.getSelectionModel().select(0)},isAutorizzatoreUtenti:function(){var a="F";"T"!==CBA.parametriGenerali.amministratore&&"T"===CBA.parametriGenerali.autorizzatore&&(a="T");return a},visualizzaFieldCss:function(a){Ext.each(this.lookup("CntFlag").query(),function(b){b.cbaConfig&&b.cbaConfig.onlyCss&&b.setHidden(!a)});this.getDatiCartella().setHidden(!a)},onLaunch:function(){this.getTabPersUtenti().disable(!0);this.gestioneForm();
this.aggiornaStore();this.storeProfili=this.getCbProfilo().getStore();this.storeProfili.load({params:{filtraAutorizz:this.isAutorizzatoreUtenti(),filtraAmmOrg:isAmministratoreOrg()}});this.readOnly=!0;CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione&&(this.getTxtNuovaPwd().minLength=10,this.getTxtConfermaNuovaPwd().minLength=10)},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.UtentiPersEconomato",{extend:"Generali.standard.stampe.Controller",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CmbEntiEco",selector:this.selContainer+"#CmbEntiEco"},{ref:"CmbOrgEco",selector:this.selContainer+"#CmbOrgEco"},{ref:"BtnAddDepositi",selector:this.selContainer+"#BtnAddDepositi"},
{ref:"GridDepositi",selector:this.selContainer+"#GridDepositi"}]);this.control(this.selContainer+"#CmbEntiEco",{change:this.changeEnte});this.control(this.selContainer+"#CmbOrgEco",{change:this.changeOrg});this.control(this.selContainer+"#BtnAddDepositi",{click:this.clickBtnAddDepositi});this.control(this.selContainer+"#GridDepositi",{edit:this.editGridDepositi,canceledit:this.cancelEditGrid})},berforeRendGridDepositi:function(){},cancelEditGrid:function(a,b,c){this.aggiornaGridDepositi()},editGridDepositi:function(a,
b,c){var d=this;c=b.record.getData();var e=a.getEditor().getForm();e.controller=this;e.store=b.view.getStore();Ext.apply(c,{automatico:getBoolValue(c.automatico),abilitato:getBoolValue(c.abilitato)});Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/pwd/utentipwdecodep/update",jsonData:Ext.JSON.encode(c),success:function(c){c=Ext.JSON.decode(c.responseText);var e=[];c.success?(msgAdd(e,c.message),msgShow("MSG_SALVATAGGIO_DATI",e),d.aggiornaGridDepositi()):(a.startEdit(b.record,0),msgShowError("ATTENZIONE",
c.message[0].testo))}})},clickBtnAddDepositi:function(){this.getGridDepositi().getStore();var a={};null!=this.getCmbOrgEco().getValue()&&null!=this.getCmbEntiEco().getValue()?(Ext.apply(a,{idOrganizzazione:this.getCmbOrgEco().getValue(),idEnte:this.getCmbEntiEco().getValue()}),this.aggiornaGridDepositi(a)):Messaggio("ATTENZIONE","Selezionare ente e organizzazione","OK","WARNING")},aggiornaGridDepositi:function(a){var b=this,c=b.getGridDepositi(),d=c.getStore(),e={};c.controller=b;a?Ext.apply(e,a):
svuotaStore(d);Ext.apply(e,{codUtente:b.cbaConfig.codUtente});d.load({params:e,callback:function(a,c,d){d?(b.getCmbOrgEco().setValue(null),b.getCmbEntiEco().setValue(null),b.getBtnAddDepositi().setDisabled(!0)):msgShowError("",c.getError())}})},changeEnte:function(a,b){var c=this.getCmbOrgEco();if(!b)return!1;SvuotaCombo(c);c.getStore().load({params:{idEnte:b},callback:function(a,b,g){g?1==a.length&&c.setValue(a):msgShowError("",b.getError())}})},changeOrg:function(a,b){this.getBtnAddDepositi().enable()},
salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();c.rcGestioneCatalogo=!0;c=this.convertiBool(c);Ext.apply(c,{codUtente:this.cbaConfig.codUtente});controller_salvaRecord(b,c,a)},aggiornaStore:function(){var a=this,b=a.getForm(),c=b.store;clearForm(b);a.cbaConfig.nomeUtente?a.getGridDepositi().setTitle(traduci("DEPOSITI")+" per "+a.cbaConfig.nomeUtente):a.getGridDepositi().setTitle(traduci("DEPOSITI"));c.load({params:{codUtente:a.cbaConfig.codUtente,checkConvalidatore:"F"},
callback:function(b,c,g){g?Ext.isEmpty(b)||Ext.isEmpty(b)||a.getForm().loadRecord(b[0]):msgShowError("",c.getError())}})},verificaCampiForm:function(){return!0},gestioneForm:function(){var a=this,b=a.getForm();b.store=Ext.create("Generali.gestPwdNew.store.UtentiPersEconomato");b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},annulla_callback:function(){a.aggiornaStore()},
verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnElimina").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},convertiBool:function(a){var b=[],c;for(c in a)b.push(c);var d;b.forEach(function(b){d=a[b];"boolean"==typeof d&&(a[b]=getBoolValue(d))});return a},onLaunch:function(){var a=this.getCmbOrgEco(),
b=this.getCmbEntiEco(),c=this.getGridDepositi(),d=Ext.create("Generali.gestPwdNew.store.ElencoOrg",{autoDestroy:!1});b.getStore().load();a.bindStore(clonaStore(d));c.controller=this;this.storeOrganizzazioni=clonaStore(d);this.gestioneForm();this.aggiornaStore();this.aggiornaGridDepositi()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestPwdNew.controller.VideataPassword",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TabPanelVideata",selector:a+"#TabPanelVideata"},{ref:"TabEntiOrg",selector:a+"#TabEntiOrg"},{ref:"TabProfili",selector:a+"#TabProfili"},{ref:"TabFiltri",selector:a+"#TabFiltri"},{ref:"TabUtenti",selector:a+"#TabUtenti"},{ref:"TabGestioneSedi",selector:a+"#TabGestioneSedi"},{ref:"TabStampe",selector:a+"#TabStampe"},
{ref:"TabRegoleRaccordi",selector:a+"#TabRegoleRaccordi"},{ref:"TabComunicazioniServ",selector:a+"#TabComunicazioniServ"},{ref:"TabDashboardEvents",selector:a+"#TabDashboardEvents"}]);this.control(a+"#TabPanelVideata",{tabchange:this.changeTabPanel})},changeTabPanel:function(a,b,c){var d=null;"TabProfili"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.ProfiliPwd",{}):"TabEntiOrg"===b.getItemId()?isAmministratoreOrg()?Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(a){a?
(d=Ext.create("Generali.gestPwdNew.view.EntiImpostazioni",{}),b.removeAll(),d&&b.add(d)):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show():d=Ext.create("Generali.gestPwdNew.view.EntiImpostazioni",{}):"TabFiltri"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.TabFiltri",{}):"TabUtenti"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.Utenti",{}):"TabGestioneSedi"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.GestioneSedi",{}):"TabStampe"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.StampePwd",
{}):"TabRegoleRaccordi"===b.getItemId()?d=Ext.create("Generali.gestPwdNew.view.RegoleRaccordi",{}):"TabComunicazioniServ"===b.getItemId()?isAmministratoreOrg()?Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(a){a&&(d=Ext.create("Generali.gestPwdNew.view.ComunicazioniServ",{}));b.removeAll();d?b.add(d):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show():d=Ext.create("Generali.gestPwdNew.view.ComunicazioniServ",{}):"TabDashboardEvents"===b.getItemId()&&(d=Ext.create("Generali.gestPwdNew.view.DashboardEvents",
{}));b.removeAll();d&&b.add(d)},onLaunch:function(){"T"===CBA.parametriGenerali.amministratore?this.changeTabPanel(null,this.getTabEntiOrg()):"T"===CBA.parametriGenerali.amministratoreOrg?this.lookup("TabPanelVideata").setActiveTab(this.getTabProfili()):"T"===CBA.parametriGenerali.autorizzatore&&(this.getTabEntiOrg().destroy(),this.getTabProfili().destroy(),this.getTabFiltri().destroy(),this.getTabGestioneSedi().destroy(),this.getTabRegoleRaccordi().destroy(),this.getTabComunicazioniServ().destroy(),
this.lookup("TabPanelVideata").setActiveTab(this.getTabUtenti()))},destroy:function(){this.callParent()}});Ext.define("Generali.gestPwdNew.store.AggiornaPassword",{extend:"Ext.data.Store",fields:[{name:"codUtente"},{name:"pwd"}],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/utentipwd/updatepwd",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{update:"/cba/gen/ws/pwd/utentipwd/updatepwd"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriAttivita",{extend:"Ext.data.TreeStore",fields:[{name:"descrizione"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtriattivita/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriEcoCdcDepositi",{extend:"Ext.data.TreeStore",fields:[{name:"descrizione"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtriecocdc/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriPerReparti",{extend:"Ext.data.TreeStore",fields:[{name:"descrizione"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtriperreparti/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriReparti",{extend:"Ext.data.TreeStore",fields:[{name:"text",convert:function(a,b){return 0===b.get("nodeID")?traduci("SEDI_REPARTI"):a}},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"idSede"},{name:"idReparto"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtrireparti/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriServizi",{extend:"Ext.data.TreeStore",fields:[{name:"descrizione"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtriservizi/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AlberoFiltriSettori",{extend:"Ext.data.TreeStore",fields:[{name:"text",convert:function(a,b){return 0===b.get("nodeID")?traduci("SEDI_REPARTI"):a}},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"idSede"},{name:"idReparto"},{name:"idStanza"},{name:"idLetto"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtrisettori/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},
autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.AlberoFiltriUfficiManutenz",{extend:"Ext.data.TreeStore",fields:[{name:"descrizione"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeID"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/filtrimanutentore/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.AmministratoriOrg",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codUtentePwd"},{name:"codEnte"},{name:"idOrganizzazione"},{name:"descEnte"},{name:"descOrg"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/amministratoriOrg/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.BottoniCbox",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/menuprofilibottoni/ente/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/menuprofilibottoni/ente/cbox"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.BottoniModulo",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/videate/bottoni/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/videate/bottoni/list"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.CboxUtenti",{extend:"Generali.data.StoreCodiceValore",constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/utentiPwd/utentiPwdModuloCbox"}},a)])},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.CboxValoreEsterno",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/regole/tabellaesterna/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/regole/tabellaesterna/list"}}});
Ext.define("Generali.gestPwdNew.store.Colori",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],data:[{codice:1,valore:traduci("NERO"),extra:"icon-color-nero"},{codice:2,valore:traduci("AZZURRO"),extra:"icon-color-azzurro"},{codice:3,valore:traduci("BLU"),extra:"icon-color-blu"},{codice:4,valore:traduci("GIALLO"),extra:"icon-color-giallo"},{codice:5,valore:traduci("ROSSO"),extra:"icon-color-rosso"},{codice:6,valore:traduci("VERDE"),extra:"icon-color-verde"},{codice:7,
valore:traduci("VERDESCURO"),extra:"icon-color-verdescuro"},{codice:8,valore:traduci("VIOLA"),extra:"icon-color-viola"},{codice:9,valore:traduci("ARANCIO"),extra:"icon-color-arancio"}],autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ComunicazioniServ",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"comunicazione"},{name:"dal",type:"date"},{name:"al",type:"date"}],proxy:{url:"/cba/gen/ws/pwd/comunicazioni/get",api:{read:"/cba/gen/ws/pwd/comunicazioni/get",create:"/cba/gen/ws/pwd/comunicazioni/new",update:"/cba/gen/ws/pwd/comunicazioni/update",destroy:"/cba/gen/ws/pwd/comunicazioni/delete"}}});
Ext.define("Generali.gestPwdNew.store.DbeCodificheOspiti",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idRisposta"},{name:"decris"},{name:"codice"},{name:"idTabella"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"dashboardEvents/ws/dashboard/codifiche/ospiti/list",api:{read:"dashboardEvents/ws/dashboard/codifiche/ospiti/list",create:"dashboardEvents/ws/dashboard/codifiche/ospiti/insert",update:"dashboardEvents/ws/dashboard/codifiche/ospiti/update",destroy:"dashboardEvents/ws/dashboard/codifiche/ospiti/delete"}}},
a)])},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.DbeEvents",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"tableAndId"},{name:"dbId"},{name:"idEvent"},{name:"tipoOperazione"},{name:"dataCreazioneEvento",type:"date"},{name:"dataSendReceive",type:"date"},{name:"sendReceive"},{name:"idTabellaRiferimento"},{name:"statoInvio"},{name:"numeroTentativi"},{name:"notifyStatus"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"dashboardEvents/ws/dashboard/list"},pageSize:100},a)])},
autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.DbeNotificheEvent",{extend:"Generali.data.Store",fields:[{name:"id"},{name:"tipoOperazione"},{name:"idProfilo"},{name:"desProfilo"}],proxy:{type:"ajax",url:"/cba/dashboardEvents/ws/dashboard/notifiche/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/dashboardEvents/ws/dashboard/notifiche/list",create:"/cba/dashboardEvents/ws/dashboard/notifiche/insert",update:"/cba/dashboardEvents/ws/dashboard/notifiche/update",destroy:"/cba/dashboardEvents/ws/dashboard/notifiche/delete"}},
autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.DbeOspitiTipo",{extend:"Generali.data.StoreCodiceValore",proxy:{type:"ajax",url:"dashboardEvents/ws/dashboard/codifiche/ospiti/tipoDatoCbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.DbeTipoEventi",{extend:"Generali.data.StoreCodiceValore",proxy:{type:"ajax",url:"dashboardEvents/ws/dashboard/tipoEventi/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ElencoEnti",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/enti/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/enti/cbox"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ElencoFiltri",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/filtrite/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/filtrite/list",destroy:"/cba/gen/ws/pwd/filtrite/delete"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ElencoOrg",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/general/org/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.ElencoProfiliPwd",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/pwd/profilipwd/cbox"}});
Ext.define("Generali.gestPwdNew.store.ElencoUtenti",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/utentipwd/list",api:{read:"/cba/gen/ws/pwd/utentipwd/list"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ElencoUtentiEcoDepositi",{extend:"Generali.data.StoreJson",fields:[{name:"codUtente"},{name:"idEnte"},{name:"idOrganizzazione"},{name:"idEcoDeposito"},{name:"descrizione"},{name:"tipo_deposito"},{name:"abilitato"},{name:"automatico"},{name:"permessi"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/pwd/utentipwdecodep/list"}},a)])},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.EnteSel",{extend:"Ext.data.Store",fields:[{name:"ragSoc"},{name:"cbaDatiIb"},{name:"cbaOspitiIb"},{name:"cbaEconIb"},{name:"cbaPagheIb"},{name:"progPortaleCba"},{name:"codControlloPortaleCba"},{name:"abilitaUtentiDb"},{name:"cbaAllegati"},{name:"cbaTerapie"},{name:"dbFarmaci"},{name:"sipcar2"},{name:"id"},{name:"cbaFeAllegati"},{name:"cbaRpAllegati"},{name:"sipcar2"}],proxy:{type:"ajax",url:"/cba/gen/ws/enti/get",api:{create:"/cba/gen/ws/enti/new",update:"/cba/gen/ws/enti/update",
destroy:"/cba/gen/ws/enti/delete"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.Enti",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],sorters:[{property:"valore",direction:"ASC"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/enti/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoSort:!0,autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.EntiCUCSS",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/regole/enti/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/regole/enti/list"}},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.EnumTipologieCartellaTipi",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/pwd/profili/enumTipo"}});
Ext.define("Generali.gestPwdNew.store.FigureProfessionali",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/figprof/list",api:{read:"/cba/gen/ws/pwd/figprof/list"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.FiltriCbox",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/filtrite/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/filtrite/cbox"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.FiltriReparti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idFiltriTe"},{name:"codRepart"},{name:"codSede"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/filtrireparti/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/filtrireparti/get"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.FiltriTe",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"descrizione"},{name:"idEnte"},{name:"idOrganizzazione"},{name:"tipoFiltro"},{name:"desOrg"},{name:"desEnte"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/filtrite/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/filtrite/get",create:"/cba/gen/ws/pwd/filtrite/new",update:"/cba/gen/ws/pwd/filtrite/update"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.FiltriUtente",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/filtriutente/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/filtriutente/list",create:"/cba/gen/ws/pwd/filtriutente/new",destroy:"/cba/gen/ws/pwd/filtriutente/delete"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ImpostaProfili",{extend:"Ext.data.Store",fields:[{name:"idProfilo"},{name:"idOrganizzazione"},{name:"descrizione"},{name:"regione"},{name:"stpColori"},{name:"modificheInGiornata"},{name:"tipo"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/profili/list",api:{read:"/cba/gen/ws/pwd/profili/list",create:"/cba/gen/ws/pwd/profili/new",update:"/cba/gen/ws/pwd/profili/update",destroy:"/cba/gen/ws/pwd/profili/delete"},reader:{type:"json",messageProperty:"message",
rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ImpostaProfiliTest",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idProfilo"},{name:"descrizione"},{name:"idIcona"},{name:"tipoBottone"},{name:"ordine"},{name:"coloreIcona"}],proxy:{type:"ajax",method:"GET",url:"/cba/css/cs/ws/menuprofilibottoni/getbottonibyprofilo",api:{read:"/cba/gen/ws/pwd/menuprofilibottoni/getbottonibyprofilo",create:"/cba/gen/ws/pwd/menuprofilibottoni/new",update:"/cba/gen/ws/pwd/menuprofilibottoni/update",destroy:"/cba/gen/ws/pwd/menuprofilibottoni/delete"},
reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.ListaOrg",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/org/src/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ModuliEnte",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"desModulo"},{name:"sequenza"},{name:"modAttivato"},{name:"idEnte"}],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/mod/src/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/mod/src/get",update:"/cba/gen/ws/general/geente/mod/update"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ModuliOrg",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"desModulo"},{name:"sequenza"},{name:"modAttivato"},{name:"idEnte"},{name:"modAttivoPerOrg"}],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/mod/src/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/mod/src/get",update:"/cba/gen/ws/pwd/profilipwdde/mod/update"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.OrganizzEnte",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codEnte"},{name:"ragioneSociale"},{name:"codiceFiscale"},{name:"indirizzo"},{name:"citta"},{name:"codComune"},{name:"provincia"},{name:"cap"},{name:"partitaIva"},{name:"telefono1"},{name:"telefono2"},{name:"fax"},{name:"email"},{name:"pec"},{name:"indirizzoFiscale"},{name:"cittaFiscale"},{name:"codComuneFiscale"},{name:"provinciaFiscale"},{name:"capFiscale"},{name:"visualizzaLogo"},{name:"visualizzaRagioneSociale"},
{name:"siglaQualita"},{name:"moduliUtilizzati"},{name:"idGruppoPer"},{name:"perEsterno"},{name:"orgDefault"},{name:"annoEsercContab"},{name:"idEnte"},{name:"idOrgPtl"},{name:"idOrgZuc"},{name:"idOrgAmministrazione"},{name:"robyoneId"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/org/src/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/org/src/get",create:"/cba/gen/ws/general/org/new",update:"/cba/gen/ws/general/org/update",destroy:"/cba/gen/ws/general/org/src/delete"}},
autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.PermessiTree",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeId"},{name:"ordine"},{name:"tipo"},{name:"tipoPermesso"},{name:"livello"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/profilipwddecss/listaprofiligestionetree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.PermessiTreePortletNon",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"nodeId"},{name:"ordine"},{name:"tipo"},{name:"tipoPermesso"},{name:"livello"},{name:"checked"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/pwd/profilipwddecss/listaprofiligestionetreeportletna",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ProfiliEntiOrg",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codProfilo"},{name:"codEnte"},{name:"modUtil"},{name:"idProfiloCss"},{name:"idOrganizzazione"},{name:"ragSoc"},{name:"descOrg"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/profilipwdde/src/list",api:{read:"/cba/gen/ws/pwd/profilipwdde/src/list",create:"/cba/gen/ws/pwd/profilipwdde/new",update:"/cba/gen/ws/pwd/profilipwdde/update",destroy:"/cba/gen/ws/pwd/profilipwdde/delete"},reader:{type:"json",
messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ProfiliPwd",{extend:"Ext.data.Store",fields:[{name:"codProfilo"},{name:"titolo"},{name:"descrizione"},{name:"gestscadenzapwd"},{name:"tiposcad"},{name:"idProfiloPwdCopy"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/profilipwd/list",api:{read:"/cba/gen/ws/pwd/profilipwd/list",create:"/cba/gen/ws/pwd/profilipwd/new",update:"/cba/gen/ws/pwd/profilipwd/update",destroy:"/cba/gen/ws/pwd/profilipwd/delete"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},
autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.ProfiliPwdCbox",{extend:"Ext.data.Store",proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/profilipwd/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/profilipwd/cbox"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.ProfiliPwdDeCss",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/css/cs/ws/profili/profilipwddecss/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/profilipwddecss/list",create:"/cba/gen/ws/pwd/profilipwddecss/new",update:"/cba/gen/ws/pwd/profilipwddecss/update",destroy:"/cba/gen/ws/pwd/profilipwddecss/delete"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.RegApertura",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"descrizione",convert:function(a){return traduci(a)}},{name:"codiceRecord"}],data:[["V","REG_CREA_RICOVERO_NOPRES","V1"],["N","REG_CREA_RICOVERO_NO","N1"],["C","REG_CREA_RICOVERO_SI","C1"],["V","REG_CREA_ASSENZA_NOPRES","V2"],["N","REG_CREA_ASSENZA_NO","N2"],["C","REG_CREA_ASSENZA_SI","C2"]]});
Ext.define("Generali.gestPwdNew.store.RegChiusura",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"descrizione",convert:function(a){return traduci(a)}},{name:"codiceRecord"}],data:[["C","REG_CHIUDI_RICOVERO_SI","C1"],["N","REG_NOTIFICA_CHIUS","N1"],["C","REG_CHIUDI_ASSENZA_SI","C2"],["N","REG_NOTIFICA_CHIUS","N2"]]});
Ext.define("Generali.gestPwdNew.store.RegTipCod",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"descrizione",convert:function(a){return traduci(a)}}],data:[["S","SERVIZIO"],["T","TIPOLOGIA_CARTELLA"],["A","ASSENZA_CU2"],["H","ASSENZA_CSS2"]]});
Ext.define("Generali.gestPwdNew.store.RegoleRaccordi",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/regole/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/regole/list"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.Risposte",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"descrizione"},{name:"idProfilo"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/tipologie/risposte/get",api:{read:"/cba/gen/ws/pwd/tipologie/risposte/get"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.gestPwdNew.store.StoricoComunicazioni",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/pwd/comunicazioni/listStorico"}});
Ext.define("Generali.gestPwdNew.store.TeAnaPersPwd",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/teanaperspwd/list",api:{read:"/cba/gen/ws/pwd/teanaperspwd/list"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.TimbriRicetta",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/timbriricetta/list",api:{read:"/cba/gen/ws/pwd/timbriricetta/list"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.TipoBottone",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/menuprofilibottoni/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.TipoIcona",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],data:[{codice:"1",valore:"Bottone1",extra:"default-icons-css-32 icon-cartella-bottone1"},{codice:"2",valore:"Bottone2",extra:"default-icons-css-32 icon-cartella-bottone2"},{codice:"3",valore:"Bottone3",extra:"default-icons-css-32 icon-cartella-bottone3"},{codice:"4",valore:"Bottone4",extra:"default-icons-css-32 icon-cartella-bottone4"},{codice:"5",valore:"Bottone5",extra:"default-icons-css-32 icon-cartella-bottone5"},
{codice:"6",valore:"Bottone6",extra:"default-icons-css-32 icon-cartella-bottone6"},{codice:"7",valore:"Bottone7",extra:"default-icons-css-32 icon-cartella-bottone7"},{codice:"8",valore:"Bottone8",extra:"default-icons-css-32 icon-cartella-bottone8"},{codice:"9",valore:"Bottone9",extra:"default-icons-css-32 icon-cartella-bottone9"},{codice:"10",valore:"Bottone10",extra:"default-icons-css-32 icon-cartella-bottone10"},{codice:"11",valore:"Bottone11",extra:"default-icons-css-32 icon-cartella-bottone11"},
{codice:"12",valore:"Bottone12",extra:"default-icons-css-32 icon-cartella-bottone12"},{codice:"13",valore:"Bottone13",extra:"default-icons-css-32 icon-cartella-bottone13"},{codice:"14",valore:"Bottone14",extra:"default-icons-css-32 icon-cartella-bottone14"},{codice:"15",valore:"Bottone15",extra:"default-icons-css-32 icon-cartella-bottone15"},{codice:"16",valore:"Bottone16",extra:"default-icons-css-32 icon-cartella-bottone16"},{codice:"17",valore:"Bottone17",extra:"default-icons-css-32 icon-cartella-bottone17"},
{codice:"18",valore:"Bottone18",extra:"default-icons-css-32 icon-cartella-bottone18"},{codice:"19",valore:"Bottone19",extra:"default-icons-css-32 icon-cartella-bottone19"},{codice:"20",valore:"Bottone20",extra:"default-icons-css-32 icon-cartella-bottone20"},{codice:"21",valore:"Bottone21",extra:"default-icons-css-32 icon-cartella-bottone21"},{codice:"22",valore:"Bottone22",extra:"default-icons-css-32 icon-cartella-bottone22"},{codice:"23",valore:"Bottone23",extra:"default-icons-css-32 icon-cartella-bottone23"},
{codice:"24",valore:"Bottone24",extra:"default-icons-css-32 icon-cartella-bottone24"},{codice:"25",valore:"Bottone25",extra:"default-icons-css-32 icon-cartella-bottone25"},{codice:"26",valore:"Bottone26",extra:"default-icons-css-32 icon-cartella-bottone26"},{codice:"27",valore:"Bottone27",extra:"default-icons-css-32 icon-cartella-bottone27"},{codice:"28",valore:"Bottone28",extra:"default-icons-css-32 icon-cartella-bottone28"},{codice:"29",valore:"Bottone29",extra:"default-icons-css-32 icon-cartella-bottone29"},
{codice:"30",valore:"Bottone30",extra:"default-icons-css-32 icon-cartella-bottone30"},{codice:"31",valore:"Bottone31",extra:"default-icons-css-32 icon-cartella-bottone31"},{codice:"32",valore:"Bottone32",extra:"default-icons-css-32 icon-cartella-bottone32"},{codice:"33",valore:"Bottone33",extra:"default-icons-css-32 icon-cartella-bottone33"},{codice:"34",valore:"Bottone34",extra:"default-icons-css-32 icon-cartella-bottone34"},{codice:"35",valore:"Bottone35",extra:"default-icons-css-32 icon-cartella-bottone35"},
{codice:"36",valore:"Bottone36",extra:"default-icons-css-32 icon-cartella-bottone36"},{codice:"37",valore:"Bottone37",extra:"default-icons-css-32 icon-cartella-bottone37"},{codice:"38",valore:"Bottone38",extra:"default-icons-css-32 icon-cartella-bottone38"},{codice:"39",valore:"Bottone39",extra:"default-icons-css-32 icon-cartella-bottone39"},{codice:"40",valore:"Bottone40",extra:"default-icons-css-32 icon-cartella-bottone40"},{codice:"41",valore:"Bottone41",extra:"default-icons-css-32 icon-cartella-bottone41"},
{codice:"42",valore:"Bottone42",extra:"default-icons-css-32 icon-cartella-bottone42"},{codice:"43",valore:"Bottone43",extra:"default-icons-css-32 icon-cartella-bottone43"},{codice:"44",valore:"Bottone44",extra:"default-icons-css-32 icon-cartella-bottone44"},{codice:"45",valore:"Bottone45",extra:"default-icons-css-32 icon-cartella-bottone45"},{codice:"46",valore:"Bottone46",extra:"default-icons-css-32 icon-cartella-bottone46"}],autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.TipoPermesso",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],data:[{codice:"L",valore:"Sola lettura",extra:"1"},{codice:"S",valore:"LetturaScrittura",extra:"1"},{codice:"N",valore:"Nessun Permesso",extra:"12"},{codice:"V",valore:"Visibile",extra:"2"}],autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.Tipologie",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/tipologie/getbyteanapers",api:{read:"/cba/gen/ws/pwd/tipologie/getbyteanapers"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.TipologieCartella",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/profili/ente/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/pwd/profili/ente/list"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.UtenteProfili",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codProfilo"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/utentipwdprofili/getprofilibyutente",api:{read:"/cba/gen/ws/pwd/utentipwdprofili/getprofilibyutente",create:"/cba/gen/ws/pwd/utentipwdprofili/new",update:"/cba/gen/ws/pwd/utentipwdprofili/update",destroy:"/cba/gen/ws/pwd/utentipwdprofili/delete"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.Utenti",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"nomeUtente"},{name:"pwd"},{name:"amministratore"},{name:"abilitato"},{name:"autorizzatore"},{name:"codUtente"},{name:"cognome"},{name:"nome"},{name:"codiceFiscale"},{name:"email"},{name:"externalId"},{name:"listTeAnaPers"},{name:"docPers"},{name:"ricoveriCss"},{name:"amministratoreOrg"},{name:"armadioFarma"},{name:"etichetteFarma"},{name:"cssAttivita"},{name:"cssProdottiMedicazioni"}],constructor:function(a){a=
a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/pwd/utentipwd/get",api:{read:"/cba/gen/ws/pwd/utentipwd/get",create:"/cba/gen/ws/pwd/utentipwd/new",update:"/cba/gen/ws/pwd/utentipwd/update",destroy:"/cba/gen/ws/pwd/utentipwd/delete"}}},a)])},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.UtentiAutorizzatiPwd",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/utentiautorizzatipwd/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{}},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.UtentiPersEconomato",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"codUtente"},{name:"rcConvalidatore"},{name:"rcGestioneCatalogo"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/pwd/utentipwdecopers/get",api:{read:"/cba/gen/ws/pwd/utentipwdecopers/get",create:"/cba/gen/ws/pwd/utentipwdecopers/new",update:"/cba/gen/ws/pwd/utentipwdecopers/update",destroy:"/cba/gen/ws/pwd/utentipwdecopers/delete"}}},a)])},autoDestroy:!0});
Ext.define("Generali.gestPwdNew.store.VideatePwd",{extend:"Generali.data.StoreJson",proxy:{url:"/cba/gen/ws/pwd/videatepwd/list",api:{read:"/cba/gen/ws/pwd/videatepwd/list",update:"/cba/gen/ws/pwd/videatepwd/update"}}});
Ext.define("Generali.gestPwdNew.view.AggiornaPassword",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"vbox",align:"stretch"},flex:1,pagging:"10",items:[{xtype:"container",itemId:"ContainerMex",reference:"ContainerMex",layout:{align:"stretch"},
flex:1,html:""},{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},border:!1,flex:2,bodyPadding:"10",items:[{xtype:"textfield",itemId:"TxtNuovaPwd",reference:"TxtNuovaPwd",fieldLabel:"Nuova password",allowBlank:!1,name:"pwdTemp",margin:"0 0 0 0",minLength:CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione?10:8,labelWidth:150,labelClsExtra:"cbaLabel",width:100,maxLength:50,enforceMaxLength:!0,inputType:"password"},{xtype:"textfield",itemId:"TxtConfermaNuovaPwd",
reference:"TxtConfermaNuovaPwd",name:"pwdNew",fieldLabel:"Conferma password",allowBlank:!1,margin:"10 0 0 0",minLength:CBA.parametriGenerali.personPwd&&20<=CBA.parametriGenerali.personPwd.versione?10:8,labelWidth:150,labelClsExtra:"cbaLabel",width:100,maxLength:50,enforceMaxLength:!0,inputType:"password"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-conferma",cls:"cbaCssBtnFunzione",text:"CONFERMA"},{xtype:"button",
itemId:"BtnAnnulla",reference:"BtnAnnulla",text:"RIPRISTINA",iconCls:"icon-annulla",cls:"cbaCssBtnFunzione"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ComunicazioniServ",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridComunicazioni",reference:"GridComunicazioni",width:300,title:"STORICO_COMUNICAZIONI",store:Ext.create("Generali.gestPwdNew.store.StoricoComunicazioni"),columns:[{xtype:"gridcolumn",dataIndex:"codice",
hidden:!0},{xtype:"gridcolumn",dataIndex:"valore",flex:1}],viewConfig:{loadMask:!1}},{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},trackResetOnLoad:!0,bodyPadding:10,border:0,flex:1,items:[{xtype:"fieldset",title:"COMUNICAZIONE_TIT",layout:{type:"vbox"},maxWidth:800,padding:10,items:[{xtype:"container",layout:{type:"hbox"},items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"datefield",reference:"DtDal",name:"dal",fieldLabel:"COMUNIC_DAL",labelAlign:"top",width:120,
allowBlank:!1,margin:"0 0 0 0",labelClsExtra:"cbaLabel"},{xtype:"timefield",reference:"TmDal",width:50,name:"oraInizio",allowBlank:!1,format:"H:i",labelClsExtra:"cbaLabel",margin:"23 0 0 2"},{xtype:"datefield",fieldLabel:"COMUNIC_AL",reference:"DtAl",labelAlign:"top",name:"al",width:120,allowBlank:!1,margin:"0 0 0 10",labelClsExtra:"cbaLabel"},{xtype:"timefield",reference:"TmAl",width:50,name:"al",allowBlank:!1,format:"H:i",labelClsExtra:"cbaLabel",name:"oraFine",margin:"23 0 0 2"}]},{xtype:"textareafield",
grow:!0,name:"comunicazione",reference:"TxaComunicazione",fieldLabel:"COMUNICAZIONE_FIELD",margin:"10 0 0 0",labelAlign:"top",height:250,width:500,maxLength:300,allowBlank:!1,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.CopiaRegolaRaccordo",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridToCopy",reference:"GridToCopy",flex:1,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"codice"},{xtype:"gridcolumn",dataIndex:"idEsterno",flex:1,text:"Copia regola per",renderer:function(a,
b,c){return null!=c.get("extra")?c.get("valore")+" (<i>"+c.get("extra")+"</i>)":c.get("valore")}}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"BtnConfermaCopia",reference:"BtnConfermaCopia",text:traduci("CONFERMA"),cls:"cbaCssBtnFunzione",iconCls:"icon-ok"},{xtype:"button",itemId:"BtnAnnullaCopia",reference:"BtnAnnullaCopia",iconCls:"icon-annulla",cls:"cbaCssBtnFunzione",text:traduci("ANNULLA")}]}],selModel:Ext.create("Ext.selection.CheckboxModel",{checkOnly:!0})}]}]});
this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.CopiaTipologiaSpecial",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",cls:"cbaCssPnlPopup",layout:{type:"vbox"},flex:1,items:[{xtype:"combobox",fieldLabel:"Profilo password",labelClsExtra:"cbaLabel",labelWidth:120,itemId:"CbProfilo",reference:"CbProfilo",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwd"),valueField:"codProfilo",displayField:"descrizione",
queryMode:"local",width:400,margin:"5 0 0 2 "},{xtype:"combobox",fieldLabel:"Organizzazione",labelClsExtra:"cbaLabel",labelWidth:120,itemId:"CbProfiloDett",reference:"CbProfiloDett",store:Ext.create("Generali.gestPwdNew.store.ProfiliEntiOrg"),valueField:"id",displayField:"descOrg",queryMode:"local",width:400,margin:"5 0 0 2 "},{xtype:"combobox",fieldLabel:"Tipologia Cartella",labelClsExtra:"cbaLabel",labelWidth:120,itemId:"CbTipologia",reference:"CbTipologia",store:Ext.create("Generali.gestPwdNew.store.ImpostaProfili"),
valueField:"id",displayField:"descrizione",queryMode:"local",width:400,margin:"5 0 0 2 "},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",itemId:"BtnConfermaCopia",reference:"BtnConfermaCopia",text:traduci("CONFERMA"),cls:"cbaCssBtnFunzione",iconCls:"icon-ok",margin:"5 40 5 30"},{xtype:"button",itemId:"BtnAnnullaCopia",reference:"BtnAnnullaCopia",iconCls:"icon-annulla",cls:"cbaCssBtnFunzione",text:traduci("ANNULLA"),margin:"5 0 5 110"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.CreazioneRegolaRaccordo",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},bodyPadding:20,flex:1,items:[{xtype:"combobox",itemId:"CbTipoCod",reference:"CbTipoCod",queryMode:"local",valueField:"codice",
displayField:"descrizione",fieldLabel:traduci("REG_TIPO_CODIFICA"),allowBlank:!1,labelWidth:120,margin:"0 0 5 0",name:"tipoCodifica"},{xtype:"combobox",itemId:"CbEsterno",reference:"CbEsterno",queryMode:"local",valueField:"codice",labelWidth:120,fieldLabel:traduci("REG_VALORE"),displayField:"valore",tpl:'<tpl for="."><tpl if="extra != null"><div class="x-boundlist-item">{valore} (<i>{extra}</i>)</div></tpl><tpl if="extra == null"><div class="x-boundlist-item">{valore}</div></tpl></tpl>',allowBlank:!1,
margin:"5 0 5 0",name:"idEsterno"},{xtype:"combobox",itemId:"CbApertura",reference:"CbApertura",fieldLabel:traduci("REG_APERTURA"),queryMode:"local",valueField:"codice",displayField:"descrizione",allowBlank:!1,labelWidth:120,margin:"5 0 5 0",name:"operazioneNuovo"},{xtype:"combobox",itemId:"CbChiusura",reference:"CbChiusura",fieldLabel:traduci("REG_CHIUSURA"),queryMode:"local",valueField:"codice",displayField:"descrizione",allowBlank:!1,labelWidth:120,margin:"5 0 5 0",name:"operazioneChiusura"}],
dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",text:traduci("CONFERMA"),cls:"cbaCssBtnFunzione",iconCls:"icon-ok"},{xtype:"button",itemId:"BtnAnnulla",reference:"BtnAnnulla",iconCls:"icon-annulla",cls:"cbaCssBtnFunzione",text:traduci("RIPRISTINA")}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.DBEDettaglio",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",border:0,cls:"cbaCssPnlPopup",flex:1,bodyPadding:10,padding:10,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",itemId:"FldIDTBL",reference:"FldIDTBL",width:220,fieldStyle:"font-weight: bold;",fieldLabel:"DBE_TAB_ID",
labelClsExtra:"cbaLabel",flex:1},{xtype:"displayfield",itemId:"FldData",reference:"FldData",width:220,fieldLabel:"DATA",fieldStyle:"font-weight: bold;",labelClsExtra:"cbaLabel",flex:1}]},{xtype:"container",border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",itemId:"FldTipoOperazione",reference:"FldTipoOperazione",width:220,fieldStyle:"font-weight: bold;",fieldLabel:"DBE_TIPO_EVENTO",labelClsExtra:"cbaLabel",flex:1},{xtype:"displayfield",itemId:"FldNumeroInvii",reference:"FldNumeroInvii",
width:220,fieldStyle:"font-weight: bold;",fieldLabel:"DBE_RN_TENTANTIVI",labelClsExtra:"cbaLabel",flex:1}]},{xtype:"container",border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",itemId:"FldSendRevece",reference:"FldSendRevece",width:220,fieldStyle:"font-weight: bold;",fieldLabel:"DBE_SEND_RECEIVE",labelClsExtra:"cbaLabel",flex:1,renderer:function(a){switch(a){case "R":return traduci("DBE_RICEVUTO");case "S":return traduci("DBE_EVENTO_INVIATO")}return a}},{xtype:"displayfield",
itemId:"FldStato",reference:"FldStato",width:220,fieldStyle:"font-weight: bold;",fieldLabel:"DBE_STATO_ELABORAZIONE",labelClsExtra:"cbaLabel",flex:1,renderer:function(a){switch(a){case 1:return traduci("DBE_DA_INVIARE");case 2:return traduci("DBE_IN_ELABORAZIONE");case 3:return traduci("DBE_INVIATO");case 4:return traduci("DBE_IN_ERRORE")}return a}}]},{xtype:"textarea",itemId:"FldMessage",reference:"FldMessage",fieldLabel:"DBE_MESSAGE",labelClsExtra:"cbaLabel",readOnly:!0,flex:1},{xtype:"textarea",
itemId:"FldResponse",reference:"FldResponse",fieldLabel:"DBE_RESPONSE",labelClsExtra:"cbaLabel",readOnly:!0,flex:1}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.DBEImpostazioni",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",border:0,cls:"cbaCssPnlPopup",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",itemId:"FieldSetPuliziaEventi",reference:"FieldSetPuliziaEventi",title:"DBE_PULIZIA_EVENTI",layout:{type:"hbox",align:"center"},bodyPadding:10,padding:10,margin:10,items:[{xtype:"numberfield",itemId:"TxtNMesi",
reference:"TxtNMesi",allowDecimals:!1,hideTrigger:!1,minValue:1,maxValue:12,fieldLabel:"DBE_MANTIENI_PER",name:"valoreMin"},{xtype:"splitter"},{xtype:"button",itemId:"BtnDelConferma",reference:"BtnDelConferma",iconCls:"icon-conferma",text:"CONFERMA",disabled:!0},{xtype:"splitter"},{xtype:"button",itemId:"BtnDelRipristina",reference:"BtnDelRipristina",iconCls:"icon-annulla",text:"RIPRISTINA",disabled:!0}]},{xtype:"fieldset",itemId:"FieldSetEventiNotifica",reference:"FieldSetEventiNotifica",title:"DBE_EVENTI_NOTIFICA",
layout:{type:"vbox",align:"stretch"},padding:10,margin:10,flex:1,items:[{xtype:"CBAShortcutGrid",itemId:"GridNotifiche",reference:"GridNotifiche",scrollable:!0,overFlowX:"auto",overFlowY:"auto",flex:1,plugins:[Ext.create("RowEditingAutoInsert",{autoCancel:!1,errorSummary:!1,activeOnNewRecordsOnly:!1})],store:Ext.create("Generali.gestPwdNew.store.DbeNotificheEvent",{autoLoad:!0}),columns:{defaults:{variableRowHeight:!0},items:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"tipoOperazione",
text:"Evento",flex:1,editor:{xtype:"combobox",displayField:"valore",queryMode:"local",allowBlank:!1,valueField:"codice",store:Ext.create("Generali.gestPwdNew.store.DbeTipoEventi",{autoLoad:!0})}},{xtype:"gridcolumn",text:"Destinatario",dataIndex:"idProfilo",flex:1,renderer:function(a,b,c){return c.get("desProfilo")},editor:{xtype:"combobox",displayField:"valore",allowBlank:!1,queryMode:"local",valueField:"codice",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwdCbox",{autoLoad:!0})}}]},viewConfig:{loadMask:!1},
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNotificaNuovo",reference:"BtnNotificaNuovo",iconCls:"icon-inserisciGriglia",text:"NUOVO"},{xtype:"button",itemId:"BtnNotificaElimina",reference:"BtnNotificaElimina",iconCls:"icon-eliminaGriglia",text:"ELIMINA"}]}]}]},{xtype:"fieldset",itemId:"FieldSetCodifiche",reference:"FieldSetCodifiche",title:"DBE_CODIFICHE",layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,margin:10,flex:1,items:[{xtype:"tabpanel",itemId:"TabDb",
reference:"TabDb",flex:1,layout:"fit",items:[{xtype:"panel",title:"DBE_DB_PWD",itemId:"PnlDbPWD",reference:"PnlDbPWD",flex:1,layout:"fit",items:[]},{xtype:"panel",title:"DBE_DB_DATI",itemId:"PnlDbDati",reference:"PnlDbDati",flex:1,layout:"fit",items:[]},{xtype:"panel",title:"DBE_DB_OSPITI",itemId:"PnlDbOspiti",reference:"PnlDbOspiti",flex:1,layout:"fit",items:[]},{xtype:"panel",title:"DBE_DB_ECO",itemId:"PnlDbEco",reference:"PnlDbEco",flex:1,layout:"fit",items:[]},{xtype:"panel",title:"DBE_DB_PAGHE",
itemId:"PnlDbPaghe",reference:"PnlDbPaghe",flex:1,layout:"fit",items:[]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.DashboardEvents",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",border:!1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"fieldset",itemId:"FieldSetPeriodo",reference:"FieldSetPeriodo",title:"DBE_PERIODO",flex:2,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,margin:10,items:[{xtype:"datefield",itemId:"EdtDtDal",reference:"EdtDtDal",
columnWidth:.5,labelClsExtra:"cbaLabel",fieldLabel:"DATA_DAL",minWidth:220},{xtype:"datefield",itemId:"EdtDtAl",reference:"EdtDtAl",columnWidth:.5,labelClsExtra:"cbaLabel",fieldLabel:"DATA_AL",minWidth:220}]},{xtype:"fieldset",itemId:"FieldSetStato",reference:"FieldSetStato",title:"DBE_STATO_EVENTI_TIPO",flex:2,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,margin:10,items:[{xtype:"radiogroup",columns:4,itemId:"RgbFiltroStato",reference:"RgbFiltroStato",items:[{boxLabel:"DBE_TUTTI",
name:"FiltroStato",inputValue:0,cls:"cbaLabel"},{boxLabel:"DBE_IN_ERRORE",name:"FiltroStato",inputValue:4,cls:"cbaLabel",checked:!0},{boxLabel:"DBE_DA_INVIARE",name:"FiltroStato",inputValue:1,cls:"cbaLabel"},{boxLabel:"DBE_INVIATI",name:"FiltroStato",inputValue:3,cls:"cbaLabel"}]},{xtype:"combobox",columnWidth:1,itemId:"CBTipoEventi",reference:"CBTipoEventi",fieldLabel:"DBE_TIPO_EVENTI",displayField:"valore",queryMode:"local",valueField:"codice",value:"Tutto",labelClsExtra:"cbaLabel",store:Ext.create("Generali.gestPwdNew.store.DbeTipoEventi",
{autoLoad:!0})}]},{xtype:"fieldset",itemId:"FieldSetTipoTesto",reference:"FieldSetTipoTesto",title:"DBE_TESTO",flex:2,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,margin:10,items:[{xtype:"textfield",itemId:"DescrizioneRicerca",reference:"DescrizioneRicerca",fieldLabel:"DBE_TESTO_CONTENUTO",labelClsExtra:"cbaLabel",flex:1,name:"noteRicerca"},{xtype:"checkboxgroup",fieldLabel:"DBE_CERCA_TESTO",labelClsExtra:"cbaLabel",itemId:"CbxCercaIn",reference:"CbxCercaIn",columns:2,items:[{boxLabel:"Message",
name:"message",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel",checked:!0},{boxLabel:"Response",name:"response",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel",checked:!0}]}]},{xtype:"panel",border:!1,layout:{align:"stretch",type:"vbox"},flex:1,items:[{xtype:"button",itemId:"BtnImpostazioni",reference:"BtnImpostazioni",flex:1,margin:10,iconCls:"icon-settings-small",scale:"large",text:"DBE_IMPOSTAZIONI"},{xtype:"button",itemId:"BtnCerca",reference:"BtnCerca",flex:1,margin:10,iconCls:"icon-ricerca",
scale:"large",text:"CERCA"}]}]},{xtype:"CBAShortcutGrid",itemId:"GridEventi",reference:"GridEventi",overFlowX:"auto",overFlowY:"auto",margin:10,flex:1,store:Ext.create("Generali.gestPwdNew.store.DbeEvents",{autoLoad:!1}),columns:{defaults:{variableRowHeight:!0},items:[{xtype:"actioncolumn",width:35,align:"center",bodyPadding:10,items:[{iconCls:"icon-elimina",tooltip:"Elimina",margin:10,handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.eliminaRecord(b)}}]},{xtype:"gridcolumn",dataIndex:"tableAndId",
text:"ID",width:150},{xtype:"datecolumn",dataIndex:"dataCreazioneEvento",format:"d/m/Y H:i:s",text:"Data Evento",flex:1},{xtype:"gridcolumn",dataIndex:"tipoOperazione",flex:1,text:"Tipologia Evento"},{xtype:"gridcolumn",dataIndex:"idTabellaRiferimento",text:"Chiave Tabella",width:110,renderer:cell_renderer_destra},{xtype:"datecolumn",dataIndex:"dataSendReceive",format:"d/m/Y H:i",text:"Data Elaborazione",flex:1},{xtype:"gridcolumn",dataIndex:"numeroTentativi",width:110,text:"Numero Tentativi",renderer:cell_renderer_destra},
{xtype:"gridcolumn",dataIndex:"statoInvio",width:110,text:"DBE_STATO_ELABORAZIONE",renderer:function(a,c){4==a&&(c.style="font-weight: bold; background-color: #fc9d9d;");3==a&&(c.style="font-weight: bold; background-color: #8cfa8c;");2==a&&(c.style="background-color: #ffffa1;");switch(a){case 1:return traduci("DBE_DA_INVIARE");case 2:return traduci("DBE_IN_ELABORAZIONE");case 3:return traduci("DBE_INVIATO");case 4:return traduci("DBE_IN_ERRORE")}return a}},{xtype:"actioncolumn",width:75,align:"center",
bodyPadding:10,items:[{margin:10,handler:function(b,c,d){b=b.getStore().getAt(c);4==b.data.statoInvio&&a.controller.reinviaRecord(b)},getClass:function(a,c,d){return 4!=d.data.statoInvio?"x-hide-display":"icon-annulla"}},{xtype:"splitter"},{iconCls:"icon-info",tooltip:"Dettagli",margin:10,handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.winDettaglio(b)}}]}]},viewConfig:{loadMask:!1},dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",itemId:"PTEventi",reference:"PTEventi"}]}]});a.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.DbeCodificheOspiti",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"CBAShortcutGrid",itemId:"GridCodifiche",reference:"GridCodifiche",scrollable:!0,overFlowX:"auto",overFlowY:"auto",flex:1,plugins:[Ext.create("RowEditingAutoInsert",{autoCancel:!1,errorSummary:!1,activeOnNewRecordsOnly:!1})],store:Ext.create("Generali.gestPwdNew.store.DbeCodificheOspiti",{autoLoad:!0}),
columns:{defaults:{variableRowHeight:!0},items:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",text:"Id Tipo Dato",flex:1,renderer:function(a,b,c){return c.data.idRisposta}},{xtype:"gridcolumn",dataIndex:"idRisposta",text:"Tipo Dato",flex:1,renderer:function(a,b,c){return c.get("decris")},editor:{xtype:"combobox",displayField:"valore",allowBlank:!1,queryMode:"local",valueField:"codice",store:Ext.create("Generali.gestPwdNew.store.DbeOspitiTipo",{autoLoad:!0})}},{xtype:"gridcolumn",
dataIndex:"codice",text:"Codice Esterno",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:100,enforceMaxLength:!0}},{xtype:"gridcolumn",dataIndex:"idTabella",text:"Codice Sipcar",flex:1,editor:{xtype:"numberfield",allowBlank:!1,decimalPrecision:0,minValue:1}}]},viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnCodificaNuovo",reference:"BtnCodificaNuovo",iconCls:"icon-inserisciGriglia",text:"NUOVO"},{xtype:"button",itemId:"BtnCodificaElimina",
reference:"BtnCodificaElimina",iconCls:"icon-eliminaGriglia",text:"ELIMINA"},{xtype:"button",itemId:"BtnCodificaCerca",reference:"BtnCodificaCerca",iconCls:"icon-ricerca",text:"CERCA"},{xtype:"numberfield",itemId:"TxtIdTipoDato",reference:"TxtIdTipoDato",emptyText:"Id Tipo Dato",allowDecimals:!1},{xtype:"textfield",itemId:"TxtTipoDato",reference:"TxtTipoDato",emptyText:"Tipo Dato"},{xtype:"textfield",itemId:"TxtCodiceEsterno",reference:"TxtCodiceEsterno",emptyText:"Codice Esterno"},{xtype:"numberfield",
itemId:"TxtCodiceSipcar",reference:"TxtCodiceSipcar",emptyText:"Codice Sipcar",allowDecimals:!1}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.EntiImpostazioni",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridEnti",reference:"GridEnti",title:"Lista Enti",store:Ext.create("Generali.gestPwdNew.store.Enti"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"codice"},
{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"valore"}]},{xtype:"tabpanel",itemId:"TabPanel",reference:"TabPanel",flex:1,layout:{type:"vbox",align:"stretch"},items:[{title:"Impostazioni",itemId:"PnlImpostazioni",reference:"PnlImpostazioni",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},hidden:!0,flex:1,trackResetOnLoad:!0,items:[{xtype:"fieldset",title:"Ente",margin:"20 20 20 20",defaultType:"textfield",
defaults:{anchor:"100%",margin:"5 5 5 5"},items:[{itemId:"TxtID",reference:"TxtID",fieldLabel:"ID",anchor:"30%",name:"id",readOnly:!0},{itemId:"TxtRagSoc",reference:"TxtRagSoc",name:"ragSoc",fieldLabel:"Ragione sociale",allowBlank:!1,readOnly:!0},{xtype:"checkboxfield",itemId:"CheckSipcar2",reference:"CheckSipcar2",name:"sipcar2",allowBlank:!1,inputValue:"T",uncheckedValue:"F",boxLabel:"Sipcar 2",margin:"10 0 5 0"}]},{xtype:"fieldset",title:"Database",margin:"20 20 20 20",layout:{type:"vbox",align:"stretch"},
items:[{xtype:"textfield",itemId:"TxtCBADATIIB",reference:"TxtCBADATIIB",fieldLabel:"CBADATIIB",labelWidth:120,name:"cbaDatiIb",margin:"5 0 5 5",flex:1,allowBlank:!1},{xtype:"textfield",itemId:"TxtCBAOSPITIB",reference:"TxtCBAOSPITIB",fieldLabel:"CBAOSPITIB",labelWidth:120,name:"cbaOspitiIb",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtCBAECONIB",reference:"TxtCBAECONIB",fieldLabel:"CBAECONIB",labelWidth:120,name:"cbaEconIb",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtCBAPAGHEIB",
reference:"TxtCBAPAGHEIB",fieldLabel:"CBAPAGHEIB",labelWidth:120,name:"cbaPagheIb",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtCBAALLEGATI",reference:"TxtCBAALLEGATI",fieldLabel:"CBAALLEGATI",labelWidth:120,name:"cbaAllegati",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtCBATERAPIE",reference:"TxtCBATERAPIE",fieldLabel:"CBATERAPIE",labelWidth:120,name:"cbaTerapie",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtDBFARMACI",reference:"TxtDBFARMACI",fieldLabel:"DBFARMACI",
labelWidth:120,name:"dbFarmaci",margin:"5 0 5 5",flex:1},{xtype:"textfield",itemId:"TxtCBAFEALLEGATI",reference:"TxtCBAFEALLEGATI",fieldLabel:"CBAFEALLEGATI",labelWidth:120,name:"cbaFeAllegati",margin:"5 0 5 5",flex:1},{xtype:"textfield",name:"progPortaleCba",hidden:!0},{xtype:"textfield",name:"codControlloPortaleCba",hidden:!0}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]},{title:"ORGANIZZAZIONI",itemId:"TabOrganizzazioni",
reference:"TabOrganizzazioni",disabled:!0,layout:{type:"vbox",align:"stretch"},flex:1,items:[]},{title:"Moduli",itemId:"TabModuli",reference:"TabModuli",disabled:!0,layout:{type:"vbox",align:"stretch"},flex:1,items:[]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.FiltriReparti",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"container",layout:{type:"vbox"},height:100,margin:"10 10 10 10",
items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",width:700,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",width:700,readOnly:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,
name:"desOrg",margin:"5 5 5 5",width:700,readOnly:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",width:400,store:Ext.create("Generali.gestPwdNew.store.ElencoEnti"),queryMode:"local",displayField:"valore",valueField:"codice",name:"idEnte",allowBlank:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",width:400,store:Ext.create("Generali.gestPwdNew.store.ElencoOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",name:"idOrganizzazione",allowBlank:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeSedRep",reference:"TreeSedRep",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriReparti"),columns:[{xtype:"treecolumn",dataIndex:"text",iconCls:"hideTreeNode",sortable:!1,flex:1}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",
iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",iconCls:"icon-annulla32",text:"Ripristina"}]}],viewConfig:{loadMask:!1}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.GestioneSedi",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"ContainerEnteOrg",reference:"ContainerEnteOrg",height:150,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,items:[{xtype:"fieldset",itemId:"FieldSet",reference:"FieldSet",title:"Ente - Organizzazione",flex:1,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,
maxWidth:500,items:[{xtype:"combobox",itemId:"CbEnti",reference:"CbEnti",store:Ext.create("Generali.gestPwdNew.store.Enti"),fieldLabel:"Ente",labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice",maxWidth:500},{xtype:"combobox",itemId:"CbOrg",reference:"CbOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),margin:"5 0 0 0",fieldLabel:"Organizzazione",labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice",maxWidth:500}]}]},{xtype:"panel",
itemId:"PanelSedi",reference:"PanelSedi",flex:1,layout:{type:"vbox",align:"stretch"},bodyPadding:10,padding:10,items:[]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriAttivita",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_SERVIZI",maxWidth:500,items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},
{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,
readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeAttivita",reference:"TreeAttivita",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriAttivita"),columns:[{xtype:"treecolumn",dataIndex:"descrizione",iconCls:"hideTreeNode",sortable:!1,flex:1}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",
cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriEcoCdcDepositi",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
minHeight:170,height:170,layout:{type:"vbox",align:"stretch"},trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},margin:"10 10 10 10",padding:10,title:"FILTRO_CDC",items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},{xtype:"textfield",
itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},
{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),queryMode:"local",displayField:"valore",
valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeCdcDepositi",reference:"TreeCdcDepositi",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriEcoCdcDepositi"),columns:[{xtype:"treecolumn",dataIndex:"text",sortable:!1,flex:1,margin:"5 0 0 0"}],dockedItems:[{xtype:"container",dock:"top",layout:{type:"vbox",align:"stretch"},margin:"0 0 5 0",items:[{xtype:"toolbar",flex:1,layout:{type:"hbox",align:"stretch"},
items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"},{xtype:"combobox",itemId:"CmbAnnoEsercizio",reference:"CmbAnnoEsercizio",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont",{autoLoad:!0}),labelWidth:100,margin:"5 5 5 5",fieldLabel:"ESERCIZIO",name:"idEsercizio",
displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel",editable:!1,isFormField:!1}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",margin:"5 5 0 5",cls:"icon-cartella-btn-espandi",itemId:"BtnEspandiTutto",reference:"BtnEspandiTutto",style:"background:transparent;border:none",nonDisabilitare:!0,tooltip:"ESPANDI_TUTTO"},{xtype:"button",margin:"0 0 0 5",cls:"icon-cartella-btn-collassa",itemId:"BtnCollassaTutto",reference:"BtnCollassaTutto",
style:"background:transparent;border:none;font-weight:bold",nonDisabilitare:!0,tooltip:"COLLASSA_TUTTO"}]}]}],viewConfig:{loadMask:!1}}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriPerReparti",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_PERREPARTI",maxWidth:500,items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},
{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,
readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreePerReparti",reference:"TreePerReparti",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriPerReparti"),columns:[{xtype:"treecolumn",dataIndex:"descrizione",sortable:!1,flex:1}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",cls:"cbaCssBtnFunzione",
iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriReparti",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_REPARTI",maxWidth:500,items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtNomeFiltro",
reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",
itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),queryMode:"local",displayField:"valore",valueField:"codice",
allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeSedRep",reference:"TreeSedRep",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriReparti"),columns:[{xtype:"treecolumn",dataIndex:"text",sortable:!1,flex:1,margin:"5 0 0 0"}],dockedItems:[{xtype:"container",dock:"top",layout:{type:"vbox",align:"stretch"},margin:"0 0 5 0",items:[{xtype:"toolbar",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",itemId:"BtnConfermaTree",
reference:"BtnConfermaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",margin:"5 5 0 5",cls:"icon-cartella-btn-espandi",itemId:"BtnEspandiTutto",reference:"BtnEspandiTutto",style:"background:transparent;border:none",nonDisabilitare:!0,tooltip:"ESPANDI_TUTTO"},
{xtype:"button",margin:"0 0 0 5",cls:"icon-cartella-btn-collassa",itemId:"BtnCollassaTutto",reference:"BtnCollassaTutto",style:"background:transparent;border:none;font-weight:bold",nonDisabilitare:!0,tooltip:"COLLASSA_TUTTO"}]}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriServizi",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_SERVIZI",maxWidth:500,items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},
{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,
readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeServizi",reference:"TreeServizi",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriServizi"),columns:[{xtype:"treecolumn",dataIndex:"descrizione",iconCls:"hideTreeNode",sortable:!1,flex:1}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",
cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriSettori",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}]},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",itemId:"Form",reference:"Form",
layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_SETTORI",maxWidth:500,items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",hidden:!0,allowBlank:!1},
{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",maxWidth:500,
readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeSedRepStanzLett",reference:"TreeSedRepStanzLett",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriSettori"),columns:[{xtype:"treecolumn",dataIndex:"text",sortable:!1,flex:1}],dockedItems:[{xtype:"container",dock:"top",layout:{type:"vbox",align:"stretch"},margin:"0 0 5 0",items:[{xtype:"toolbar",flex:1,layout:{type:"hbox",
align:"stretch"},items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",margin:"5 5 0 5",cls:"icon-cartella-btn-espandi",itemId:"BtnEspandiTutto",reference:"BtnEspandiTutto",style:"background:transparent;border:none",
nonDisabilitare:!0,tooltip:"ESPANDI_TUTTO"},{xtype:"button",margin:"0 0 0 5",cls:"icon-cartella-btn-collassa",itemId:"BtnCollassaTutto",reference:"BtnCollassaTutto",style:"background:transparent;border:none;font-weight:bold",nonDisabilitare:!0,tooltip:"COLLASSA_TUTTO"}]}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaFiltriUfficiManutenz",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridFiltri",reference:"GridFiltri",title:"Lista Filtri",store:Ext.create("Generali.gestPwdNew.store.ElencoFiltri"),width:300,columns:[{xtype:"gridcolumn",hidden:!0,
dataIndex:"id"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",renderer:function(a,b,c,d,e,g,h){return"F"==c.get("visibile")?"<div>\n\t\t            \t\t    \t\t\t"+a+'\n\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t            \t\t    \t\t \t</div>':a}}],viewConfig:{loadMask:!1}},{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"form",
itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},flex:1,trackResetOnLoad:!0,hidden:!0,items:[{xtype:"fieldset",layout:{type:"vbox",align:"stretch"},height:150,margin:"10 10 10 10",padding:10,title:"FILTRO_UFFICI_MANUTENZ",maxWidth:500,items:[{xtype:"textfield",itemId:"TxtId",reference:"TxtId",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtIdEnte",reference:"TxtIdEnte",name:"idEnte",hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtIdOrg",reference:"TxtIdOrg",name:"idOrganizzazione",
hidden:!0,allowBlank:!1},{xtype:"textfield",itemId:"TxtNomeFiltro",reference:"TxtNomeFiltro",fieldLabel:"Nome filtro",labelWidth:100,name:"descrizione",margin:"5 5 5 5",maxWidth:500,allowBlank:!1},{xtype:"textfield",itemId:"TxtEnte",reference:"TxtEnte",fieldLabel:"Ente",labelWidth:100,name:"desEnte",margin:"5 5 5 5",maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"textfield",itemId:"TxtOrganizzazione",reference:"TxtOrganizzazione",fieldLabel:"Organizzazione",labelWidth:100,name:"desOrg",margin:"5 5 5 5",
maxWidth:500,readOnly:!0,nonDisabilitare:!0},{xtype:"combobox",itemId:"CmbEnti",reference:"CmbEnti",fieldLabel:"Enti",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0},{xtype:"combobox",itemId:"CmbOrganizzazioni",reference:"CmbOrganizzazioni",fieldLabel:"Organizzazione",labelWidth:100,margin:"5 5 5 5",maxWidth:500,store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),
queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,isFormField:!1,hidden:!0}]},{xtype:"treepanel",flex:1,hideHeaders:!0,border:0,rootVisible:!1,hidden:!0,itemId:"TreeManutentore",reference:"TreeManutentore",store:Ext.create("Generali.gestPwdNew.store.AlberoFiltriUfficiManutenz"),columns:[{xtype:"treecolumn",dataIndex:"descrizione",iconCls:"hideTreeNode",sortable:!1,flex:1}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnConfermaTree",reference:"BtnConfermaTree",
cls:"cbaCssBtnFunzione",iconCls:"icon-ok",text:"Conferma"},{xtype:"button",itemId:"BtnRipristinaTree",reference:"BtnRipristinaTree",cls:"cbaCssBtnFunzione",iconCls:"icon-annulla32",text:"Ripristina"}]}],viewConfig:{loadMask:!1}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaProfili",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",title:"ELENCO_TIPOLOGIE_CARTELLA",scrollable:!0,flex:1,itemId:"Grid",reference:"Grid",store:Ext.create("Generali.gestPwdNew.store.ImpostaProfili"),
columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"codEntePwd",hidden:!0},{xtype:"gridcolumn",dataIndex:"codProfiloPwd",hidden:!0},{xtype:"gridcolumn",dataIndex:"idOrganizzazione",hidden:!0},{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:100,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"REGIONE",align:"center",width:200,sortable:!1,itemId:"ColRegione",reference:"ColRegione",dataIndex:"regione",
editor:{xtype:"combobox",store:Ext.create("Generali.store.Regione"),queryMode:"local",displayField:"valore",valueField:"codice"},renderer:function(a,c,d,e,g,h,k){d=this.down("[dataIndex=regione]").getEditor().getStore();d=trovaRecord(d,"codice",a);a="";d&&(a=d.data.valore);return a}},{xtype:"gridcolumn",text:"STAMPE_COLORI",dataIndex:"stpColori",width:100,sortable:!1,align:"center",renderer:function(a,c,d,e,g,h,k){renderCheckColumn(c,a)},editor:{xtype:"checkboxfield",checked:!0,inputValue:"T",uncheckedValue:"F"}},
{xtype:"gridcolumn",text:"Abilitazione per",dataIndex:"tipo",width:100,align:"center",renderer:function(b,c,d,e,g,h,k){if(b=trovaRecord(a.controller.storeEnumsTipo,"codice",b))return b.get("valore")},editor:{xtype:"combobox",reference:"CbTipoAbilitazione",displayField:"valore",queryMode:"local",valueField:"codice",readOnly:!0}},{xtype:"gridcolumn",reference:"ColProfiloFrom",text:"Copia da",hidden:!0,dataIndex:"_tmp_idProfiloFrom",width:350,align:"center",editor:{xtype:"combobox",itemId:"CbProfiloFrom",
reference:"CbProfiloFrom",displayField:"descrizione",queryMode:"local",name:"_tmp_idProfiloFrom",valueField:"id",forceSelection:!0,listConfig:{tpl:new Ext.XTemplate('<tpl if="this.launch() == true"><tpl for="."><tpl if="this.isGruppo(descOrg) == true"><br/><span style="color:blue;margin-top:10px;"><strong>{descOrg}</strong><hr style="background-color: blue; height: 3px; margin:2px 0 2px; 0"></span><div class="x-boundlist-item">{descrizione}</div><tpl else><div class="x-boundlist-item">{descrizione}</div></tpl></tpl></tpl>',
{compiled:!0,gruppoOld:null,isGruppo:function(a){var b=this.gruppoOld;null!=a&&(this.gruppoOld=a);this.countGruppo++;return null!=a&&a!=b},launch:function(){this.gruppoOld=null;this.countGruppo=0;return!0}})}}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",cls:"cbaCssBtnFunzione",text:"NUOVO",tooltip:"NUOVO",hidden:!0},{xtype:"button",
cls:"cbaCssBtnFunzione",itemId:"BtnElimina",reference:"BtnElimina",text:"ELIMINA",tooltip:"ELIMINA",hidden:!0},{xtype:"button",iconCls:"icon-locked",cls:"cbaCssBtnFunzione",itemId:"BtnSblocca",reference:"BtnSblocca"}]}]}]},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},itemId:"CntDettaglio",reference:"CntDettaglio"}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostaProfiliDe",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",cls:"cbaCssGrid",flex:1,columnLines:!0,scrollable:!0,itemId:"GridDet",reference:"GridDet",store:Ext.create("Generali.gestPwdNew.store.ImpostaProfiliTest"),columns:[{xtype:"gridcolumn",dataIndex:"id",text:"ID",hidden:!0},{xtype:"gridcolumn",text:"IDPROFILO",dataIndex:"idProfilo",hidden:!0},
{xtype:"gridcolumn",text:"CODENTE",dataIndex:"codEnte",hidden:!0},{xtype:"gridcolumn",text:"VOCE_MENU_PERSONALIZZATA",flex:1,sortable:!1,dataIndex:"descrizione",editor:{xtype:"textfield",maxLength:50,enforceMaxLength:!0,allowBlank:!1}},{xtype:"gridcolumn",itemId:"ColTipoIcona",reference:"ColTipoIcona",text:"ICONA",width:150,dataIndex:"idIcona",sortable:!1,editor:{xtype:"combobox",store:Ext.create("Generali.gestPwdNew.store.TipoIcona"),queryMode:"local",displayField:"valore",matchFieldWidth:!1,valueField:"codice",
allowBlank:!1,listConfig:{tpl:'<tpl for="."><li role="option" class="x-boundlist-item" style="list-style-type: none; width:200px;"> <div class="{extra}" style="height:50px;width:50px;display: inline-block;"></div><div style="display: inline-block;">{valore}</div></li></tpl>'}},renderer:function(a,b,c,d,e,g,h){d=this.down("[dataIndex=idIcona]").getEditor().getStore();a||(c.data.idIcona=1);if(a=trovaRecord(d,"codice",a))b.tdCls=a.get("extra");return""}},{xtype:"gridcolumn",itemId:"ColColoreIcona",reference:"ColColoreIcona",
text:"COLORE_ICONA",width:150,dataIndex:"coloreIcona",sortable:!1,editor:{xtype:"combobox",store:Ext.create("Generali.gestPwdNew.store.Colori"),queryMode:"local",displayField:"valore",matchFieldWidth:!1,valueField:"codice",allowBlank:!1,listConfig:{tpl:'<tpl for="."><li role="option" class="x-boundlist-item" style="list-style-type: none; width:200px;"> <div class="{extra}" style="height:50px;width:50px;display: inline-block;"></div><div style="display: inline-block;">{valore}</div></li></tpl>'}},
renderer:function(a,b,c,d,e,g,h){d=this.down("[dataIndex=coloreIcona]").getEditor().getStore();a||(c.data.coloreIcona=1);if(a=trovaRecord(d,"codice",a))b.tdCls=a.get("extra");return""}},{xtype:"gridcolumn",text:"TIPO_BOTTONE",width:200,itemId:"ColTipoBottone",reference:"ColTipoBottone",sortable:!1,dataIndex:"tipoBottone",editor:{xtype:"combobox",forceSelection:!0,valueField:"codice",displayField:"valore",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.TipoBottone"),allowBlank:!1,emptyText:"SELEZIONARE_TIPO_BOTTONE",
enableRegEx:!0},renderer:function(a,b,c,d,e,g,h){b=this.down("[dataIndex=tipoBottone]").getEditor().getStore();return(a=trovaRecord(b,"codice",a))?a.get("valore"):""}}],viewConfig:{plugins:{ptype:"gridviewdragdrop"},loadMask:!1,getRowClass:function(a,b,c,d){return a.data.idIcona?"cbaCssRigaAlta40":""}},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoBottone",reference:"BtnNuovoBottone",
cls:"cbaCssBtnFunzione",text:"NUOVO",tooltip:"NUOVO"},{xtype:"button",itemId:"BtnEliminaBottone",reference:"BtnEliminaBottone",cls:"cbaCssBtnFunzione",text:"ELIMINA",tooltip:"ELIMINA"},{xtype:"tbfill"},{xtype:"button",itemId:"BtnMoveUp",reference:"BtnMoveUp",iconCls:"icon-up",tooltip:"MOVE_UP"},{xtype:"button",itemId:"BtnMoveDown",reference:"BtnMoveDown",iconCls:"icon-down",tooltip:"MOVE_DOWN"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ImpostazioniModuloCSS",{extend:"Generali.standard.ControlledContainer",uses:["Generali.gestPwdNew.store.VideatePwd","Generali.gestPwdNew.store.BottoniModulo"],layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"tabpanel",itemId:"TabPanel",reference:"TabPanel",layout:{type:"vbox",align:"stretch"},flex:1,items:[{title:"Tipologia Cartella e Bottoni",itemId:"TabProfiliBottoni",reference:"TabProfiliBottoni",
layout:{type:"vbox",align:"stretch"},flex:1,items:[]},{title:"Gestione Permessi",itemId:"TabGestionePermessi",reference:"TabGestionePermessi",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",title:"TIPOLOGIA CARTELLA",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwdDeCss"),itemId:"GridTipologiaCartella",reference:"GridTipologiaCartella",width:300,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"id"},{xtype:"gridcolumn",flex:1,dataIndex:"idProfiloCss",editor:{xtype:"combobox",
itemId:"CmbProfili",reference:"CmbProfili",valueField:"codice",displayField:"valore",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.TipologieCartella")},renderer:function(a,c,d,e,g,h,k){return d.get("descProfiloCss")}},{xtype:"gridcolumn",hidden:!0,dataIndex:"idProfiloPwdDe"}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"BtnAggiungi",reference:"BtnAggiungi",
cls:"cbaCssBtnFunzione",text:"Aggiungi",tooltip:"Aggiungi"},{xtype:"button",cls:"cbaCssBtnFunzione",itemId:"BtnEliminaPnlTipo",reference:"BtnEliminaPnlTipo",text:"ELIMINA",tooltip:"ELIMINA"},{xtype:"button",cls:"cbaCssBtnFunzione",itemId:"BtnCopiaSpecial",reference:"BtnCopiaSpecial",text:"COPIA",tooltip:"COPIA",maxWidth:70,hidden:!0}]}]},{xtype:"panel",itemId:"PanelTree",reference:"PanelTree",layout:{type:"vbox",align:"stretch"},flex:1,margin:"0 5 0 5",items:[{xtype:"form",layout:{type:"vbox",align:"stretch"},
flex:2,itemId:"FormProfilo",reference:"FormProfilo",items:[{xtype:"treepanel",flex:1,rootVisible:!1,itemId:"TreePermessi",reference:"TreePermessi",store:Ext.create("Generali.gestPwdNew.store.PermessiTree"),columns:[{xtype:"treecolumn",dataIndex:"text",flex:1,text:"Menu e Portlet",renderer:function(b,c,d,e,g,h,k){1===d.get("livello")&&(c=(c=trovaRecord(a.controller.storeTipoBottone,"codice",d.get("tipo")))?c.get("valore"):"",b+="&nbsp&nbsp(<em>"+c+"</em>)");return b}},{xtype:"gridcolumn",text:"Permesso Videate",
dataIndex:"tipoPermesso",flex:1,editor:{xtype:"combobox",valueField:"codice",displayField:"valore",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.TipoPermesso",{autoLoad:!1}),allowBlank:!1},renderer:function(a,c,d,e,g,h,k){c=this.down("[dataIndex=tipoPermesso]").getEditor().getStore();return(r=trovaRecord(c,"codice",a))?r.get("valore"):""}}],viewConfig:{loadMask:!1,plugins:{ptype:"treeviewdragdrop",itemId:"PlgPermessi",reference:"PlgPermessi"}},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],listeners:{itemappend:function(a,c){c.data.text=traduci(c.data.text)}},dockedItems:[{xtype:"panel",layout:{type:"hbox"},height:30,items:[{xtype:"textfield",itemId:"TxtSearchDescrizione",reference:"TxtSearchDescrizione",fieldLabel:"Cerca videata",labelClsExtra:"cbaCssLabel",labelWidth:100,enableKeyEvents:!0},{xtype:"button",margin:"0 5 0 5",cls:"icon-cartella-btn-espandi",itemId:"BtnEspandiTutto",reference:"BtnEspandiTutto",style:"background:transparent;border:none",
nonDisabilitare:!0,tooltip:"ESPANDI_TUTTO"},{xtype:"button",margin:"0 0 0 5",cls:"icon-cartella-btn-collassa",itemId:"BtnCollassaTutto",reference:"BtnCollassaTutto",style:"background:transparent;border:none;font-weight:bold",nonDisabilitare:!0,tooltip:"COLLASSA_TUTTO"},{xtype:"tbfill"},{xtype:"button",text:"Dissocia portlet",margin:"2 5 2 0",itemId:"BtnDissocia",reference:"BtnDissocia",nonDisabilitare:!0,tooltip:"Dissocia portlet",disabled:!0}]}]}]},{xtype:"panel",layout:{type:"hbox",align:"stretch"},
flex:1,items:[{xtype:"treepanel",flex:4,rootVisible:!1,itemId:"TreePortletNonAssociati",reference:"TreePortletNonAssociati",store:Ext.create("Generali.gestPwdNew.store.PermessiTreePortletNon"),columns:[{xtype:"treecolumn",dataIndex:"text",flex:2,text:"Portlet non associati"},{xtype:"gridcolumn",text:"Tipo Bottone",dataIndex:"tipo",flex:1,renderer:function(b,c,d,e,g,h,k){return 3===d.get("livello")?"":(b=trovaRecord(a.controller.storeTipoBottone,"codice",b))?b.get("valore"):""}}],listeners:{itemappend:function(a,
c){c.data.text=traduci(c.data.text)}},viewConfig:{loadMask:!1},dockedItems:[{xtype:"panel",layout:{type:"hbox"},height:30,items:[{xtype:"button",margin:"0 5 0 5",cls:"icon-cartella-btn-espandi",itemId:"BtnEspandiTuttoPNA",reference:"BtnEspandiTuttoPNA",style:"background:transparent;border:none",nonDisabilitare:!0,tooltip:"ESPANDI_TUTTO"},{xtype:"button",margin:"0 0 0 5",cls:"icon-cartella-btn-collassa",itemId:"BtnCollassaTuttoPNA",reference:"BtnCollassaTuttoPNA",style:"background:transparent;border:none;font-weight:bold",
nonDisabilitare:!0,tooltip:"COLLASSA_TUTTO"},{xtype:"tbfill"}]}]},{xtype:"fieldset",title:"Associa Portlet",layout:{type:"vbox",align:"stretch"},flex:1,scrollable:!0,margin:"10 5 10 5",items:[{xtype:"label",text:"Seleziona Bottone e permesso",margin:"15 5 15 5"},{xtype:"combobox",itemId:"CmbBottoni",reference:"CmbBottoni",queryMode:"local",maxWidth:250,disabled:!0,store:Ext.create("Generali.gestPwdNew.store.BottoniCbox"),valueField:"codice",displayField:"valore",margin:"5 5 5 5"},{xtype:"combobox",
itemId:"CmbPermesso",reference:"CmbPermesso",queryMode:"local",maxWidth:250,store:Ext.create("Generali.gestPwdNew.store.TipoPermesso",{autoLoad:!1}),valueField:"codice",displayField:"valore",margin:"5 5 5 5",allowBlank:!1},{xtype:"button",itemId:"BtnAssocia",reference:"BtnAssocia",text:"Associa",maxWidth:250,margin:"10 0 0 0",disabled:!0,margin:"5 5 5 5"}]}]}]}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"button",cls:"cbaCssBtnFunzione",text:"ESCI",itemId:"BtnEsci",
Reference:"BtnEsci"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ModificaPwd",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",itemId:"Container",layout:{type:"vbox",align:"stretch"},flex:1,border:!1,items:[{xtype:"form",itemId:"Form",reference:"Form",layout:{type:"vbox",align:"stretch"},flex:1,border:!1,items:[{xtype:"textfield",itemId:"TxtVecchiaPwd",reference:"TxtVecchiaPwd",fieldLabel:"PWD_CORRENTE",labelWidth:130,allowBlank:!1,margin:"20 20 5 20",inputType:"password"},
{xtype:"textfield",itemId:"TxtNuovaPwd",reference:"TxtNuovaPwd",fieldLabel:"PWD_NEW",labelWidth:130,allowBlank:!1,margin:"0 20 5 20",maxLength:50,minLength:8,enforceMaxLength:!0,inputType:"password"},{xtype:"textfield",itemId:"TxtConfermaPwd",reference:"TxtConfermaPwd",fieldLabel:"PWD_CONFERMA",labelWidth:130,allowBlank:!1,margin:"0 20 5 20",maxLength:50,minLength:8,enforceMaxLength:!0,inputType:"password"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"BtnConferma",
reference:"BtnConferma",iconCls:"icon-conferma",cls:"cbaCssBtnFunzione",text:"CONFERMA"},{xtype:"button",itemId:"BtnRipristina",reference:"BtnRipristina",text:"RIPRISTINA",iconCls:"icon-annulla",cls:"cbaCssBtnFunzione"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.Moduli",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",cls:"cbaCssPnlPopup",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"panel",itemId:"Panel",reference:"Panel",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridMod",reference:"GridMod",store:Ext.create("Generali.gestPwdNew.store.ModuliEnte"),
margin:"20 20 20 20",flex:1,plugins:{ptype:"rowediting",clicksToEdit:2},columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",flex:5,dataIndex:"desModulo",renderer:function(a,b,c,d,e,g,h){modulo=c.get("modAttivato");return 1==modulo?"<b>"+c.get("desModulo")+"</b>":c.get("desModulo")}},{xtype:"gridcolumn",dataIndex:"modAttivato",text:"Abilitato",flex:1,editor:{xtype:"checkbox",itemId:"CheckBox",reference:"CheckBox",inputValue:!0,uncheckedValue:!1},renderer:function(a,b,c,d,e,g,h){renderCheckColumn(b,a)}}]}],
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"tbfill"},{xtype:"button",cls:"cbaCssBtnFunzione",text:"ESCI",itemId:"BtnEsci",Reference:"BtnEsci"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ModuliProfiliPwd",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",itemId:"Container",reference:"Container",cls:"cbaCssPnlPopup",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"panel",border:!1,margin:"5 5 5 5",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridEntiOrg",reference:"GridEntiOrg",flex:3,
store:Ext.create("Generali.gestPwdNew.store.ProfiliEntiOrg"),columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"codEnte"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idOrganizzazione"},{xtype:"gridcolumn",text:"Ente",flex:1,dataIndex:"ragSoc"},{xtype:"gridcolumn",text:"Organizzazione",flex:2,dataIndex:"descOrg",renderer:function(a,c,d,e,g,h,k){return"F"==d.get("visibile")?"<div>\n\t\t\t            \t\t    \t\t \t"+a+'\n\t\t\t            \t\t    \t\t \t<img src="/cba/generali/images/svg/others/locked-profili.svg" style="float:right;" width="16"/>\n\t\t\t            \t\t    \t\t \t</div>':
a}}],viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"cercaGrid",fieldLabel:"CERCA",width:250,labelWidth:60,cbaConfig:{searchField:"ragSoc"}}]}]},{xtype:"gridpanel",itemId:"GridModuli",reference:"GridModuli",flex:2,margin:"0 0 0 5",store:Ext.create("Generali.gestPwdNew.store.ModuliOrg"),plugins:{ptype:"rowediting",clicksToEdit:2},columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"desModulo",renderer:function(a,c,d,e,g,h,k){moduloOrg=d.get("modAttivoPerOrg");
return 1==moduloOrg?"<b>"+d.get("desModulo")+"</b>":d.get("desModulo")}},{xtype:"gridcolumn",dataIndex:"modAttivoPerOrg",text:"Abilitato",width:100,align:"center",editor:{xtype:"checkbox",itemId:"CheckBox",reference:"CheckBox",inputValue:!0,uncheckedValue:!1},renderer:function(a,c,d,e,g,h,k){renderCheckColumn(c,a)}},{xtype:"actioncolumn",width:100,text:"Permessi",align:"center",items:[{handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.winModificaPermessi(b)}}],renderer:function(a,c,d,e,
g,h,k){moduloOrg=d.get("modAttivoPerOrg");1==moduloOrg&&(c.tdCls="icon-edit")}}],viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"cercaGrid",fieldLabel:"CERCA",width:250,labelWidth:60,cbaConfig:{searchField:"desModulo"}}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.Organizzazioni",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridOrg",reference:"GridOrg",title:"Lista Organizzazioni",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),width:300,columns:[{xtype:"gridcolumn",
hidden:!0,dataIndex:"codice"},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"valore"}],viewConfig:{loadMask:!1}},{xtype:"panel",itemId:"ContainerForm",reference:"ContainerForm",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"form",flex:1,hidden:!0,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox",align:"stretch"},trackResetOnLoad:!0,items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idEnte",hidden:!0},{xtype:"textfield",name:"annoEsercContab",
hidden:!0},{xtype:"container",layout:{type:"vbox"},items:[{xtype:"container",layout:"hbox",margin:"5 0 10 10",items:[{xtype:"textfield",itemId:"TxtRagioneSociale",reference:"TxtRagioneSociale",margin:"10 0 0 10",width:700,maxLength:100,enforceMaxLength:!0,fieldLabel:"RAGIONE_SOCIALE",name:"ragioneSociale",allowBlank:!1,labelClsExtra:"cbaLabel"}]},{xtype:"container",layout:"hbox",margin:"5 0 10 10",items:[{xtype:"textfield",margin:"5 0 0 10",width:300,fieldLabel:"CODICE_FISCALE",name:"codiceFiscale",
maxLength:16,enforceMaxLength:!0,allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:300,margin:"5 0 0 10",fieldLabel:"PARTITA_IVA",name:"partitaIva",maxLength:11,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{fieldLabel:"ROBYONE_ID",xtype:"textfield",name:"robyoneId",width:500,margin:"5 0 0 10",labelClsExtra:"cbaLabel"}]},{xtype:"container",layout:{type:"hbox"},margin:"5 0 0 20",defaults:{margin:"5 10 0 0"},items:[{xtype:"checkboxfield",itemId:"CkbDefault",reference:"CkbDefault",cls:"cbaLabel",
fieldLabel:"",name:"orgDefault",boxLabel:"ORG_DEFAULT",inputValue:"T",uncheckedValue:"F",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",itemId:"CkbEsterno",reference:"CkbEsterno",cls:"cbaLabel",fieldLabel:"",name:"perEsterno",boxLabel:"ORG_ESTERNA",inputValue:"T",uncheckedValue:"F",labelClsExtra:"cbaLabel"},{xtype:"numberfield",itemId:"TxtGruppo",reference:"TxtGruppo",width:100,labelWidth:50,labelClsExtra:"cbaLabel",fieldLabel:"GRUPPO",name:"idGruppoPer",allowDecimals:!1},{xtype:"numberfield",itemId:"OrgPtlPers",
reference:"OrgPtlPers",labelClsExtra:"cbaLabel",fieldLabel:"ORG_PTL",name:"idOrgPtl",allowDecimals:!1,useThousandSeparator:!1,hidden:!0,readOnly:!0,width:200,listeners:{render:function(a){creaToolTipInfo(a,"MSG_ORG_PORT_PERS")}}},{xtype:"button",itemId:"BtnOrgEnti",reference:"BtnOrgEnti",hidden:!1,disabled:!0,text:"RACCORDO_ENTI_ORG_SHORT",tooltip:"RACCORDO_ENTI_ORG"},{xtype:"textfield",itemId:"OrgZucchetti",reference:"OrgZucchetti",labelClsExtra:"cbaLabel",fieldLabel:"ORG_ZUCCHETTI",name:"idOrgZuc",
hidden:!0,readOnly:!0,width:200},{width:600,xtype:"combobox",itemId:"CbxOrgAmm",reference:"CbxOrgAmm",queryMode:"local",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),labelClsExtra:"cbaLabel",labelWidth:200,fieldLabel:"Organizzazione Piano dei Conti",name:"idOrgAmministrazione",valueField:"codice",displayField:"valore",allowBlank:!0}]}]},{xtype:"tabpanel",itemId:"TPDatiAgg",reference:"TPDatiAgg",flex:1,layout:{type:"vbox",align:"stretch"},activeTab:0,margin:"10 0 0 0",items:[{xtype:"panel",
title:"INDIRIZZO",layout:{type:"vbox",align:"stretch"},flex:1,bodyPadding:10,items:[{xtype:"fieldset",items:[{xtype:"textfield",margin:"5 0 0 0",width:450,fieldLabel:"INDIRIZZO",name:"indirizzo",allowBlank:!1,maxLength:100,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",margin:"5 0 0 0",width:450,fieldLabel:"LOCALITA",name:"citta",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",margin:"5 0 0 0",width:200,fieldLabel:"CAP",name:"cap",maxLength:5,enforceMaxLength:!0,
allowBlank:!1,labelClsExtra:"cbaLabel",allowDecimals:!1,maskRe:/[0-9.]/},{xtype:"combobox",itemId:"CbxProvince",reference:"CbxProvince",store:Ext.create("Generali.province.store.cboxProvince"),margin:"5 0 0 0",valueField:"codice",displayField:"valore",queryMode:"local",width:450,fieldLabel:"PROVINCIA",name:"provincia",allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CbxComuni",reference:"CbxComuni",store:Ext.create("Generali.comuni.store.cboxComuni"),margin:"5 0 5 0",valueField:"codice",
displayField:"valore",queryMode:"local",width:450,fieldLabel:"COMUNE",name:"codComune",allowBlank:!1,labelClsExtra:"cbaLabel"}]},{xtype:"fieldset",title:"INDIRIZZO_FISCALE",items:[{xtype:"textfield",margin:"5 0 0 0",width:450,fieldLabel:"INDIRIZZO",name:"indirizzoFiscale",maxLength:40,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",margin:"5 0 0 0",width:450,fieldLabel:"LOCALITA",name:"cittaFiscale",maxLength:30,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",margin:"5 0 0 0",
width:200,fieldLabel:"CAP",name:"capFiscale",maxLength:5,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",margin:"5 0 0 0",itemId:"CbxProvinceFiscale",reference:"CbxProvinceFiscale",store:Ext.create("Generali.province.store.cboxProvince"),valueField:"codice",displayField:"valore",queryMode:"local",width:450,fieldLabel:"PROVINCIA",name:"provinciaFiscale",labelClsExtra:"cbaLabel"},{xtype:"combobox",margin:"5 0 10 0",itemId:"CbxComuniFiscale",reference:"CbxComuniFiscale",store:Ext.create("Generali.comuni.store.cboxComuni"),
valueField:"codice",displayField:"valore",queryMode:"local",width:450,fieldLabel:"COMUNE",name:"codComuneFiscale",labelClsExtra:"cbaLabel"}]}]},{xtype:"panel",title:"RECAPITI_TELEFONICI_ED_EMAIL",bodyPadding:10,items:[{xtype:"textfield",width:250,fieldLabel:"TELEFONO_1",name:"telefono1",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:250,fieldLabel:"TELEFONO_2",name:"telefono2",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",width:250,
fieldLabel:"FAX",name:"fax",maxLength:20,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",vtype:"email",width:400,fieldLabel:"EMAIL",name:"email",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",vtype:"email",width:400,fieldLabel:"EMAIL_PEC",name:"pec",maxLength:50,enforceMaxLength:!0,labelClsExtra:"cbaLabel"}]},{xtype:"panel",itemId:"PersonStampe_tabOrg",reference:"PersonStampe_tabOrg",title:"PERSON_STAMPE",items:[{xtype:"container",layout:{align:"stretch",
type:"hbox"},items:[{xtype:"form",flex:1,border:!1,itemId:"PersonStampe_formOrg",reference:"PersonStampe_formOrg",layout:{type:"vbox"},bodyPadding:10,items:[{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"visualizzaLogo",boxLabel:"VISUALIZZA_LOGO",inputValue:"T",uncheckedValue:"F",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",cls:"cbaLabel",fieldLabel:"",name:"visualizzaRagioneSociale",boxLabel:"VISUALIZZA_RAGSOC",inputValue:"T",uncheckedValue:"F",labelClsExtra:"cbaLabel"},{xtype:"textfield",
width:500,fieldLabel:"TESTO_VISION",labelClsExtra:"cbaLabel",name:"siglaQualita",labelClsExtra:"cbaLabel"}]}]},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",border:!1,padding:10,bodyPadding:"5 0 0 0",title:"LOGOSX",items:[{xtype:"image",height:50,itemId:"PersonStampe_logoSx",reference:"PersonStampe_logoSx",width:100},{xtype:"container",items:[{xtype:"filefield",cls:"cba-stdbutton-25",itemId:"PersonStampe_uploadLogoSx",reference:"PersonStampe_uploadLogoSx",fieldLabel:"",
buttonOnly:!0,name:"f_logoSx",buttonConfig:{xtype:"filebutton",text:traduci("ALLEGA_FILE"),width:100,iconCls:"icon-allegato"}}]}]},{xtype:"panel",border:!1,padding:10,bodyPadding:"5 0 0 0",title:"LOGODX",items:[{xtype:"image",height:50,itemId:"PersonStampe_logoDx",reference:"PersonStampe_logoDx",width:100},{xtype:"container",items:[{xtype:"filefield",cls:"cba-stdbutton-25",itemId:"PersonStampe_uploadLogoDx",reference:"PersonStampe_uploadLogoDx",fieldLabel:"",buttonOnly:!0,name:"f_logoDx",buttonConfig:{xtype:"filebutton",
text:traduci("ALLEGA_FILE"),width:100,iconCls:"icon-allegato"}}]}]},{xtype:"label",cls:"cbaLabel",margin:"15 0 0 10",text:"MISURE_MAX_LOGO"}]}]},{xtype:"panel",title:"PERSON_AD_HOC",bodyPadding:10,itemId:"PnlPersAdHoc",reference:"PnlPersAdHoc",hidden:!0,layout:{type:"fit"}},{xtype:"panel",title:"PARAMETRI_FATTURAZIONE",bodyPadding:10,itemId:"PnlParamFatt",reference:"PnlParamFatt",hidden:!0,isFormField:!1,layout:"fit"}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",
reference:"BoxBottoni",hidden:!0}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.PermessiModuli",{extend:"Generali.standard.ControlledContainer",uses:["Generali.gestPwdNew.store.VideatePwd","Generali.gestPwdNew.store.BottoniModulo"],initComponent:function(){var a=this;a.scrittura=traduci("SCRITTURA");a.lettura=traduci("LETTURA");a.nonVisibile=traduci("NON_VISIBILE");a.visibile=traduci("VISIBILE");Ext.applyIf(a,{items:[{xtype:"panel",itemId:"PanelVideata",reference:"PanelVideata",title:"Gestione permessi ",layout:{type:"hbox",align:"stretch"},
items:[{xtype:"container",title:"VIDEATA",itemId:"CntBottoni",reference:"CntBottoni",layout:{type:"vbox",align:"stretch"},width:300,defaults:{margin:"5 5 5 5"}},{xtype:"gridpanel",itemId:"Grid",reference:"Grid",flex:1,store:Ext.create("Generali.gestPwdNew.store.VideatePwd"),columns:[{xtype:"gridcolumn",flex:1,dataIndex:"desVideata",text:"VIDEATA",renderer:function(a,c,d){return(d&&d.get("codvideata_padre")?" - ":"")+a}},{xtype:"gridcolumn",width:200,dataIndex:"tipoPermesso",text:"PERMESSO",renderer:function(b,
c,d){c="";switch(b){case "S":c=a.scrittura;break;case "L":c=a.lettura;break;case "N":c=a.nonVisibile;break;case "V":c=a.visibile}return c},editor:{xtype:"combobox",queryMode:"local",valueField:"codice",displayField:"valore",allowBlank:!1,store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"codice"},{name:"valore"}],data:[["S",a.scrittura],["L",a.lettura],["N",a.nonVisibile],["V",a.visibile]]})}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"tbfill"},{xtype:"button",iconCls:"icon-hamburger",itemId:"BtnImposta",reference:"BtnImposta",menu:[{text:a.scrittura,value:"S",itemId:"MenuScrittura",reference:"MenuScrittura"},{text:a.lettura,value:"L",itemId:"MenuLettura",reference:"MenuLettura"},{text:a.nonVisibile,value:"N",itemId:"MenuNessunPerm",reference:"MenuNessunPerm"}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.ProfiliPwd",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){var a=this;a.treMesi=traduci("MESI3");a.seiMesi=traduci("MESI6");Ext.applyIf(a,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"panel",border:!1,itemId:"PanelProfili",reference:"PanelProfili",layout:{type:"vbox",align:"stretch"},flex:3,items:[{xtype:"panel",
margin:"5 5 5 5",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"gridpanel",itemId:"GridProfili",reference:"GridProfili",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwd"),flex:1,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"codProfilo"},{xtype:"gridcolumn",text:"ELENCO_PROFILI",flex:1,dataIndex:"descrizione",editor:{xtype:"textfield",allowBlank:!1}},{xtype:"gridcolumn",dataIndex:"gestscadenzapwd",hidden:!0},{xtype:"gridcolumn",width:150,dataIndex:"tiposcad",text:"RINNOVO_PWD",
itemId:"TipoScad",reference:"TipoScad",renderer:function(b,c,d){c="";switch(b){case 3:c=a.treMesi;break;case 6:c=a.seiMesi}return c},editor:{xtype:"combobox",itemId:"CbTipoScad",reference:"CbTipoScad",queryMode:"local",valueField:"codice",displayField:"valore",allowBlank:!1,store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"codice"},{name:"valore"}],data:[[3,a.treMesi],[6,a.seiMesi]]})}},{xtype:"gridcolumn",dataIndex:"filtraOrgLogin",text:traduci("PROFILIPWD_FILRA_ORG_LOGIN"),width:150,editor:{xtype:"checkbox",
inputValue:"T",uncheckedValue:"F"},renderer:function(a,c,d){return renderCheckColumn(c,a)}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"cercaGrid",fieldLabel:"CERCA",width:250,labelWidth:60,cbaConfig:{searchField:"descrizione"}}]}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]}]},{xtype:"panel",itemId:"PanelModuliProfili",
reference:"PanelModuliProfili",layout:{type:"hbox",align:"stretch"},flex:4,items:[Ext.create("Generali.gestPwdNew.view.ModuliProfiliPwd")]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.RegoleRaccordi",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"vbox",align:"stretch"},flex:1,padding:10,scrollable:!0,items:[{xtype:"fieldset",title:"REG_ENTE_ORG",layout:{type:"vbox",align:"stretch"},height:200,maxWidth:600,padding:10,items:[{xtype:"gridpanel",itemId:"GridEntiCUCSS",reference:"GridEntiCUCSS",
store:Ext.create("Generali.gestPwdNew.store.EntiCUCSS"),flex:1,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"codEnte"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idOrganizzazione"},{xtype:"gridcolumn",dataIndex:"descEnte",flex:1,text:traduci("ENTE")},{xtype:"gridcolumn",dataIndex:"descOrg",flex:1,text:traduci("ORGANIZZAZIONE")}]}]},{xtype:"container",layout:{type:"hbox",align:"stretch"},height:300,maxWidth:1200,scrollabe:!0,items:[{xtype:"panel",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",
itemId:"GridRegole",reference:"GridRegole",store:Ext.create("Generali.gestPwdNew.store.RegoleRaccordi"),flex:1,border:0,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"id"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idEnte"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idOrganizzazione"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idPadre"},{xtype:"gridcolumn",dataIndex:"tipoCodifica",flex:1,text:traduci("REG_TIPO_CODIFICA"),renderer:function(b,c,d){return(c=trovaRecord(a.controller.storeTipoCod,"codice",
b))?c.get("descrizione"):b}},{xtype:"gridcolumn",dataIndex:"idEsterno",flex:1.5,text:traduci("REG_VALORE"),renderer:function(a,c,d){return"H"===d.get("tipoCodifica")||"A"===d.get("tipoCodifica")?d.get("descIdEsterno")+" (<i>"+d.get("descServ")+"</i>)":d.get("descIdEsterno")}},{xtype:"gridcolumn",dataIndex:"operazioneNuovo",flex:1,text:traduci("REG_APERTURA"),renderer:function(b,c,d){c=a.controller.storeApertura;var e=b;c.clearFilter();if("S"==d.data.tipoCodifica||"T"==d.data.tipoCodifica)e+="1";else if("H"==
d.data.tipoCodifica||"A"==d.data.tipoCodifica)e+="2";return(d=trovaRecord(c,"codiceRecord",e))?d.get("descrizione"):b},editor:{xtype:"combobox",itemId:"CbApertura",reference:"CbApertura",queryMode:"local",valueField:"codice",displayField:"descrizione",allowBlank:!1}},{xtype:"gridcolumn",dataIndex:"operazioneChiusura",flex:1,text:traduci("REG_CHIUSURA"),renderer:function(b,c,d){c=a.controller.storeChiusura;c.clearFilter();var e=b;if("S"==d.data.tipoCodifica||"T"==d.data.tipoCodifica)e+="1";else if("H"==
d.data.tipoCodifica||"A"==d.data.tipoCodifica)e+="2";return(d=trovaRecord(c,"codiceRecord",e))?d.get("descrizione"):b},editor:{xtype:"combobox",itemId:"CbChiusura",reference:"CbChiusura",queryMode:"local",valueField:"codice",displayField:"descrizione",allowBlank:!1}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovaRegola",reference:"BtnNuovaRegola",text:"NUOVO",
cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia"},{xtype:"button",itemId:"BtnEliminaRegola",reference:"BtnEliminaRegola",iconCls:"icon-elimina",cls:"cbaCssBtnFunzione",text:"ELIMINA"},{xtype:"button",itemId:"BtnOpenWinCopy",reference:"BtnOpenWinCopy",iconCls:"icon-copia",hidden:!0,cls:"cbaCssBtnFunzione",text:"COPIA"}]}]},{xtype:"panel",layout:{type:"vbox",align:"stretch"},width:300,margin:"0 0 0 10",items:[{xtype:"gridpanel",itemId:"GridRegoleDett",reference:"GridRegoleDett",store:Ext.create("Generali.gestPwdNew.store.RegoleRaccordi"),
flex:1,border:0,columns:[{xtype:"gridcolumn",hidden:!0,dataIndex:"id"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idEnte"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idOrganizzazione"},{xtype:"gridcolumn",hidden:!0,dataIndex:"idPadre"},{xtype:"gridcolumn",dataIndex:"tipoCodifica",hidden:!0},{xtype:"gridcolumn",dataIndex:"idEsterno",flex:1,text:traduci("REG_VALORE_RACC"),renderer:function(a,c,d){return"H"===d.get("tipoCodifica")||"A"===d.get("tipoCodifica")?d.get("descIdEsterno")+" (<i>"+d.get("descServ")+
"</i>)":d.get("descIdEsterno")},editor:{xtype:"combobox",itemId:"CbEsternoDett",reference:"CbEsternoDett",queryMode:"local",valueField:"codice",displayField:"valore",tpl:'<tpl for="."><tpl if="extra != null"><div class="x-boundlist-item">{valore} (<i>{extra}</i>)</div></tpl><tpl if="extra == null"><div class="x-boundlist-item">{valore}</div></tpl></tpl>',allowBlank:!1}},{xtype:"gridcolumn",dataIndex:"operazioneNuovo",hidden:!0},{xtype:"gridcolumn",dataIndex:"operazioneChiusura",hidden:!0}],viewConfig:{loadMask:!1},
plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovaRegolaDett",reference:"BtnNuovaRegolaDett",text:"NUOVO",cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia"},{xtype:"button",itemId:"BtnEliminaRegolaDett",reference:"BtnEliminaRegolaDett",iconCls:"icon-elimina",cls:"cbaCssBtnFunzione",text:"ELIMINA"}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.StampePwd",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"container",layout:{type:"vbox"},flex:1,padding:10,items:[{xtype:"fieldset",title:"Stampe",layout:{type:"vbox"},padding:10,width:600,height:250,items:[{xtype:"container",itemId:"CntTipoStampa",reference:"CntTipoStampa",
layout:{type:"hbox"},items:[{xtype:"combobox",itemId:"CbTipoStampa",reference:"CbTipoStampa",queryMode:"local",valueField:"codice",displayField:"valore",allowBlank:!1,margin:"0 20 0 0",labelWidth:200,maxWidth:450,fieldLabel:traduci("SEL_VOCE_STAMPA"),store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"codice"},{name:"valore"}],data:[["1;/cba/gen/ws/report/utenti",traduci("PRNT_LISTA_OPERATORI")],["2;/cba/gen/ws/report/profili",traduci("PRNT_LISTA_PROFILI")],["3;/cba/gen/ws/report/permessi/profiliCss",
traduci("PRNT_LISTA_PERMESSI_CSS")]]})},{xtype:"newButtonStampa",itemId:"BtnStampa",reference:"BtnStampa",iconCls:"icon-stampa",cls:"cba-button-25",scale:"small",width:120}]},{xtype:"container",itemId:"CntFiltriParam",reference:"CntFiltriParam",layout:{type:"vbox",align:"stretch"},margin:"20 0 0 0",flex:1,items:[{xtype:"container",reference:"CntStampaOperatori",hidden:!0,layout:{type:"hbox"},flex:1,items:[{xtype:"fieldset",title:traduci("ORDINAMENTO"),layout:{type:"vbox",align:"stretch"},flex:2,padding:10,
items:[{xtype:"radiogroup",reference:"RadioOrdine",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"radio",boxLabel:traduci("ORDINA_NOMINATIVO"),name:"ordine",inputValue:"N",value:!0},{xtype:"radio",boxLabel:traduci("ORDINA_PROFILO"),name:"ordine",inputValue:"P"}]}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},margin:"0 0 0 20",flex:1,items:[{xtype:"checkbox",reference:"CkSoloAttivi",boxLabel:traduci("UTENTI_ATTIVI"),margin:"20 0 0 0",value:!0}]}]},{xtype:"container",reference:"CntStampaPermessiCss",
hidden:!0,layout:{type:"vbox"},flex:1,items:[{xtype:"fieldset",title:"Ente - Organizzazione",width:500,layout:{type:"vbox",align:"stretch"},padding:10,items:[{xtype:"combobox",itemId:"CbEnti",reference:"CbEnti",store:Ext.create("Generali.gestPwdNew.store.Enti"),fieldLabel:"Ente",labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},{xtype:"combobox",itemId:"CbOrg",reference:"CbOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),fieldLabel:"Organizzazione",
labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},{xtype:"combobox",reference:"CbTipCart",store:Ext.create("Generali.gestPwdNew.store.TipologieCartella"),fieldLabel:"Tip. Cartella",labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice"}]}]},{xtype:"container",reference:"CntStampaContatori",hidden:!0,layout:{type:"vbox"},flex:1,items:[{xtype:"fieldset",title:"Organizzazione",width:570,layout:{type:"hbox",align:"stretch"},
padding:10,items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"combobox",itemId:"CbOrganizzazioni",reference:"CbOrganizzazioni",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),fieldLabel:"Organizzazione",labelClsExtra:"cbaLabel",queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1,border:2},{xtype:"datefield",itemId:"EdtDtDal",reference:"EdtDtDal",fieldLabel:"DATA",labelClsExtra:"cbaLabel",allowBlank:!1,border:2},{xtype:"container",itemId:"CntData",
reference:"CntData",hidden:!0,border:2,layout:{type:"vbox",align:"stretch"},items:[{xtype:"datefield",itemId:"DataDal",reference:"DataDal",fieldLabel:"DATA_DAL",labelClsExtra:"cbaLabel",allowBlank:!1},{xtype:"datefield",itemId:"DataAl",reference:"DataAl",fieldLabel:"DATA_AL",labelClsExtra:"cbaLabel",allowBlank:!1}]}]},{xtype:"fieldset",title:"Stampa",layout:{type:"vbox",align:"streatch"},padding:2,items:[{xtype:"radiogroup",columns:1,vertical:!0,itemId:"RgbTipoOperazione",reference:"RgbTipoOperazione",
items:[{boxLabel:"OSPITI_RICOVERATI",name:"rbVisualizzaPer",inputValue:"C",cls:"cbaLabel",checked:!0},{boxLabel:"DIPENDENTI_ATTIVI",name:"rbVisualizzaPer",inputValue:"P",cls:"cbaLabel"},{boxLabel:"OSPITI_PER_GIORNO",name:"rbVisualizzaPer",inputValue:"O",cls:"cbaLabel"},{boxLabel:"DIPENDENTI_PER_GIORNO",name:"rbVisualizzaPer",inputValue:"D",cls:"cbaLabel"}]}]}]}]}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.TabFiltri",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"tabpanel",itemId:"TabPanelFiltri",reference:"TabPanelFiltri",layout:{type:"vbox",align:"stretch"},flex:1,items:[{title:"FILTRI_REPARTI",itemId:"TabFiltriReparti",reference:"TabFiltriReparti",numero:1,
layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_SERVIZI",itemId:"TabFiltriServizi",reference:"TabFiltriServizi",numero:2,layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_SETTORI",itemId:"TabFiltriSettori",reference:"TabFiltriSettori",numero:3,layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_PERREPARTI",itemId:"TabFiltriPerReparti",reference:"TabFiltriPerReparti",numero:4,layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_ECOCDCDEP",itemId:"TabFiltriEcoCdc",reference:"TabFiltriEcoCdc",
numero:5,layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_ATTIVITA",itemId:"TabFiltriAttivita",reference:"TabFiltriAttivita",numero:6,layout:{type:"hbox",align:"stretch"}},{title:"FILTRI_UFFICI_MANUTENZ",itemId:"TabFiltriUfficiManutenz",reference:"TabFiltriUfficiManutenz",numero:7,layout:{type:"hbox",align:"stretch"}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.Utenti",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",itemId:"GridUtenti",reference:"GridUtenti",title:"LISTA_UTENTI",width:300,collapsible:!0,collapseDirection:"left",store:Ext.create("Generali.gestPwdNew.store.ElencoUtenti"),columns:[{xtype:"gridcolumn",dataIndex:"codice",hidden:!0},{xtype:"gridcolumn",dataIndex:"valore",flex:1}],viewConfig:{loadMask:!1},
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"cercaGrid",fieldLabel:"CERCA",width:250,labelWidth:60,cbaConfig:{searchField:"valore"}}]}]},{xtype:"tabpanel",border:0,itemId:"TabPersUtenti",reference:"TabPersUtenti",flex:1,activeTab:0,items:[{xtype:"panel",title:"PERS_GENERALI",border:!1,layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"container",itemId:"Contenuto",reference:"Contenuto",layout:{type:"vbox",align:"stretch"},hidden:!0,padding:5,bodyPadding:5,flex:1,items:[{xtype:"fieldset",
itemId:"FieldsetForm",reference:"FieldsetForm",layout:{type:"vbox",align:"stretch"},flex:1,scrollable:!0,padding:10,margin:"20 0 0 0",items:[{xtype:"form",hidden:!0,trackResetOnLoad:!0,readOnly:!0,border:!1,scrollable:!1,layout:{type:"vbox",align:"stretch"},itemId:"Form",reference:"Form",items:[{xtype:"textfield",itemId:"TxtCodUtente",name:"id",hidden:!0},{xtype:"textfield",itemId:"TxtNomeUtente",reference:"TxtNomeUtente",name:"nomeUtente",fieldLabel:"NOMEUTENTE",labelWidth:115,labelClsExtra:"cbaLabel",
maxWidth:360,maxLength:50,enableKeyEvents:!0,enforceMaxLength:!0,allowBlank:!1},{xtype:"container",layout:{type:"vbox"},items:[{xtype:"container",layout:{type:"hbox"},items:[{xtype:"textfield",fieldLabel:"PASSWORD",itemId:"TxtPwd",reference:"TxtPwd",name:"pwd",margin:"0 10 0 0",labelWidth:115,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0,inputType:"password",readOnly:!0},{xtype:"button",margin:"0 10 0 10",disabled:!1,itemId:"BtnNuovaPwd",reference:"BtnNuovaPwd",scale:"small",
text:"MODIFICA_PASSWORD"}]},{xtype:"fieldset",margin:"5 0 0 20",title:"MODIFICA_PASSWORD",itemId:"fsModificaPwd",reference:"fsModificaPwd",hidden:!0,items:[{xtype:"textfield",itemId:"TxtNuovaPwd",reference:"TxtNuovaPwd",fieldLabel:"NUOVA_PASSWORD",name:"pwdNew",labelWidth:130,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0,inputType:"password",hidden:!0,minLength:8},{xtype:"textfield",itemId:"TxtConfermaNuovaPwd",reference:"TxtConfermaNuovaPwd",fieldLabel:"CONFERMA_NUOVA_PASSWORD",
labelWidth:130,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0,inputType:"password",hidden:!0,minLength:8,isFormField:!1}]}]},{xtype:"combobox",itemId:"CbProfilo",reference:"CbProfilo",name:"codProfilo",fieldLabel:"Profilo",labelClsExtra:"cbaLabel",labelWidth:120,allowBlank:!1,maxWidth:355,margin:"5 0 0 0",displayField:"descrizione",queryMode:"local",valueField:"codProfilo",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwd")},{xtype:"fieldset",title:"Campi Facoltativi",layout:{type:"vbox",
align:"stretch"},maxWidth:360,margin:"5 0 5 0",items:[{xtype:"textfield",itemId:"TxtCognome",reference:"TxtCognome",name:"cognome",fieldLabel:"COGNOME",labelWidth:115,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0},{xtype:"textfield",itemId:"TxtNome",reference:"TxtNome",name:"nome",fieldLabel:"NOME",labelWidth:115,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0},{xtype:"textfield",itemId:"TxtCodiceFiscale",reference:"TxtCodiceFiscale",name:"codiceFiscale",
fieldLabel:"COD_FISCALE",fieldStyle:"text-transform:uppercase",labelWidth:115,labelClsExtra:"cbaLabel",width:360,maxLength:16,enforceMaxLength:!0},{xtype:"textfield",vtype:"email",itemId:"TxtEmail",reference:"TxtEmail",name:"email",fieldLabel:"EMAIL",labelWidth:115,labelClsExtra:"cbaLabel",width:360,maxLength:50,enforceMaxLength:!0},{xtype:"textfield",itemId:"TxtCodiceEsterno",reference:"TxtCodiceEsterno",name:"externalId",fieldLabel:"CODICEESTERNO",labelWidth:115,labelClsExtra:"cbaLabel",width:360,
maxLength:50,enforceMaxLength:!0,listeners:{afterrender:function(){this.getEl().dom.setAttribute("data-qtip",traduci("MSG_CODICEESTERNO"))}}}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Privilegi",itemId:"FieldSetPrivilegi",reference:"FieldSetPrivilegi",layout:{type:"hbox"},defaultType:"radiofield",height:60,maxWidth:600,items:[{xtype:"checkboxfield",itemId:"CheckAmministratore",reference:"CheckAmministratore",boxLabel:traduci("AMMINISTRATORE"),cls:"cbaLabel",
inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"amministratore"},{xtype:"checkboxfield",itemId:"CheckAutorizzatore",reference:"CheckAutorizzatore",boxLabel:traduci("AUTORIZZATORE"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"autorizzatore"},{xtype:"checkboxfield",itemId:"CheckAmmOrg",reference:"CheckAmmOrg",boxLabel:traduci("AMM_ORG"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"amministratoreOrg"}]},{xtype:"container",layout:{type:"hbox"},
reference:"CntFlag",items:[{xtype:"container",layout:{type:"vbox"},items:[{xtype:"checkboxfield",boxLabel:traduci("UT_ABILITATO"),itemId:"Abilitato",reference:"Abilitato",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"abilitato"},{xtype:"checkboxfield",boxLabel:traduci("GESTORE_CONSENSO"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"consenso",cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:traduci("GESTORE_DOC_PERS"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"docPers",
cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:traduci("GESTORE_RICOVERI_CSS"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"ricoveriCss",cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:traduci("PRODOTTI_MEDICAZIONI"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"cssProdottiMedicazioni",cbaConfig:{onlyCss:!0}}]},{xtype:"container",layout:{type:"vbox"},margin:"0 0 0 20",items:[{xtype:"checkboxfield",boxLabel:traduci("ARMADIO_FARMA"),cls:"cbaLabel",inputValue:"T",
uncheckedValue:"F",name:"armadioFarma",cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:traduci("ETICHETTE_FARMA"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"etichetteFarma",cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:traduci("GESTORE_CONSULTAZIONE_CARTELLA"),cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"cssGestoreConsultazione",cbaConfig:{onlyCss:!0}},{xtype:"checkboxfield",boxLabel:"UT_PRESCRIZIONE_TR_SOLO_PN",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",
name:"cssTerapieSoloPN"},{xtype:"checkboxfield",boxLabel:"GESTORE_ATTIVITA_CSS",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",name:"cssAttivita"}]}]}]},{xtype:"fieldset",itemId:"FieldSetGridAmmOrg",reference:"FieldSetGridAmmOrg",title:"Organizzazioni autorizzate",height:200,maxWidth:450,layout:{type:"vbox",align:"stretch"},hidden:!0,padding:10,items:[{xtype:"gridpanel",itemId:"GridOrgAutorizzate",reference:"GridOrgAutorizzate",flex:1,store:Ext.create("Generali.gestPwdNew.store.AmministratoriOrg"),
columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0,cbaConfig:{idColonna:"id"}},{xtype:"gridcolumn",dataIndex:"codUtentePwd",hidden:!0,cbaConfig:{idColonna:"codUtentePwd"}},{xtype:"gridcolumn",dataIndex:"codEnte",flex:1,hidden:!0,cbaConfig:{idColonna:"codEnte"},editor:{xtype:"combobox",itemId:"EditorGridAmmOrgCmbEnti",reference:"EditorGridAmmOrgCmbEnti",store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",labelClsExtra:"cbaLabel",displayField:"valore",valueField:"codice",allowBlank:!1},
renderer:function(a,c,d,e,g,h,k){return d.get("descEnte")}},{xtype:"gridcolumn",dataIndex:"idOrganizzazione",cbaConfig:{idColonna:"idOrganizzazione"},hidden:!0,flex:1,editor:{xtype:"combobox",itemId:"EditorGridAmmOrgCmbOrg",reference:"EditorGridAmmOrgCmbOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),queryMode:"local",labelClsExtra:"cbaLabel",displayField:"valore",valueField:"codice",allowBlank:!1},renderer:function(a,c,d,e,g,h,k){return d.get("descOrg")}},{xtype:"gridcolumn",text:"Organizzazione (Ente)",
flex:1,cbaConfig:{idColonna:"descEnteOrg"},renderer:function(a,c,d,e,g,h,k){return d.get("descOrg")+" ("+d.get("descEnte")+")"}}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnAggiungiAdminOrg",reference:"BtnAggiungiAdminOrg",text:"NUOVO",cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia"},{xtype:"button",itemId:"BtnEliminaAdminOrg",reference:"BtnEliminaAdminOrg",iconCls:"icon-eliminaGriglia",cls:"cbaCssBtnFunzione",text:"ELIMINA"}]}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})]}]},{xtype:"fieldset",itemId:"FieldSetGridProfAut",reference:"FieldSetGridProfAut",title:"Profili autorizzati alla modifica dell 'Utente",height:200,maxWidth:350,layout:{type:"vbox",align:"stretch"},hidden:!0,padding:10,items:[{xtype:"gridpanel",itemId:"GridProfiliAutorizzati",reference:"GridProfiliAutorizzati",flex:1,store:Ext.create("Generali.gestPwdNew.store.UtentiAutorizzatiPwd"),columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"codUtente",
hidden:!0},{xtype:"gridcolumn",text:"Profilo",dataIndex:"codProfilo",flex:1,editor:{xtype:"combobox",itemId:"CbFigProfEditor",reference:"CbFigProfEditor",store:Ext.create("Generali.gestPwdNew.store.ProfiliPwd"),queryMode:"local",labelClsExtra:"cbaLabel",displayField:"descrizione",name:"tipo",valueField:"codProfilo"},renderer:function(b,c,d,e,g,h,k){return(b=trovaRecord(a.controller.storeProfili,"codProfilo",b))?b.get("descrizione"):""}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,
errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnAggiungiAutor",reference:"BtnAggiungiAutor",text:"NUOVO",cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia"},{xtype:"button",itemId:"BtnEliminaAutor",reference:"BtnEliminaAutor",iconCls:"icon-eliminaGriglia",cls:"cbaCssBtnFunzione",text:"ELIMINA"}]}]}]},{xtype:"checkbox",name:"dirtyCartella",itemId:"DirtyCartella",reference:"DirtyCartella",hidden:!0,checked:!1},{xtype:"fieldset",title:"Dati Cartella",
itemId:"DatiCartella",reference:"DatiCartella",flex:1,minHeight:175,layout:{type:"hbox",align:"stretch"},padding:10,items:[{xtype:"gridpanel",itemId:"GridCartella",reference:"GridCartella",trackResetOnLoad:!0,store:Ext.create("Generali.gestPwdNew.store.TeAnaPersPwd"),flex:1,columns:[{xtype:"gridcolumn",dataIndex:"progr",hidden:!0},{xtype:"gridcolumn",dataIndex:"idEntePwd",hidden:!0},{xtype:"gridcolumn",dataIndex:"descEnte",text:"Ente",flex:1,editable:!1},{xtype:"gridcolumn",dataIndex:"descr",hidden:!0},
{xtype:"gridcolumn",dataIndex:"tipo",text:"Figura professionale",editor:{xtype:"combobox",itemId:"CbFigProf",reference:"CbFigProf",store:Ext.create("Generali.gestPwdNew.store.FigureProfessionali"),queryMode:"local",labelClsExtra:"cbaLabel",displayField:"valore",name:"tipo",valueField:"codice"},flex:1,renderer:function(a,c,d,e,g,h,k){return d.get("figuraProfessionale")}},{xtype:"gridcolumn",dataIndex:"altro",text:"Descrizione aggiuntiva",editor:{xtype:"textfield",itemId:"TxtDescAgg",reference:"TxtDescAgg"},
flex:2},{xtype:"gridcolumn",dataIndex:"idTimbro",text:"Timbro",editor:{xtype:"combobox",itemId:"CbTimbro",reference:"CbTimbro",store:Ext.create("Generali.gestPwdNew.store.TimbriRicetta"),queryMode:"local",labelClsExtra:"cbaLabel",displayField:"valore",name:"idTimbro",valueField:"codice"},flex:1,renderer:function(a,c,d,e,g,h,k){return d.get("timbro")}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:2})]},{xtype:"gridpanel",itemId:"GridTipologie",reference:"GridTipologie",
flex:1,margin:"0 0 0 15",hidden:!0,store:Ext.create("Generali.gestPwdNew.store.Tipologie"),columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"progrTe",hidden:!0},{xtype:"gridcolumn",dataIndex:"idProfilo",hidden:!0},{xtype:"gridcolumn",dataIndex:"desProfilo",width:100,text:"Tipologia"},{xtype:"gridcolumn",dataIndex:"codAreaAnalisiPAI",text:"Area Analisi pre PAI",flex:1,width:150,itemId:"ColPAI",reference:"ColPAI",editor:{xtype:"combobox",queryMode:"local",displayField:"descrizione",
matchFieldWidth:!1,valueField:"id"},renderer:function(a,c,d,e,g,h,k){return(a=trovaRecord(this.controller.storeAreePAI,"id",a))?a.get("descrizione"):""}},{xtype:"gridcolumn",dataIndex:"codAreaAnalisiPRI",text:"Area Analisi pre PRI",flex:1,itemId:"ColPRI",reference:"ColPRI",editor:{xtype:"combobox",queryMode:"local",displayField:"descrizione",matchFieldWidth:!1,valueField:"id"},renderer:function(a,c,d,e,g,h,k){return(a=trovaRecord(this.controller.storeAreePRI,"id",a))?a.get("descrizione"):""}},{xtype:"gridcolumn",
dataIndex:"riapertura",text:"Riapertura Cartella",width:90,itemId:"ColRiapertura",reference:"ColRiapertura",editor:{xtype:"checkboxfield",name:"riapertura",inputValue:"T",uncheckedValue:"F"},renderer:function(a,c,d,e,g,h,k){a="check"+Ext.id();d='<img style="display:block;height:16px;margin-left:32px;" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc="/cba/generali/images/svg/others/'+("T"===d.get("riapertura")?"checked":"check-disabled-gray")+'.svg"></img>';return"<span id="+a+">"+d+"</span>"}},{xtype:"gridcolumn",
dataIndex:"abilitato",text:"ABILITATA",width:80,itemId:"ColAbilitato",reference:"ColAbilitato",editor:{xtype:"checkboxfield",name:"abilitato",inputValue:"T",uncheckedValue:"F"},renderer:function(a,c,d,e,g,h,k){a="check"+Ext.id();d='<img style="display:block;height:16px;margin-left:32px;" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc="/cba/generali/images/svg/others/'+("T"===d.get("abilitato")?"checked":"check-disabled-gray")+'.svg"></img>';return"<span id="+a+">"+d+"</span>"}}],viewConfig:{loadMask:!1,
emptyText:traduci("NESSUNA_DATO")},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})]}]}]},{xtype:"fieldset",itemId:"FieldsetFiltri",reference:"FieldsetFiltri",padding:10,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridFiltriUtente",reference:"GridFiltriUtente",store:Ext.create("Generali.gestPwdNew.store.FiltriUtente"),minHeight:200,columns:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",dataIndex:"idEnte",text:"Ente",editor:{xtype:"combobox",
itemId:"CmbEnti",reference:"CmbEnti",store:Ext.create("Generali.gestPwdNew.store.ElencoEnti"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,renderer:function(a,c,d,e,g,h,k){return d.get("descEnte")}},{xtype:"gridcolumn",dataIndex:"idOrganizzazione",text:"Organizzazione",editor:{xtype:"combobox",itemId:"CmbOrg",reference:"CmbOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,
renderer:function(a,c,d,e,g,h,k){return d.get("descOrg")}},{xtype:"gridcolumn",dataIndex:"idFiltroReparti",text:"Filtri Reparti",editor:{xtype:"combobox",itemId:"CmbFiltroRep",reference:"CmbFiltroRep",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,hidden:!0,tipoFiltro:1,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroRep")}},{xtype:"gridcolumn",dataIndex:"idFiltroServizi",text:"Filtri Servizi",editor:{xtype:"combobox",
itemId:"CmbFiltroServ",reference:"CmbFiltroServ",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:2,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroServ")}},{xtype:"gridcolumn",dataIndex:"idFiltroSettori",text:"Filtri Settori",editor:{xtype:"combobox",itemId:"CmbFiltroSett",reference:"CmbFiltroSett",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",
valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:3,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroSett")}},{xtype:"gridcolumn",dataIndex:"idFiltroPerReparti",text:"Filtri Reparti Personale",editor:{xtype:"combobox",itemId:"CmbFiltroPerRep",reference:"CmbFiltroPerRep",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:4,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroPerRep")}},
{xtype:"gridcolumn",dataIndex:"idFiltroEcoCdc",text:"Filtri CdC",editor:{xtype:"combobox",itemId:"CmbFiltroEcoCdc",reference:"CmbFiltroEcoCdc",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:5,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroEcoCdc")}},{xtype:"gridcolumn",dataIndex:"idFiltroAttivita",text:"Filtri Attivit",editor:{xtype:"combobox",itemId:"CmbFiltroAttivita",reference:"CmbFiltroAttivita",
store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:6,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroAttivita")}},{xtype:"gridcolumn",dataIndex:"idFiltroUfficiManutenz",text:"Filtri Uffici Manutenzione",editor:{xtype:"combobox",itemId:"CmbFiltroUffManutenz",reference:"CmbFiltroUffManutenz",store:Ext.create("Generali.gestPwdNew.store.FiltriCbox"),queryMode:"local",displayField:"valore",
valueField:"codice",allowBlank:!1},flex:1,tipoFiltro:7,hidden:!0,renderer:function(a,c,d,e,g,h,k){return d.get("descFiltroUfficiManutenz")}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],viewConfig:{loadMask:!1},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnAggiungiFiltro",reference:"BtnAggiungiFiltro",text:"NUOVO",cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia"},{xtype:"button",itemId:"BtnEliminaFiltro",reference:"BtnEliminaFiltro",
iconCls:"icon-eliminaGriglia",cls:"cbaCssBtnFunzione",text:"ELIMINA"}]}]}]}]}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"},{xtype:"button",dock:"right",iconCls:"icon-locked",cls:"cbaCssBtnFunzione",width:150,itemId:"BtnAbilitaMod",reference:"BtnAbilitaMod",text:"Abilita Modifiche"}]}]},{title:"PERS_ECONOMATO",layout:"fit",itemId:"TabPersEconomato",reference:"TabPersEconomato",cbaConfig:{url:"Generali.gestPwdNew.view.UtentiPersEconomato"},
hidden:!isAreaAbilita("Economato")}]}]});a.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.UtentiPersEconomato",{extend:"Generali.standard.ControlledContainer",gestioneRichieste:function(){var a=[];CBA.moduli.modulo58.installato&&a.push({xtype:"checkboxfield",boxLabel:"Magazzino",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"rcMagazzino"});CBA.moduli.modulo62.installato&&a.push({xtype:"checkboxfield",boxLabel:"Farmacia",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"rcFarmacia"});CBA.moduli.modulo59.installato&&
a.push({xtype:"checkboxfield",boxLabel:"Serv. Manutenzione",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"rcServizioManutenzione"});if(!Ext.isEmpty(a))return{xtype:"container",layout:"hbox",items:a}},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"container",layout:"vbox",items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"},{xtype:"form",itemId:"Form",reference:"Form",trackResetOnLoad:!0,
border:!1,scrollable:!1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"RICHIESTE_REPARTO",margin:"5 0 5 5",items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"codUtente",hidden:!0},{xtype:"checkboxfield",itemId:"CheckRcGestCatalogo",reference:"CheckRcGestCatalogo",boxLabel:"GEST_CATALOGO",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"rcGestioneCatalogo",hidden:!0},{xtype:"checkboxfield",itemId:"CheckRcConvalidatore",reference:"CheckRcConvalidatore",
boxLabel:"CONVALIDATORE_RC",cls:"cbaLabel",inputValue:"T",uncheckedValue:"F",margin:"5 10 0 0",name:"rcConvalidatore"},this.gestioneRichieste()]}]}]},{xtype:"container",layout:"fit",flex:1,items:[{xtype:"CBAShortcutGrid",itemId:"GridDepositi",reference:"GridDepositi",title:"DEPOSITI",layout:{align:"stretch"},store:Ext.create("Generali.gestPwdNew.store.ElencoUtentiEcoDepositi"),border:5,columns:{defaults:{variableRowHeight:!0},items:[{xtype:"gridcolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",
dataIndex:"codUtente",hidden:!0},{xtype:"gridcolumn",dataIndex:"idEnte",text:"ENTE",flex:2,renderer:function(a,b,c,d,e,g,h){return(b=trovaRecord(this.controller.getCmbEntiEco().getStore(),"codice",a))?b.get("valore"):a}},{xtype:"gridcolumn",dataIndex:"idOrganizzazione",text:"ORGANIZZAZIONE",flex:2,renderer:function(a,b,c,d,e,g,h){return c.get("desOrg")}},{xtype:"gridcolumn",dataIndex:"tipoDeposito",text:"TIPO_DEPOSITO",flex:1},{xtype:"gridcolumn",dataIndex:"descrizione",text:"DESCRIZIONE",flex:3},
{xtype:"gridcolumn",dataIndex:"permessi",text:"PERMESSI",flex:1,editor:{xtype:"combobox",store:Ext.create("Ext.data.Store",{fields:["codice","valore"],data:[{codice:"L",valore:"Sola lettura"},{codice:"N",valore:"Non visibile"},{codice:"S",valore:"Lettura e Scrittura"}]}),queryMode:"local",displayField:"valore",valueField:"codice",allowBlank:!1},renderer:function(a,b,c){b="";switch(a){case "L":b="Lettura";break;case "N":b="Nessun permesso";break;case "S":b="Scrittura"}return b}},{xtype:"gridcolumn",
dataIndex:"abilitato",text:"DEPOSITO_ABILITATO",flex:1,align:"center",editor:{xtype:"checkboxfield",inputValue:"T",uncheckedValue:"F"},renderer:function(a,b,c,d,e,g,h){return renderCheckColumn(b,a)}},{xtype:"gridcolumn",dataIndex:"automatico",text:"DEPOSITO_AUTOMATICO",flex:1,align:"center",editor:{xtype:"checkboxfield",inputValue:"T",uncheckedValue:"F"},renderer:function(a,b,c,d,e,g,h){return renderCheckColumn(b,a)}}]},viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,
errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"container",layout:"vbox",items:[{xtype:"container",items:[{xtype:"combobox",itemId:"CmbEntiEco",reference:"CmbEntiEco",fieldLabel:"ENTE",labelWidth:100,margin:"5 5 5 5",width:500,store:Ext.create("Generali.gestPwdNew.store.Enti"),queryMode:"local",displayField:"valore",valueField:"codice",name:"idEnte",editable:!1},{xtype:"combobox",itemId:"CmbOrgEco",reference:"CmbOrgEco",fieldLabel:"ORGANIZZAZIONE",labelWidth:100,margin:"5 5 5 5",
width:500,queryMode:"local",displayField:"valore",valueField:"codice",name:"idOrganizzazione",editable:!1}]},{xtype:"button",margin:"0 0 0 405",itemId:"BtnAddDepositi",reference:"BtnAddDepositi",text:"DEPOSITI",cls:"cbaCssBtnFunzione",iconCls:"icon-inserisciGriglia",disabled:!0}]}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestPwdNew.view.VideataPassword",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",cls:"cbaCssPnlPopup",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"tabpanel",itemId:"TabPanelVideata",reference:"TabPanelVideata",tabPosition:"left",tabRotation:0,layout:{type:"vbox",align:"stretch"},minTabWidth:120,flex:1,items:[{title:"Enti - Organizzazioni",itemId:"TabEntiOrg",reference:"TabEntiOrg",
numero:1,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Profili",cls:"x-tab-button-center",itemId:"TabProfili",reference:"TabProfili",numero:2,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Utenti",itemId:"TabUtenti",reference:"TabUtenti",numero:3,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Filtri",itemId:"TabFiltri",
reference:"TabFiltri",numero:4,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Gestione Sedi",itemId:"TabGestioneSedi",reference:"TabGestioneSedi",numero:5,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Stampe",itemId:"TabStampe",reference:"TabStampe",numero:6,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Regole Raccordi",
itemId:"TabRegoleRaccordi",reference:"TabRegoleRaccordi",numero:7,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Comunicazioni di<br>Servizio",itemId:"TabComunicazioniServ",reference:"TabComunicazioniServ",numero:8,tabConfig:{height:50,style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}},{title:"Monitor Integrazioni",itemId:"TabDashboardEvents",reference:"TabDashboardEvents",numero:9,tabConfig:{height:50,
style:"text-align: center",margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.gestioneScheduler.controller.Impostazioni",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"TipoScarico",selector:this.selContainer+"#TipoScarico"},{ref:"CkbRipetizione",selector:this.selContainer+"#CkbRipetizione"},{ref:"CntOrari",selector:this.selContainer+"#CntOrari"},{ref:"FsRipetiOgni",
selector:this.selContainer+"#FsRipetiOgni"},{ref:"RdgRipetiOgni",selector:this.selContainer+"#RdgRipetiOgni"},{ref:"TxtOre",selector:this.selContainer+"#TxtOre"},{ref:"TxtMin",selector:this.selContainer+"#TxtMin"},{ref:"Dalle",selector:this.selContainer+"#Dalle"},{ref:"Alle",selector:this.selContainer+"#Alle"},{ref:"FsOrariScarico",selector:this.selContainer+"#FsOrariScarico"},{ref:"GridOrariScheduler",selector:this.selContainer+"#GridOrariScheduler"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},
{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"BtnRipristina",selector:this.selContainer+"#BtnRipristina"},{ref:"FsFrequenza",selector:this.selContainer+"#FsFrequenza"},{ref:"RdgFrequenza",selector:this.selContainer+"#RdgFrequenza"},{ref:"Settimana",selector:this.selContainer+"#Settimana"}]);this.control(this.selContainer+"#TipoScarico",{change:this.changeTipoScarico});this.control(this.selContainer+"#CkbRipetizione",{change:this.changeCkbRipetizione});this.control(this.selContainer+
"#RdgFrequenza",{change:this.changeRdgFrequenza});this.control(this.selContainer+"#RdgRipetiOgni",{change:this.changeRdgRipetiOgni});this.control(this.selContainer+"#Dalle",{blur:this.blurDalleAlle});this.control(this.selContainer+"#Alle",{blur:this.blurDalleAlle});this.control(this.selContainer+"#GridOrariScheduler",{beforeedit:this.beforeeditGridOrariScheduler,edit:this.editGridOrariScheduler,canceledit:this.canceleditGridOrariScheduler,validateedit:this.validateeditGridOrariScheduler});this.control(this.selContainer+
"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#BtnRipristina",{click:this.clickBtnRipristina})},clickBtnNuovo:function(a,b){var c={},d=this.getGridOrariScheduler(),e=d.getStore().getCount();Ext.apply(c,{idTestata:this.idTestata,note:null});controller_nuovoRecordGrid(c,d,e)},clickBtnElimina:function(a,b){this.getGridOrariScheduler().getSelectionModel().getSelection().forEach(function(a){a.store.deleteRecord(a)})},
clickBtnRipristina:function(a,b){var c=this.getGridOrariScheduler().getSelectionModel();Ext.each(c.getSelection(),function(a){a.reject()})},validateeditGridOrariScheduler:function(a,b,c){return msgShow("",[])},canceleditGridOrariScheduler:function(a,b,c){b.record.phantom&&b.record.reject();StdSipcar.sporcaForm(this.getForm(),!1);this.abilitaBottoniGrid(!0)},editGridOrariScheduler:function(a,b,c){this.abilitaBottoniGrid(!0)},beforeeditGridOrariScheduler:function(a,b,c){if(!0===a.editing)return!1;StdSipcar.sporcaForm(this.getForm());
this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},blurDalleAlle:function(a){var b=a.getValue();b&&a.setValue(new Date(b.setMinutes(0)))},changeRdgRipetiOgni:function(a,b){var c=this.getTxtOre(),d=this.getTxtMin();c.setDisabled("M"==b.tipoTime);d.setDisabled("H"==b.tipoTime);"H"==b.tipoTime?d.setValue(null):c.setValue(null)},changeCkbRipetizione:function(a,b){this.getFsOrariScarico().setVisible(!b);this.getFsRipetiOgni().setVisible(b)},
changeRdgFrequenza:function(a,b){this.getSettimana().setVisible("S"==b.ggFrequenza)},changeTipoScarico:function(a,b){this.getFsFrequenza().setVisible("T"==b.abilitato);this.getCntOrari().setVisible("T"==b.abilitato);this.getCkbRipetizione().setVisible("T"==b.abilitato)},verificaCampiForm:function(){var a=this.getForm(),b=a.getForm().getFieldValues(),c=[];a.isValid()||msgAddError(c,"MSG_CAMPI_OBBLIGATORI");"T"==b.abilitato&&"S"==b.ggFrequenza&&Ext.isEmpty(this.getSettimana().getValues())&&msgAddError(c,
"MSG_GG_SETT_OBB");if("T"==b.abilitato)if(b.ripetizione)"H"==b.tipoTime&&0< !b.valoreOre?msgAddError(c,"MSG_RIPETIZIONE_ORE_MIN"):"M"==b.tipoTime&&0< !b.valoreMin&&msgAddError(c,"MSG_RIPETIZIONE_ORE_MIN"),!Ext.isEmpty(b.eseguiDalle)&&!Ext.isEmpty(b.eseguiAlle)&&b.eseguiDalle>=b.eseguiAlle&&msgAddError(c,"MSG_DALLE_MAG_UGUALE_ALLE");else{var d=this.getGridOrariScheduler().getStore(),e=!1;d.each(function(a){if(!d.isRecordDeleted(a))return e=!0,!1});e||msgAddError(c,"MSG_NO_ORARI")}return msgShow("",
c)},salvaForm:function(a){var b=this,c=b.getForm(),d=c.getForm().getFieldValues(),e=null,g=null,h=null,e=d["H"==d.tipoTime?"valoreOre":"valoreMin"],g=d.eseguiDalle,h=d.eseguiAlle;Ext.isEmpty(g)&&!Ext.isEmpty(h)?g=new Date(1899,11,30,0,0,0,0):Ext.isEmpty(h)&&!Ext.isEmpty(g)&&(h=new Date(1899,11,31,0,0,0,0));var k=b.getGridOrariScheduler().getStore().getChanges(),l=[],m=[];Ext.isEmpty(k)||k.forEach(function(a){"T"==a.eliminare?m.push(a.id):l.push({id:Ext.isEmpty(a.id)?"-9999":a.id,idTestata:b.idTestata,
ora:a.ora})});Ext.isEmpty(m)||Ext.apply(d,{orariDaCancellare:m});Ext.isEmpty(l)||Ext.apply(d,{orariScheduler:l});(k=b.getSettimana().getValues())&&Ext.apply(d,{giorni:k.toString()});Ext.apply(d,{id:parseInt(d.id),idOrganizzazione:b.idOrganizzazione,idModulo:CBA.moduli.moduloAttivo,ripetizione:getBoolValue(d.ripetizione),timeInterval:e,eseguiDalle:g,eseguiAlle:h});delete d.giorniScarico;delete d.valoreMin;delete d.valoreOre;controller_salvaRecord(c,d,a,{forzaRegistrazione:"F"})},gestioneForm:function(){var a=
this,b=a.getForm(),c=b.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeTestata;b.controller=a;var d=Ext.create("Generali.standard.controller_PannelloBottoni",{itemId:"cntBottoni",cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},verificaCampiForm_callback:function(){var b=!0,c=a.getGridOrariScheduler().editingPlugin;c.editing&&(c.completeEdit(),b=!c.editing);b&&(b=a.verificaCampiForm());return b}}});inserisciBottoni(b.boxBottoni,
d);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnElimina").hide();if("L"!=b.permesso){var e=b.boxBottoni,g=a.getGridOrariScheduler().getStore(),d=function(){var c=b.isDirty()||g.isModified()||b.getRecord()&&b.getRecord().phantom;!c||b.isDirty()||g.isModified()||(c=!1);e.queryById("cntBottoni").setBtnEditMode(c);a.controllerPrincipale.getBtnRiavSched().setDisabled(c)};c.on("dirtychange",d);g.on({datachanged:d,update:d})}},caricaRecord:function(a,
b){this.idTestata=a?a.get("id"):0;this.controllerPrincipale=b;this.aggiornaStore(this.idTestata)},aggiornaStore:function(a){var b=this.getForm(),c=b.getForm();this.idTestata=StdSipcar.isValidID(a)?a:this.idTestata;this.nuovoInserimento=!StdSipcar.isValidID(this.idTestata);clearForm(b);var d=this.getGridOrariScheduler().getStore();d.removeAll();StdSipcar.isValidID(this.idTestata)&&this.storeTestata.load({params:{id:this.idTestata},callback:function(a,b,h){h?Ext.isEmpty(a)||(a=a[0],a.set("giorniScarico",
Ext.JSON.decode("["+a.get("giorni")+"]")),a.set("valoreOre","H"==a.get("tipoTime")?a.get("timeInterval"):null),a.set("valoreMin","M"==a.get("tipoTime")?a.get("timeInterval"):null),a.set("ggFrequenza",Ext.isEmpty(a.get("ggFrequenza"))?"T":a.get("ggFrequenza")),c.loadRecord(a),d.loadData(a.get("orariScheduler"))):msgShowError("",b.getError())}})},onLaunch:function(){var a=this,b=a.getGridOrariScheduler(),c=b.getSelectionModel();b.controller=a;a.storeTestata=Ext.create("Generali.gestioneScheduler.store.Scheduler",
{autoLoad:!1});var d=function(b){var c=a.getBtnElimina(),d=a.getBtnRipristina();Ext.isEmpty(b)?(c.setVisible(!1),d.setVisible(!1)):(b=b[0],b=b.store&&b.store.isRecordDeleted(b),c.setVisible(!b),c.setDisabled(!c.isVisible()),d.setVisible(b))};b.getStore().on({datachanged:function(){d(c.getSelection())},update:function(a,b){d([b])}});c.on("selectionchange",function(a,b){d(b)});a.gestioneForm()},destroy:function(){delete this.storeTestata;this.callParent()}});
Ext.define("Generali.gestioneScheduler.controller.Scheduler",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridJobs",selector:this.selContainer+"#GridJobs"},{ref:"BtnRiavSched",selector:this.selContainer+"#BtnRiavSched"},{ref:"PnlTestata",selector:this.selContainer+"#PnlTestata"}]);this.control(this.selContainer+"#GridJobs",{select:this.selectGrid});this.control(this.selContainer+"#BtnRiavSched",
{click:this.clickBtnRiavSched})},selectGrid:function(a,b){this.testata&&this.testata.caricaRecord(b,this);this.getPnlTestata().setVisible(b)},clickBtnRiavSched:function(){StdSipcar.promiseGetRequest(getUrlGen()+"/ws/scheduler/restart")},effettuaRicerca:function(){var a=this.getGridJobs(),b=a.getStore(),c={};Ext.apply(c,{idOrganizzazione:this.idOrganizzazione});b.load({params:c,callback:function(b,c,g){g?Ext.isEmpty(b)||a.getSelectionModel().select(0):msgShowError("",c.getError())}})},onLaunch:function(){this.idOrganizzazione=
StdSipcar.coalesce(this.cbaConfig.idOrganizzazione,getIdOrg());var a=this.getPnlTestata(),b={};Ext.apply(b,{controllerPrincipale:this,idOrganizzazione:this.idOrganizzazione,cbaConfig:{permesso:this.cbaConfig.permesso}});b=Ext.create("Generali.gestioneScheduler.view.Impostazioni",b);a.add(b);this.testata=b.controller;this.effettuaRicerca()},destroy:function(){this.callParent()}});
Ext.define("Generali.gestioneScheduler.store.OrariScheduler",{extend:"Generali.data.Store",fields:[{name:"id"},{name:"idTestata"},{name:"ora",type:"date"}],autoDestroy:!0});
Ext.define("Generali.gestioneScheduler.store.Scheduler",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idEntePwd"},{name:"idOrganizzazione"},{name:"idProfilo"},{name:"abilitato"},{name:"idModulo"},{name:"idJob"},{name:"ggFrequenza"},{name:"giorni"},{name:"ripetizione"},{name:"tipoTime"},{name:"timeInterval"},{name:"eseguiDalle",type:"date"},{name:"eseguiAlle",type:"date"},{name:"orariScheduler"},{name:"orariDaCancellare"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/scheduler/impostaz/get",
api:{create:"/cba/gen/ws/general/scheduler/impostaz/new",update:"/cba/gen/ws/general/scheduler/impostaz/update",destroy:"/cba/gen/ws/general/scheduler/impostaz/delete"}}},a)])},autoDestroy:!0});
Ext.define("Generali.gestioneScheduler.view.Impostazioni",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"form",itemId:"Form",reference:"Form",autoScroll:!0,trackResetOnLoad:!0,flex:1,margin:"15 5 5 5",border:0,fieldDefaults:{margin:"0 5 5 0"},layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idEntePwd",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",
hidden:!0},{xtype:"textfield",name:"idJob",hidden:!0},{xtype:"textfield",name:"idProfilo",hidden:!0},{xtype:"container",layout:"vbox",items:[{xtype:"fieldset",title:"ABILITATO",width:300,items:[{xtype:"radiogroup",itemId:"TipoScarico",reference:"TipoScarico",items:[{boxLabel:"NO",name:"abilitato",cls:"cbaLabel",inputValue:"F",checked:!0},{boxLabel:"SI",name:"abilitato",cls:"cbaLabel",inputValue:"T"}]},{xtype:"checkboxfield",hidden:!0,cls:"cbaLabel",boxLabel:"RIPETIZIONE",itemId:"CkbRipetizione",reference:"CkbRipetizione",
name:"ripetizione",inputValue:"T",uncheckedValue:"F"}]}]},{xtype:"container",hidden:!0,itemId:"CntOrari",reference:"CntOrari",layout:"hbox",items:[{xtype:"fieldset",itemId:"FsRipetiOgni",reference:"FsRipetiOgni",title:"SCARICA_OGNI",hidden:!0,width:300,items:[{xtype:"radiogroup",vertical:!0,columns:1,itemId:"RdgRipetiOgni",reference:"RdgRipetiOgni",width:200,items:[{xtype:"container",layout:"hbox",items:[{xtype:"radio",boxLabel:"ORE",name:"tipoTime",cls:"cbaLabel",inputValue:"H",checked:!0,width:80},
{xtype:"splitter"},{xtype:"numberfield",allowDecimals:!1,hideTrigger:!1,itemId:"TxtOre",reference:"TxtOre",minValue:0,maxValue:23,width:90,name:"valoreOre"}]},{xtype:"container",layout:"hbox",items:[{xtype:"radio",boxLabel:"MINUTI",name:"tipoTime",cls:"cbaLabel",inputValue:"M",width:80},{xtype:"splitter"},{xtype:"numberfield",itemId:"TxtMin",reference:"TxtMin",disabled:!0,allowDecimals:!1,hideTrigger:!1,minValue:0,maxValue:59,width:90,name:"valoreMin"}]}]},{xtype:"container",layout:"hbox",items:[{xtype:"timefield24",
itemId:"Dalle",reference:"Dalle",fieldLabel:"DALLE",labelClsExtra:"cbaLabel",labelAlign:"left",name:"eseguiDalle",format:"H:i",labelWidth:35,width:90},{xtype:"timefield24",itemId:"Alle",reference:"Alle",fieldLabel:"ALLE",labelClsExtra:"cbaLabel",labelAlign:"left",name:"eseguiAlle",format:"H:i",labelWidth:35,width:110,listeners:{render:function(a){creaToolTipInfo(a,"PRZ_TOOLTIP_AZZERA_MINUTI")}}}]}]},{xtype:"fieldset",itemId:"FsOrariScarico",reference:"FsOrariScarico",title:"ORARI",width:300,items:[{xtype:"gridpanel",
itemId:"GridOrariScheduler",reference:"GridOrariScheduler",store:Ext.create("Generali.gestioneScheduler.store.OrariScheduler"),border:0,height:180,columns:[{xtype:"gridcolumn",flex:1,hidden:!0,align:"center",style:"text-align:center",dataIndex:"id",text:"ID"},{xtype:"gridcolumn",flex:1,hidden:!0,align:"center",style:"text-align:center",dataIndex:"idTestata",text:"ID_TESTATA"},{xtype:"datecolumn",text:"ORA",dataIndex:"ora",flex:1,align:"center",sortable:!1,format:"H:i",editor:{xtype:"timefield24",
allowBlank:!1,format:"H:i"}}],viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){return d.classifyRecord(a)}},plugins:[Ext.create("RowEditingAutoInsert",{autoCancel:!1,errorSummary:!1,activeOnNewRecordsOnly:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"},{xtype:"button",itemId:"BtnRipristina",
reference:"BtnRipristina",iconCls:"icon-eliminaGriglia",text:"Ripristina",hidden:!0}]}]}]}]},{xtype:"fieldset",title:"FREQUENZA",itemId:"FsFrequenza",reference:"FsFrequenza",hidden:!0,items:[{xtype:"radiogroup",columns:2,itemId:"RdgFrequenza",reference:"RdgFrequenza",items:[{boxLabel:"TUTTI_GIORNI",name:"ggFrequenza",cls:"cbaLabel",inputValue:"T",checked:!0},{boxLabel:"GIORNI_DELLA_SETTIMANA",name:"ggFrequenza",cls:"cbaLabel",inputValue:"S"}]},{xtype:"cbaMultipleChoice",itemId:"Settimana",reference:"Settimana",
hidden:!0,style:{border:"0px!important"},listeners:{afterrender:function(a,b){var c=a.query("checkbox");Ext.apply(a,{getValues:function(){var a=[];c.forEach(function(b){b.getValue()&&a.push(b.inputValue)});return Ext.isEmpty(a)?void 0:a}})}},cbaConfig:{itemsCfg:[{html:traduci("LUN"),name:"giorniScarico",isFormField:!0,inputValue:1,width:60},{html:traduci("MAR"),name:"giorniScarico",isFormField:!0,inputValue:2,width:60},{html:traduci("MER"),name:"giorniScarico",isFormField:!0,inputValue:3,width:60},
{html:traduci("GIO"),name:"giorniScarico",isFormField:!0,inputValue:4,width:60},{html:traduci("VEN"),name:"giorniScarico",isFormField:!0,inputValue:5,width:60},{html:traduci("SAB"),name:"giorniScarico",isFormField:!0,inputValue:6,width:60},{html:traduci("DOM"),name:"giorniScarico",isFormField:!0,inputValue:7,width:60}]}}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni"}]});this.callParent(arguments)}});
Ext.define("Generali.gestioneScheduler.view.Scheduler",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",padding:10,items:[{xtype:"button",itemId:"BtnRiavSched",reference:"BtnRiavSched",iconCls:"icon-processing",text:"RIAVVIA_SCHEDULER",width:230}]},{xtype:"gridpanel",itemId:"GridJobs",reference:"GridJobs",store:Ext.create("Generali.gestioneScheduler.store.Scheduler",
{proxy:{url:getUrlGen()+"/ws/scheduler/impostaz/list"}}),title:traduci("ATTIVITA"),height:170,columns:{defaults:{variableRowHeight:!0},items:[{xtype:"numbercolumn",dataIndex:"id",hidden:!0},{xtype:"gridcolumn",flex:1,dataIndex:"desJob",text:"DESCRIZIONE"}]},viewConfig:{loadMask:!1}},{xtype:"panel",itemId:"PnlTestata",reference:"PnlTestata",hidden:!0,flex:1.5,layout:"fit"}]}]});this.callParent(arguments)}});
Ext.define("Generali.gruppoCategoriaArticoli.controller.Articoli",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormArticoli",selector:this.selContainer+"#FormArticoli"},{ref:"CBNatura",selector:this.selContainer+"#CBNatura"},{ref:"CodiceCategoria",selector:this.selContainer+"#CodiceCategoria"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"DescArticoli",selector:this.selContainer+
"#DescArticoli"}])},verificaCampiForm:function(){var a=[];this.getFormArticoli().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormArticoli(),c=b.getForm().getFieldValues();Ext.apply(c,{nonAttivo:getBoolValue(c.nonAttivo)});this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})?a&&this.callbackEsci&&this.callbackEsci():this.recordModificato=!1},gestioneForm:function(){var a=this,b=a.getFormArticoli();b.permesso=
a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeArticoli;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(c){var d=a.cbaConfig.controllerTree;tree=d.getTreeRep();store=tree.getStore();if(a.cbaConfig.nuovoInserimento||d.cbaConfig.caricamentoEsterno)var g=trovaRecord(store,"text",a.getDescArticoli().getValue());g&&g.get("idCategoria")!=a.cbaConfig.codiceCategoria?Messaggio("ATTENZIONE","DATI_STESSA_DESCR","YESNO",
"QUESTION",!1,function(){a.salvaForm(c)},function(){var c=b.getForm().findField("id").getValue();a.recordModificato=!0;a.cbaConfig.nuovoInserimento?a.aggiornaStore():a.aggiornaStore(c)}):a.salvaForm(c)},annulla_callback:function(){var c=b.getForm().findField("id").getValue(),e=b.getForm().findField("idCategoria").getValue();0<c?a.aggiornaStore():a.cbaConfig.controllerTree.aggiornaStore(null,null,e,null)},nuovo_callback:function(){controller_nuovoRecord(b);setTimeout(function(){Ext.isEmpty(a.getCBNatura().getValue())&&
a.getCBNatura().getStore().each(function(b){null!=b.get("extra")&&"T"==b.get("extra").split(",")[2]&&a.getCBNatura().setValue(b)});a.cbaConfig.descrizioneArticolo&&(a.inserimentoEsterno=!0,a.getDescArticoli().setValue(a.cbaConfig.descrizioneArticolo))},100)},elimina_callback:function(){var c=b.getForm().findField("id").getValue(),e=b.getForm().findField("idCategoria").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.cbaConfig.controllerTree.aggiornaStore(null,
null,e,null)})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});"L"!=b.permesso&&(inserisciBottoni(b.boxBottoni,c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide(),b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.disabilitaTree(e)}))},aggiornaStore:function(a){var b=this,c=b.storeArticoli,d=b.getFormArticoli().getForm();b.cbaConfig.controllerTree.disabilitaTree(!1);b.cbaConfig.codiceArticolo||
a?c.load({params:{id:b.cbaConfig.codiceArticolo?b.cbaConfig.codiceArticolo:a},callback:function(c,g,h){h?(g=b.cbaConfig.controllerTree,Ext.isEmpty(c)||d.loadRecord(c[0]),b.recordModificato&&(b.recordModificato=!1,g.aggiornaStore(null,a,null,null),delete g.cbaConfig.nuovoInserimento,g.cbaConfig.caricamentoEsterno&&g.cbaConfig.callbackSeleziona&&(h=c[0].get("id"),c=c[0].get("descrizione"),g.cbaConfig.callbackSeleziona(h,c),g.getTreeRep().up("window").close()))):msgShowError("",g.getError())}}):(b.cbaConfig.CntPrincipale.removeAll(),
b.cbaConfig.controllerTree.aggiornaStore())},onLaunch:function(){var a=this.getCBNatura().getStore();this.idOrganizzazione=this.cbaConfig.idOrganizzazione;this.idEsercizio=this.cbaConfig.anno;this.storeArticoli=Ext.create("Generali.gruppoCategoriaArticoli.store.Articoli");this.gestioneForm();this.cbaConfig.nuovoInserimento?(this.getBoxBottoni().queryById("btnNuovo").handler(),this.getCodiceCategoria().setValue(this.cbaConfig.codiceCategoria)):this.aggiornaStore();a.getProxy().extraParams={tipoDato:"NB"};
a.load()},destroy:function(){eliminaStore(this.storeArticoli)}});
Ext.define("Generali.gruppoCategoriaArticoli.controller.Categoria",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormCategoria",selector:this.selContainer+"#FormCategoria"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBContoCategoria",selector:this.selContainer+"#CBContoCategoria"},{ref:"CodiceGruppo",selector:this.selContainer+"#CodiceGruppo"},{ref:"DescrizioneCategoria",selector:this.selContainer+
"#DescrizioneCategoria"},{ref:"TxtAmmortamento",selector:this.selContainer+"#TxtAmmortamento"}])},verificaCampiForm:function(){var a=[];this.getFormCategoria().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormCategoria(),c=b.getForm().getFieldValues();this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getFormCategoria();b.permesso=
a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeCategoria;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(c){store=a.cbaConfig.controllerTree.getTreeRep().getStore();if(a.cbaConfig.nuovoInserimento)var d=trovaRecord(store,"text",a.getDescrizioneCategoria().getValue());d&&d.get("idGruppo")!=a.cbaConfig.codiceGruppo?Messaggio("ATTENZIONE","DATI_STESSA_DESCR","YESNO","QUESTION",!1,function(){a.salvaForm(c)},
function(){var c=b.getForm().findField("id").getValue();a.recordModificato=!0;a.aggiornaStore(c)}):a.salvaForm(c)},annulla_callback:function(){var c=b.getForm().findField("id").getValue(),e=b.getForm().findField("idGruppo").getValue();0<c?a.aggiornaStore():a.cbaConfig.controllerTree.aggiornaStore(null,null,null,e)},nuovo_callback:function(){controller_nuovoRecord(b);setTimeout(function(){a.cbaConfig.nuovaCategoria&&(a.getCBContoCategoria().setValue(a.cbaConfig.nuovaCategoria),delete a.cbaConfig.nuovaCategoria)},
100)},elimina_callback:function(){var c=b.getForm().findField("id").getValue(),e=b.getForm().findField("idGruppo").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.cbaConfig.controllerTree.aggiornaStore(null,null,null,e)})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});a.cbaConfig.codiceArticolo||(inserisciBottoni(b.boxBottoni,c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide());if("L"!=
b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.disabilitaTree(e)})},aggiornaStore:function(a){var b=this,c=b.storeCategoria,d=b.getFormCategoria(),e=d.getForm();b.cbaConfig.codiceArticolo&&containerSolaLettura(d);b.cbaConfig.controllerTree.disabilitaTree(!1);b.cbaConfig.codiceCategoria||a?c.load({params:{id:b.cbaConfig.codiceCategoria?b.cbaConfig.codiceCategoria:a},callback:function(c,d,k){if(k){var g=b.cbaConfig.controllerTree;Ext.isEmpty(c)||
e.loadRecord(c[0]);b.recordModificato&&(b.recordModificato=!1,g.aggiornaStore(null,null,a,null),delete g.cbaConfig.nuovaCategoria,b.cbaConfig.nuovoInserimento&&setTimeout(function(){g.clickBtnNuovo()},200))}else msgShowError("",d.getError())}}):(b.cbaConfig.CntPrincipale.removeAll(),b.cbaConfig.controllerTree.aggiornaStore())},onLaunch:function(){var a=this,b=a.getCBContoCategoria().getStore();a.idOrganizzazione=a.cbaConfig.idOrganizzazione;a.idEsercizio=a.cbaConfig.anno;a.storeCategoria=Ext.create("Generali.gruppoCategoriaArticoli.store.Categoria");
a.gestioneForm();b.load({params:{idOrganizzazione:a.idOrganizzazione,idEsercizio:a.idEsercizio,soloCespite:"T"},callback:function(){a.getTxtAmmortamento().setDisabled(CBA.moduli.modulo53.abilitato);a.cbaConfig.nuovoInserimento?(a.getBoxBottoni().queryById("btnNuovo").handler(),a.getCodiceGruppo().setValue(a.cbaConfig.codiceGruppo)):a.aggiornaStore()}})},destroy:function(){eliminaStore(this.storeCategoria)}});
Ext.define("Generali.gruppoCategoriaArticoli.controller.Gruppo",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormGruppo",selector:this.selContainer+"#FormGruppo"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBContoGruppo",selector:this.selContainer+"#CBContoGruppo"},{ref:"DescrizioneGruppo",selector:this.selContainer+"#DescrizioneGruppo"}])},verificaCampiForm:function(){var a=
[];this.getFormGruppo().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormGruppo(),c=b.getForm().getFieldValues();c.idOrganizzazione=this.idOrganizzazione;this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})&&a&&this.callbackEsci&&this.callbackEsci()},gestioneForm:function(){var a=this,b=a.getFormGruppo();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeGruppo;b.controller=a;var c=
Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});a.cbaConfig.codiceCategoria||
(inserisciBottoni(b.boxBottoni,c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.disabilitaTree(e)})},aggiornaStore:function(a){var b=this,c=b.storeGruppo,d=b.getFormGruppo(),e=d.getForm();b.cbaConfig.codiceCategoria&&containerSolaLettura(d);b.cbaConfig.controllerTree.disabilitaTree(!1);b.cbaConfig.codiceGruppo||a?c.load({params:{id:b.cbaConfig.codiceGruppo?
b.cbaConfig.codiceGruppo:a},callback:function(c,d,k){k?(Ext.isEmpty(c)||e.loadRecord(c[0]),b.recordModificato&&(b.recordModificato=!1,b.cbaConfig.controllerTree.aggiornaStore(null,null,null,a),b.cbaConfig.nuovoInserimento&&setTimeout(function(){b.cbaConfig.controllerTree.clickBtnNuovo()},200))):msgShowError("",d.getError())}}):(b.cbaConfig.CntPrincipale.removeAll(),b.cbaConfig.controllerTree.aggiornaStore())},onLaunch:function(){var a=this,b=a.getCBContoGruppo().getStore();a.idOrganizzazione=a.cbaConfig.idOrganizzazione;
a.idEsercizio=a.cbaConfig.anno;a.storeGruppo=Ext.create("Generali.gruppoCategoriaArticoli.store.Gruppo");a.gestioneForm();b.load({params:{idOrganizzazione:a.idOrganizzazione,idEsercizio:a.idEsercizio,soloCespite:"T"},callback:function(){a.cbaConfig.nuovoInserimento?a.getBoxBottoni().queryById("btnNuovo").handler():a.aggiornaStore()}})},destroy:function(){eliminaStore(this.storeGruppo)}});
Ext.define("Generali.gruppoCategoriaArticoli.controller.PnlGruppoCatArt",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:this.selContainer+
"#TreeRep"},{ref:"CBAnno",selector:this.selContainer+"#CBAnno"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"CntPrincipale",selector:this.selContainer+"#CntPrincipale"},{ref:"BtnEsci",selector:this.selContainer+"#BtnEsci"},{ref:"CntFinestra",selector:this.selContainer+"#CntFinestra"},{ref:"BtnSeleziona",selector:this.selContainer+"#BtnSeleziona"},{ref:"TxtCerca",selector:this.selContainer+"#TxtCerca"},{ref:"LblSelettore",selector:this.selContainer+"#LblSelettore"}]);this.control(this.selContainer+
"#TreeRep",{select:this.selectTree,itemdblclick:this.itemdblclickTree,beforeitemcontextmenu:this.beforeitemcontextmenuTree});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnEsci",{click:this.clickBtnEsci});this.control(this.selContainer+"#BtnSeleziona",{click:this.clickBtnSeleziona});this.control(this.selContainer+"#CBAnno",{change:this.changeCBAnno});this.control(this.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(this.filtraTree,
500,this)})},filtraTree:function(a){var b=this.getTreeRep(),c=b.getStore(),d=[];this.getLblSelettore().setVisible(!1);c.clearFilter();Ext.isEmpty(a.getValue())?(c.each(function(a){a.set("cls","")}),b.getSelectionModel().select(0)):(c.each(function(b){if(b.isLeaf()){var c=!1,e=b.get("text");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);c?(b.set("cls","cba-dirty-record"),d.push(b)):b.set("cls","")}}),this.filtraPadri(c,d),this.getLblSelettore().setVisible(1<d.length),Ext.isEmpty(d)?
b.getSelectionModel().select(0):(b.ensureVisible(d[0]),this.getLblSelettore().setText(d.length+" "+traduci("ELEMENTI_TROVATI"))));a.focus()},filtraPadri:function(a,b){a.filter(function(a){for(var c=!1,e=0,g=b.length;e<g;e++)if(a.contains(b[e])){c=!0;break}else if(a.isLeaf()&&(c=a===b[e]))break;return c})},clickBtnSeleziona:function(a){if(this.cbaConfig.callbackSeleziona){var b=this.getTreeRep().getSelectionModel().getSelection()[0];if(!Ext.isEmpty(b)&&b.get("idArticolo")){var c=this.cbaConfig.controllerGrid;
if(this.getCntPrincipale().down("#CBContoCategoria").getValue()==c.cbaConfig.controllerInserimento.getCBConto().getValue())var c=b.get("idArticolo"),b=b.get("text"),d=this.getCntPrincipale().down("#TxtAmmortamento").getValue();else return msgShowWarning("","CONTI_NON_COLLEGATI"),!1;this.cbaConfig.callbackSeleziona(c,b,d)}else return msgShowWarning("","SELEZIONARE_ARTICOLO"),!1}a.up("window").close()},clickBtnEsci:function(a){a.up("window").close()},changeCBAnno:function(a,b,c,d){},disabilitaTree:function(a){"L"!=
this.cbaConfig.permesso&&this.getTreeRep().setDisabled(a)},clickBtnNuovo:function(){var a=this.getTreeRep().getSelectionModel().getSelection()[0],b=this.getCntPrincipale(),c={};if(this.cbaConfig.nuovoInserimento){var d=this.cbaConfig.controllerGrid;if(this.getCntPrincipale().down("#CBContoCategoria"))var e=this.getCntPrincipale().down("#CBContoCategoria").getValue();this.cbaConfig.idCategoria&&delete this.cbaConfig.idCategoria;if(a.get("idCategoria")&&!Ext.isEmpty(e)&&e!=d.cbaConfig.controllerInserimento.getCBConto().getValue())return msgShowWarning("",
"CONTI_NON_COLLEGATI"),!1}b.removeAll();Ext.apply(c,{nuovoInserimento:!0,controllerTree:this,CntPrincipale:b,idOrganizzazione:this.idOrganizzazione,nodeID:a.get("nodeID"),codiceGruppo:a.get("idGruppo"),codiceCategoria:a.get("idCategoria"),codiceArticolo:a.get("idArticolo"),anno:this.idEsercizioDefault});a&&(Ext.isEmpty(a.get("idGruppo"))?b.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Gruppo",{cbaConfig:c})):Ext.isEmpty(a.get("idCategoria"))?(this.cbaConfig.nuovaCategoria&&this.cbaConfig.caricamentoEsterno&&
Ext.apply(c,{nuovaCategoria:this.cbaConfig.nuovaCategoria}),b.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Categoria",{cbaConfig:c}))):(this.cbaConfig.nuovoInserimento&&this.cbaConfig.caricamentoEsterno&&Ext.apply(c,{descrizioneArticolo:this.cbaConfig.nuovoInserimento}),b.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Articoli",{cbaConfig:c}))))},itemdblclickTree:function(a,b,c,d,e,g){if(this.cbaConfig.callbackSeleziona)if(!Ext.isEmpty(b)&&b.get("idArticolo")){c=this.cbaConfig.controllerGrid;
if(this.getCntPrincipale().down("#CBContoCategoria").getValue()==c.cbaConfig.controllerInserimento.getCBConto().getValue())c=b.get("idArticolo"),b=b.get("text"),d=this.getCntPrincipale().down("#TxtAmmortamento").getValue();else return msgShowWarning("","CONTI_NON_COLLEGATI"),!1;this.cbaConfig.callbackSeleziona(c,b,d);a.up("window").close()}else return msgShowWarning("","SELEZIONARE_ARTICOLO"),!1},selectTree:function(a,b,c,d){var e=this;a={};b=b.data;c=this.getCntPrincipale();b.params&&(a=b.params[0]);
Ext.apply(a,{nuovoInserimento:this.nuovoRecord,controllerTree:this,CntPrincipale:c,idOrganizzazione:this.idOrganizzazione,permesso:this.cbaConfig.permesso,text:b.text,nodeID:b.nodeID,codiceGruppo:b.idGruppo,codiceCategoria:b.idCategoria,codiceArticolo:b.idArticolo,anno:this.idEsercizioDefault});c.removeAll();d=function(a,b){return a.setDisabled(b||"L"==e.cbaConfig.permesso)};Ext.isEmpty(b.idGruppo)&&!Ext.isEmpty(b.idCategoria)?(this.getBtnNuovo().setText(traduci("NUOVO")),d(this.getBtnNuovo(),!0)):
(this.getBtnNuovo().setText(traduci("NUOVO_GRUPPO")),d(this.getBtnNuovo(),!1),Ext.isEmpty(b.idGruppo)||(this.getBtnNuovo().setText(traduci("NUOVA_CATEGORIA")),c.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Gruppo",{cbaConfig:a}))),Ext.isEmpty(b.idCategoria)||(this.getBtnNuovo().setText(traduci("NUOVO_ARTICOLO")),c.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Categoria",{cbaConfig:a}))),Ext.isEmpty(b.idArticolo)||(d(this.getBtnNuovo(),!0),c.add(Ext.create("Generali.gruppoCategoriaArticoli.view.Articoli",
{cbaConfig:a}))))},beforeitemcontextmenuTreeView:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a,b,c,d){var e=this,g={},h=e.getTreeRep(),k=h.getStore(),l=e.cbaConfig.controllerGrid;!e.cbaConfig.piuArticoli&&e.cbaConfig.caricamentoEsterno?e.getTxtCerca().setValue(""):delete e.cbaConfig.piuArticoli;Ext.apply(g,{idOrganizzazione:e.idOrganizzazione});!e.cbaConfig.nuovaCategoria&&e.cbaConfig.caricamentoEsterno&&Ext.apply(g,{idContoCategoria:l.cbaConfig.controllerInserimento.getCBConto().getValue()});
k.load({params:g,callback:function(g,k,l){if(l){var m;b&&(m=h.getRootNode().findChild("idArticolo",b,!0));c&&(m=h.getRootNode().findChild("idCategoria",c,!0));d&&(m=h.getRootNode().findChild("idGruppo",d,!0));a&&(m=h.getRootNode().findChild("nodeID",a,!0));h.expandAll();e.cbaConfig.caricamentoEsterno&&e.cbaConfig.idCategoria&&(m=h.getRootNode().findChild("idCategoria",e.cbaConfig.idCategoria,!0));m?(h.getSelectionModel().select(0),h.getSelectionModel().select([m]),e.cbaConfig.idCategoria&&e.clickBtnNuovo()):
h.getSelectionModel().select(0)}else msgShowError("",k.getError())}})},stampaAlbero:function(){var a=this.cbaConfig,b=a.winElaborazione,c={};Ext.apply(c,{idOrganizzazione:a.idOrganizzazione});"string"===typeof b&&(a.winElaborazione=b===(!0).toString());Ext.apply(this.parametriStampa,{url:a.url,jsonData:a.jsonData,titolo:a.titolo,winElaborazione:b,params:{reportId:a.idRecord}});a=this.parametriStampa;Ext.apply(a.params,c);this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),
this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampaAlbero();this.callParent([a,b])},onLaunch:function(){var a=this;a.getCBAnno();a.idOrganizzazione=a.cbaConfig.idOrganizzazione?a.cbaConfig.idOrganizzazione:getIdOrg();a.getTreeRep().controller=a;a.cbaConfig.caricamentoEsterno&&(a.cbaConfig.controllerGrid.controllerInventario=a);getIdEsercizioDefaultByIdOrg(a.idOrganizzazione,function(b){a.idEsercizioDefault=b});a.getCntFinestra().setVisible(a.cbaConfig.caricamentoEsterno);
a.getBtnStampa().setVisible(!Ext.isEmpty(a.cbaConfig.url));a.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.gruppoCategoriaArticoli.store.Articoli",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCategoria"},{name:"descrizione"},{name:"idNatura"},{name:"nonAttivo"},{name:"categoria"},{name:"descrNatura"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/articolo/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/articoli/articolo/get",create:"/cba/gen/ws/general/articoli/articolo/insert",update:"/cba/gen/ws/general/articoli/articolo/update",
destroy:"/cba/gen/ws/general/articoli/articolo/delete"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.store.Categoria",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idGruppo"},{name:"descrizione"},{name:"idConto"},{name:"ammortamento"},{name:"idEsercizio"},{name:"idOrganizzazione"},{name:"descrGruppo"},{name:"descrConto"},{name:"gruppo"},{name:"conto"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/categoriaArt/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/articoli/categoriaArt/get",
create:"/cba/gen/ws/general/articoli/categoriaArt/insert",update:"/cba/gen/ws/general/articoli/categoriaArt/update",destroy:"/cba/gen/ws/general/articoli/categoriaArt/delete"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.store.CategorieByIdConto",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idGruppo"},{name:"descrizione"},{name:"idConto"},{name:"ammortamento"},{name:"descrGruppo"},{name:"descrConto"},{name:"idEsercizio"},{name:"idOrganizzazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/categoriaArt/listByIdConto",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.store.Gruppo",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idConto"},{name:"descrizione"},{name:"conto"},{name:"descrConto"},{name:"idEsercizio"},{name:"idOrganizzazione"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/gruppoArt/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/articoli/gruppoArt/get",create:"/cba/gen/ws/general/articoli/gruppoArt/insert",update:"/cba/gen/ws/general/articoli/gruppoArt/update",
destroy:"/cba/gen/ws/general/articoli/gruppoArt/delete"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.store.PnlGruppoCatArt",{extend:"Ext.data.TreeStore",fields:[{name:"checked",convert:function(a,b){return null}},{name:"children"},{name:"expanded"},{name:"iconCls"},{name:"idArticolo"},{name:"idCategoria"},{name:"idGruppo"},{name:"leaf"},{name:"nodeID"},{name:"text"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/articolo/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.store.searchByDescr",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCategoria"},{name:"descrizione"},{name:"idNatura"},{name:"nonAttivo"},{name:"descrNatura"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articoli/articolo/searchByDescr",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.gruppoCategoriaArticoli.view.Articoli",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"fieldset",title:"GESTIONE_ARTICOLI",flex:1,bodyPadding:10,items:[{xtype:"form",itemId:"FormArticoli",reference:"FormArticoli",trackResetOnLoad:!0,border:0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0,labelClsExtra:"cbaLabel"},
{xtype:"textfield",itemId:"CodiceCategoria",reference:"CodiceCategoria",fieldLabel:"ID_CATEGORIA",name:"idCategoria",hidden:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,maxLength:100,flex:1,name:"descrizione",itemId:"DescArticoli",reference:"DescArticoli",fieldLabel:"DESCRIZIONE_ARTICOLI",allowBlank:!1,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CBNatura",reference:"CBNatura",store:Ext.create("Generali.multiData.store.MultiDataCbox"),labelWidth:150,minChars:0,
name:"idNatura",displayField:"valore",queryMode:"remote",queryParam:"descrizione",valueField:"codice",fieldLabel:"NATURA",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"NON_ATTIVO",name:"nonAttivo",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.gruppoCategoriaArticoli.view.Categoria",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"fieldset",title:"GESTIONE_CATEGORIA",flex:1,bodyPadding:10,items:[{xtype:"form",itemId:"FormCategoria",reference:"FormCategoria",trackResetOnLoad:!0,border:0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0,labelClsExtra:"cbaLabel"},
{xtype:"textfield",itemId:"CodiceGruppo",reference:"CodiceGruppo",fieldLabel:"ID_GRUPPO",name:"idGruppo",hidden:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,maxLength:40,flex:1,name:"descrizione",itemId:"DescrizioneCategoria",reference:"DescrizioneCategoria",fieldLabel:"DESCRIZIONE_CATEGORIA",allowBlank:!1,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CBContoCategoria",reference:"CBContoCategoria",store:Ext.create("Generali.pianodeiconti.store.DesSottoconto"),
labelWidth:150,minChars:3,name:"idConto",displayField:"valore",queryMode:"local",valueField:"codice",fieldLabel:"CONTO",labelClsExtra:"cbaLabel"},{xtype:"container",items:[{xtype:"textfield",itemId:"TxtAmmortamento",reference:"TxtAmmortamento",labelWidth:150,width:250,fieldLabel:"AMMORTAMENTO",name:"ammortamento",labelClsExtra:"cbaLabel"}]}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.gruppoCategoriaArticoli.view.Gruppo",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"fieldset",title:"GESTIONE_GRUPPO",flex:1,bodyPadding:10,items:[{xtype:"form",itemId:"FormGruppo",reference:"FormGruppo",trackResetOnLoad:!0,border:0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0,labelClsExtra:"cbaLabel"},{xtype:"textfield",
labelWidth:150,maxLength:100,flex:1,name:"descrizione",itemId:"DescrizioneGruppo",reference:"DescrizioneGruppo",fieldLabel:"DESCRIZIONE_GRUPPO",allowBlank:!1,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"combobox",itemId:"CBContoGruppo",reference:"CBContoGruppo",store:Ext.create("Generali.pianodeiconti.store.DesSottoconto"),labelWidth:150,minChars:3,name:"idConto",displayField:"valore",queryMode:"local",valueField:"codice",fieldLabel:"CONTO",labelClsExtra:"cbaLabel"}]}]},{xtype:"container",
itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.gruppoCategoriaArticoli.view.PnlGruppoCatArt",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",itemId:"TreeRep",reference:"TreeRep",width:380,border:0,store:Ext.create("Generali.gruppoCategoriaArticoli.store.PnlGruppoCatArt"),rootVisible:!1,useArrows:!0,plugins:[{ptype:"bufferedrenderer"}],viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){0==b&&a.set("text",traduci("GRUPPI"));
return a.get("cls")}},dockedItems:[{xtype:"toolbar",dock:"top",itemId:"CntFinestra",reference:"CntFinestra",items:[{xtype:"button",itemId:"BtnSeleziona",reference:"BtnSeleziona",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"ANNULLA"}]},{xtype:"toolbar",dock:"top",layout:{type:"hbox",align:"left"},border:0,items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",
align:"left",text:"NUOVO"},{xtype:"newButtonStampa",itemId:"BtnStampa",reference:"BtnStampa",text:"STAMPA",scale:"small",hidden:!0},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",emptyText:"CERCA",flex:1}]},{xtype:"label",border:0,dock:"top",hidden:!0,itemId:"LblSelettore",reference:"LblSelettore"}]},{xtype:"panel",itemId:"CntPrincipale",reference:"CntPrincipale",flex:1,bodyPadding:10,autoScroll:!0,layout:{align:"stretch",type:"vbox"}}]});this.callParent(arguments)}});
Ext.define("Help.controller.Help",{extend:"Generali.standard.ViewController",historyTopic:[],posCurrentTopic:0,init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TabRicerca",selector:a+"#TabRicerca"},{ref:"BtnCerca",selector:a+"#BtnCerca"},{ref:"GridTopic",selector:a+"#GridTopic"},{ref:"TxtCerca",selector:a+"#TxtCerca"},{ref:"BtnIndietro",selector:a+"#BtnIndietro"},{ref:"BtnAvanti",selector:a+"#BtnAvanti"},{ref:"BtnStampa",selector:a+"#BtnStampa"},{ref:"TreeIndice",
selector:a+"#TreeIndice"},{ref:"PnlTopic",selector:a+"#PnlTopic"},{ref:"Correlati",selector:a+"#Correlati"},{ref:"BtnEsci",selector:a+"#BtnEsci"}]);this.control(a+"#GridTopic",{select:this.selectGridTopic});this.control(a+"#BtnEsci",{click:this.esci});this.control(a+"#TxtCerca",{keydown:this.keydownTxtCerca});this.control(a+"#BtnCerca",{click:this.cerca});this.control(a+"#BtnIndietro",{click:this.indietro});this.control(a+"#BtnAvanti",{click:this.avanti});this.control(a+"#TreeIndice",{itemclick:this.itemclickTreeIndice});
this.control(a+"#Correlato1",{click:this.aggiungiCorrelato});this.control(a+"#Correlato2",{click:this.aggiungiCorrelato});this.control(a+"#BtnStampa",{click:this.stampa})},selectGridTopic:function(a,b){var c=b.get("id");this.caricaTopic(c,!0);this.caricaCorrelati(c)},esci:function(){this.getPnlTopic().up("window").close()},stampa:function(){alert("stampa")},keydownTxtCerca:function(a,b,c){12==b.button&&this.cerca()},cerca:function(){this.cercaTopic()},avanti:function(){this.topicIndietroAvanti(!0)},
indietro:function(){this.topicIndietroAvanti(!1)},caricaTopic:function(a,b){b&&(this.historyTopic.push(a),this.posCurrentTopic=this.historyTopic.length-1);this.abilitaIndietroAvanti()},caricaBlobTopic:function(a){var b=this;b.storeTopic.load({params:{id:a},callback:function(a,d,e){Ext.isEmpty(a)||b.getPnlTopic().update(a[0].get("text"))}})},caricaCorrelati:function(a){var b=this;b.storeCorrelati.load({params:{topicId:a},callback:function(a,d,e){b.getCorrelati().removeAll();Ext.each(a,function(a){b.getCorrelati().add({xtype:"label",
padding:"0 0 10 0",text:a.get("title"),cls:"cbaLabelLink",listeners:{render:function(c){c.getEl().on("click",function(){b.puoiInserireTopic(a.get("relatedId"))&&b.caricaTopic(a.get("relatedId"),!0)},c)}}})})}})},puoiInserireTopic:function(a){return 0<this.historyTopic.length&&a==this.historyTopic[this.historyTopic.length-1]?!1:!0},cancellaListe:function(){this.getPnlTopic().update("");this.getCorrelati().removeAll()},itemclickTreeIndice:function(a,b){var c=b.get("id");this.puoiInserireTopic(c)&&(this.cancellaListe(),
this.caricaTopic(c,!0),this.caricaCorrelati(c))},abilitaIndietroAvanti:function(){this.getBtnIndietro().setDisabled(0==this.posCurrentTopic);this.getBtnAvanti().setDisabled(this.posCurrentTopic==this.historyTopic.length-1);this.getBtnStampa().setDisabled(0==this.historyTopic.length);var a=this.historyTopic[this.posCurrentTopic],b=trovaRecord(this.getTreeIndice().getStore(),"id",a);this.getPnlTopic().setTitle(b.get("text"));this.caricaBlobTopic(a)},topicIndietroAvanti:function(a){this.posCurrentTopic+=
a?1:-1;a=this.historyTopic[this.posCurrentTopic];var b=this.getTreeIndice(),c=trovaRecord(b.getStore(),"id",a);c.get("leaf")&&b.expandPath(c.getPath());b.getSelectionModel().select([c]);this.caricaTopic(a,!1);this.caricaCorrelati(a)},svuotaHistory:function(){this.historyTopic=[];this.currTopic=0},cercaTopic:function(){var a=this.getGridTopic();this.getTabRicerca().setActiveTab(1);this.getGridTopic().getStore().removeAll();this.cancellaListe();var b=this.getTxtCerca().getValue();b&&a.getStore().load({params:{text:b},
callback:function(a,b,e){}})},selectNodeTree:function(a){var b=this.getTreeIndice();if(a=trovaRecord(b.getStore(),"id",a))b.expandPath(a.getPath()),b.getSelectionModel().select([a]),this.itemclickTreeIndice(b,a)},onLaunch:function(){var a=this;a.getPnlTopic().currentController=a;a.svuotaHistory();a.storeCorrelati=Ext.create("Help.store.Correlati");a.storeTopic=Ext.create("Help.store.Topic");var b=a.getTreeIndice();b.getStore().load({callback:function(c,d,e){e?(b.expandAll(),a.selectNodeTree(a.cbaConfig.topicId)):
msgShowError("",d.getError())}});a.getTxtCerca().focus()},destroy:function(){eliminaStore(this.storeCorrelati);eliminaStore(this.storeTopic)}});Ext.define("Help.store.Correlati",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"topicId"},{name:"relatedId"},{name:"viewOrder"},{name:"title"}],proxy:{type:"ajax",url:"/cba/gen/ws/hlp/rltpc/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Help.store.Topic",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"parentId"},{name:"name"},{name:"text"},{name:"order"},{name:"area"}],proxy:{type:"ajax",url:"/cba/gen/ws/hlp/tpc/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Help.store.TopicSearch",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"parentId"},{name:"name"},{name:"text"},{name:"order"},{name:"area"}],proxy:{type:"ajax",url:"/cba/gen/ws/hlp/tpc/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Help.store.Tree",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"id"},{name:"area"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/hlp/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Help.view.Help",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"vbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"toolbar",items:[{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:250,enableKeyEvents:!0},{xtype:"button",text:"CERCA",itemId:"BtnCerca",reference:"BtnCerca",iconCls:"icon-ricerca",scale:"large"},{xtype:"tbspacer",flex:1},{xtype:"tbspacer",width:30},{xtype:"button",text:"INDIETRO",itemId:"BtnIndietro",reference:"BtnIndietro",
disabled:!0,iconCls:"icon-indietro",scale:"large"},{xtype:"button",text:"AVANTI",itemId:"BtnAvanti",reference:"BtnAvanti",disabled:!0,iconCls:"icon-avanti",scale:"large"},{xtype:"button",text:"STAMPA",itemId:"BtnStampa",reference:"BtnStampa",disabled:!0,hidden:!0,iconCls:"icon-stampa32",scale:"large"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-esci32",scale:"large",text:"ESCI"}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"tabpanel",itemId:"TabRicerca",
reference:"TabRicerca",collapsible:!0,collapseDirection:"left",width:250,items:[{xtype:"panel",title:"INDICE",layout:{type:"fit"},items:[{xtype:"treepanel",itemId:"TreeIndice",reference:"TreeIndice",border:0,rootVisible:!1,store:Ext.create("Help.store.Tree"),viewConfig:{loadMask:!1}}]},{xtype:"gridpanel",title:"RISULTATI_RICERCA",itemId:"GridTopic",reference:"GridTopic",store:Ext.create("Help.store.TopicSearch"),columns:[{xtype:"gridcolumn",dataIndex:"name",text:"ARGOMENTI",flex:1}],viewConfig:{loadMask:!1}}]},
{xtype:"panel",flex:1,itemId:"PnlTopic",reference:"PnlTopic",autoScroll:!0},{xtype:"panel",itemId:"Correlati",reference:"Correlati",title:"CORRELATI",width:150,autoScroll:!0,collapsible:!0,collapseDirection:"right",layout:{type:"vbox",padding:"5"}}]}]});this.callParent(arguments)}});
Ext.define("Generali.imports.controller.ImportBancheSportelli",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Paginatore",selector:this.selContainer+"#Paginatore"},{ref:"BtnElabora",selector:this.selContainer+"#BtnElabora"},{ref:"ParametriImportazione",selector:this.selContainer+"#ParametriImportazione"},{ref:"FormAllegato",selector:this.selContainer+"#FormAllegato"},{ref:"FileSelect",selector:this.selContainer+
"#FileSelect"},{ref:"BtnSelezionaFile",selector:this.selContainer+"#BtnSelezionaFile"},{ref:"TxtLog",selector:this.selContainer+"#TxtLog"},{ref:"ChbinvalidaRkPrecedenti",selector:this.selContainer+"#ChbinvalidaRkPrecedenti"}]);this.control(this.selContainer+"#BtnSelezionaFile",{change:this.selezionaFile});this.control(this.selContainer+"#BtnElabora",{click:this.elaboraButton})},selezionaFile:function(a,b,c,d){a.up("form");this.formAllegato=this.getFormAllegato();this.getBtnElabora().setDisabled(!this.formAllegato)},
disabilitaElabora:function(a){this.getBtnElabora().setDisabled(a||"S"!=this.cbaConfig.permesso)},elaboraButton:function(){var a,b;a=newIdElab();b=this.getChbinvalidaRkPrecedenti().getValue();this.submitAllegato(a,b)},submitAllegato:function(a,b,c){c=void 0===c?!0:c;var d=this,e;e="/cba/gen/ws/general/banca/import?idAvanzamentoElaborazione="+a+"&invalidaRkPrecedenti="+(b?"T":"F")+("&isSimulazione="+(c?"T":"F"));d.getTxtLog().setValue("");var g=d.getFileSelect();g.clearOnSubmit=!c;Ext.create("winElaborazione",
{height:135,idElaborazione:a,afterAnnulla:Ext.bind(d.afterAnnulla,d)}).start();a=g.fileInputEl.dom.files[0];g=new FormData;g.append("file",a);Ext.Ajax.request({url:e,method:"POST",rawData:g,headers:{"Content-Type":null},success:function(a){a=Ext.JSON.decode(a.responseText);controllaWinElaborazione();a.success?c?d.submitAllegato(newIdElab(),b,!1):msgShow("IMPORTAZIONE_DATI",a.message):(msgShowError("",a.message),Ext.isEmpty(a.data)?d.getTxtLog().setValue(""):a.data.forEach(function(a){var b=d.getTxtLog().getValue();
d.getTxtLog().setValue(b+"\n"+a.testo)}))}})},afterAnnulla:function(){this.disabilitaElabora(!1)},onLaunch:function(){this.getPaginatore();this.tipoDato="";this.disabilitaElabora(!1);this.idOrganizzazione=getIdOrg()},destroy:function(){this.callParent()}});
Ext.define("Generali.imports.view.ImportBancheSportelli",{extend:"Generali.standard.ControlledContainer",uses:["Ext.selection.CheckboxModel","winElaborazione","Generali.imports.controller.ImportBancheSportelli"],initComponent:function(){Ext.applyIf(this,{layout:{type:"vbox",align:"stretch"},items:[{xtype:"tabpanel",itemId:"Paginatore",reference:"Paginatore",flex:1,tabBar:{height:48,items:[{xtype:"tbfill"},{xtype:"toolbar",border:0,items:[{xtype:"tbspacer",width:10},{xtype:"button",itemId:"BtnElabora",
reference:"BtnElabora",iconCls:"icon-elabora32",scale:"large",text:"ELABORA"}]}]},items:[{xtype:"container",itemId:"ParametriImportazione",reference:"ParametriImportazione",border:0,tabConfig:{title:"IMPORTAZIONE_DATI",height:44},layout:"vbox",items:[{xtype:"container",itemId:"AltriParameri",reference:"AltriParameri",border:!1,width:800,padding:5,fieldDefaults:{flex:1,margin:"5 5 5 5"},layout:{type:"vbox",align:"stretch"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"INVALIDA_PRECEDENTI",
inputValue:"T",uncheckedValue:"F",name:"attivo",itemId:"ChbinvalidaRkPrecedenti",reference:"ChbinvalidaRkPrecedenti",width:100,cls:"cbaLabel"}]},{xtype:"form",itemId:"FormAllegato",reference:"FormAllegato",border:!1,width:800,padding:5,fieldDefaults:{flex:1,margin:"5 5 5 5"},layout:{type:"vbox",align:"stretch"},items:[{xtype:"filefield",fieldLabel:"SELEZIONA_BANCHE_CSV",labelWidth:250,labelClsExtra:"cbaLabel",msgTarget:"side",allowBlank:!1,anchor:"100%",itemId:"FileSelect",reference:"FileSelect",
baseCls:"cba-button-25",buttonOnly:!1,name:"fileData",buttonConfig:{xtype:"filebutton",margin:"0 0 1 0",cls:"cba-button-25",alwaysOnTop:!0,itemId:"BtnSelezionaFile",reference:"BtnSelezionaFile",text:traduci("SELEZIONA_FILE"),iconCls:"icon-csv"},listeners:{change:function(a,b){if(b){var c=b.replace(/C:\\fakepath\\/g,""),d=c.lastIndexOf("."),d=c.substr(d+1,c.length-d),e=c.lastIndexOf("\\"),c=c.substring(e+1),e=["csv"];Ext.Array.contains(e,d)?a.setRawValue(c):(a.setActiveError(traduci("MSG_SELEZIONE_TIPI_FILE_AMMESSI")+
e.join()),Ext.MessageBox.show({title:traduci("FILE_TYPE_ERROR"),msg:traduci("MSG_SELEZIONE_TIPI_FILE_AMMESSI")+e.join(),buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR}),a.setRawValue(null))}}}}]},{xtype:"container",layout:"anchor",flex:1,margin:0,defaults:{margin:0},layout:{type:"vbox",align:"stretch"},items:[{xtype:"textarea",itemId:"TxtLog",reference:"TxtLog",reference:"TxtLog",autoScroll:!0,readOnly:!0,width:1E3,height:600}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.modelliJson.controller.ModelliJson",{extend:"Generali.standard.ViewController",init:function(){this.callParent(arguments);this.addRef([])},onSelectionChangeTreePanel:function(a,b){var c=this.lookup("CntDetail"),d=b&&b[0];c.setHidden(!d);if(!d)return!1;var d=d.getData(),c=d.idModello,d=d.idVersione,e=0,c=d||c;d&&(e=1);this.getCardLayout().setActiveItem(e);c&&this.getControllerActiveItem().fetchData(c)},getControllerActiveItem:function(){return this.getCardLayout().getActiveItem().controller},
getCardLayout:function(){return this.lookup("CntDetail").layout},onItemClickTreePanel:function(a,b,c,d,e,g){"cba-display-none"==e.target.className&&(a=b.getData().idModello,this.getCardLayout().setActiveItem(a?1:0),this.getControllerActiveItem().newRecord(b.getData()))},getTotalToSync:function(){var a=this.lookup("LblInfoSync"),b=this.lookup("CntInfoSync");Ext.Ajax.request({method:"GET",url:getUrlGen()+"/ws/formio/modelli/versioni/totaltosync",params:{modulo:this.idModuloSipcar},success:function(c){c=
Ext.JSON.decode(c.responseText);var d=c.message,e=c.data;c.success?(b.setHidden(!e||e&&0==e.length),e&&0<e.length&&a.setHtml(Ext.String.format(traduci("FORMIO_INFO_DA_INSERIRE"),e.length))):msgShowError("",d)}})},aggiornaStore:function(a,b,c){b=void 0===b?null:b;c=void 0===c?{}:c;var d=this,e=this.lookup("Tree");a={modulo:this.idModuloSipcar,filtraOrgAmm:isAmministratoreOrg()};var g=Object.assign({idOrg:null},a,c);this.populateFilterTags(g);c.idOrg||delete c.idOrg;Object.assign(a,c);e.getStore().load({params:a,
callback:function(a,c,g){if(g){Ext.suspendLayouts();e.expandAll();Ext.resumeLayouts(!0);a=null;b&&(a=trovaRecord(e.getStore(),"idVersione",b));e.getSelectionModel().deselectAll();e.getSelectionModel().select(a?a:0);var h=a&&a.get("idModello");d.getTotalToSync();h&&(Ext.suspendLayouts(),e.getRootNode().cascadeBy(function(a){Ext.isEmpty(a.get("idModello"))||a.get("idModello")==h||a.collapse()}),Ext.resumeLayouts(!0))}}})},onChangeSearchField:function(a,b,c){var d=this;(a=this.lookup("Tree"))&&a.getStore().getData().filterBy(function(a){a&&
(a.set("text",a.get("text")+" "),d.cycleTreeNode(a,b,!1))})},onClickBtnFilter:function(a){var b=this;this.winRicerca?this.winRicerca.show():this.winRicerca=Ext.create("winCBA",{name:"Generali.modelliJson.view.ModelliJson_Filter",titolo:"FILTRO",closable:!1,maximizable:!1,altezzaWin:300,larghezzaWin:500,configItem:{ctrlMain:this,callBackOnConferma:function(a){return b.aggiornaStore(null,null,a)}}}).showBy(a,"br")},cycleTreeNode:function(a,b,c){var d=this;a.childNodes.forEach(function(a){if(a.isLeaf())a.parentNode.isVisible()||
a.set("visible",c);else{var e=0<=a.getData().appoText.toLowerCase().indexOf(b.toLowerCase());a.set("visible",e);d.cycleTreeNode(a,b,e)}})},manualSync:function(){var a=this;this.startSync();Ext.Ajax.request({method:"GET",url:getUrlGen()+"/ws/formio/modelli/versioni/sync",params:{hideInizioAttesa:!0,modulo:this.idModuloSipcar},success:function(b){var c=Ext.JSON.decode(b.responseText);b=c.message;var d=c.success,c=c.data;a.stopSync();if(d){var e="Niente da aggiornare!";c&&0<c.length&&(e="<b>"+traduci("FORMIO_STATO_AGGIORNAMENTO")+
":</b> <ul>",c.forEach(function(a){e+='<li><span style="color: '+(2==a.tipo?"red":"green")+'">'+a.testo+"</span></li>"}),e+="</ul>");Messaggio("ATTENZIONE",e,"OK","QUESTION",function(){a.aggiornaStore()})}else msgShowError("",b)},failure:function(){return a.stopSync()}})},startSync:function(){this.lookup("CntIndicator").show()},stopSync:function(){this.lookup("CntIndicator").hide()},onAfterrenderImgInfoSync:function(a){var b=this;a.getEl().on("click",function(){b.manualSync()})},generateView:function(a){a=
void 0===a?"":a;var b=this;Ext.suspendLayouts(!0);return new Promise(function(c,d){b.lookup("CntDetail").add(Ext.create("Generali.modelliJson.view.ModelliJson_"+a,{cbaConfig:{controllerTree:b,idModuloSipcar:b.idModuloSipcar,getRecordSel:function(){return tree.getSelectionModel().getSelection()[0]},callBackFn:function(){return c(!0)}}}));Ext.resumeLayouts(!0)})},onClickChipElement:function(){this.lookup("BtnFilter").fireHandler()},populateFilterTags:function(a){a=void 0===a?{}:a;var b=this,c=this.lookup("CntTags"),
d="",e;for(e in a){var g=this.translateObj[e];g&&(d+='\n\t\t\t\t<div style="\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tmargin-left: 3px;\n\t\t\t\t\tbackground-color: #e0e0e0;\n\t\t\t\t\tcolor: rgba(0,0,0,.87);\n\t\t\t\t\tborder-radius: 16px;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tpadding: 3px;">\n\t\t\t\t\t<div class="edit-filter" style="\n\t\t\t\t\t\tbackground: #FFF;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t\twidth: 24px;\n\t\t\t\t\t\theight: 24px;\n\t\t\t\t\t\t text-align: center;">\n\t\t\t\t\t\t\t<img src ="/cba/generali/images/svg/others/edit.svg" width="15"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span style="margin-left:4px;">\n\t\t\t\t\t\t'+
g.value(a[e])+"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t")}c.setHtml(d);(a=c.getEl().dom.querySelectorAll(".edit-filter"))&&0<a.length&&a.forEach(function(a){return a.addEventListener("click",b.onClickChipElement.bind(b))})},getDescrModulo:function(){var a=this;return Sipcar.app.getController("Login").storeModuli.getData().items.filter(function(b){return b.get("codice")==a.idModuloSipcar})[0]},onLaunch:function(){var a=this;ImpostaUrl(this.lookup("Tree").getStore());this.idModuloSipcar=CBA.moduli.moduloAttivo;
this.lookup("SearchModello").on("change",Ext.Function.createBuffered(this.onChangeSearchField.bind(this),300,this));this.translateObj={modulo:{value:function(){var b=a.getDescrModulo(),c="";b&&(c=b.getData().valore);return c}},idOrg:{value:function(b){return null!=b?a.winRicerca.down("[reference=CboxOrg]").getSelection().getData().valore:traduci("FORMIO_TUTTE_LE_ORG")}}};this.generateView("Modello").then(function(){return a.generateView("Versione").then(function(){return a.aggiornaStore()})})},destroy:function(){}});
Ext.define("Generali.modelliJson.controller.ModelliJson_Filter",{extend:"Generali.standard.ViewController",init:function(){this.callParent(arguments);this.addRef([])},onClickBtnConferma:function(){var a=this.cbaConfig,a=void 0===a.callBackOnConferma?function(){return null}:a.callBackOnConferma,b=this.lookup("Form").getForm().getFieldValues();a(b);this.getView().up("window").hide()},onLaunch:function(){this.lookup("CboxOrg").getStore().load({params:{filtraOrgAutor:isAmministratoreOrg()}})},destroy:function(){}});
Ext.define("Generali.modelliJson.controller.ModelliJson_Main",{extend:"Generali.standard.ViewController",init:function(){this.callParent(arguments);this.addRef([])},onLaunch:function(){var a=this;CBA.parametriGenerali.produzione&&(49==CBA.moduli.moduloAttivo?Ext.Ajax.request({method:"GET",url:"/cba/css/cs/ws/dossier/impostazioni/get",success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];b.success?"T"!=b.data.formIO&&Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(b){b||
a.getView().destroy()}}).show():(msgAddError(c,b.message),msgShow("",c))}}):59!=CBA.moduli.moduloAttivo&&Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(b){b||a.getView().destroy()}}).show());this.lookup("TabModelli").add(Ext.create("Generali.modelliJson.view.ModelliJson",{}));this.lookup("TabFormioBuilder").add({xtype:"CBAFormio",builder:!0})},destroy:function(){}});
Ext.define("Generali.modelliJson.controller.ModelliJson_Modello",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"}])},isValidId:function(a){return null!=a&&0<a},gestioneForm:function(){var a=this,b=this.lookup("Form");b.boxBottoni=this.lookup("BoxBottoni");this.storeForm=b.store=Ext.create("Generali.modelliJson.store.ModelliJson_Modello");ImpostaUrl(this.storeForm);
b.controller=this;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},nuovo_callback:function(){containerSolaLettura(b,!1);controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)?Messaggio("ATTENZIONE","NESSUNA_REGISTRAZIONE_SELEZIONATA","OK","QUESTION"):controller_eliminaRecord(b.store,{id:c},function(){return a.aggiornaStore(c)},!1)},annulla_callback:function(){var c=
b.getForm().findField("id").getValue();a.fetchData(c)},verificaCampiForm_callback:function(){return a.verificaCampiForm()},noIcon:!0}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();var d=this.lookup("ContainerMain");b.getForm().on("dirtychange",function(c,g){var e=a.lookup("Form").getForm().findField("id").getValue();IsolaCmp(d,g);controller_abilitaBottoni(b);g&&!a.isValidId(e)&&b.isValid()})},verificaCampiForm:function(){var a=
[],b=this.lookup("Form"),c=this.lookup("CBAFormio");b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");c&&null==c.getSchema()&&msgAddError(a,"FORMIO_MSG_SCHEMA_FORM_OBBLIGATORIO");return msgShow("",a)},salvaForm:function(){var a=this.lookup("Form"),b=a.getForm().getFieldValues(),c=this.controllerVersione.lookup("CBAFormio");delete b._dirty;var d=b.id;Object.assign(b,{idModulo:this.cbaConfig.idModuloSipcar});this.isValidId(d)||Object.assign(b,{custom:"T",versioni:[{jsonSchema:JSON.stringify(c.getSchema())}]});
controller_salvaRecord(a,b)},loadCboxOrg:function(){var a=this.lookup("CboxOrg").getStore();return new Promise(function(b,c){a.load({params:{filtraOrgAutor:isAmministratoreOrg()},callback:function(a,e,g){g?b():c()}})})},loadCboxPortlet:function(){if(49!=CBA.moduli.moduloAttivo)return Promise.resolve();var a=this.lookup("CboxPortlet").getStore();return new Promise(function(b,c){a.load({params:{idProfiloCss:CBA.parametriGenerali.idProfiloCss},callback:function(a,e,g){g?b():c()}})})},newRecord:function(a){a=
this.lookup("Form");var b=this.lookup("CntInsertVersione");clearForm(a);containerSolaLettura(a,!1);controller_nuovoRecord(a);a.getForm().setValues({});this.lookup("LblInfoVersione").setHtml(null);b.show();this.controllerVersione.insertFormioForm(null)},loadModelloInfo:function(a){var b=this;Ext.Ajax.request({method:"GET",url:getUrlGen()+"/ws/formio/modelli/infover",params:{id:a},success:function(a){var c=Ext.JSON.decode(a.responseText),e=c.message;a=c.data;if(c.success){var c=b.lookup("LblInfoVersione"),
e=a.custom,g=a.numVersione;a=a.dataVersione;a='\n\t\t\t\t\t\t<div style="display: flex; flex-direction: column; line-height: 2 !important;" class="cbaLabel">\n\t\t\t\t\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t\t\t\t\t\t<div style="width: 220px;">'+traduci("FORMIO_ULTIMA_VERSIONE")+': </div> \n\t\t\t\t\t\t\t\t<div style="width: 50px;">v.'+g+'</div>\n\t\t\t\t\t\t\t\t<div style="width: 50px;">'+traduci("DEL")+": </div>\n\t\t\t\t\t\t\t\t<div>"+(new moment(a)).format("DD/MM/YYYY")+
'</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t\t\t\t\t\t<div style="width: 220px;">'+traduci("FORMIO_TIPO_VERSIONE")+": </div> \n\t\t\t\t\t\t\t\t<div>"+("T"==e?"CUSTOM":"SISTEMA")+"</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t";c.setHtml(a)}else msgShowError("",e)}})},fetchData:function(a){a=void 0===a?null:a;var b=this,c=this.lookup("Form"),d=c.getForm(),e=c.store,g=this.cbaConfig.controllerTree;clearForm(c);this.lookup("CntInsertVersione").hide();
this.isValidId(a)?e.load({params:{id:a},callback:function(e,g,l){l&&!Ext.isEmpty(e)&&(d.loadRecord(e[0]),b.loadModelloInfo(a),containerSolaLettura(c,!0))}}):g.lookup("Tree").getSelectionModel().deselectAll()},aggiornaStore:function(a,b){a=void 0===a?null:a;b=void 0===b?{}:b;clearForm(this.lookup("Form"));this.fetchData(a);this.cbaConfig.controllerTree.aggiornaStore(null,b&&b.data?b.data.idVerToSel:null)},onLaunch:function(){var a=this.cbaConfig.callBackFn,b=this.lookup("CntInsertVersione");this.gestioneForm();
Promise.all([this.loadCboxOrg(),this.loadCboxPortlet()]).then(function(){a()})["catch"](function(a){return console.error("Exception in function onLaunch when fetching "+a)});this.controllerVersione=b.add(Ext.create("Generali.modelliJson.view.ModelliJson_Versione",{layout:{type:"vbox",align:"stretch"},cbaConfig:{controllerModello:this,insertFromModello:!0}})).lookupController();59==CBA.moduli.moduloAttivo&&this.lookup("CboxPortlet").setVisible(!1)},destroy:function(){eliminaStore(this.storeForm)}});
Ext.define("Generali.modelliJson.controller.ModelliJson_Versione",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"}])},isValidId:function(a){return null!=a&&0<a},gestioneForm:function(){var a=this,b=this.lookup("Form"),c=this;b.boxBottoni=this.lookup("BoxBottoni");this.storeForm=b.store=Ext.create("Generali.modelliJson.store.ModelliJson_Versione");
ImpostaUrl(this.storeForm);b.controller=this;var d=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(!1)},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)?Messaggio("ATTENZIONE","NESSUNA_REGISTRAZIONE_SELEZIONATA","OK","QUESTION"):controller_eliminaRecord(b.store,{id:c},function(){return a.aggiornaStore(c)},!1)},annulla_callback:function(){var c=
b.getForm().findField("id").getValue();a.fetchData(c)},verificaCampiForm_callback:function(){return a.verificaCampiForm()},noIcon:!0}});inserisciBottoni(b.boxBottoni,d,!0);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();if(CBA.parametriGenerali.amministratore&&"T"==CBA.parametriGenerali.amministratore){var e=Ext.create("Ext.Button",{text:"Hard delete",handler:function(){Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(a){if(a){var d=
b.getForm().findField("id").getValue();Ext.Ajax.request({method:"GET",async:!1,url:getUrlGen()+"/ws/formio/modelli/versioni/harddelete",params:{id:d},success:function(a){a=Ext.JSON.decode(a.responseText);var b=a.message;a.success?c.aggiornaStore(d):msgShowError("",b)}})}else msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()}});b.boxBottoni.add(e)}b.boxBottoni.add(d);var g=this.lookup("ContainerMain");b.getForm().on("dirtychange",function(c,d){var e=a.lookup("Form").getForm().findField("id").getValue();
IsolaCmp(g,d);controller_abilitaBottoni(b);d&&!a.isValidId(e)&&b.isValid()})},newRecord:function(a){var b=this.lookup("Form");clearForm(b);controller_nuovoRecord(b);b.getForm().setValues({idModello:a.idModello});this.lookup("BtnAttach").show();this.lookup("FieldsetPreview").show();this.lookup("LblInfoModello").setHtml(null);this.insertFormioForm()},getLastVersioneModello:function(a){a=void 0===a?null:a;var b=0;Ext.Ajax.request({method:"GET",async:!1,url:getUrlGen()+"/ws/formio/modelli/versioni/max",
params:{idModello:a},success:function(a){a=Ext.JSON.decode(a.responseText);var c=a.message,e=a.data;a.success?b=e:msgShowError("",c)}});return b},insertFormioForm:function(a){a=void 0===a?null:a;var b=this.lookup("FieldsetPreview"),c=b.down("CBAFormio");b.show();a?c.makeFormioForm(a,function(){return c.readOnly(!0)}):c.clearFormio()},loadModelloInfo:function(a){a=void 0===a?null:a;var b=this.lookup("LblInfoModello"),c=a;a=c.versione;var c=c.data,d=this.cbaConfig.controllerTree.lookup("Tree").getSelectionModel().getSelection()[0];
if(d&&d.parentNode){var e=d.parentNode.getData(),d=e.text,e=e.custom;a='\n\t\t\t\t<div style="display: flex; flex-direction: column; line-height: 2 !important;" class="cbaLabel">\n\t\t\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t\t\t\t<div style="width: 220px;">'+traduci("FORMIO_MODELLO_RIF")+": </div> \n\t\t\t\t\t\t<div>"+d+'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t\t\t\t<div style="width: 220px;">'+traduci("FORMIO_VERSIONE")+
': </div> \n\t\t\t\t\t\t<div style="width: 50px;">v.'+a+'</div>\n\t\t\t\t\t\t<div style="width: 50px;">'+traduci("DEL")+": </div>\n\t\t\t\t\t\t<div>"+(new moment(c)).format("DD/MM/YYYY")+'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style="display: flex; flex-direction: row;">\n\t\t\t\t\t\t<div style="width: 220px;">'+traduci("FORMIO_TIPO_VERSIONE")+": </div> \n\t\t\t\t\t\t<div>"+("T"==e?"CUSTOM":"SISTEMA")+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t";b.setHtml(a)}},fetchData:function(a){a=void 0===
a?null:a;var b=this,c=this.lookup("Form"),d=c.getForm(),e=c.store;clearForm(c);c=this.cbaConfig.controllerTree;this.isValidId(a)?e.load({params:{id:a},callback:function(a,c,e){e&&!Ext.isEmpty(a)&&(a=a[0],d.loadRecord(a),b.loadModelloInfo(a.getData()),b.lookup("BtnAttach").hide(),b.lookup("FieldsetPreview").show(),b.insertFormioForm(Ext.JSON.decode(a.get("jsonSchema"))))}}):c.lookup("Tree").getSelectionModel().deselectAll()},onChangeFileField:function(a){var b=this;a=a.getEl().down("input[type=file]");
var c=this.cbaConfig,d=c.controllerModello,c=void 0===c.insertFromModello?!1:c.insertFromModello;if(a){var e=new FileReader;e.onload=function(a){b.insertFormioForm(Ext.JSON.decode(a.target.result))};e.readAsText(a.dom.files[0]);c&&d.lookup("CmpDirty").setValue(1)}},verificaCampiForm:function(){var a=[];this.lookup("Form").isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(){if(this.cbaConfig.insertFromModello)return!1;var a=this.lookup("Form"),b=a.getForm().getFieldValues(),
c=this.lookup("CBAFormio");delete b._dirty;Object.assign(b,{jsonSchema:JSON.stringify(c.getSchema())});controller_salvaRecord(a,b)},aggiornaStore:function(a){a=void 0===a?null:a;clearForm(this.lookup("Form"));this.fetchData(a);this.cbaConfig.controllerTree.aggiornaStore(null,a)},onLaunch:function(){this.gestioneForm();var a=this.cbaConfig,b=void 0===a.callBackFn?function(){return null}:a.callBackFn;(void 0===a.insertFromModello?0:a.insertFromModello)&&this.lookup("BoxBottoni").hide();b()},destroy:function(){eliminaStore(this.storeForm)}});
Ext.define("Generali.modelliJson.store.ListaPortlet",{extend:"Generali.data.Store",fields:[{name:"id"},{name:"descrizione"},{name:"descrizioneFormatted",convert:function(a,b){return traduci(b.get("descrizione"))}},{name:"abilitato"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/pwd/profilipwddecss/portlet/tipo",api:{read:"/cba/gen/ws/pwd/profilipwddecss/portlet/tipo"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.modelliJson.store.ModelliJson",{extend:"Ext.data.TreeStore",fields:[{name:"text"},{name:"appoText",convert:function(a,b){var c=b.get("text");b.get("versione")&&(c="v."+b.get("versione")+" del  "+(null==b.get("dataVersione")?'<span style="color: red;"><b>('+traduci("FORMIO_DA_INSERIRE")+")</b></span>":FormattaData(b.get("dataVersione"))));return c}},{name:"leaf"},{name:"iconCls"},{name:"children"},{name:"level"},{name:"nodId"},{name:"codice"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",
method:"GET",urlGen:"/ws/formio/modelli/tree",api:{read:"*"},reader:{type:"json",messageProperty:"message",rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.modelliJson.store.ModelliJson_Modello",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idModello"},{name:"versione"},{name:"jsonSchema"},{name:"data",type:"date"}],proxy:{type:"ajax",method:"GET",urlGen:"/ws/formio/modelli/get",url:"ws/formio/modelli/get",api:{read:".",create:".",update:".",destroy:"."},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0,autoLoad:!1});
Ext.define("Generali.modelliJson.store.ModelliJson_Versione",{extend:"Ext.data.Store",fields:[],proxy:{type:"ajax",method:"GET",urlGen:"/ws/formio/modelli/versioni/get",url:"/cba/gen/ws/formio/modelli/versioni/get",api:{read:".",create:".",update:".",destroy:"."},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0,autoLoad:!1});
Ext.define("Generali.modelliJson.view.ModelliJson",{extend:"Generali.standard.ControlledContainer",uses:["Generali.modelliJson.store.ModelliJson","Generali.modelliJson.view.ModelliJson_Versione","Generali.modelliJson.view.ModelliJson_Modello"],layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",reference:"CntMain",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"container",reference:"CntIndicator",hidden:!0,html:'\n\t\t\t\t\t\t\t<div class="main-indicator">\n\t\t\t\t\t\t\t\t<div class="cnt-indicator">\n\t\t\t\t\t\t\t\t\t<div class="lds-dual-ring">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t'+
traduci("FORMIO_TEXT_INDICATOR")+"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>"},{xtype:"container",layout:{type:"vbox",align:"stretch"},width:400,padding:3,style:{borderRight:"1px solid #bbb !important;"},items:[{xtype:"container",padding:4,layout:{type:"vbox",align:"stretch"},style:{boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",marginBottom:"10px;"},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"textfield",emptyText:traduci("CERCA")+"...",
reference:"SearchModello"},{xtype:"container",flex:1},{xtype:"button",reference:"BtnFilter",iconCls:"icon-filter-disabled",scale:"medium",style:"border-color:transparent !important;background: transparent !important;",listeners:{click:"onClickBtnFilter"}}]},{xtype:"label",cls:"cbaGrassetto",text:traduci("FILTRI")+":"},{xtype:"label",reference:"CntTags",style:"display: flex;"}]},{xtype:"treepanel",flex:1,border:!1,itemId:"Tree",reference:"Tree",store:Ext.create("Generali.modelliJson.store.ModelliJson"),
useArrows:!0,header:!1,rootVisible:!1,viewConfig:{loadMask:!1},columns:[{xtype:"treecolumn",title:"DESCRIZIONE",dataIndex:"appoText",flex:1,renderer:function(a,b,c){if((null==c.get("custom")||"F"==c.get("custom"))&&null!=c.get("nodeId"))return a;b.tdCls=c.get("versione")?"":"cba-display-block";return"\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+a+'\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="show-tooltip">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="tooltip-text">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'+
(null==c.get("nodeId")?"Nuovo modello":"Nuova versione")+'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talign="right" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass="cba-display-none"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc="/cba/generali/images/svg/buttons/insert.svg" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt="fast menu" \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth="16"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t'}}],dockedItems:[{xtype:"toolbar",
dock:"top",hidden:!0,reference:"CntInfoSync",items:[{xtype:"container",layout:{type:"hbox",align:"middle"},items:[{xtype:"label",reference:"LblInfoSync"},{xtype:"image",cls:"animated infinite rotateIn delay-2s zoom",width:32,src:"/cba/generali/images/svg/buttons/change.svg",listeners:{afterrender:"onAfterrenderImgInfoSync"}}]}]}],listeners:{itemclick:"onItemClickTreePanel",selectionchange:"onSelectionChangeTreePanel"}}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,padding:4,items:[{xtype:"panel",
hidden:!0,border:!1,reference:"CntDetail",layout:{type:"card",align:"stretch"},flex:1}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.modelliJson.view.ModelliJson_Filter",{extend:"Generali.standard.ControlledContainer",uses:["Generali.modelliJson.controller.ModelliJson_Filter"],layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){var a=this;Ext.applyIf(this,{items:[{xtype:"panel",reference:"ContainerMain",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"form",margin:"8 0 0 0",padding:6,border:!1,reference:"Form",trackResetOnLoad:!0,layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"fieldset",
padding:6,items:[{xtype:"combobox",width:300,margin:"5 0 0 0",emptyText:"FORMIO_TUTTE_LE_ORG",reference:"CboxOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg",{}),queryMode:"local",minChars:0,displayField:"valore",valueField:"codice",fieldLabel:"ORGANIZZAZIONE",name:"idOrg"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"container",layout:{type:"hbox"},defaults:{margin:"0 0 0 4"},items:[{xtype:"button",cls:"cba-button-25",text:"CONFERMA",listeners:{click:"onClickBtnConferma"}},
{xtype:"button",cls:"cba-button-25",text:"ESCI",listeners:{click:function(){return a.up("window").hide()}}}]}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.modelliJson.view.ModelliJson_Main",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"tabpanel",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"panel",title:"FORMIO_MODELLI_PERSONALIZZATI",reference:"TabModelli",layout:{type:"vbox",align:"stretch"},flex:1},{xtype:"panel",title:"FORMIO_FORM_BUILDER",reference:"TabFormioBuilder",layout:{type:"vbox",align:"stretch"},flex:1}]}]});
this.callParent(arguments)}});
Ext.define("Generali.modelliJson.view.ModelliJson_Modello",{extend:"Generali.standard.ControlledContainer",uses:["CbaUtils.componenti.desktop.CBAFormio","Generali.gestPwdNew.store.ElencoOrg","Generali.standard.controller_PannelloBottoni","Generali.modelliJson.store.ModelliJson_Modello","Generali.modelliJson.controller.ModelliJson_Modello"],layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",reference:"ContainerMain",layout:{type:"vbox",
align:"stretch"},flex:1,items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",margin:"2 2 0 0"},{xtype:"form",margin:"8 0 0 0",padding:6,border:!1,reference:"Form",trackResetOnLoad:!0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"codVideata"},{xtype:"textfield",reference:"CmpDirty",hidden:!0,name:"_dirty"},{xtype:"fieldset",padding:4,reference:"FieldsetDatiGenerali",layout:{type:"vbox",align:"stretch"},title:"Dati generali modello",
items:[{xtype:"textfield",fieldLabel:"DESCRIZIONE",reference:"Descrizione",allowBlank:!1,name:"descrizione"},{xtype:"combobox",margin:"5 0 0 0",emptyText:"FORMIO_TUTTE_LE_ORG",reference:"CboxOrg",store:Ext.create("Generali.gestPwdNew.store.ListaOrg",{}),queryMode:"local",minChars:0,displayField:"valore",valueField:"codice",fieldLabel:"ORGANIZZAZIONE",name:"idOrgCustom"},{xtype:"combobox",margin:"5 0 0 0",emptyText:"FORMIO_SCELTA_PORTLET",reference:"CboxPortlet",store:Ext.create("Generali.modelliJson.store.ListaPortlet",
{}),queryMode:"local",minChars:0,displayField:"descrizioneFormatted",valueField:"id",fieldLabel:"PORTLET",name:"idPortletCustom"},{xtype:"label",margin:"8 0 0 0",reference:"LblInfoVersione"}]}]},{xtype:"container",flex:1,hidden:!0,layout:{type:"vbox",align:"stretch"},reference:"CntInsertVersione"}]}]});this.callParent(arguments)}});
Ext.define("Generali.modelliJson.view.ModelliJson_Versione",{extend:"Generali.standard.ControlledContainer",uses:["Generali.modelliJson.controller.ModelliJson_Versione","Generali.modelliJson.store.ModelliJson_Modello"],layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",reference:"ContainerMain",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",margin:"2 2 0 0"},{xtype:"form",
margin:"8 0 0 0",padding:6,border:!1,reference:"Form",trackResetOnLoad:!0,layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idModello"},{xtype:"textfield",reference:"CmpDirty",hidden:!0,name:"_dirty"},{xtype:"fieldset",reference:"FieldsetDatiGenerali",layout:{type:"vbox",align:"stretch"},title:"",padding:4,items:[{xtype:"label",reference:"LblInfoModello"},{xtype:"filefield",reference:"BtnAttach",isFormField:!1,name:"jsonSchema",
buttonOnly:!0,buttonText:"Seleziona schema...",listeners:{change:"onChangeFileField"}}]},{xtype:"fieldset",hidden:!0,reference:"FieldsetPreview",margin:"4 0 0 0",layout:{type:"vbox",align:"stretch"},flex:1,title:"Anteprima modello",items:[{xtype:"CBAFormio"}]}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.multiData.controller.MultiData",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridTabella",selector:a.selContainer+"#GridTabella"},{ref:"CbPropAuto",selector:a.selContainer+"#CbPropAuto"},{ref:"BtnNuovo",selector:a.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:a.selContainer+"#BtnElimina"},{ref:"BtnSeleziona",selector:a.selContainer+"#BtnSeleziona"},{ref:"BtnEsci",selector:a.selContainer+
"#BtnEsci"},{ref:"ToolbarFinestra",selector:a.selContainer+"#ToolbarFinestra"},{ref:"TxtCerca",selector:a.selContainer+"#TxtCerca"},{ref:"TipoCliFor",selector:a.selContainer+"#TipoCliFor"},{ref:"CBCliFor",selector:a.selContainer+"#CBCliFor"}]);a.control(a.selContainer+"#GridTabella",{beforeedit:a.beforeeditGridTabella,edit:a.editGridTabella,canceledit:a.canceleditGridTabella,validateedit:a.validateeditGridTabella});a.control(a.selContainer+"#BtnNuovo",{click:a.clickBtnNuovo});a.control(a.selContainer+
"#TipoCliFor",{change:a.filtraCliFor});a.control(a.selContainer+"#BtnElimina",{click:a.clickBtnElimina});a.control(a.selContainer+"#BtnSeleziona",{click:a.conferma});a.control(a.selContainer+"#BtnEsci",{click:a.clickBtnEsci});a.control(a.selContainer+"#TxtCerca",{change:Ext.Function.createBuffered(function(b){var c=a.getGridTabella(),d=c.getStore();d.clearFilter();Ext.isEmpty(b.getValue())||d.filter(function(a){var c=!1;(a=a.get("descrizione"))&&0<=a.toUpperCase().indexOf(b.getValue().toUpperCase())&&
(c=!0);return c});c.getSelectionModel().select(0)},100,a)})},conferma:function(a){var b=this.getGridTabella();this.cbaConfig.callbackSeleziona&&(b=b.getSelectionModel().getSelection()[0],this.cbaConfig.callbackSeleziona(b),a.up("window").close())},clickBtnEsci:function(a){a.up("window").close()},filtraCliFor:function(a,b,c,d){this.getCBCliFor().getStore().load({params:{tipo:b}})},clickBtnNuovo:function(){var a=this.getGridTabella();controller_nuovoRecordGrid({id:null,idOrganizzazione:this.idOrganizzazione,
tipoDato:this.tipoDato},a)},clickBtnElimina:function(){var a=this,b=a.getGridTabella(),c=b.getSelectionModel().getSelection()[0];controller_eliminaRecord(b.getStore(),{id:c?c.get("id"):""},function(){a.aggiornaStore()})},abilitaBottoniGrid:function(a){var b=this.getBtnNuovo(),c=this.getBtnElimina();b.setDisabled(!a);c.setDisabled(!a)},beforeeditGridTabella:function(a,b,c){tipoCliFor=this.getTipoCliFor();if(!0===a.editing)return!1;tipoCliFor.fireEvent("change",tipoCliFor,b.record.get("tipoClienteFornitore"));
this.abilitaBottoniGrid(!1)},canceleditGridTabella:function(a,b,c){a=b.record;this.abilitaBottoniGrid(!0);this.aggiornaStore(a.get("id"))},validateeditGridTabella:function(a,b,c){return msgShow("",[])},editGridTabella:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();Ext.apply(c,{predefinito:getBoolValue(c.predefinito)});if(this.getCbPropAuto().getValue()){var e=this.getGridTabella().getStore();if(e=trovaRecord(e,"predefinito","T"))e=e.data,
e.predefinito="F",controller_salvaRecord(d,e,!1)}controller_salvaRecord(d,c,!1)?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},aggiornaStore:function(a){var b=this.getGridTabella(),c=b.getStore();this.getTxtCerca().setValue(Ext.emptyString);c.load({params:{tipoDato:this.tipoDato,idOrganizzazione:this.idOrganizzazione},callback:function(d,e,g){g?(d=0,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){var a=this.getGridTabella().getStore();
svuotaStore(a)},onLaunch:function(){var a=this.getGridTabella();this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:0;"GENTIPOBENE"==this.cbaConfig.panelType&&(this.tipoDato="TB");"GENNATURA"==this.cbaConfig.panelType&&(this.tipoDato="NB");"GEPROVENIENZA"==this.cbaConfig.panelType&&(this.tipoDato="PR");"GEFINANZIAMENTO"==this.cbaConfig.panelType&&(this.tipoDato="FF");"GECODSIOPE"==this.cbaConfig.panelType&&(this.tipoDato="SP");this.getToolbarFinestra().setVisible(this.cbaConfig.mostraEsci);
a.controller=this;this.aggiornaStore()}});
Ext.define("Generali.multiData.store.MultiData",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"descrizione",sortType:"asUCText"},{name:"predefinito"},{name:"sigla"},{name:"telefono"},{name:"tipoDato"},{name:"tipoClienteFornitore"},{name:"idClienteFornitore"},{name:"desClienteFornitore"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/multiData/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/multiData/list",create:"/cba/gen/ws/general/multiData/insert",
update:"/cba/gen/ws/general/multiData/update",destroy:"/cba/gen/ws/general/multiData/delete"}},autoDestroy:!0});Ext.define("Generali.multiData.store.MultiDataCbox",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/multiData/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.multiData.store.TipoCliFor",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore",convert:function(a,b){return traduci(a)}}],data:[["C","CLIENTE"],["F","FORNITORE"]],autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.multiData.view.MultiData",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a="GEFINANZIAMENTO"!=this.cbaConfig.panelType?!0:!1;Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridTabella",reference:"GridTabella",store:Ext.create("Generali.multiData.store.MultiData"),columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:100,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"TIPO",
dataIndex:"tipoClienteFornitore",sortable:!1,editor:{xtype:"combobox",itemId:"TipoCliFor",reference:"TipoCliFor",allowBlank:!0,displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.multiData.store.TipoCliFor")},renderer:function(a,c,d,e,g,h,k){return"C"==a?traduci("CLIENTE"):"F"==a?traduci("FORNITORE"):null},hidden:a},{xtype:"gridcolumn",text:"RAGIONE_SOCIALE",dataIndex:"idClienteFornitore",sortable:!1,flex:1,editor:{xtype:"combobox",itemId:"CBCliFor",reference:"CBCliFor",
minChars:3,displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.anaCliFor.store.cboxAnaCliFor")},renderer:function(a,c,d,e,g,h,k){return d.get("desClienteFornitore")},hidden:a},{xtype:"actioncolumn",align:"center",sortable:!1,dataIndex:"predefinito",text:"PROPONI_IN_AUTOMATICO",editor:{xtype:"checkboxfield",inputValue:"T",uncheckedValue:"F",itemId:"CbPropAuto",reference:"CbPropAuto"},renderer:function(a,c){renderCheckColumn(c,a)}}],viewConfig:{width:300,loadMask:!1},
plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",itemId:"ToolbarFinestra",reference:"ToolbarFinestra",dock:"top",hidden:!0,height:48,items:[{xtype:"button",itemId:"BtnSeleziona",reference:"BtnSeleziona",iconCls:"icon-ok32",scale:"large",text:"CONFERMA"},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-annulla32",scale:"large",text:"ANNULLA"}]},{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",
iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:200,fieldLabel:"",emptyText:"CERCA"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.nazioni.store.RegoleNazioni",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"tipoRegola"},{name:"codiceFiscaleNazione"},{name:"siglaNazione"},{name:"patternRegola"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/nazioni/regole/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.nazioni.store.cboxNazioniGen",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/nazioni/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.nazioni.store.cboxNazioniIstat",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/nazioni/list/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.notifiche.controller.Notifiche",{extend:"Generali.standard.ViewController",init:function(){var a=this;a.selContainer="#"+a.containerId+" ";a.callParent(arguments);a.addRef([{ref:"GridNotifiche",selector:a.selContainer+"#GridNotifiche"},{ref:"BtnSalva",selector:a.selContainer+"#BtnSalva"},{ref:"ContainerGrid",selector:a.selContainer+"#ContainerGrid"},{ref:"Status",selector:a.selContainer+"#Status"},{ref:"BtnEditNotificheMan",selector:a.selContainer+"#BtnEditNotificheMan"}]);a.control(a.selContainer+
"#BtnEditNotificheMan",{click:a._openNotificheManuali});a.control(a.selContainer+"#BtnSalva",{click:function(){return a.onClickBtnSalva(a.panelExpand)}});a.control(a.selContainer+"#GridNotifiche",{itemdblclick:a.itemdblclickGridNotifiche,selectionchange:a.selectionchangeGridNotifiche})},_openNotificheManuali:function(){this.openNotificheManuali()},openNotificheManuali:function(a){var b=this;StdSipcar.openNotificheManuali(function(){b.getContainerGrid().removeAll();b.buildMenu()},a)},itemdblclickGridNotifiche:function(a,
b){if("F"==b.get("letto"))this.onClickBtnSalva(a.up("panel").up("panel"),b);var c=b.get("commandName");if(c){var d=null;b.get("commandParams")&&(d=b.get("commandParams").split("&"));a.up("window").close();55==b.get("idModulo")&&this.eseguiCmdsModulo55(c,d);48==b.get("idModulo")&&this.eseguiCmdsModulo48(c,d);50==b.get("idModulo")&&this.eseguiCmdsModulo50(c,d);43==b.get("idModulo")&&this.eseguiCmdsModulo43(c,d);44==b.get("idModulo")&&this.eseguiCmdsModulo44(c,b.get("commandParams"));49==b.get("idModulo")&&
this.eseguiCmdsModulo49(c,d);-1==b.get("idModulo")&&this.eseguiCmdsModuloGen(c,d);60==b.get("idModulo")&&this.eseguiCmdsModulo60(c,d)}else"T"==a.up().up().cbaConfig.ntfManuale&&this.openNotificheManuali(b.getData())},selectionchangeGridNotifiche:function(a,b){var c=a.view.up("panel"),d=c.up("panel");this.getBtnSalva().setDisabled(0==b.length);b.length<c.getStore().getData().length&&d.down("checkbox").setValue(!1)},segnaComeNonLetta:function(a,b){var c=this;if("F"==a.get("letto"))return!1;Ext.Ajax.request({method:"POST",
url:"/cba/gen/ws/general/ntf/setNoRead",params:{id:a.get("idNotifica")},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(a=b.queryById("CountTipo").getEl().dom.innerText,""==a&&(a=0),setBadgeText(b.queryById("CountTipo"),Number(a)+1),c.aggiornaGriglia(!0)):msgShowError("",a.message)}})},aggiornaGriglia:function(a,b){if(!a)return!1;var c=this,d=c.panelExpand,e=d.down("CBAShortcutGrid"),g=e.getStore();e.cbaConfig.paged.fromScroll||(svuotaStore(g),Ext.apply(e.cbaConfig.paged,{fromScroll:!1,
maxResults:20}),Ext.apply(g.cbaConfig.parametri,{firstResult:0}));g.cbaConfig.parametri||(g.cbaConfig.parametri={});Ext.apply(g.cbaConfig.parametri,{idOrganizzazione:getIdOrg(),idGroup:45==CBA.moduli.moduloAttivo?getIdGruppo():null,idOperatore:CBA.parametriGenerali.codUtente,tipo:d.cbaConfig.tipoNotifica,maxResult:e.cbaConfig.paged.maxResults,dataDal:moment().add(-7,"days").startOf("day").toDate(),dataAl:moment().add(30,"days").endOf("day").toDate()});Ext.Ajax.request({method:"GET",url:g.getProxy().getUrl(),
async:!0,params:g.cbaConfig.parametri,success:function(a){a=Ext.JSON.decode(a.responseText);var h=a.data;a.success?Ext.isEmpty(h)||(g.loadData(h,!0),Ext.apply(e.cbaConfig.paged,{fromScroll:!1}),c.refreshCountStore(d,h.length),d.down("checkbox").getValue()?e.getSelectionModel().selectAll():e.getSelectionModel().deselectAll(),b&&b()):msgShowError("",a.message)}})},refreshCountStore:function(a,b){Ext.isEmpty(a)||Ext.isEmpty(b)||(this.storeCount[a.cbaConfig.indexStore]=b);this.getStatus().update({count:this.getTotNotifiche()})},
deselectOthers:function(a){var b=a.up();Ext.each(b.items.items,function(b){b.down("checkbox")&&b.getItemId()!=a.getItemId()&&b.down("checkbox").setValue(!1)})},costruisciGriglieNotifiche:function(a){if(!a||0==a.length)return!1;var b=this,c=null,d=null,e=[],g=-1,h=Ext.create("Ext.menu.Menu",{listeners:{beforeshow:function(a){var c="T"==b.panelExpand.down("gridpanel").menuShortcut.record.get("letto");a.down("#SegnaComeLetta").setVisible(!c);a.down("#SegnaComeNonLetta").setVisible(c)}},items:[{text:traduci("NOTIFICHE_SEGNA_COME_LETTA"),
itemId:"SegnaComeLetta",handler:function(a){a=b.panelExpand;b.onClickBtnSalva(a,a.down("gridpanel").menuShortcut.record)}},{text:traduci("NOTIFICHE_SEGNA_COME_NON_LETTA"),itemId:"SegnaComeNonLetta",handler:function(a){a=b.panelExpand;b.segnaComeNonLetta(a.down("gridpanel").menuShortcut.record,a)}}]});b.getContainerGrid().removeAll();b.storeCount=[];Ext.each(a,function(a){g+=1;c=a.valore;d=a.codice;e=a.extra.split(";");a=Ext.create("Ext.panel.Panel",{itemId:"Panel"+d,collapsed:!0,layout:{type:"vbox",
align:"stretch"},height:450,margin:"3 0 0 0",title:c,ui:b.getClasseUiByModulo(e[0]),cbaConfig:{tipoNotifica:a.codice,moduloNotifica:e[0],ntfTot:e[1],ntfNonLette:e[2],indexStore:g,ntfManuale:e[3]},animCollapse:!1,items:[{xtype:"CBAShortcutGrid",marginLeftShortcutOff:0,itemId:"G"+d,store:Ext.create("Generali.notifiche.store.Notifiche"),hideHeaders:!0,cbaPaged:!0,margin:"0 0 1 0",menuShortcut:h,flex:1,columns:[{xtype:"gridcolumn",dataIndex:"livelloErr",width:18,renderer:function(a,b,c,d,e,g,h){switch(a){case 0:case null:b.tdCls=
"icon-info";break;case 1:b.tdCls="icon-warning";b.style="vertical-align: top";break;case 2:b.tdCls="icon-error"}}},{xtype:"gridcolumn",flex:1,dataIndex:"descrizione",text:"DESCRIZIONE",renderer:function(a,b,c,d,e,g,h){d="T"==h.up().up().cbaConfig.ntfManuale?70:300;return StdSipcar.rendererDescNotifica(a,b,c,!0,d)}},{xtype:"gridcolumn",dataIndex:"menu",width:20,renderer:function(a,b,c,d,e,g,h){return this.rendererShortcutColumn()}}],viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){if("T"==a.get("letto"))return"non_attivi"},
trackOver:!1,emptyText:""},selModel:Ext.create("Ext.selection.CheckboxModel",{checkOnly:!0,pruneRemoved:!1}),listeners:{itemdblclick:function(a,c){return b.itemdblclickGridNotifiche(a,c)},selectionchange:function(a,c){return b.selectionchangeGridNotifiche(a,c)}}}],listeners:{afterrender:function(a){return b.doAfterRenderPanel(a)}}});b.storeCount.push(Number(e[1]));b.getContainerGrid().add(a)});return!0},getTotNotifiche:function(){var a=0;this.storeCount&&Ext.each(this.storeCount,function(b){a+=b});
return a+1*this.cbaConfig.countNtf.valore},onClickBtnSalva:function(a,b){this.setReadDeleteNtf(a,0,b)},doAfterRenderPanel:function(a){var b=this;a.getHeader().items.items[0].hide();var c=Ext.create({xtype:"container",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"checkbox",itemId:"CheckSelAll"+a.cbaConfig.tipoNotifica},{xtype:"container",itemId:"CntTitle"+a.cbaConfig.tipoNotifica,layout:{xtype:"hbox",align:"stretch"},flex:1,margin:"3 0 0 10",items:[{xtype:"label",text:a.title,cls:"cbaLabel"}]},
{xtype:"image",src:"/cba/generali/images/svg/others/bin.svg",title:traduci("ELIMINA"),width:20,height:20,margin:"0 30 0 0"},{xtype:"container",itemId:"CountTipo",margin:"3 5 0 0"}],listeners:{afterrender:function(c){b.refreshNotifica(c,a.cbaConfig.ntfNonLette)}}});a.getHeader().insert(0,c);a.getHeader().getEl().on("click",function(c){"checkbox"==c.target.type?b.changeCheckSelAll(a,a.down("checkbox").getValue()):"IMG"==c.target.tagName?b.beforeDelete(a):b.expandPanel(a)})},beforeDelete:function(a){var b=
this;0<a.down("gridpanel").getSelectionModel().getSelection().length&&Messaggio("Attenzione","MSG_ELIMINA_PLURALE","YESNO","QUESTION","",function(){return b.setReadDeleteNtf(a,1)},!1)},setReadDeleteNtf:function(a,b,c){var d=this,e=[],g=a.down("gridpanel"),h=a.cbaConfig.tipoNotifica;b=0==b?"/cba/gen/ws/general/ntf/setRead":1==b?"/cba/gen/ws/general/ntf/multiDelete":"";a.down("checkbox").getValue()||(c&&e.push(c.get("idNotifica")),Ext.each(g.getSelectionModel().getSelection(),function(a){e.push(a.get("idNotifica"))}));
(a.down("checkbox").getValue()||0<e.length)&&Ext.Ajax.request({method:"POST",url:b,params:{tipoNotifica:h,list:e.toString(),idOperatore:CBA.parametriGenerali.codUtente,customParam:a.down("checkbox").getValue()},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?b.data&&"ELIMINA"==b.data?(d.refreshCountStore(a,0),a.destroy()):b.data&&"OK"!=b.data&&(b.data.split(";"),b=b.data.split(";")[2],a.isDestroyed||(d.refreshNotifica(a,b),d.aggiornaGriglia(g.isVisible()))):msgShowError("",b.message)}})},
refreshNotifica:function(a,b){0==b&&(b="");setBadgeText(a.queryById("CountTipo"),b)},changeCheckSelAll:function(a,b){this.panelExpand&&this.panelExpand.getItemId()==a.getItemId()?b?a.down("gridpanel").getSelectionModel().selectAll():a.down("gridpanel").getSelectionModel().deselectAll():this.expandPanel(a)},getClasseUiByModulo:function(a){switch(a){case "-1":return"cbaPanelGrigioGen";case "43":case "50":case "46":case "48":case "55":case "64":return"cbaPanelViolaUtenti";case "49":case "69":return"cbaPanelBluCss";
case "57":case "62":case "58":case "59":case "60":case "61":return"cbaPanelVerdeEco";case "44":case "51":case "52":case "53":case "54":case "56":return"cbaPanelGialloAmm";case "45":return"cbaPanelArancioPer";default:return"cbaPanelGialloAmm"}},expandPanel:function(a){var b=!0;this.panelExpand&&(this.panelExpand.getItemId()==a.getItemId()?(a.collapse(),delete this.panelExpand,b=!1):this.panelExpand&&this.panelExpand.collapse());b&&(a.expand(),this.panelExpand=a,this.deselectOthers(a),this.aggiornaGriglia(!0,
function(){Ext.defer(function(){a.up().setScrollY(a.getEl().lastBox.y)},100)}))},aggiornaStore:function(){this.aggiornaGriglia(!0)},costruisciPanelNtfPresenze:function(){var a=this,b=Ext.create("Ext.panel.Panel",{layout:{type:"vbox",align:"stretch"},collapsed:!0,height:450,margin:"3 0 0 0",title:traduci("OPEN_NTF_PRESENZE"),ui:a.getClasseUiByModulo("45"),listeners:{afterrender:function(b){return a.doAfterRendelPanelPer(b)}}});a.getContainerGrid().add(b)},doAfterRendelPanelPer:function(a){var b=this;
a.getHeader().items.items[0].hide();a.getHeader().setHeight(45);var c=Ext.create({xtype:"container",layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"container",layout:{xtype:"hbox",align:"stretch"},flex:1,margin:"3 0 0 30",items:[{xtype:"label",text:a.title,cls:"cbaLabel"}]},{xtype:"container",itemId:"CountTipo",margin:"3 5 0 0"}],listeners:{afterrender:function(a){b.refreshNotifica(a,b.cbaConfig.countNtf.valore)}}});a.getHeader().insert(0,c);a.getHeader().getEl().on("click",function(c){a.up("window").close();
b.CMD_PER_default("OPEN_NTF",!0)})},buildMenu:function(){var a=this;Ext.Ajax.request({method:"GET",params:{idOrganizzazione:getIdOrg(),idOperatore:CBA.parametriGenerali.codUtente,dataDal:moment().add(-7,"days").startOf("day").toDate(),dataAl:moment().add(30,"days").endOf("day").toDate()},url:"/cba/gen/ws/general/ntf/group/src",success:function(b){b=Ext.JSON.decode(b.responseText);if(b.success){b=a.costruisciGriglieNotifiche(b.data);if(0<a.cbaConfig.countNtf.valore||45==CBA.moduli.moduloAttivo)if(b)a.costruisciPanelNtfPresenze();
else return a.getView().up("window").close(),a.CMD_PER_default("OPEN_NTF",!0),!0;a.refreshCountStore();a.getView().up("window").show()}else msgShowError("",b.message)}})},onLaunch:function(){this.buildMenu();this.listNtfManuali=[]},destroy:function(){this.callParent()},cp_fatt_cespiti:function(a){var b=a.idPrimaNotaTes,c=a.idEsercizio,d=a.cliFor;if(CBA.moduli.modulo44.abilitato){var e=Sipcar.app.getMenuController();a=e.getTabApplicativi();var g=a.getActiveTab(),h=a.queryById("tab44"),k=function(a){var b;
switch(d){case "C":b="CPFattureCli";break;case "F":b="CPFattureFor"}var g=e.getCardApplicativo().queryById("tab_"+b);if(g)(b=g.down())&&b.getController().fireEvent("RecordSelezionatoById",a);else if(b=b?trovaButtonMenu("btn"+b):!1)delete b.auto_idRecord,delete b.notifica,delete b.auto_idEsercizio,b.auto_idRecord=a,b.auto_idEsercizio=c,b.notifica=!0,b.handler(b)};"tab44"!=g.getItemId()?(a.onAfter("tabchange",function(){k(b)},a,{single:!0}),h?a.setActiveTab(h):eseguiModulo(44)):k(b)}},eseguiCmdsModulo44:function(a,
b){var c=getObjectFromString(b.toString(),"&","=");this[a.toLowerCase()](c)},eseguiCmdsModuloGen:function(a,b){switch(a){case "OPEN_DASHBOARD_EVENTS":Ext.create("winCBA",{name:"Generali.gestPwdNew.view.DashboardEvents",titolo:"Monitor Integrazioni",closable:!0,maximizable:!1,minimizable:!1,maximized:!0,configItem:{permesso:"S"}}).show()}},eseguiCmdsModulo49:function(a,b){var c,d=-1,e,g;Ext.each(b,function(a){switch(a.split("=")[0].toUpperCase()){case "CODOSPITE":c=a.split("=")[1];break;case "IDRICOVERO":d=
a.split("=")[1];break;case "COGNOME":e=a.split("=")[1];break;case "IDPROFILOCS":g=a.split("=")[1]}});switch(a){case "CSS_OPEN_FASCICOLO":this.CMD_CSS_default(a,c,e,d,g,!0);break;case "CSS_OPEN_SERVIZIO":this.CMD_CSS_default(a,c,e,d,g,!0,!0)}},eseguiCmdsModulo43:function(a,b){var c=null,d=-1,e=null,g=null;Ext.each(b,function(a){switch(a.split("=")[0].toUpperCase()){case "CODOSPITE":c=a.split("=")[1];break;case "IDRICOVERO":d=a.split("=")[1];break;case "IDDOC":e=a.split("=")[1];break;case "COGNOME":g=
a.split("=")[1]}});switch(a){case "CU_DOC_IN_SCADENZA":case "CU_DOC_SCADUTO":case "CU_APRI_FASCICOLO":case "CU_OPEN_FASCICOLO":this.CMD_CU_default(a,c,g,d,e,!0);break;case "CU_OPEN_SERVIZIO":this.CMD_CU_default(a,c,g,d,e,!0,!0);break;case "CU_FE_EXPIRED":this.CU_FE_EXPIRED();break;case "CU_OPEN_UNODOMO":this.CU_OPEN_UNODOMO()}},CU_FE_EXPIRED:function(){eseguiModulo(43,"btnElabFattElettAtt",{})},CU_OPEN_UNODOMO:function(){eseguiModulo(43,"btnCUUnoDomoPE",{})},CMD_CU_default:function(a,b,c,d,e,g,h){var k=
this,l=0,m=null;Ext.each(Sipcar.app.getController("Menu").getCardApplicativo().items.items,function(a){43==a.cbaConfig.idModulo&&(Sipcar.app.getController("Menu").getTabApplicativi().setActiveTab(l),m=a.down("#Cerca"));l++});m?(g=trovaButtonMenu("btnOSP_Anagrafica"),g.cbaConfig.cmdName=a,g.cbaConfig.idRicovero=0<d?d:null,e&&(g.cbaConfig.idDocumento=e),c&&m.controller.getCognome().setValue(c),m.controller.getSenzaServizi().setValue(!0===h),h?(m.controller.secondoTentativo=!0,m.controller.cerca({codOspite:b},
b)):m.controller.cerca({codOspite:b})):g&&(eseguiModulo(43,"btnOSP_Anagrafica",{codOspite:b}),setTimeout(function(){k.CMD_CU_default(a,b,c,d,e,!1,h)},3500))},getParametriRicercaByModulo:function(a,b){var c=0;result=null;Sipcar.app.getController("Menu")&&Sipcar.app.getController("Menu").getCardApplicativo()&&Ext.each(Sipcar.app.getController("Menu").getCardApplicativo().items.items,function(d){d.cbaConfig.idModulo==a&&(Sipcar.app.getController("Menu").getTabApplicativi().setActiveTab(c),result=b?d.down("#"+
b):!0);c++});return result},setMenuModulo49:function(a,b,c,d){var e=null;switch(a){case "CSS_OPEN_FASCICOLO":b.up().controller.getFiltroSettUtente().setValue(!1);b.up().controller.codOspiteTemp=c;b.up().controller.getCognome().setValue(d);break;case "CSS_OPEN_SERVIZIO":if("T"===CBA.parametriGenerali.amministratore){var g=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().queryById("btnnull");if(g)e={codOspite:c,cognome:d},g.cbaConfig.paramsAssociaTip=e,g.handler();else var h=setInterval(function(){if(g=
Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().queryById("btnnull"))clearInterval(h),e={codOspite:c,cognome:d},g.cbaConfig.paramsAssociaTip=e,g.handler()},300)}}},setMenuModulo45:function(a){switch(a){case "OPEN_NTF":Ext.create("winCBA",{name:"GeneraliPE.notifiche.view.Notifiche",titolo:"NOTIFICHE",dimensione:8,closable:!0,configItem:{permesso:"S",idModulo:45,tipo:null},listeners:{close:function(a){CBA.taskNotifiche.restart()}}}).show()}},CMD_PER_default:function(a,b,c){var d=
this,e=null;if(c)var g=setInterval(function(){if(e=d.getParametriRicercaByModulo(45,null))d.setMenuModulo45(a),clearInterval(g)},c);else e=d.getParametriRicercaByModulo(45,null);e&&!c?d.setMenuModulo45(a):b&&(eseguiModulo(45),d.CMD_PER_default(a,!1,300))},CMD_CSS_default:function(a,b,c,d,e,g,h,k){var l=this,m=null;if(k)var n=setInterval(function(){if(m=l.getParametriRicercaByModulo(49,"ParametriRicerca"))l.setMenuModulo49(a,m,b,c),clearInterval(n)},k);else m=l.getParametriRicercaByModulo(49,"ParametriRicerca");
if(m&&!k&&CBA.parametriGenerali.idProfiloCss==e)l.setMenuModulo49(a,m,b,c);else if(g)if(e){var p=!1;Ext.create("Generali.gestPwdNew.store.ProfiliPwdDeCss").load({params:{idProfiloPwdDe:CBA.parametriGenerali.idProfiloPwdDe},callback:function(g,k,m){if(m){if(Ext.isEmpty(g))return msgShowError("","MSG_NESSUNA_TIPCART"),!1;Ext.each(g,function(a){a.data.idProfiloCss==e&&(p=!0,CBA.parametriGenerali.idProfiloCss=a.data.idProfiloCss,CBA.parametriGenerali.idProfiloPwdDeCss=a.data.id)});p?(eseguiModulo(49,
null,null,!0),l.CMD_CSS_default(a,b,c,d,e,!1,h,300)):msgShow("INFO","La Tipoogia Cartella non  abilitata per l'operatore!")}else return!1}})}else eseguiModulo(49),l.CMD_CSS_default(a,b,c,d,e,!1,h,300)},eseguiCmdsModulo48:function(a,b){var c=b[0].split("=")[1];switch(a){case "LA_PUNTEGGI":this.CMD_LA_punteggi(a,c)}},CMD_LA_default:function(a){tabApplicativi=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab();var b=tabApplicativi.queryById("btnLAFunzPers").initialConfig.menu.items[1];
"undefined"!==typeof aggiornaPunteggiLA&&aggiornaPunteggiLA?(tmp=0,Ext.each(Ext.all("#tbdettab"+CBA.moduli.moduloAttivo)[0].getTabBar().getRefItems(),function(a){if("Aggiorna punteggio manuale"==a.title)return Ext.all("#tbdettab"+CBA.moduli.moduloAttivo)[0].setActiveTab(Ext.all("#tbdettab"+CBA.moduli.moduloAttivo)[0].getTabBar().getRefItems()[tmp].card),!1;tmp++}),Ext.all("#tbdettab"+CBA.moduli.moduloAttivo)[0].getTabBar().getRefItems()[tmp].card.items.items[0].controller.caricaNotifiche(a)):(aggiornaPunteggiLA=
{codOspite:a},b.handler(b))},CMD_LA_punteggi:function(a,b){var c=this,d=!0;Ext.suspendLayouts();"Lista d'attesa"!=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().title&&(Ext.each(Sipcar.app.getController("Menu").getTabApplicativi().items.items,function(a){if("Lista d'attesa"==a.title)return Sipcar.app.getController("Menu").getTabApplicativi().setActiveTab(a),!1}),"Lista d'attesa"!=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().title&&(d=!1,eseguiModulo(48),
setTimeout(function(){c.CMD_LA_default(b)},1E3)));d&&this.CMD_LA_default(b);Ext.resumeLayouts()},eseguiCmdsModulo50:function(a,b){var c=b[0].split(b[0].indexOf("=")+1,b[0].indexOf(";"))[1],d=b[0].split("=")[2];switch(a){case "CA_PRESENZE":this.CMD_CA_PRESENZE(a,c,d)}},CMD_CA_default:function(a,b){},CMD_CA_PRESENZE:function(a,b,c){var d=this;a=!0;Ext.suspendLayouts();"Contabilit Alunni"!=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().title&&(Ext.each(Sipcar.app.getController("Menu").getTabApplicativi().items.items,
function(a){if("Contabilit Alunni"==a.title)return Sipcar.app.getController("Menu").getTabApplicativi().setActiveTab(a),!1}),"Contabilit Alunni"!=Sipcar.app.getController("Menu").getTabApplicativi().getActiveTab().title&&(a=!1,eseguiModulo(50),setTimeout(function(){d.CMD_CA_default(b,c)},1E3)));a&&this.CMD_CA_default(b,c);Ext.resumeLayouts()},eseguiCmdsModulo55:function(a,b){var c=b[0].split("=")[1],d="";Ext.Ajax.request({method:"GET",url:getUrlGen()+"/ws/genOsp/users/get",async:!1,params:{id:c},
success:function(a){a=Ext.JSON.decode(a.responseText);a.success&&(d=a.data.cognome)}});switch(a){case "FAR_BINA_RIVALUTAZIONE":this.CMD_FAR_rivalutazioneBina(a,c,d);break;case "FAR_ANAGRAFICA_CF":case "FAR_DATI_PERMANENZABREVE":this.CMD_FAR_default(a,c,d)}},CMD_FAR_default:function(a,b,c){var d=0,e=null;Ext.each(Sipcar.app.getController("Menu").getCardApplicativo().items.items,function(a){55==a.cbaConfig.idModulo&&(Sipcar.app.getController("Menu").getTabApplicativi().setActiveTab(d),e=a.down("#Cerca"));
d++});e?(trovaButtonMenu("btnOSP_Anagrafica").cbaConfig.cmdName=a,Ext.isEmpty(c)||e.controller.getCognome().setValue(c),e.controller.cerca({codOspite:b})):eseguiModulo(55,"btnOSP_Anagrafica",{codOspite:b})},CMD_FAR_rivalutazioneBina:function(a,b,c){var d=this;55!=CBA.moduli.moduloAttivo?CBA.parametriGenerali.produzione?loadScript("generaliCSS-min.js",function(){d.CMD_FAR_default(a,b,c)}):loadScript("css/generali/standard/componentiCSS.js",function(){loadScript("css/generali/standard/standardCSS.js",
function(){d.CMD_FAR_default(a,b,c)})}):d.CMD_FAR_default(a,b,c)},eseguiCmdsModulo60:function(a,b){switch(a){case "RC_CV_MAGAZZINO":this.RC_CV_MAGAZZINO(a,0);break;case "RC_CV_FARMACIA":this.RC_CV_FARMACIA(a,0);break;case "RC_CV_MANUTENZIONE":this.RC_CV_MANUTENZIONE(a,0);break;case "RC_EV_MAGAZZINO":this.RC_EV_MAGAZZINO(a,0);break;case "RC_EV_FARMACIA":this.RC_EV_FARMACIA(a,0);break;case "RC_EV_MANUTENZIONE":this.RC_EV_MANUTENZIONE(a,0)}},RC_CV_MAGAZZINO:function(a,b){eseguiModulo(60,"btnRCConvalidaRichieste")},
RC_CV_FARMACIA:function(a,b){eseguiModulo(60,"btnRCConvalidaRichieste")},RC_CV_MANUTENZIONE:function(a,b){eseguiModulo(60,"btnRCConvalidaRichieste")},RC_EV_MAGAZZINO:function(a,b){eseguiModulo(58,"btnMAGRichiesteRep")},RC_EV_FARMACIA:function(a,b){eseguiModulo(62,"btnFARRichiesteRep")},RC_EV_MANUTENZIONE:function(a,b){eseguiModulo(59,"btnMNCalendario")}});
Ext.define("Generali.notifiche.controller.NotificheManuali",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridNotifiche",selector:this.selContainer+"#GridNotifiche"},{ref:"CntNotifica",selector:this.selContainer+"#CntNotifica"},{ref:"CntParametri",selector:this.selContainer+"#CntParametri"},{ref:"CkbNonLetto",selector:this.selContainer+"#CkbNonLetto"},{ref:"CkbLetto",selector:this.selContainer+"#CkbLetto"},
{ref:"TxtDesc",selector:this.selContainer+"#TxtDesc"},{ref:"DataDal",selector:this.selContainer+"#DataDal"},{ref:"DataAl",selector:this.selContainer+"#DataAl"}]);this.control(this.selContainer+"#GridNotifiche",{select:this.selectGridNotifiche})},selectGridNotifiche:function(a,b,c,d){this.controller_notifica&&this.controller_notifica.aggiornaStore(b?b.get("id"):null)},getParamsUrl:function(){var a="Generali";StdSipcar.isAreaPersonale(CBA.moduli.moduloAttivo)?a+="PE":StdSipcar.isAreaUtenti(CBA.moduli.moduloAttivo)&&
(a+="OSP");return a+".notifiche.view.ParamsNotificheManuali"},effettuaRicerca:function(){this.aggiornaStore()},aggiornaStore:function(a,b){var c=this,d=c.getGridNotifiche(),e=d.getStore(),g={};c.cbaConfig.record&&Ext.apply(g,{idNotifica:c.cbaConfig.record.idNotifica});Ext.apply(g,{idOrganizzazione:c.idOrganizzazione,idOperatore:CBA.parametriGenerali.codUtente,idGruppo:c.idGruppo,idModulo:CBA.moduli.moduloAttivo});var h=c.getCkbLetto().getValue(),k=c.getCkbNonLetto().getValue(),l=null;h&&!k?l="T":
k&&!h&&(l="F");Ext.apply(g,{dataDal:c.getDataDal().getValue(),dataAl:c.getDataAl().getValue(),letto:l,descrizione:c.getTxtDesc().getValue()});e.removeAll();StdSipcar.promiseGetRequest("/cba/gen/ws/general/ntf/manuali/src",g).then(function(a){Ext.isEmpty(a)?c.selectGridNotifiche(d):(e.add(a),c.cbaConfig.record&&(a=trovaRecord(e,"id",c.cbaConfig.record.idNotifica),d.getSelectionModel().select(a?[a]:0),c.cbaConfig.record=null))})["catch"](function(a){msgShowError("",a)})},caricaParametri:function(a){a=
void 0===a?{}:a;if(this.controller_parametri)return this.controller_parametri.caricaParametri(a)},selezioneParametro:function(a){a=void 0===a?{}:a;this.controller_notifica&&this.controller_notifica.setCommandParams(Ext.urlEncode(a))},esci_callback:function(){this.cbaConfig.esci_callback&&this.cbaConfig.esci_callback()},elimina_callback:function(){me.aggiornaStore()},onLaunch:function(){var a=this;a.idOrganizzazione=getIdOrg();a.idGruppo=getIdGruppo();var b=Ext.create("Generali.notifiche.view.NotificheManualiTes",
{controllerPrincipale:a,idOrganizzazione:a.idOrganizzazione,idGruppo:a.idGruppo,cbaConfig:{permesso:a.cbaConfig.permesso,esci_callback:a.esci_callback.bind(a),caricaParametri:a.caricaParametri.bind(a),elimina_callback:a.elimina_callback.bind(a)}});a.getCntNotifica().add(b);a.controller_notifica=b.controller;StdSipcar.createIfExists(a.getParamsUrl(),{cbaConfig:{permesso:a.cbaConfig.permesso,idOrganizzazione:a.idOrganizzazione,idGruppo:a.idGruppo,selezioneParametro:a.selezioneParametro.bind(a)}}).then(function(b){a.getCntParametri().add(b);
a.controller_parametri=b.controller})["catch"](function(a){return msgShowError("",a)});a.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.notifiche.controller.NotificheManualiTes",{extend:"Generali.standard.stampe.Controller",parametriStampa:{url:"/cba/gen/ws/report/notifiche/manuali",titolo:"STAMPA_GIUSTIFICATIVI",hideXml:!0,hideCsv:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBTipoNotifica",selector:this.selContainer+"#CBTipoNotifica"},{ref:"CommandParams",
selector:this.selContainer+"#CommandParams"}])},doPrint:function(a,b){var c={},d=this.controllerPrincipale;Ext.apply(c,{idOrganizzazione:getIdOrg(),idGruppo:45==CBA.moduli.moduloAttivo?getIdGruppo():null,idModulo:CBA.moduli.moduloAttivo,dataLimite:d.getDataAl().getValue(),idNotifica:null,idOperatore:CBA.parametriGenerali.codUtente,dataDal:d.getDataDal().getValue(),dataAl:d.getDataAl().getValue(),letto:getBoolValue(this.controllerPrincipale.getCkbLetto().getValue()),descrizione:this.controllerPrincipale.getTxtDesc().getValue()});
d=Ext.apply(this.parametriStampa,{});Ext.apply(d.params,c);this.callParent([a,b])},aggiornaStore:function(a,b){var c=this,d=c.getForm(),e=d.getForm();c.idNotifica=StdSipcar.isValidID(a)?a:c.idNotifica;clearForm(d);if(StdSipcar.isValidID(c.idNotifica)){var g;c.storeNotificheMan.load({params:{id:c.idNotifica},callback:function(a,b,d){d?Ext.isEmpty(a)||(e.loadRecord(a[0]),g=Ext.urlDecode(a[0].get("commandParams"))):msgShowError("",b.getError());c.cbaConfig.caricaParametri&&c.cbaConfig.caricaParametri(g)}})}else c.cbaConfig.caricaParametri&&
c.cbaConfig.caricaParametri()},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues(),d=!StdSipcar.isValidID(c.id);d&&Ext.apply(c,{idOrganizzazione:this.idOrganizzazione,idGruppo:this.idGruppo,livelloErr:0});(a=controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"}))&&this.controllerPrincipale&&(c=this.controllerPrincipale.getGridNotifiche(),b=c.getStore(),
c=c.getSelectionModel(),d?(b.insert(0,a),c.select(0)):((d=trovaRecord(b,"id",a.id))&&d.set(a),c.select(d?[d]:0)))},clearFormNotifiche:function(){clearForm(this.getForm());this.cbaConfig.caricaParametri&&this.cbaConfig.caricaParametri()},gestioneForm:function(){var a=this,b=a.getForm(),c=b.getForm();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeNotificheMan;b.controller=a;var d=Ext.create("Generali.standard.controller_PannelloBottoni",{itemId:"cntBottoni",cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},
annulla_callback:function(){a.aggiornaStore(c.findField("id").getValue())},nuovo_callback:function(){controller_nuovoRecord(b,c.findField("ora"));var d=new a.storeNotificheMan.model({idOrganizzazione:a.idOrganizzazione,idGruppo:a.idGruppo}),e=a.getCBTipoNotifica().getStore();1==e.getCount()&&d.set("idTipo",e.first().get("codice"));c.loadRecord(d);a.cbaConfig.caricaParametri&&a.cbaConfig.caricaParametri()},elimina_callback:function(){var c=b.getForm().findField("id").getValue();StdSipcar.isValidID(c)&&
controller_eliminaRecord(b.store,{id:c},function(){a.clearFormNotifiche(b);a.cbaConfig&&a.controllerPrincipale.effettuaRicerca()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){a.cbaConfig.esci_callback&&a.cbaConfig.esci_callback();b.up("window").close()}}}),e=d.down("#BtnStampa");a.configurePrintButton(e,"preview");e.show();inserisciBottoni(b.boxBottoni,d,!0,"start");if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,d){a.controllerPrincipale.getGridNotifiche().setDisabled(d);
controller_abilitaBottoni(b)})},setCommandParams:function(a){a=void 0===a?{}:a;this.getCommandParams().setValue(a)},onLaunch:function(){this.storeNotificheMan=Ext.create("Generali.notifiche.store.NotificheManuali",{autoLoad:!1});this.getCBTipoNotifica().getStore().load({params:{idModulo:CBA.moduli.moduloAttivo}});this.gestioneForm()},destroy:function(){delete this.storeNotificheMan;this.callParent()}});
Ext.define("Generali.notifiche.controller.ParamsNotificheManuali",{extend:"Generali.standard.ViewController",caricaParametri:Ext.emptyFn,doAutoSelect:function(a,b){b=void 0===b?"codice":b;var c=a.store,d=a.picker,e=0,g,h;d&&a.autoSelect&&0<c.getCount()&&(a.autoSelectLast&&(g=d.getSelectionModel(),(h=g.lastSelected?trovaRecord(c,b,g.lastSelected.get(b)):void 0)&&g.selected.length&&-1<c.indexOf(h)&&(e=h)),d.getNavigationModel().setPosition(e))},selectParametro:function(a){a&&this.cbaConfig.selezioneParametro&&
this.cbaConfig.selezioneParametro(a)},destroy:function(){this.callParent()}});
Ext.define("Generali.notifiche.store.Notifiche",{extend:"Ext.data.Store",fields:[{name:"idModulo"},{name:"idNotifica"},{name:"idNotificaOperatori"},{name:"idTipo"},{name:"idOperatore"},{name:"ora"},{name:"descrizione"},{name:"livelloErr"},{name:"commandName"},{name:"commandParams"},{name:"letto"},{name:"oraLettura"},{name:"idLettore"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/ntf/src",reader:{type:"json",messageProperty:"message",rootProperty:"data",totalProperty:"total"},api:{read:"/cba/gen/ws/general/ntf/src"},
simpleSortMode:!0,filterParam:"query"},autoDestroy:!0});
Ext.define("Generali.notifiche.store.NotificheManuali",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idTipo"},{name:"idOrganizzazione"},{name:"idGruppo"},{name:"ora",type:"date"},{name:"descrizione"},{name:"livelloErr"},{name:"commandParams"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/ntf/get",api:{create:"/cba/gen/ws/general/ntf/new",update:"/cba/gen/ws/general/ntf/update",destroy:"/cba/gen/ws/general/ntf/delete"}}},a)])},autoDestroy:!0});
Ext.define("Generali.notifiche.store.NotificheTipoCbox",{extend:"Generali.data.StoreCodiceValore",constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/gen/ws/general/ntf/tipo/cbox"}},a)])},autoDestroy:!0});
Ext.define("Generali.notifiche.view.Notifiche",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",border:0,itemId:"ContainerGrid",reference:"ContainerGrid",layout:{type:"vbox",align:"stretch"},flex:1,dockedItems:[{dock:"top",xtype:"toolbar",items:[{xtype:"component",itemId:"Status",reference:"Status",tpl:"Totale notifiche: {count}",style:"margin-right:5px"}]},{xtype:"toolbar",dock:"bottom",layout:{pack:"center"},items:[{xtype:"button",
iconCls:"icon-ok",text:traduci("CONFERMA_LETTURA"),itemId:"BtnSalva",reference:"BtnSalva",width:150,cls:"cbaCssBtnFunzione",disabled:!0},{xtype:"button",iconCls:"icon-edit",text:traduci("NOTIFICHE_MANUALI"),itemId:"BtnEditNotificheMan",reference:"BtnEditNotificheMan",width:150}]}],scrollable:!0}]});this.callParent(arguments)}});
Ext.define("Generali.notifiche.view.NotificheManuali",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",itemId:"GridNotifiche",reference:"GridNotifiche",store:Ext.create("Generali.notifiche.store.NotificheManuali",{autoLoad:!1}),flex:1,maxWidth:375,layout:{align:"stretch"},viewConfig:{loadMask:!1,getRowClass:function(a,c,d,e){if("T"==a.get("letto"))return"non_attivi"}},dockedItems:[{xtype:"fieldset",
title:"FILTRI",style:"border-bottom-width: 1px !important;",dock:"top",margin:"3 3 5 3",padding:5,items:[{xtype:"container",layout:"hbox",items:[{xtype:"datefield",itemId:"DataDal",reference:"DataDal",fieldLabel:"DAL",labelClsExtra:"cbaLabel",selectOnFocus:!0,labelWidth:40,width:150,margin:"0 3 0 0",value:moment().add(-7,"days").startOf("day").toDate()},{xtype:"component",flex:1},{xtype:"datefield",itemId:"DataAl",reference:"DataAl",fieldLabel:"AL",labelClsExtra:"cbaLabel",labelWidth:40,width:150,
value:moment().add(30,"days").endOf("day").toDate()}]},{xtype:"container",layout:"hbox",items:[{xtype:"checkboxfield",itemId:"CkbNonLetto",reference:"CkbNonLetto",boxLabel:"NON_LETTO",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel",checked:!0,margin:"0 10 0 0"},{xtype:"checkboxfield",itemId:"CkbLetto",reference:"CkbLetto",boxLabel:"LETTO",inputValue:"T",uncheckedValue:"F",cls:"cbaLabel"}]},{xtype:"container",layout:{type:"hbox",align:"middle"},items:[{xtype:"textfield",itemId:"TxtDesc",reference:"TxtDesc",
emptyText:traduci("DESCRIZIONE")+"...",flex:1,margin:"0 10 0 0"},{xtype:"button",iconCls:"icon-ricerca",cls:"cba-button-25",text:"CERCA",handler:function(){a.controller.effettuaRicerca()}}]}]}],columns:{defaults:{variableRowHeight:!0},items:[{xtype:"gridcolumn",text:"DATA_NOTIFICA",dataIndex:"ora",renderer:function(a,c,d,e,g,h,k){return FormattaData(a)}},{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,renderer:function(a,c,d,e,g,h,k){return StdSipcar.rendererDescNotifica(a,c,
d,!1)}}]}},{xtype:"splitter",nonDisabilitare:!0},{xtype:"container",autoScroll:!0,border:0,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",itemId:"CntNotifica",reference:"CntNotifica",border:0,layout:"fit"},{xtype:"container",itemId:"CntParametri",reference:"CntParametri",border:0,flex:1,layout:"fit"}]}]});a.callParent(arguments)}});
Ext.define("Generali.notifiche.view.NotificheManualiTes",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120},{xtype:"form",itemId:"Form",reference:"Form",trackResetOnLoad:!0,margin:"15 5 5 5",border:0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",
name:"idGruppo",hidden:!0},{xtype:"textfield",itemId:"CommandParams",reference:"CommandParams",name:"commandParams",hidden:!0},{xtype:"datefield",itemId:"DataPromemoria",reference:"DataPromemoria",fieldLabel:"SCADENZA_PROMEMORIA",labelClsExtra:"cbaLabel",name:"ora",maxWidth:300,labelWidth:150,selectOnFocus:!0,allowBlank:!1},{xtype:"combobox",itemId:"CBTipoNotifica",reference:"CBTipoNotifica",fieldLabel:"TIPO_NOTIFICA",store:Ext.create("Generali.notifiche.store.NotificheTipoCbox",{autoLoad:!1}),name:"idTipo",
labelWidth:150,displayField:"valore",queryMode:"local",valueField:"codice",labelClsExtra:"cbaLabel",allowBlank:!1},{xtype:"textarea",fieldLabel:"DESCRIZIONE",labelWidth:150,allowBlank:!1,itemId:"DesNotifica",reference:"DesNotifica",name:"descrizione",height:100,enforceMaxLength:!0,maxLength:2E3,labelClsExtra:"cbaLabel"}]}]});this.callParent(arguments)}});
Ext.define("Generali.organizzazioni.controller.ParametriFatturazione",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormParametri",selector:this.selContainer+"#FormParametri"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"BtnMonitor",selector:this.selContainer+"#BtnMonitor"}]);this.control(this.selContainer+"#BtnMonitor",{click:this.monitorClick})},monitorClick:function(){StdSipcar.promiseGetRequest("/cba/gen/ws/general/parametri/fatturazione/job/watch").then(function(a){return Messaggio("INFO",
"MONITOR ATTIVO <br> "+a[0],"OK","INFORMATION")})["catch"](function(a){return msgShowError("",a)})},aggiornaStore:function(a){var b=this.cbaConfig.idEnte?this.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd,c=this.getFormParametri();this.idOrganizzazione=StdSipcar.isValidID(a)?a:this.idOrganizzazione;clearForm(c);this.storeParametri.load({params:{id:this.idOrganizzazione,idEnte:b},callback:function(a,b,g){g?Ext.isEmpty(a)||c.loadRecord(a[0]):msgShowError("",b.getError())}})},caricaOrganizzazione:function(a){delete this.idOrganizzazione;
StdSipcar.isValidID(a)&&this.aggiornaStore(a)},salvaForm:function(a){var b=this.getFormParametri(),c=b.getForm().getFieldValues();Ext.apply(c,{idOrganizzazione:this.idOrganizzazione});controller_salvaRecord(b,c,a,{forzaRegistrazione:"F",idEnte:this.cbaConfig.idEnte?this.cbaConfig.idEnte:CBA.parametriGenerali.codEntePwd},!1,null,"idOrganizzazione")&&a&&this.callbackEsci&&this.callbackEsci()},verificaCampiForm:function(a){var b=[];a.isValid()||msgAddError(b,"MSG_CAMPI_OBBLIGATORI");return msgShow("",
b)},gestioneForm:function(){var a=this,b=a.getFormParametri();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeParametri;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.aggiornaStore()},verificaCampiForm_callback:function(){return a.verificaCampiForm(b)}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();
b.boxBottoni.queryById("btnElimina").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},onLaunch:function(){this.storeParametri=Ext.create("Generali.organizzazioni.store.ParametriFatturazione",{autoLoad:!1});this.gestioneForm()},destroy:function(){delete this.storeParametri;this.callParent(arguments)}});
Ext.define("Generali.organizzazioni.controller.PersonAdHoc",{extend:"Generali.standard.ViewController",init:function(){this.myRegExp=RegExp("<br>","gi");this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CbxModuliAttivi",selector:this.selContainer+"#CbxModuliAttivi"},{ref:"TreeVociMenu",selector:this.selContainer+"#TreeVociMenu"}]);this.control(this.selContainer+"#CbxModuliAttivi",{change:this.changeCbxModuliAttivi});this.control(this.selContainer+"#TreeVociMenu",
{checkchange:this.treeCheckChange})},setNodeStyle:function(a,b){a.set("text",'<span style="color: '+(b?"black":"red")+'">'+a.get("titolo")+"</span>");"T"==a.get("abilitaPersonalizzazione")&&a.set("iconCls","icon-"+(b?"un":"")+"locked")},treeItemAppend:function(a,b){"T"!=b.get("abilitaPersonalizzazione")?b.set("cls","hideTreeNode"):this.setNodeStyle(b,"T"==b.get("visibile"))},treeCheckChange:function(a,b,c){var d=this;c=!1;a.isLeaf()||(c=!0,msgShowWarning("ATTENZIONE","MSG_NODOPADRE_NONPOSSODISATTIVARE"));
"T"!=a.get("abilitaPersonalizzazione")&&(c=!0,msgShowWarning("ATTENZIONE","MSG_NONPERSONALIZZABILE_NONPOSSODISATTIVARE"));c?a.set("checked",!b):(d.setNodeStyle(a,b),Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/menuItem/setVisible",params:{id:a.get("id"),isVisible:b?"T":""},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(msgShowText("",b.message),d.changeCbxModuliAttivi()):msgShowError("",b.message);d.aggiornaStore(a.get("id"))}}))},onLaunch:function(){var a=this;if(!a.cbaConfig.storeModuliAttivi){var b=
Sipcar.app.getController("Login");a.storeModuliAttivi=Ext.create("Generali.store.CodiceValoreExtra");a.storeModuliAttivi.areaPersonale=!1;b.storeModuli.each(function(b){b&&b.data&&b.data.abilitato&&0<b.data.codice&&(a.storeModuliAttivi.add({codice:b.get("codice"),valore:b.get("valore").replace("&agrave;","")}),a.storeModuliAttivi.areaPersonale||"Personale"!=b.get("area")||(a.storeModuliAttivi.areaPersonale=!0))});a.cbaConfig.storeModuliAttivi=a.storeModuliAttivi}a.getCbxModuliAttivi().bindStore(a.cbaConfig.storeModuliAttivi)},
aggiornaStore:function(a){var b=this,c=b.getTreeVociMenu();c.getStore().load({params:{idOrganizzazione:getIdOrg(),idModulo:b.getCbxModuliAttivi().getValue(),codEnte:CBA.parametriGenerali.codEnte},callback:function(d,e,g){c.expandAll();c.getRootNode().cascade(function(d){d.get("text");d.get("visibile");d.get("abilitaPersonalizzazione");var e="T"==d.get("visibile");d.set("checked",e);b.setNodeStyle(d,e);a&&(d=c.getRootNode().findChild("id",a,!0),c.ensureVisible(d?d:0,{select:!0,focus:!0,animate:!0}))})}})},
changeCbxModuliAttivi:function(a,b){var c=this.getTreeVociMenu();b?this.aggiornaStore():svuotaStore(c.getStore())}});Ext.define("Generali.organizzazioni.store.ParametriFatturazione",{extend:"Generali.data.StoreJson",fields:[{name:"idOrganizzazione"},{name:"codiceCliente"},{name:"chiaveFatturazione"},{name:"dataUltimoInvio",type:"date"}],proxy:{url:"/cba/gen/ws/general/parametri/fatturazione/get",api:{create:"/cba/gen/ws/general/parametri/fatturazione/new",update:"/cba/gen/ws/general/parametri/fatturazione/update"}}});
Ext.define("Generali.organizzazioni.store.TreeVociMenu",{extend:"Ext.data.TreeStore",fields:[{name:"id"},{name:"titolo"},{name:"leaf"},{name:"children"},{name:"visibile"}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/menuItem/src/withPermission",reader:{type:"json",messageProperty:"message"}},autoDestroy:!0});
Ext.define("Generali.organizzazioni.view.ParametriFatturazione",{extend:"Generali.standard.ControlledContainer",layout:{type:"hbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"form",itemId:"FormParametri",reference:"FormParametri",flex:1,trackResetOnLoad:!0,border:0,fieldDefaults:{margin:"0 5 5 0",labelWidth:150,maxWidth:450},layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",name:"codiceCliente",fieldLabel:"CODICE_CLIENTE",
labelClsExtra:"cbaLabel",maskRe:/[0-9.]/},{xtype:"textfield",fieldLabel:"CHIAVE_FATTURAZIONE",name:"chiaveFatturazione",labelClsExtra:"cbaLabel",maxLength:15,enforceMaxLength:!0},{xtype:"datefield",name:"dataUltimoInvio",hidden:!0,fieldLabel:"DATA_ULTIMO_INVIO",labelClsExtra:"cbaLabel",maxWidth:300},{xtype:"button",cls:"cba-button-25",itemId:"BtnMonitor",reference:"BtnMonitor",text:traduci("MONITORAGGIO"),iconCls:"icon-info",maxWidth:120}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
width:120}]});this.callParent(arguments)}});
Ext.define("Generali.organizzazioni.view.PersonAdHoc",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",items:[{xtype:"combobox",itemId:"CbxModuliAttivi",reference:"CbxModuliAttivi",fieldLabel:"MODULI_ATTIVI",valueField:"codice",width:400,allowBlank:!1,displayField:"valore",queryMode:"local",editable:!1,isFormField:!1,labelClsExtra:"cbaLabel"}]},{xtype:"treepanel",flex:1,border:0,margin:"0 10 0 0",
itemId:"TreeVociMenu",reference:"TreeVociMenu",maxWidth:600,rootVisible:!1,useArrows:!0,store:Ext.create("Generali.organizzazioni.store.TreeVociMenu"),columns:[{xtype:"treecolumn",dataIndex:"text",text:"VOCI_MENU",flex:1}],plugins:{ptype:"cellediting",clicksToEdit:1}}]});this.callParent(arguments)}});
Ext.define("Generali.personGenerali.privacyLog.controller.PrivacyLog",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideXml:!0,hideCsv:!1,hideText:!0,hideBtnStampaOnSecondaryWin:!0},init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Form",selector:a+"#Form"},{ref:"Grid",selector:a+"#Grid"},{ref:"BtnStampa",selector:a+"#BtnStampa"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"CboxUtente",selector:a+"#CboxUtente"},{ref:"CboxSoggetto",selector:a+
"#CboxSoggetto"},{ref:"CboxRicovero",selector:a+"#CboxRicovero"},{ref:"BtnMostra",selector:a+"#BtnMostra"},{ref:"BtnAnnulla",selector:a+"#BtnAnnulla"},{ref:"DataDal",selector:a+"#DataDal"},{ref:"DataAl",selector:a+"#DataAl"},{ref:"OraDal",selector:a+"#OraDal"},{ref:"OraAl",selector:a+"#OraAl"}]);this.control(a+"#CboxSoggetto",{change:this.changeCboxSoggetto});this.control(a+"#DataDal",{change:this.changeDataDal});this.control(a+"#DataAl",{change:this.changeDataAl});this.control(a+"#CboxUtente",{});
this.control(a+"#BtnMostra",{click:this.clickBtnMostra});this.control(a+"#BtnAnnulla",{click:this.clickBtnAnnulla});this.control(a+"#BtnEsci",{click:this.clickBtnEsci})},changeDataDal:function(a){Ext.isEmpty(this.getOraDal().getValue())&&this.getOraDal().setValue("00:00")},changeDataAl:function(a){Ext.isEmpty(this.getOraAl().getValue())&&this.getOraAl().setValue("23:59")},verificaCampiForm:function(){var a=[],b=this.getForm();0!=a.length||b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",
a)},clickBtnEsci:function(a){a.up("window").close()},clickBtnAnnulla:function(){clearForm(this.getForm());svuotaStore(this.getGrid().store)},clickBtnMostra:function(){var a=this.getDataDal().getValue(),b=this.getDataAl().getValue(),c=this.getOraDal().getValue(),d=this.getOraAl().getValue();a&&c&&(a=sommaDataOra(a,c));b&&d&&(b=sommaDataOra(b,d));Ext.apply(this.param,{idEnte:CBA.parametriGenerali.codEntePwd,idDatabase:0,area:1,videata:"",tabella:"",idRecord:0,userId:this.getCboxUtente().getValue()?
this.getCboxUtente().getValue():0,idSoggetto:this.getCboxSoggetto().getValue()?this.getCboxSoggetto().getValue():0,idRicovero:this.getCboxRicovero().getValue()?this.getCboxRicovero().getValue():0,dal:a?a:null,al:b?b:null});this.aggiornaStore()},changeCboxSoggetto:function(a,b){CBA.moduli.modulo49.storeAnagraficaSel.getAt(0);var c=this.getCboxRicovero();SvuotaCombo(c);null==b||Ext.isString(b)||(c.getStore().getProxy().extraParams={codospite:b},c.getStore().load());this.getCboxUtente().isValid()},changeCboxUtente:function(a,
b){this.getCboxSoggetto().isValid()},stampa:function(){this.getForm();var a=Ext.apply(this.parametriStampa,{url:"/cba/gen/ws/general/reports/prt/log",titolo:"LOG"});Ext.apply(a.params,this.param);var b=[];b.nomeOperazione="tipoOperazione";var c=this.getGrid().getStore().sorters.getAt(0)._property,d=this.getGrid().getStore().sorters.getAt(0)._direction;Ext.isEmpty(b[c])||(c=b[c]);Ext.apply(a.params,{orderColumn:Ext.isEmpty(c)?null:c,orderDirection:Ext.isEmpty(d)?null:d});var b=this.getDataDal().getValue(),
c=this.getDataAl().getValue(),d=this.getOraDal().getValue(),e=this.getOraAl().getValue();d&&(b=sommaDataOra(b,d));e&&(c=sommaDataOra(c,e));Ext.apply(a.params,{dal:b?b:null,al:c?c:null});this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampa();this.callParent([a,b])},aggiornaStore:function(a){var b=this.getGrid().getStore();this.verificaCampiForm()&&
b.load({params:this.param,callback:function(c,d,e){e?0<c.length&&a&&trovaRecord(b,"id",id):msgShowError("",d.getError())}})},onLaunch:function(){this.param={};Ext.apply(this.parametriStampa,this.cbaConfig.parametriStampa);this.configurePrintButton(this.getBtnStampa(),"preview");this.getForm().isValid()}});
Ext.define("Generali.personGenerali.privacyLog.store.PrivacyLog",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idEnte"},{name:"idDatabase"},{name:"idModulo"},{name:"videata"},{name:"tabella"},{name:"idRecord"},{name:"query"},{name:"dataOra",type:"date"},{name:"tipoOperazione"},{name:"userId"},{name:"userName"},{name:"tipoSoggetto"},{name:"idAssistito"},{name:"nomeAssistito"},{name:"idRicovero"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/log/new",api:{read:"/cba/gen/ws/log/list"},reader:{type:"json",
messageProperty:"message",rootProperty:"data"}},sorters:[{property:"dataOra",direction:"DESC"}],autoDestroy:!0});
Ext.define("Generali.personGenerali.privacyLog.store.RicoveriPrec",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codOspite"},{name:"dal",type:"date"},{name:"al",type:"date"},{name:"idProfilo"},{name:"comboRicoveri",convert:function(a,b){var c=Ext.Date.format(b.get("dal"),"d/m/Y H:i"),d=Ext.Date.format(b.get("al"),"d/m/Y H:i");return c+" - "+d}}],proxy:{type:"ajax",url:"/cba/css/cs/ws/ricoveri/search",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0,autoLoad:!1});
Ext.define("Generali.personGenerali.privacyLog.view.PrivacyLog",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=new Date;Ext.applyIf(this,{layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"container",itemId:"Container",layout:{type:"vbox",align:"stretch"},flex:1,items:[{xtype:"CSSButtonsPanel",height:40,margin:"15 5 10 0",layout:{type:"hbox",align:"center",pack:"end"},items:[{xtype:"container",margin:"0 10 0 0",layout:{type:"hbox",align:"middle",pack:"end"},
items:[{xtype:"button",itemId:"BtnMostra",reference:"BtnMostra",text:"MOSTRA",cls:"cbaCssBtnFunzione-special"},{xtype:"button",itemId:"BtnAnnulla",reference:"BtnAnnulla",text:"RIPRISTINA_FILTRI",margin:"0 0 0 10",cls:"cbaCssBtnFunzione-special"}]},{xtype:"newButtonStampa",text:"STAMPA",iconCls:"box-print-css",itemId:"BtnStampa",reference:"BtnStampa",margin:"0 0 0 6",width:30,cls:"cbaBtnFunzione-mini",scale:"small"},{xtype:"button",text:"ESCI",itemId:"BtnEsci",reference:"BtnEsci",margin:"0 0 0 6",
cls:"cbaBtnFunzione-mini",iconCls:"box-exit-css"}]},{xtype:"fieldset",title:"FILTRI_LOG",margin:"0 10 10 10",items:[{xtype:"form",cls:"cbaCssForm",itemId:"Form",reference:"Form",layout:{type:"hbox"},margin:"0 5 0 5",bodyPadding:5,trackResetOnLoad:!0,items:[{xtype:"container",hidden:49==CBA.moduli.moduloAttivo?!1:!0,items:[{xtype:"combobox",width:400,itemId:"CboxUtente",reference:"CboxUtente",editable:!0,store:Ext.create("CS.pwd.store.Utenti",{autoLoad:!0}),labelWidth:60,labelClsExtra:"cbaCssLabel",
fieldLabel:"UTENTE",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"cssComboPazienti",flex:1,labelClsExtra:"cbaCssLabel",showIconInfo:!0,labelWidth:60,width:400,itemId:"CboxSoggetto",reference:"CboxSoggetto",fieldLabel:"1"==this.cbaConfig.area?"ASSISTITO":"DIPENDENTE",allowBlank:!0},{xtype:"combobox",width:400,itemId:"CboxRicovero",reference:"CboxRicovero",editable:!0,hidden:"1"==this.cbaConfig.area?!1:!0,store:Ext.create("Generali.personGenerali.privacyLog.store.RicoveriPrec",
{autoLoad:!1}),labelWidth:60,labelClsExtra:"cbaCssLabel",fieldLabel:"RICOVERO",displayField:"comboRicoveri",queryMode:"local",valueField:"id"}]},{xtype:"container",padding:0,margin:"0 0 0 30",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",padding:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"datefield",itemId:"DataDal",reference:"DataDal",labelWidth:60,width:280,maxValue:a,fieldLabel:"DATA_DAL",format:"d/m/Y",name:"dal",labelClsExtra:"cbaCssLabel",allowBlank:!0},{xtype:"timefield",
margin:"0 0 0 4",width:60,itemId:"OraDal",reference:"OraDal",format:"H:i",name:"_oraDal",labelClsExtra:"cbaCssLabel"}]},{xtype:"container",margin:"5 0 0 0",layout:{type:"hbox",align:"stretch"},padding:0,items:[{xtype:"datefield",itemId:"DataAl",reference:"DataAl",fieldLabel:"DATA_AL",labelWidth:60,width:280,maxValue:a,format:"d/m/Y",name:"al",labelClsExtra:"cbaCssLabel"},{xtype:"timefield",margin:"0 0 0 4",width:60,itemId:"OraAl",reference:"OraAl",format:"H:i",name:"_oraAl",labelClsExtra:"cbaCssLabel"}]}]}]}]},
{xtype:"container",layout:{type:"vbox",align:"stretch"},flex:1,margin:8,items:[{xtype:"gridpanel",itemId:"Grid",reference:"Grid",title:traduci("LOG"),flex:1,emptyText:traduci("NESSUN_DATO_DA_STAMPARE"),store:Ext.create("Generali.personGenerali.privacyLog.store.PrivacyLog",{}),columns:[{xtype:"gridcolumn",dataIndex:"id",text:"ID_LOG",width:80,sortable:!0},{xtype:"datecolumn",dataIndex:"dataOra",text:"DATA_LOG",flex:1,format:"d/m/Y H:i:s",align:"center",sortable:!0},{xtype:"gridcolumn",dataIndex:"nomeModulo",
text:"NOME_MODULO",width:100,sortable:!1},{xtype:"gridcolumn",dataIndex:"idModulo",text:"ID_MODULO",hidden:!0,width:100,sortable:!1},{xtype:"gridcolumn",flex:1,dataIndex:"tabella",text:"TABELLA",sortable:!0},{xtype:"gridcolumn",dataIndex:"idRecord",text:"ID_RECORD",width:80,sortable:!0},{xtype:"gridcolumn",flex:1,dataIndex:"queryString",text:"QUERY",sortable:!0},{xtype:"gridcolumn",flex:1,dataIndex:"nomeOperazione",text:"TIPO_OPERAZIONE",sortable:!0},{xtype:"gridcolumn",flex:1,dataIndex:"userId",
text:"OPERATORE",sortable:!1,hidden:!0},{xtype:"gridcolumn",flex:1,dataIndex:"funzione",text:"FUNZIONE",sortable:!0},{xtype:"gridcolumn",dataIndex:"userId",text:"ID_UTENTE",width:80,sortable:!0},{xtype:"gridcolumn",flex:1,dataIndex:"userName",text:"UTENTE",sortable:!0},{xtype:"gridcolumn",dataIndex:"idSoggetto",text:"1"==this.cbaConfig.area?"ID_ASSISTITO":"ID_DIPENDENTE",width:100,sortable:!0},{xtype:"gridcolumn",flex:1,dataIndex:"nomeSoggetto",text:"1"==this.cbaConfig.area?"NOME_ASSISTITO":"NOME_DIPENDENTE",
sortable:!0},{xtype:"gridcolumn",dataIndex:"idRicovero",text:"ID_RICOVERO",width:90,sortable:!0}],viewConfig:{loadMask:!1}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.personGenerali.scheduler.controller.Scheduler",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this._manuale=traduci("MANUALE");this.callParent(arguments);this.addRef([{ref:"Grid",selector:this.selContainer+"#Grid"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"RdgFrequenza",selector:this.selContainer+"#RdgFrequenza"},{ref:"Settimana",selector:this.selContainer+
"#Settimana"},{ref:"TipoScarico",selector:this.selContainer+"#TipoScarico"},{ref:"FsFrequenza",selector:this.selContainer+"#FsFrequenza"},{ref:"CntOrari",selector:this.selContainer+"#CntOrari"},{ref:"RdgRipetiOgni",selector:this.selContainer+"#RdgRipetiOgni"},{ref:"TxtMin",selector:this.selContainer+"#TxtMin"},{ref:"TxtOre",selector:this.selContainer+"#TxtOre"},{ref:"CkbRipetizione",selector:this.selContainer+"#CkbRipetizione"},{ref:"FsRipetiOgni",selector:this.selContainer+"#FsRipetiOgni"},{ref:"FsOrariScarico",
selector:this.selContainer+"#FsOrariScarico"},{ref:"Dalle",selector:this.selContainer+"#Dalle"},{ref:"Alle",selector:this.selContainer+"#Alle"},{ref:"ImageScaricoAut",selector:this.selContainer+"#ImageScaricoAut"},{ref:"BtnRiavSched",selector:this.selContainer+"#BtnRiavSched"},{ref:"GridOrariScheduler",selector:this.selContainer+"#GridOrariScheduler"},{ref:"BtnNuovoGridOrariScheduler",selector:this.selContainer+"#BtnNuovoGridOrariScheduler"},{ref:"BtnEliminaGridOrariScheduler",selector:this.selContainer+
"#BtnEliminaGridOrariScheduler"},{ref:"CampoDirty",selector:this.selContainer+"#CampoDirty"}]);this.control(this.selContainer+"#Grid",{select:this.selectGrid,afterrender:this.afterrenderGrid});this.control(this.selContainer+"#BtnRiavSched",{click:this.clickBtnRiavSched});this.control(this.selContainer+"#ImageScaricoAut",{render:this.renderImageScaricoAut});this.control(this.selContainer+"#RdgFrequenza",{change:this.changeRdgFrequenza});this.control(this.selContainer+"#TipoScarico",{change:this.changeTipoScarico});
this.control(this.selContainer+"#CkbRipetizione",{change:this.changeCkbRipetizione});this.control(this.selContainer+"#RdgRipetiOgni",{change:this.changeRdgRipetiOgni});this.control(this.selContainer+"#Dalle",{blur:this.blurDalle});this.control(this.selContainer+"#Alle",{blur:this.blurAlle});this.control(this.selContainer+"#GridOrariScheduler",{beforeedit:this.beforeeditGridOrariScheduler,edit:this.editGridOrariScheduler,canceledit:this.canceleditGridOrariScheduler,validateedit:this.validateeditGridOrariScheduler,
select:this.selectGridOrariScheduler});this.control(this.selContainer+"#BtnNuovoGridOrariScheduler",{click:this.clickBtnNuovoGridOrariScheduler});this.control(this.selContainer+"#BtnEliminaGridOrariScheduler",{click:this.clickBtnEliminaGridOrariScheduler})},afterrenderGrid:function(a){var b=this;a=a.getHeader();a.removeAll();a.addCls("css-header-portlet");var c=Ext.create("Ext.Img",{itemId:"IcnDetails",src:"/cba/css/generali/images/btnFunzione/update-arrow-white.svg",height:16,width:16,margin:"0 8 0 0",
tooltip:traduci("RICARICA_SCHEDULER"),listeners:{afterrender:function(a){a=a.getEl();a.on("click",function(){b.ricaricaScheduler()});a.setStyle("cursor","pointer");creaToolTipBubble(a,traduci("RICARICA_SCHEDULER"))}}});a.insert(0,c);c=Ext.create("Ext.form.Label",{itemId:"LabelTitoloWinCss",text:"Attivit",style:{"white-space":"nowrap","text-overflow":"ellipsis",display:"block",color:"#FFFFFF","text-align":"center"},flex:1,margin:"0 10 0 0"});a.insert(1,c)},selectGrid:function(a,b){this.aggiornaStore(b.get("id"))},
selectGridOrariScheduler:function(a,b){a.getStore().indexOf(b);Ext.isEmpty(b)||this.getBtnEliminaGridOrariScheduler().setDisabled(!1)},validateeditGridOrariScheduler:function(a,b,c){return msgShow("",[])},canceleditGridOrariScheduler:function(a,b,c){this.gestisciBottoniGrid(!1);a.grid.getStore().reload();Ext.each(a.grid.getStore().data.items,function(b){!Ext.isEmpty(b)&&Ext.isEmpty(b.data.ora)&&a.grid.getStore().remove(b)})},editGridOrariScheduler:function(a,b,c){b.record.getData();var d=a.getEditor().getForm();
d.controller=this;d.store=b.view.getStore();if(this.updateGrid){b.grid.getStore().remove(b.record);for(a=0;a<this.recGridOrariScheduler.length;a++)this.recGridOrariScheduler[a]==b.record.data&&this.recGridOrariScheduler.splice(a,1);this.recGridOrariScheduler.push(b.newValues);b.grid.getStore().insert(b.rowIdx,b.newValues);this.getCampoDirty().setValue(new Date);return!0}b.grid.getStore().remove(b.record);d.store.insert(0,b.newValues);Ext.each(d.store.data.items,function(a){Ext.Object.isEmpty(a.data)&&
d.store.remove(a)});this.recGridOrariScheduler.push(b.newValues);this.getCampoDirty().setValue(new Date);this.gestisciBottoniGrid(!1)},beforeeditGridOrariScheduler:function(a,b,c){this.updateGrid=b.value?!0:!1;if(!0===a.editing)return!1;a.getEditor().getForm()},clickBtnEliminaGridOrariScheduler:function(a){var b=this,c,d=b.getGridOrariScheduler(),e=d.getSelectionModel().getSelection()[0];e&&Messaggio("ATTENZIONE",traduci("ELIMINA_RECORD")+"?","YESNO","QUESTION",!1,function(){Ext.each(b.recGridOrariScheduler,
function(a,b){a==e.data&&(c=b)});b.recDeleteOrariScheduler.push(e.get("id"));b.recGridOrariScheduler.splice(c,1);b.getCampoDirty().setValue(new Date);d.getStore().remove(e)},function(){return!1})},clickBtnNuovoGridOrariScheduler:function(a){a=this.getGridOrariScheduler();var b=a.getSelectionModel(),c=a.getStore();this.gestisciBottoniGrid(!0);c.insert(0,{});b.select(0);a.getPlugin().startEdit(0,0)},gestisciBottoniGrid:function(a){this.getBtnNuovoGridOrariScheduler().setDisabled(a);this.getBtnEliminaGridOrariScheduler().setDisabled(a)},
ricaricaScheduler:function(a){Ext.Ajax.request({method:"POST",url:"/cba/css/cs/ws/quartz/scheduler/profili",jsonData:Ext.JSON.encode(CBA.parametriGenerali.idProfiloCss),success:function(a){a=Ext.JSON.decode(a.responseText);var b=[],d="";a.success?(d="MSG_SALVATAGGIO_DATI",msgAdd(b,"RICARICA_OK")):msgAddError(b,a.message);msgShow(d,b)}})},clickBtnRiavSched:function(a){me=this;Ext.Ajax.request({method:"GET",url:"/cba/css/cs/ws/quartz/restart",success:function(a){a=a.responseText;var b=[],d="";"OK"==
a?(d="MSG_OPERAZIONE_OK",msgAdd(b,"RIAVVIO_OK"),me.creaMex()):msgAddError(b,a.message);msgShow(d,b)}})},renderImageScaricoAut:function(a){var b=this;Ext.create("Ext.tip.ToolTip",{target:a.getId(),style:"display:inline-block;text-align:left;",listeners:{beforeshow:function(a){a.update(b.tooltipScarico)}}})},creaMex:function(){var a=this;a.tooltipScarico="";Ext.Ajax.request({method:"GET",url:"/cba/css/cs/ws/quartz/watch",success:function(b){a.tooltipScarico=b.responseText.replace(/---------------------------------------------/gi,
"</br>---------------------------------------------</br>");a.tooltipScarico=a.tooltipScarico.replace(/\n/g,"<br>")}})},blurDalle:function(a){var b=a.getValue();b&&a.setValue(new Date(b.setMinutes(0)))},blurAlle:function(a){var b=a.getValue();b&&a.setValue(new Date(b.setMinutes(0)))},changeRdgRipetiOgni:function(a,b){var c=this.getTxtOre(),d=this.getTxtMin();c.setDisabled("M"==b.tipoTime);d.setDisabled("H"==b.tipoTime);"H"==b.tipoTime?d.setValue(null):c.setValue(null)},changeCkbRipetizione:function(a,
b){this.getFsOrariScarico().setVisible(!b);this.getFsRipetiOgni().setVisible(b)},changeRdgFrequenza:function(a,b){this.getSettimana().setVisible("S"==b.ggFrequenza)},changeTipoScarico:function(a,b){this.getFsFrequenza().setVisible("T"==b.abilitato);this.getCntOrari().setVisible("T"==b.abilitato);this.getCkbRipetizione().setVisible("T"==b.abilitato)},verificaCampiForm:function(){var a=[],b=this.getForm(),c=b.getForm().getFieldValues();b.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");"T"!=c.abilitato||
"S"!=c.ggFrequenza||Ext.Array.contains(c.giorniScarico,!0)||msgAddError(a,"MSG_GG_SETT_OBB");c.ripetizione&&("H"==c.tipoTime&&0< !c.valoreOre?msgAddError(a,"MSG_RIPETIZIONE_ORE_MIN"):"M"==c.tipoTime&&0< !c.valoreMin&&msgAddError(a,"MSG_RIPETIZIONE_ORE_MIN"),!Ext.isEmpty(c.eseguiDalle)&&!Ext.isEmpty(c.eseguiAlle)&&c.eseguiDalle>=c.eseguiAlle&&msgAddError(a,"MSG_DALLE_MAG_UGUALE_ALLE"));return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues(),d=[];Ext.each(c.giorniScarico,
function(a,b){!0===a&&d.push(b+1)});var e=null,g=null,h=null,k=null,l=[],m=[],g=c.tipoTime,e="H"==c.tipoTime?c.valoreOre:c.valoreMin,h=c.eseguiDalle,k=c.eseguiAlle;Ext.isEmpty(h)&&!Ext.isEmpty(k)?h=new Date(1899,11,30,0,0,0,0):Ext.isEmpty(k)&&!Ext.isEmpty(h)&&(k=new Date(1899,11,31,0,0,0,0));m=this.recDeleteOrariScheduler;Ext.each(this.recGridOrariScheduler,function(a){l.push({id:Ext.isEmpty(a.id)?"-9999":a.id,idTestata:"-9999",ora:a.ora})});Ext.apply(c,{idModulo:CBA.moduli.moduloAttivo,giorni:d.toString(),
tipoTime:g,timeInterval:e,orariScheduler:l,orariDaCancellare:m,eseguiDalle:h,eseguiAlle:k});delete c.giorniScarico;delete c.dataUltimoScarico;delete c.idGruppo;delete c.campoDirty;delete c.valoreMin;delete c.valoreOre;c=convertiBool(c);controller_salvaRecord(b,c,a,!1,!0)},gestioneForm:function(){var a=this,b=a.getForm();b.permesso="S";b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=Ext.create("Generali.personGenerali.scheduler.store.Scheduler");b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",
{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){var b=a.getGrid(),c=b.getSelectionModel().getSelection()[0];a.recGridOrariScheduler=[];a.recDeleteOrariScheduler=[];b.getSelectionModel().select(c);a.aggiornaStore(c.get("id"))},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnElimina").hide();if("L"!=
b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.getGrid().setDisabled(e);a.getBtnRiavSched().setDisabled(e)})},gestioneGrid:function(a){var b=this.getGrid();b.getStore();Ext.Ajax.request({method:"GET",url:"/cba/css/cs/ws/generaliSipcar/impostaz/list",params:{idModulo:CBA.moduli.moduloAttivo},success:function(c){c=Ext.JSON.decode(c.responseText);var d=c.data;c.success?Ext.isEmpty(d)||(b.getSelectionModel().deselectAll(),Ext.each(d,function(a){b.getStore().add(a)}),
Ext.isEmpty(a)?b.getSelectionModel().select(0):b.getSelectionModel().select(a)):msgShowError("",c.message)}})},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),c=c.store;b.getGridOrariScheduler().getStore();c.load({params:{id:a},callback:function(a,c,h){h?(clearForm(b.getForm()),Ext.isEmpty(a)||(a=a[0],a.set("giorniScarico",Ext.JSON.decode("["+a.get("giorni")+"]")),a.set("valoreOre","H"==a.get("tipoTime")?a.get("timeInterval"):null),a.set("valoreMin","M"==a.get("tipoTime")?a.get("timeInterval"):
null),a.set("ggFrequenza",Ext.isEmpty(a.get("ggFrequenza"))?"T":a.get("ggFrequenza")),d.loadRecord(a),b.recGridOrariScheduler=[],b.getGridOrariScheduler().getStore().clearFilter(),svuotaStore(b.getGridOrariScheduler().getStore()),b.getGridOrariScheduler().getStore().loadData(a.get("orariScheduler")),b.recGridOrariScheduler=a.get("orariScheduler"),b.getBtnEliminaGridOrariScheduler().setDisabled(!0)),b.creaMex()):msgShowError("",c.getError())}})},onLaunch:function(){this.recGridOrariScheduler=[];this.recDeleteOrariScheduler=
[];this.gestioneGrid();this.gestioneForm()},destroy:function(){eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.personGenerali.scheduler.store.Scheduler",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idEntePwd"},{name:"idOrganizzazione"},{name:"idProfilo"},{name:"abilitato"},{name:"idModulo"},{name:"idJob"},{name:"ggFrequenza"},{name:"giorni"},{name:"ripetizione"},{name:"tipoTime"},{name:"timeInterval"},{name:"eseguiDalle",type:"date"},{name:"eseguiAlle",type:"date"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/scheduler/impostaz/get",reader:{type:"json",messageProperty:"message",
rootProperty:"data"},api:{read:"/cba/gen/ws/general/scheduler/impostaz/get",create:"/cba/gen/ws/general/scheduler/impostaz/new",update:"/cba/gen/ws/general/scheduler/impostaz/update",destroy:"/cba/gen/ws/general/scheduler/impostaz/delete"}},autoDestroy:!0});
Ext.define("Generali.personGenerali.scheduler.store.SchedulerOrariScarico",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idTestata"},{name:"ora",type:"date"}],proxy:{type:"ajax",method:"GET",url:"/cba/gen/ws/general/scheduler/impostaz/get",api:{read:"/cba/gen/ws/general/scheduler/impostaz/get"},reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0,remoteSort:!0});
Ext.define("Generali.personGenerali.scheduler.view.Scheduler",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},flex:1,initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"form",itemId:"Form",reference:"Form",flex:1,border:0,trackResetOnLoad:!0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idEntePwd",hidden:!0},{xtype:"textfield",
name:"idOrganizzazione",hidden:!0},{xtype:"textfield",name:"idJob",hidden:!0},{xtype:"textfield",name:"idProfilo",hidden:!0},{xtype:"textfield",itemId:"CampoDirty",reference:"CampoDirty",name:"campoDirty",hidden:!0},{xtype:"container",layout:{type:"hbox",flex:1},margin:"10 10 10 10",items:[{xtype:"label",html:'<img height=16 width=16 class="icon-alarm-clock" src="'+Ext.BLANK_IMAGE_URL+'"></img>',itemId:"ImageScaricoAut",reference:"ImageScaricoAut",margin:"3 0 0 0 "},{xtype:"button",itemId:"BtnRiavSched",
reference:"BtnRiavSched",text:"RIAVVIA_SCHEDULER",cls:"cbaCssBtnFunzione-special",margin:"0 0 0 15",width:230}]},{xtype:"gridpanel",itemId:"Grid",reference:"Grid",title:traduci("ATTIVITA"),height:170,emptyText:traduci("GRID_JOBS_VUOTA"),store:Ext.create("Generali.personGenerali.scheduler.store.Scheduler"),columns:[{xtype:"gridcolumn",flex:1,dataIndex:"id",hidden:!0,text:"ID"},{xtype:"gridcolumn",flex:1,dataIndex:"idJob",hidden:!0,text:"ID_JOB"},{xtype:"gridcolumn",flex:1,dataIndex:"desJob",text:"DESCRIZIONE"},
{xtype:"gridcolumn",width:"100",dataIndex:"idEntePwd",text:"ENTE",renderer:function(a,b,c,d,e,g){return Ext.isEmpty(a)?"":"*"}},{xtype:"gridcolumn",flex:1,dataIndex:"desOrganizzazione",text:"ORGANIZZAZIONE"},{xtype:"gridcolumn",flex:1,dataIndex:"desProfilo",text:"PROFILO"}],viewConfig:{loadMask:!1}},{xtype:"container",border:0,scrollable:!0,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",border:0,items:[{xtype:"container",margin:"10 10 10 10",items:[{xtype:"fieldset",title:"ABILITATO",
width:150,items:[{xtype:"radiogroup",itemId:"TipoScarico",reference:"TipoScarico",items:[{boxLabel:"NO",name:"abilitato",cls:"cbaLabel",margin:"0 30 0 0",inputValue:"F",checked:!0},{boxLabel:"SI",name:"abilitato",cls:"cbaLabel",inputValue:"T"}]}]},{xtype:"checkboxfield",hidden:!0,cls:"cbaLabel",boxLabel:"RIPETIZIONE",itemId:"CkbRipetizione",reference:"CkbRipetizione",isFormField:!0,name:"ripetizione",inputValue:"T",uncheckedValue:"F"}]},{xtype:"container",itemId:"CntOrari",reference:"CntOrari",margin:"10 10 10 10",
hidden:!0,items:[{xtype:"fieldset",itemId:"FsRipetiOgni",reference:"FsRipetiOgni",title:"SCARICA_OGNI",width:300,hidden:!0,items:[{xtype:"radiogroup",vertical:!0,columns:1,margin:"10 0 10 0",itemId:"RdgRipetiOgni",reference:"RdgRipetiOgni",items:[{xtype:"container",layout:{type:"hbox"},items:[{xtype:"radio",boxLabel:"ORE",name:"tipoTime",cls:"cbaLabel",inputValue:"H",checked:!0,width:80},{xtype:"splitter"},{xtype:"numberfield",allowDecimals:!1,hideTrigger:!1,itemId:"TxtOre",reference:"TxtOre",minValue:0,
maxValue:23,width:70,name:"valoreOre"}]},{xtype:"container",layout:"hbox",items:[{xtype:"radio",boxLabel:"MINUTI",name:"tipoTime",cls:"cbaLabel",inputValue:"M",width:80},{xtype:"splitter"},{xtype:"numberfield",itemId:"TxtMin",reference:"TxtMin",allowDecimals:!1,hideTrigger:!1,minValue:0,maxValue:59,width:70,name:"valoreMin"}]}]},{xtype:"container",margin:"10 0 10 0",layout:"hbox",items:[{xtype:"timefield24",itemId:"Dalle",reference:"Dalle",fieldLabel:"DALLE",labelClsExtra:"cbaLabel",labelAlign:"left",
name:"eseguiDalle",format:"H:i",labelWidth:35,width:90,margin:"0 5 0 0"},{xtype:"timefield24",itemId:"Alle",reference:"Alle",fieldLabel:"ALLE",labelClsExtra:"cbaLabel",labelAlign:"left",name:"eseguiAlle",format:"H:i",labelWidth:35,width:110,listeners:{render:function(a){creaToolTipInfo(a,"PRZ_TOOLTIP_AZZERA_MINUTI")}}}]}]},{xtype:"fieldset",itemId:"FsOrariScarico",reference:"FsOrariScarico",title:"ORARI",width:300,items:[{xtype:"gridpanel",itemId:"GridOrariScheduler",reference:"GridOrariScheduler",
store:Ext.create("Generali.personGenerali.scheduler.store.SchedulerOrariScarico"),flex:1,border:0,height:180,columns:[{xtype:"gridcolumn",flex:1,hidden:!0,align:"center",style:"text-align:center",dataIndex:"id",text:"ID"},{xtype:"gridcolumn",flex:1,hidden:!0,align:"center",style:"text-align:center",dataIndex:"idTestata",text:"ID_TESTATA"},{xtype:"datecolumn",text:"ORA",dataIndex:"ora",flex:1,align:"center",sortable:!1,format:"H:i",editor:{xtype:"timefield24",allowBlank:!1,format:"H:i"}}],viewConfig:{loadMask:!1},
plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoGridOrariScheduler",reference:"BtnNuovoGridOrariScheduler",iconCls:"icon-inserisciGriglia",style:{"background-color":"#77b0e2","border-color":"#4b80af"},text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaGridOrariScheduler",reference:"BtnEliminaGridOrariScheduler",iconCls:"icon-eliminaGriglia",style:{"background-color":"#77b0e2","border-color":"#4b80af"},
text:"Elimina"}]}]}]}]}]},{xtype:"fieldset",title:"FREQUENZA",margin:"10 10 10 10",hidden:!0,itemId:"FsFrequenza",reference:"FsFrequenza",items:[{xtype:"radiogroup",columns:2,itemId:"RdgFrequenza",reference:"RdgFrequenza",items:[{boxLabel:"TUTTI_GIORNI",name:"ggFrequenza",cls:"cbaLabel",inputValue:"T",checked:!0},{boxLabel:"GIORNI_DELLA_SETTIMANA",name:"ggFrequenza",cls:"cbaLabel",inputValue:"S"}]},{xtype:"cbaMultipleChoice",itemId:"Settimana",reference:"Settimana",hidden:!0,style:{border:"0px!important"},
cbaConfig:{itemsCfg:[{html:traduci("LUN"),name:"giorniScarico",isFormField:!0,inputValue:1,width:60},{html:traduci("MAR"),name:"giorniScarico",isFormField:!0,inputValue:2,width:60},{html:traduci("MER"),name:"giorniScarico",isFormField:!0,inputValue:3,width:60},{html:traduci("GIO"),name:"giorniScarico",isFormField:!0,inputValue:4,width:60},{html:traduci("VEN"),name:"giorniScarico",isFormField:!0,inputValue:5,width:60},{html:traduci("SAB"),name:"giorniScarico",isFormField:!0,inputValue:6,width:60},
{html:traduci("DOM"),name:"giorniScarico",isFormField:!0,inputValue:7,width:60}]}}]}]}],dockedItems:[{xtype:"container",margin:"5 0 0 0",itemId:"BoxBottoni",reference:"BoxBottoni",dock:"bottom"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.personPagoPA.controller.PersonPagoPA",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Container",selector:this.selContainer+"#Container"},{ref:"Form",selector:this.selContainer+"#Form"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"StoricoDataDal",selector:this.selContainer+"#StoricoDataDal"},{ref:"DataDecorrenza",selector:this.selContainer+"#DataDecorrenza"},
{ref:"CBTipoPayer",selector:this.selContainer+"#CBTipoPayer"},{ref:"CBVersioneTracciato",selector:this.selContainer+"#CBVersioneTracciato"},{ref:"BtnEnableAbilitazioni",selector:this.selContainer+"#BtnEnableAbilitazioni"},{ref:"CboxAbilitazioniPortaleUtenti",selector:this.selContainer+"#CboxAbilitazioniPortaleUtenti"},{ref:"TxtUsername",selector:this.selContainer+"#TxtUsername"},{ref:"TxtPassword",selector:this.selContainer+"#TxtPassword"},{ref:"TxtUrlDominio",selector:this.selContainer+"#TxtUrlDominio"}]);
this.control(this.selContainer+"#BtnEnableAbilitazioni",{click:this.enableAbilitazioni});this.control(this.selContainer+"#StoricoDataDal",{select:this.onStoricoDataDalSelect});this.control(this.selContainer+"#CBTipoPayer",{change:this.changeTipoPayer})},filtraVersione:function(a){var b=this.getCBVersioneTracciato(),c=this.getView().storeVersioneTracciato;b.reset();c.clearFilter();c.filter("extra",a);0<c.getCount()?(a=c.getAt(0),b.setValue(a.get("codice"))):b.reset()},changeTipoPayer:function(a,b,
c,d){"3"==b?(this.getTxtUrlDominio().show(),this.getTxtUrlDominio().allowBlank=!1,this.getTxtUsername().allowBlank=!1,this.getTxtPassword().allowBlank=!1):(this.getTxtUrlDominio().hide(),this.getTxtUrlDominio().allowBlank=!0,this.getTxtUsername().allowBlank=!0,this.getTxtPassword().allowBlank=!0);this.filtraVersione(b)},onStoricoDataDalSelect:function(a,b,c,d,e,g){this.impostaDati(b)},enableAbilitazioni:function(a){var b=this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(c){c?
(a.hide(),b.getCboxAbilitazioniPortaleUtenti().setReadOnly(!1)):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()},impostaDati:function(a){var b=this.getForm();this.getStoricoDataDal().setDisabled(!1);clearForm(b);a&&b.loadRecord(a)},nuovo:function(){var a=this.getForm(),b=a.getForm();this.getStoricoDataDal().setDisabled(!0);this.getBoxBottoni().queryById("btnNuovo").setDisabled(!0);this.getBoxBottoni().queryById("btnElimina").setDisabled(!0);controller_nuovoRecord(a);this.getDataDecorrenza().setValue(new Date);
1==this.getCBTipoPayer().getStore().getCount()&&b.setValues({tipoPayer:this.getCBTipoPayer().getStore().getAt(0).get("codice"),versioneTracciato:this.getCBVersioneTracciato().getStore().getAt(2).get("codice")});a=this.getStoricoDataDal().getStore();b=a.data.length-1;0<=b?(a=a.getData().items[b].copy(),a.data.id=-9999,a.data.dataDecorrenza=new Date,this.impostaDati(a)):this.getCboxAbilitazioniPortaleUtenti().setValue("F")},verificaCampiForm:function(){var a=[];this.getForm().isValid()||msgAddError(a,
"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getForm(),c=b.getForm().getFieldValues();Ext.apply(c,{idOrganizzazione:this.cbaConfig.idOrganizzazione,tipoPayer:this.getCBTipoPayer().getValue(),portaleUtenti:c.portaleUtenti});controller_salvaRecord(b,c,a);["T","P"].includes(c.portaleUtenti)&&this.updatePortaleEnteDettaglio(c)},updatePortaleEnteDettaglio:function(a){Ext.Ajax.request({url:getUrlGen()+"/ws/portale/updateEnteDet",method:"POST",jsonData:Ext.JSON.encode(a),
success:function(a){a=Ext.JSON.decode(a.responseText);a.success?Messaggio("MSG_OPERAZIONE_OK",a.message[0].testo,"OK","INFO"):Messaggio("MSG_ERRORE_SERVER_GENERICO",a.message[0].testo,"OK","ERROR")},failure:function(a){a=Ext.JSON.decode(a.responseText);Messaggio("MSG_ERRORE_SERVER_GENERICO",a?a.message[0].testo:"Errore salvataggio credenziali su Portale Utenti","OK","ERROR")}})},gestioneForm:function(){var a=this,b=a.getForm();b.setTitle(traduci("GESTIONE_PERSONALIZZAZIONI")+" - "+a.cbaConfig.text);
b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.getStoricoDataDal().getStore();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(c){0!=a.salvaForm(c)?(b.getForm().reset,a.getStoricoDataDal().setDisabled(!1),a.getBoxBottoni().queryById("btnConferma").setDisabled(!0),a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!0)):(a.getBoxBottoni().queryById("btnNuovo").setDisabled(!0),a.getBoxBottoni().queryById("btnElimina").setDisabled(!0),
a.getBoxBottoni().queryById("btnConferma").setDisabled(!1),a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!1))},annulla_callback:function(){var b=a.getForm().getValues().id;a.getStoricoDataDal().setDisabled(!1);clearForm(a.getForm());a.aggiornaStore(b);a.getBoxBottoni().queryById("btnConferma").setDisabled(!0);a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!0)},nuovo_callback:function(){a.nuovo()},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||
controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStore();clearForm(a.getForm())})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(a.getBoxBottoni(),c);a.getBoxBottoni().queryById("btnEsci").setVisible(!1);if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStore:function(a){var b=this,c=b.getForm(),d=c.getForm(),e=c.store;e.load({params:{idOrg:b.cbaConfig.idOrganizzazione},
callback:function(g,h,k){k?Ext.isEmpty(g)?clearForm(c):(a||(a=d.findField("id").getValue()),g=trovaRecord(e,"id",a),h=b.getStoricoDataDal(),h.getSelectionModel().deselectAll(),h.getSelectionModel().select(g?[g]:0)):msgShowError("",h.getError());b.getBtnEnableAbilitazioni().isVisible()||(b.getBtnEnableAbilitazioni().show(),b.getCboxAbilitazioniPortaleUtenti().setReadOnly(!0))}})},onLaunch:function(){this.filtraVersione("-1");this.gestioneForm();this.aggiornaStore()},destroy:function(){eliminaStore(this.storeForm);
this.callParent()}});
Ext.define("Generali.personPagoPA.store.PersonPagoPA",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"dataDecorrenza",type:"date"},{name:"uidPagoPA"},{name:"pwdPagoPA"},{name:"codIPA"},{name:"tipoPayer"},{name:"versioneTracciato"},{name:"portaleUtenti"},{name:"urlDominio"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pagoPA/prszn/search",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{create:"/cba/gen/ws/general/pagoPA/prszn/new",update:"/cba/gen/ws/general/pagoPA/prszn/update",
destroy:"/cba/gen/ws/general/pagoPA/prszn/delete"}},autoDestroy:!0});
Ext.define("Generali.personPagoPA.view.PersonPagoPA",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){this.storeTipoPayer=new Ext.data.ArrayStore({fields:["codice","valore"],data:[["1",traduci("PAGOPA_TIPOPAYER_MYPAY_TN")],["2",traduci("PAGOPA_TIPOPAYER_MYPAY_VR")],["3",traduci("PAGOPA_TIPOPAYER_DEDANET")]],autoLoad:!0,autoDestroy:!0});this.storeVersioneTracciato=new Ext.data.ArrayStore({fields:["id","codice","valore","extra"],data:[["1",
"1","1.1","1"],["2","2","1.2","1"],["3","3","1.3","1"],["4","1","1.1","2"],["5","2","1.2","2"],["6","3","1.3","2"],["7","10","10","3"]],autoLoad:!0,autoDestroy:!0});this.storeAbilitazioniPortaleUtenti=new Ext.data.ArrayStore({fields:["codice","valore"],data:[["F",traduci("PAGOPA_PORTALEUTENTI_NESSUNA"),""],["P",traduci("PAGOPA_PORTALEUTENTI_PUBBLICAZIONE"),""],["T",traduci("PAGOPA_PORTALEUTENTI_PAGAMENTO"),""]],autoLoad:!0,autoDestroy:!0});Ext.applyIf(this,{items:[{xtype:"gridpanel",title:"ELENCO",
width:110,itemId:"StoricoDataDal",reference:"StoricoDataDal",store:Ext.create("Generali.personPagoPA.store.PersonPagoPA"),columns:[{xtype:"datecolumn",dataIndex:"dataDecorrenza",text:"DATA_DECORRENZA",flex:1,format:"d/m/Y",align:"center"}],trackResetOnLoad:!0,selModel:Ext.create("Ext.selection.RowModel",{})},{xtype:"form",flex:1,itemId:"Form",reference:"Form",autoScroll:!0,layout:{type:"vbox"},bodyPadding:10,trackResetOnLoad:!0,items:[{xtype:"textfield",name:"id",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",
hidden:!0},{xtype:"datefield",itemId:"DataDecorrenza",reference:"DataDecorrenza",fieldLabel:"DATA_DECORRENZA",labelClsExtra:"cbaLabel",labelWidth:106,name:"dataDecorrenza",width:215},{xtype:"fieldset",bodyPadding:10,margin:"5 0 5 0",width:400,title:"ACCOUNT",itemId:"Account",reference:"Account",items:[{xtype:"combobox",itemId:"CBTipoPayer",reference:"CBTipoPayer",emptyText:" ",labelWidth:100,width:320,store:this.storeTipoPayer,name:"tipoPayer",fieldLabel:"PAGOPA_TIPOPAYER",labelClsExtra:"cbaLabel",
displayField:"valore",valueField:"codice",mode:"local",allowBlank:!1,editable:!1,matchFieldWidth:!0},{xtype:"combobox",itemId:"CBVersioneTracciato",reference:"CBVersioneTracciato",emptyText:" ",labelWidth:100,width:320,store:this.storeVersioneTracciato,name:"versioneTracciato",fieldLabel:"PAGOPA_VERSIONE_TRACCIATO",labelClsExtra:"cbaLabel",displayField:"valore",valueField:"codice",mode:"local",allowBlank:!1,editable:!1,matchFieldWidth:!0},{xtype:"textfield",itemId:"TxtUsername",reference:"TxtUsername",
fieldLabel:"USERNAME",name:"uidPagoPA",labelClsExtra:"cbaLabel",margin:"5 0 10 0",width:320,maxLength:50,enforceMaxLength:!0},{xtype:"textfield",itemId:"TxtPassword",reference:"TxtPassword",fieldLabel:"PASSOWRD",inputType:"password",name:"pwdPagoPA",margin:"5 0 10 0",width:320,labelClsExtra:"cbaLabel",listeners:{change:function(a,b,c,d){c=!0;b&&a.isValid()&&(Ext.isEmpty(b)||Ext.isEmpty(b.trim())||(c=!1));a.triggers.change.setHidden(c)}},triggers:{change:{cls:"icon-copy",tooltip:traduci("COPIA"),hidden:!0,
handler:function(a){!Ext.isEmpty(a.getValue())&&a.isValid()&&(a=document.getElementById(a.getId()+"-inputEl"),a.type="text",a.select(),document.execCommand("copy"),a.type="password")}}}},{xtype:"textfield",fieldLabel:"PAGOPA_CODICE_IPA",name:"codIPA",labelClsExtra:"cbaLabel",margin:"5 0 10 0",width:320,maxLength:30,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"PAGOPA_URL_DOMINIO",itemId:"TxtUrlDominio",reference:"TxtUrlDominio",name:"urlDominio",labelClsExtra:"cbaLabel",margin:"5 0 10 0",width:320,
maxLength:200,enforceMaxLength:!0,validator:function(a){return/^(?!.*(?:http:|https:))(?!.*\/).*/.test(a)?!0:traduci("PAGOPA_MSG_URL_DOMINIO_NON_VALIDO")}}]},{xtype:"fieldset",title:"Abilitazioni",layout:{type:"hbox"},bodyPadding:10,margin:"5 0 5 0",width:400,items:[{xtype:"container",layout:"vbox",margin:"10 0 0 0",items:[{xtype:"checkboxfield",margin:"10 0 10 3",itemId:"AbilitazioneInvio",reference:"AbilitazioneInvio",boxLabel:"PAGOPA_ABILITAZIONE_INVIO",cls:"cbaLabel",name:"invio",inputValue:"T",
uncheckedValue:"F",checked:!0,readOnly:!0,isFormField:!1},{xtype:"combobox",itemId:"CboxAbilitazioniPortaleUtenti",reference:"CboxAbilitazioniPortaleUtenti",margin:"10 0 10 3",width:315,name:"portaleUtenti",fieldLabel:traduci("PAGOPA_ABILITAZIONE_PORTALEUTENTI"),labelAlign:"top",labelClsExtra:"cbaLabel",editable:!1,store:this.storeAbilitazioniPortaleUtenti,displayField:"valore",queryMode:"local",valueField:"codice",matchFieldWidth:!1,allowBlank:!1,readOnly:!0}]},{xtype:"button",itemId:"BtnEnableAbilitazioni",
reference:"BtnEnableAbilitazioni",margin:"0 0 0 15",cls:"cba-button-25",iconCls:"icon-locked",tooltip:"SBLOCCA",width:25}]}]},{xtype:"panel",region:"east",itemId:"BoxBottoni",reference:"BoxBottoni",width:120,title:""}]});this.callParent(arguments)}});
Ext.define("personStampe.controller.PersonStampeCnt",{extend:"Ext.app.Controller",refs:[{ref:"PersonStampe_Container",selector:"#PersonStampe_Container"},{ref:"PersonStampe_boxBottoni",selector:"#PersonStampe_boxBottoni"},{ref:"PersonStampe_albero",selector:"#PersonStampe_albero"},{ref:"PersonStampe_pnlAlbero",selector:"#PersonStampe_pnlAlbero"},{ref:"PersonStampe_grid1",selector:"#PersonStampe_grid1"},{ref:"PersonStampe_grid2",selector:"#PersonStampe_grid2"},{ref:"PersonStampe_su",selector:"#PersonStampe_su"},
{ref:"PersonStampe_giu",selector:"#PersonStampe_giu"},{ref:"PersonStampe_elimina",selector:"#PersonStampe_elimina"},{ref:"PersonStampe_contDati",selector:"#PersonStampe_contDati"},{ref:"PersonStampe_tabella",selector:"#PersonStampe_tabella"},{ref:"PersonStampe_form",selector:"#PersonStampe_form"},{ref:"PersonStampe_tabOrg",selector:"#PersonStampe_tabOrg"},{ref:"PersonStampe_formOrg",selector:"#PersonStampe_formOrg"},{ref:"PersonStampe_tabCampi",selector:"#PersonStampe_tabCampi"},{ref:"PersonStampe_tabPanel",
selector:"#PersonStampe_tabPanel"},{ref:"PersonStampe_campiHidden",selector:"#PersonStampe_campiHidden"}],onPersonStampe_ContainerBeforeRender:function(a,b){var c=this,d=getConfigMenu();c.storeAlbero=Ext.create("personStampe.store.PersonStampe_albero",{autoDestroy:!0});c.storeCampi=Ext.create("personStampe.store.PersonStampe_campi",{autoDestroy:!0});c.storeOrg=Ext.create("personStampe.store.PersonStampe_org",{autoDestroy:!0});var e=Ext.create("Ext.tree.Panel",{autoScroll:!0,displayField:"titolo",
width:300,store:c.storeAlbero,itemId:"PersonStampe_pnlAlbero",reference:"PersonStampe_pnlAlbero",useArrows:!0,rootVisible:!1,viewConfig:{loadMask:!1}});a.queryById("PersonStampe_campi").insert(0,e);var g=c.getPersonStampe_Container(),h=c.getPersonStampe_form();c.idOrganizzazione=g.cbaConfig.idOrganizzazione;h.permesso=g.cbaConfig.permesso;h.boxBottoni=this.getPersonStampe_boxBottoni();h.store=c.storeAlbero;h.aggiornaStore=function(a){e.getStore().load({params:{idModulo:d.idModulo,codEnte:CBA.parametriGenerali.codEnte,
idOrganizzazione:c.idOrganizzazione},callback:function(b,c,d){d?(b=e.getRootNode().findChild("id",a,!0),e.expandAll(),b?(e.getSelectionModel().select(0),e.getSelectionModel().select([b])):e.getSelectionModel().select(0)):msgShowError("",c.getError())}})};h.impostaDati=function(a){clearForm(h);a&&h.loadRecord(a);c.setConfigGriglie(a);var b=0;a&&(b=a.get("versioneModelloReport"));var d="L"==h.permesso||a&&!a.get("leaf")||0>=b;containerSolaLettura(c.getPersonStampe_contDati(),d);a&&a.get("leaf")&&controller_abilitaBottoni(h);
h.boxBottoni.queryById("btnNuovo").setVisible(0===b);h.boxBottoni.queryById("btnElimina").setVisible(0<b);h.boxBottoni.queryById("btnConferma").setVisible(0<b);h.boxBottoni.queryById("btnAnnulla").setVisible(0<b)};h.verificaCampiForm=function(a){a=[];h.isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)};g=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(a){c.salvaCampi(h,a)},esci_callback:function(){},annulla_callback:function(){h.aggiornaStore()},
nuovo_callback:function(){c.copiaFoglia(h)},elimina_callback:function(){eliminaRecordQuestion(h,h.store,["id"])},verificaCampiForm_callback:function(){return!0}}});inserisciBottoni(h.boxBottoni,g);h.boxBottoni.queryById("btnEsci").hide();if("L"!=h.permesso)h.on("dirtychange",function(a,b){controller_abilitaBottoni(h);b?e.setDisabled(!0):e.setDisabled(!1)});"L"==h.permesso&&(containerSolaLettura(c.getPersonStampe_contDati()),controller_bottoniSolaLettura(h.boxBottoni));h.aggiornaStore();c.getPersonStampe_campiHidden().hide();
Localizer.localize(a)},onButtonClickPersonStampe_elimina:function(a,b,c){a=this.getPersonStampe_grid1();b=this.getPersonStampe_grid2();if(c=b.getSelectionModel().getSelection()[0])b.getStore().remove(c),a.getStore().add(c),0<b.getStore().getTotalCount()&&b.getSelectionModel().select(0),setEditForm(this.getPersonStampe_form())},onButtonClickPersonStampe_su:function(a,b,c){spostaRiga(this.getPersonStampe_grid2(),-1);setEditForm(this.getPersonStampe_form())},onButtonClickPersonStampe_giu:function(a,
b,c){spostaRiga(this.getPersonStampe_grid2(),1);setEditForm(this.getPersonStampe_form())},onComboboxSelectPersonStampe_tabella:function(a,b,c){this.aggiornaCampi(a?a.value:0)},onTabpanelBeforeTabChangePersonStampe_tabPanel:function(a,b,c,d){a=this.getPersonStampe_form();b=this.getPersonStampe_formOrg();return!a.getForm().isDirty()&&!b.getForm().isDirty()},onTreepanelBeforeItemContextMenu:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},onPersonStampe_ContainerDestroy:function(a,b){eliminaStore(this.storeAlbero);
eliminaStore(this.storeCampi);eliminaStore(this.storeOrg)},onTreepanelItemClick:function(a,b,c,d,e,g){this.getPersonStampe_form().impostaDati(b)},setConfigGriglie:function(a){if(!a)return!1;var b=this,c=b.getPersonStampe_form(),d=b.getPersonStampe_grid1(),e=b.getPersonStampe_grid2(),g=b.getPersonStampe_tabella();if(!a.get("leaf"))return clearForm(c),svuotaStore(d.getStore()),svuotaStore(e.getStore()),!1;d.getView().hasListener("drop")||(d.store=Ext.create("Ext.data.ArrayStore",{fields:["caption",
"id","infoGroupDesc"],autoLoad:!0,groupField:"infoGroupDesc",sorters:[{property:"infoGroupDesc",direction:"ASC"}]}),e.store=Ext.create("Ext.data.ArrayStore",{fields:["caption","id","infoGroupDesc"],autoLoad:!0}),d.getView().addListener("drop",function(a,c,e,g){d.getStore().group("infoGroupDesc");d.getStore().sort("infoGroupDesc");setEditForm(b.getPersonStampe_form())}),e.getView().addListener("drop",function(a,c,e,g){d.getStore().group("infoGroupDesc");d.getStore().sort("infoGroupDesc");setEditForm(b.getPersonStampe_form())}),
d.getView().addListener("beforedrop",function(a,b,c,e,g){d.solaLettura&&g.cancelDrop()}),e.getView().addListener("beforedrop",function(a,b,c,d,g){e.solaLettura&&g.cancelDrop()}));b.storeCampi.getProxy().extraParams={idOrganizzazione:a.get("idOrganizzazione"),modelName:a.get("siglaModelloReport"),modelVersion:a.get("versioneModelloReport")};b.storeCampi.load({callback:function(a,k,l){if(l){var h=[];a&&(k=a[0].get("components"),Ext.each(k,function(a){h.push([a.key,a.key])}));k=Ext.create("Ext.data.ArrayStore",
{fields:["codice","valore"],data:h,autoLoad:!0});g.store=k;k=0;a&&(a=g.getStore().getAt(0),c.getForm().setValues({tabella:a}),k=a.get("codice"));b.aggiornaCampi(k)}else svuotaStore(d.getStore()),svuotaStore(e.getStore())}})},aggiornaCampi:function(a){var b=this.getPersonStampe_grid1(),c=this.getPersonStampe_grid2(),d=b.getStore(),e=c.getStore(),g=[],h=[];this.storeCampi.each(function(b){b&&(b=b.get("components"),Ext.each(b,function(b){b.key==a&&Ext.each(b.columns,function(a){var b=[a.caption,a.id,
a.infoGroupDesc];a.visible?h.push(b):g.push(b)})}))});d.loadData(g);e.loadData(h);b.bindStore(d);c.bindStore(e)},updateAlberoCampi:function(a){var b=this.getPersonStampe_grid2(),c=this.getPersonStampe_tabella(),d=b.getStore();0>a.id&&(a=this.storeCampi.getAt(0),a.set("originModelName",a.get("modelName")),a.set("originModelVersion",a.get("modelVersion")));var e=c.getValue();this.storeCampi.each(function(a){a&&(a=a.get("components"),Ext.each(a,function(a){a.key==e&&Ext.each(a.columns,function(a){var b=
trovaRecord(d,"id",a.id);b?(a.visible=!0,a.position=d.indexOf(b)+1):a.visible=!1})}))});return this.storeCampi.getAt(0).getData()},copiaFoglia:function(a){containerSolaLettura(this.getPersonStampe_contDati(),!1);a.boxBottoni.queryById("btnConferma").setVisible(!0);a.boxBottoni.queryById("btnAnnulla").setVisible(!0);var b=this.getPersonStampe_pnlAlbero(),c=b.getSelectionModel().getSelection()[0],d=c.copy();d.setId(-9999);c.parentNode.appendChild(d);b.getSelectionModel().select([d]);a.getForm().setValues({versioneModelloReport:1,
titolo:traduci("COPIARECORD")+" - "+c.get("titolo")});a.queryById("recordId").setValue(-9999);this.setConfigGriglie(c)},salvaCampi:function(a,b){var c=a.getForm().getFieldValues();if(!a.verificaCampiForm(c))return!1;c.idOrganizzazione=this.idOrganizzazione;delete c.tabella;Ext.apply(c,{modelTemplate:this.updateAlberoCampi(c)});controller_salvaRecord(a,c,b)},init:function(a){this.control({"container#PersonStampe_Container":{beforerender:this.onPersonStampe_ContainerBeforeRender,destroy:this.onPersonStampe_ContainerDestroy},
"button#PersonStampe_elimina":{click:this.onButtonClickPersonStampe_elimina},"button#PersonStampe_su":{click:this.onButtonClickPersonStampe_su},"button#PersonStampe_giu":{click:this.onButtonClickPersonStampe_giu},"combobox#PersonStampe_tabella":{select:this.onComboboxSelectPersonStampe_tabella},"tabpanel#PersonStampe_tabPanel":{beforetabchange:this.onTabpanelBeforeTabChangePersonStampe_tabPanel},"treepanel#PersonStampe_pnlAlbero":{beforeitemcontextmenu:this.onTreepanelBeforeItemContextMenu,itemclick:this.onTreepanelItemClick}})}});
Ext.define("personStampe.store.PersonStampe_albero",{extend:"Ext.data.TreeStore",constructor:function(a){a=a||{};this.callParent([Ext.apply({autoLoad:!1,storeId:"PersonStampe_albero",root:{expanded:!1},proxy:{type:"ajax",api:{read:"/cba/gen/ws/general/menuItem/src/getPrnMenu",create:"/cba/gen/ws/general/menuItemReport/new",update:"/cba/gen/ws/general/menuItemReport/update",destroy:"/cba/gen/ws/general/menuItem/delete"},url:"/cba/gen/ws/general/menuItem/src/getPrnMenu",reader:{type:"json",messageProperty:"message",
rootProperty:"children"}},fields:[{name:"id"},{name:"idModuloPrg"},{name:"codEnte"},{name:"idOrganizzazione"},{name:"idPadre"},{name:"posizione"},{name:"codVideataPwd"},{name:"titolo"},{name:"descrizione"},{name:"progetto"},{name:"nomeForm"},{name:"iconCls"},{name:"siglaModelloReport"},{name:"versioneModelloReport"},{name:"siglaQualita"},{name:"leaf"},{name:"expanded"}]},a)])}});
Ext.define("personStampe.store.PersonStampe_campi",{extend:"Ext.data.Store",constructor:function(a){a=a||{};this.callParent([Ext.apply({storeId:"PersonStampe_campi",proxy:{type:"ajax",api:{read:"/cba/gen/ws/general/reports/design/getModelTemplate",create:"/cba/gen/ws/general/reports/design/setModelTemplate",update:"/cba/gen/ws/general/reports/design/setModelTemplate"},url:"/cba/gen/ws/general/reports/design/getModelTemplate",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},fields:[{name:"modelName"},
{name:"modelVersion"},{name:"originModelName"},{name:"originModelVersion"},{name:"components"}]},a)])}});
Ext.define("personStampe.store.PersonStampe_org",{extend:"Ext.data.Store",constructor:function(a){a=a||{};this.callParent([Ext.apply({storeId:"PersonStampe_org",proxy:{type:"ajax",api:{read:"/cba/gen/ws/general/org/get",create:"/cba/gen/ws/general/org/new",update:"/cba/gen/ws/general/org/update",destroy:"/cba/gen/ws/general/org/delete"},url:"/cba/gen/ws/general/org/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},fields:[{name:"id"},{name:"codEnte"},{name:"ragioneSociale"},
{name:"codiceFiscale"},{name:"indirizzo"},{name:"citta"},{name:"visualizzaLogo"},{name:"visualizzaRagioneSociale"},{name:"siglaQualita"}]},a)])}});
Ext.define("personStampe.view.Container",{extend:"Ext.container.Container",itemId:"PersonStampe_Container",reference:"PersonStampe_Container",layout:{type:"fit"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"tabpanel",itemId:"PersonStampe_tabPanel",reference:"PersonStampe_tabPanel",activeTab:0,items:[{xtype:"panel",itemId:"PersonStampe_campi",reference:"PersonStampe_campi",layout:{align:"stretch",type:"hbox"},title:"PERSON_CAMPI_STAMPA",items:[{xtype:"container",flex:1,itemId:"PersonStampe_contDati",
reference:"PersonStampe_contDati",layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"form",flex:1,border:!1,itemId:"PersonStampe_form",reference:"PersonStampe_form",layout:{padding:10,type:"vbox"},trackResetOnLoad:!0,items:[{xtype:"textfield",width:400,fieldLabel:"TITOLO_STAMPA",labelClsExtra:"cbaLabel",name:"titolo",allowBlank:!1},{xtype:"textareafield",width:400,fieldLabel:"NOTE",labelClsExtra:"cbaLabel",name:"descrizione"},{xtype:"textfield",
width:400,fieldLabel:"TESTO_VISION",labelClsExtra:"cbaLabel",name:"siglaQualita"},{xtype:"combobox",itemId:"PersonStampe_tabella",reference:"PersonStampe_tabella",width:400,fieldLabel:"TABELLA",labelClsExtra:"cbaLabel",name:"tabella",displayField:"valore",queryMode:"local",valueField:"codice"},{xtype:"container",flex:1,itemId:"PersonStampe_campiHidden",reference:"PersonStampe_campiHidden",items:[{xtype:"textfield",itemId:"recordId",reference:"recordId",fieldLabel:"recordId",name:"id"},{xtype:"textfield",
width:200,fieldLabel:"VERSIONE",labelClsExtra:"cbaLabel",name:"versioneModelloReport"},{xtype:"textfield",fieldLabel:"idModuloPrg",name:"idModuloPrg"},{xtype:"textfield",fieldLabel:"codEnte",name:"codEnte"},{xtype:"textfield",fieldLabel:"idOrganizzazione",name:"idOrganizzazione"},{xtype:"textfield",fieldLabel:"idPadre",name:"idPadre"},{xtype:"textfield",fieldLabel:"posizione",name:"posizione"},{xtype:"textfield",fieldLabel:"codVideataPwd",name:"codVideataPwd"},{xtype:"textfield",fieldLabel:"progetto",
name:"progetto"},{xtype:"textfield",fieldLabel:"nomeForm",name:"nomeForm"},{xtype:"textfield",fieldLabel:"iconCls",name:"iconCls"},{xtype:"textfield",fieldLabel:"siglaModelloReport",name:"siglaModelloReport"}]}]},{xtype:"container",border:!1,itemId:"PersonStampe_boxBottoni",reference:"PersonStampe_boxBottoni",width:120}]},{xtype:"container",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"gridpanel",flex:1,itemId:"PersonStampe_grid1",reference:"PersonStampe_grid1",width:100,title:"CAMPI_DISPONIBILI",
columns:[{xtype:"gridcolumn",dataIndex:"caption",text:"DESCRIZIONE",flex:1}],viewConfig:{plugins:[Ext.create("Ext.grid.plugin.DragDrop",{dragGroup:"grid1",dropGroup:"grid2"})]},features:[{ftype:"grouping",groupHeaderTpl:["{name}"]}]},{xtype:"container",width:20},{xtype:"gridpanel",flex:1,itemId:"PersonStampe_grid2",reference:"PersonStampe_grid2",title:"CAMPI_STAMPA",columns:[{xtype:"gridcolumn",dataIndex:"caption",text:"DESCRIZIONE",flex:1}],viewConfig:{plugins:[Ext.create("Ext.grid.plugin.DragDrop",
{dragGroup:"grid2",dropGroup:"grid1"})]},dockedItems:[{xtype:"toolbar",dock:"top",itemId:"PersonStampe_tbCampiStampa",reference:"PersonStampe_tbCampiStampa",items:[{xtype:"button",itemId:"PersonStampe_su",reference:"PersonStampe_su",iconCls:"icon-up",text:"SU"},{xtype:"button",itemId:"PersonStampe_giu",reference:"PersonStampe_giu",iconCls:"icon-down",text:"GIU"},{xtype:"button",itemId:"PersonStampe_elimina",reference:"PersonStampe_elimina",iconCls:"icon-elimina16",text:"ELIMINA"}]}]}]}]}]}]}]});this.callParent(arguments)}});
Ext.Loader.setConfig({enabled:!0});Ext.application({stores:["PersonStampe_albero","PersonStampe_campi","PersonStampe_org"],views:["Container"],controllers:["PersonStampeCnt"],name:"personStampe",appFolder:"generali/personStampe/app"});
Ext.define("Generali.person_fe.controller.GestAccountPersonFE",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormFE",selector:this.selContainer+"#FormFE"},{ref:"boxBottoni",selector:this.selContainer+"#boxBottoni"},{ref:"StoricoDataDal",selector:this.selContainer+"#StoricoDataDal"},{ref:"CkbPrimaNota",selector:this.selContainer+"#CkbPrimaNota"},{ref:"fsRacPrimaNota",
selector:this.selContainer+"#fsRacPrimaNota"},{ref:"regimeFiscale",selector:this.selContainer+"#regimeFiscale"},{ref:"racTipoPrimaNota",selector:this.selContainer+"#racTipoPrimaNota"},{ref:"racNaturaPrimaNota",selector:this.selContainer+"#racNaturaPrimaNota"},{ref:"CkbRappFiscale",selector:this.selContainer+"#CkbRappFiscale"},{ref:"CkbInterFiscale",selector:this.selContainer+"#CkbInterFiscale"},{ref:"fsRapFiscale",selector:this.selContainer+"#fsRapFiscale"},{ref:"fsInterFiscale",selector:this.selContainer+
"#fsInterFiscale"},{ref:"RFidIva",selector:this.selContainer+"#RFidIva"},{ref:"IFidIva",selector:this.selContainer+"#IFidIva"},{ref:"ProtAutoFattAtt",selector:this.selContainer+"#ProtAutoFattAtt"},{ref:"ProtAutoFattPas",selector:this.selContainer+"#ProtAutoFattPas"},{ref:"IconOK",selector:this.selContainer+"#IconOK"},{ref:"IconNO",selector:this.selContainer+"#IconNO"},{ref:"IconEmpty",selector:this.selContainer+"#IconEmpty"},{ref:"LblIconOK",selector:this.selContainer+"#LblIconOK"},{ref:"LblIconNO",
selector:this.selContainer+"#LblIconNO"},{ref:"rgTipoKtree",selector:this.selContainer+"#rgTipoKtree"},{ref:"CkbDisableB2C",selector:this.selContainer+"#CkbDisableB2C"},{ref:"CkbEnableImportXML",selector:this.selContainer+"#CkbEnableImportXML"},{ref:"CkbEnableExportXML",selector:this.selContainer+"#CkbEnableExportXML"},{ref:"BtnEnableB2C",selector:this.selContainer+"#BtnEnableB2C"},{ref:"BolloSenzaAddB2C",selector:this.selContainer+"#BolloSenzaAddB2C"},{ref:"BolloNAccNegativoB2C",selector:this.selContainer+
"#BolloNAccNegativoB2C"},{ref:"TipoEsenzBollo",selector:this.selContainer+"#TipoEsenzBollo"},{ref:"DescrizioneDaModelli",selector:this.selContainer+"#DescrizioneDaModelli"},{ref:"BoxCollegamentiDm7",selector:this.selContainer+"#BoxCollegamentiDm7"},{ref:"ChkCodIpaOperatore",selector:this.selContainer+"#ChkCodIpaOperatore"},{ref:"CntCodIpaOperatori",selector:this.selContainer+"#CntCodIpaOperatori"},{ref:"GridCodUfficio",selector:this.selContainer+"#GridCodUfficio"},{ref:"BtnNuovoCodUfficio",selector:this.selContainer+
"#BtnNuovoCodUfficio"},{ref:"BtnEliminaCodUfficio",selector:this.selContainer+"#BtnEliminaCodUfficio"},{ref:"GridCodUfficioOperatore",selector:this.selContainer+"#GridCodUfficioOperatore"},{ref:"BtnNuovoCodUffOperatore",selector:this.selContainer+"#BtnNuovoCodUffOperatore"},{ref:"BtnEliminaCodUffOperatore",selector:this.selContainer+"#BtnEliminaCodUffOperatore"},{ref:"CbCanaleTrasmittente",selector:this.selContainer+"#CbCanaleTrasmittente"},{ref:"EdtCodFiscaleTrasmittente",selector:this.selContainer+
"#EdtCodFiscaleTrasmittente"},{ref:"ChkVisuFattNocig",selector:this.selContainer+"#ChkVisuFattNocig"}]);this.control(this.selContainer+"#BtnEnableB2C",{click:this.enableCkbDisableB2C});this.control(this.selContainer+"#CkbPrimaNota",{change:this.changeCkbPrimaNota});this.control(this.selContainer+"#CkbRappFiscale",{change:this.changeCkbRappFiscale});this.control(this.selContainer+"#CkbInterFiscale",{change:this.changeCkbInterFiscale});this.control(this.selContainer+"#CbCanaleTrasmittente",{select:this.onChangeCbCanaleTrasmittente});
this.control(this.selContainer+"#StoricoDataDal",{select:this.onStoricoDataDalSelectNew});this.control(this.selContainer+"#ChkCodIpaOperatore",{change:this.changeChkCodIpaOperatore});this.control(this.selContainer+"#GridCodUfficio",{beforeedit:this.beforeEditGridCodUfficio,edit:this.editGridCodUfficio,canceledit:this.cancelEditGridCodUfficio,validateedit:this.validateEditGridCodUfficio});this.control(this.selContainer+"#BtnNuovoCodUfficio",{click:this.clickBtnNuovoCodUfficio});this.control(this.selContainer+
"#BtnEliminaCodUfficio",{click:this.clickBtnEliminaCodUfficio});this.control(this.selContainer+"#GridCodUfficioOperatore",{beforeedit:this.beforeEditGridCodUfficioOperatore,edit:this.editGridCodUfficioOperatore,canceledit:this.cancelEditGridCodUfficioOperatore,validateedit:this.validateEditGridCodUfficioOperatore});this.control(this.selContainer+"#BtnNuovoCodUffOperatore",{click:this.clickBtnNuovoCodUffOperatore});this.control(this.selContainer+"#BtnEliminaCodUffOperatore",{click:this.clickBtnEliminaCodUffOperatore})},
stampa:function(){var a={};this.kTreeLocalSessionId||(this.kTreeLocalSessionId=LoginSysDocFattEle());Ext.apply(a,{sessionId:this.kTreeLocalSessionId});Ext.apply(this.parametriStampa,{url:"/cba/gen/ws/general/fatturaElettronica/fatture/getManualeConservazione",titolo:traduci("MANUALE_CONSERVAZIONE")});var b=this.parametriStampa;Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params))},
doPrint:function(a){this.stampa();this.callParent([a,"pdf"])},enableCkbDisableB2C:function(a){var b=this;Ext.widget("passwordCBA",{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(c){c?(a.hide(),b.getCkbDisableB2C().setDisabled(!1),b.getBolloSenzaAddB2C().setDisabled(!1),b.getBolloNAccNegativoB2C().setDisabled(!1),b.getCkbEnableImportXML().setDisabled(!1)):msgShowError("",traduci("PASSWORD_ERRATA"))}}).show()},TestConnessione:function(){var a=LoginSysDocFattEle();this.getIconNO().setVisible(""==
a);this.getIconOK().setVisible(""!=a);this.getLblIconNO().setVisible(""==a);this.getLblIconOK().setVisible(""!=a);this.getIconEmpty().setVisible(!1)},nascondiIconeTestConnessione:function(){this.getIconNO().setVisible(!1);this.getIconOK().setVisible(!1);this.getLblIconNO().setVisible(!1);this.getLblIconOK().setVisible(!1);this.getIconEmpty().setVisible(!0)},changeCkbRappFiscale:function(a,b){1==b?(this.getFsRapFiscale().setVisible(!0),this.getRFidIva().allowBlank=!1,this.getRFidIva().validateValue()):
(this.getFsRapFiscale().setVisible(!1),this.getRFidIva().allowBlank=!0)},onChangeCbCanaleTrasmittente:function(a,b){if(b&&b.data){var c=b.data.extra?b.data.extra:"";this.getEdtCodFiscaleTrasmittente().setValue(c);2==b.data.codice&&(this.getProtAutoFattAtt().setValue(!1),this.getProtAutoFattPas().setValue(!1));this.getProtAutoFattAtt().setDisabled(2==b.data.codice);this.getProtAutoFattPas().setDisabled(2==b.data.codice)}},changeCkbInterFiscale:function(a,b){1==b?(this.getFsInterFiscale().setVisible(!0),
this.getIFidIva().allowBlank=!1,this.getIFidIva().validateValue()):(this.getFsInterFiscale().setVisible(!1),this.getIFidIva().allowBlank=!0)},changeCkbPrimaNota:function(a,b){1==b?(this.getFsRacPrimaNota().setVisible(!0),this.getRacTipoPrimaNota().allowBlank=!1,this.getRacNaturaPrimaNota().allowBlank=!1,this.getRacTipoPrimaNota().validateValue(),this.getRacNaturaPrimaNota().validateValue()):(this.getFsRacPrimaNota().setVisible(!1),this.getRacTipoPrimaNota().allowBlank=!0,this.getRacNaturaPrimaNota().allowBlank=
!0)},changeChkCodIpaOperatore:function(a,b){var c=!1;this.abilitaBottoniGridCodUfficio(b);this.abilitaBottoniGridCodUfficioOperatore(!1);!0===b&&((c=this.isEnabledModAggiuntivo("GE_CODIPA_OPE"))||Ext.create("winCBA",{name:"Generali.person_fe.view.SbloccaCodIpaOperatori",dimensione:8,closable:!0,configItem:{callBack_CodIpaOpe:function(){c=!0}}}).show());c||(this.getChkCodIpaOperatore().setValue(!1),this.getChkCodIpaOperatore().validateValue());this.getCntCodIpaOperatori().setVisible(c)},isEnabledModAggiuntivo:function(a){var b=
!1;a&&Ext.Ajax.request({method:"GET",url:getUrlGen()+"/auth/extraFn/isEnabled",async:!1,params:{codiceFunzione:a,idOrganizzazione:this.cbaConfig.idOrganizzazione},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b=a.data:msgShowError("",a.message)}});return b},onStoricoDataDalSelectNew:function(a,b){this.aggiornaStoreStorico;this.impostaDatiFormFe(b)},aggiornaStore:function(a,b){},impostaDatiFormFe:function(a){var b=this.getFormFE();this.getStoricoDataDal().setDisabled(!1);this.getBoxCollegamentiDm7().setVisible(!Ext.isEmpty(a.get("ei7AttivoDal")));
clearForm(b);this.loadComboRaccordi();var c=this.getCodeByString_storePersFattEle(this.getRegimeFiscale(),a.get("regimeFiscale")),d=this.getCodeByString_storePersFattEle(this.getRacTipoPrimaNota(),a.get("raccordoTipoDocConto")),e=this.getCodeByString_storePersFattEle(this.getRacNaturaPrimaNota(),a.get("raccordoNaturaConto"));b.getForm().setValues({tipoK:1,idEnte:101,idOrganizzazione:a.get("idOrganizzazione"),id:a.get("id"),dal:a.get("dal"),anno:a.get("anno"),CkbPrimaNota:"T"==a.get("primaNota"),regimeFiscale:c,
racTipoPrimaNota:d,racNaturaPrimaNota:e,IBAN:a.get("ibanPagamento"),canaleTrasmittente:a.get("canaleTrasmittente"),codFiscaleTrasmittente:a.get("codFiscaleTrasmittente"),CkbRappFiscale:"T"==a.get("rappresentanteFiscale"),RFidIva:a.get("idFiscaleIvaRappFiscale"),RFidCode:a.get("idCodiceRappFiscale"),RFdenom:a.get("denominazioneRappFiscale"),RFcognome:a.get("cognomeRappFiscale"),RFnome:a.get("nomeRappFiscale"),RFtitolo:a.get("titoloRappFiscale"),RFcodeEori:a.get("codEoriRappFiscale"),userName:a.get("userName"),
password:a.get("password"),codIpaUfficio:a.get("codIpaUfficio"),codIpaAutofatture:a.get("codIpaAutofatture"),gestioneCodIpaOperatore:"T"==a.get("gestioneCodIpaOperatore"),ProtAutoFattAtt:"T"==a.get("protocollaAttive"),ProtAutoFattPas:"T"==a.get("protocollaPassive"),visuFattNocig:"T"==a.get("visuFattNocig"),bolloSenzaAddB2C:"T"==a.get("bolloSenzaAddB2C"),bolloNAccNegativoB2C:"T"==a.get("bolloNAccNegativoB2C"),descrizioneDaModelli:"T"==a.get("descrizioneDaModelli"),tipoEsenzioneBollo:a.get("tipoEsenzioneBollo"),
fattPassivaNonAttiva:"T"==a.get("fattPassivaNonAttiva"),CkbDisableB2C:"T"==a.get("disableB2C"),CkbEnableImportXML:"T"==a.get("enableImportXml"),CkbEnableExportXML:"T"==a.get("enableExportXml"),CkbInterFiscale:"T"==a.get("intermediarioFiscale"),IFidIva:a.get("idFiscaleIvaIntermFiscale"),IFidCode:a.get("idCodiceIntermFiscale"),IFdenom:a.get("denominazioneIntermFiscale"),IFnome:a.get("nomeIntermFiscale"),IFcognome:a.get("cognomeIntermFiscale"),IFtitolo:a.get("titoloIntermFiscale"),IFcodeEori:a.get("codEoriIntermFiscale"),
numerazioneSeparata:"T"==a.get("numerazioneSeparata"),codenteIntProtocollo:a.get("codenteIntProtocollo"),versione:a.get("versione"),ei7AttivoDal:a.get("ei7AttivoDal")});this.loadGridCodUfficio();b.getForm().reset()},loadGridCodUfficio:function(){var a=this.getGridCodUfficio(),b={};this.storeGridCodUfficio||(this.storeGridCodUfficio=a.getStore());this.cbaConfig.idOrganizzazione&&Ext.apply(b,{idOrganizzazione:this.cbaConfig.idOrganizzazione});this.storeGridCodUfficio.load({params:b,callback:function(b,
d,e){e?Ext.isEmpty(b)||a.getSelectionModel().select(0):msgShowError("",d.getError())}})},loadComboRaccordi:function(){this.loadStorePersFattEle(this.getRegimeFiscale(),"RF");this.loadStorePersFattEle(this.getRacTipoPrimaNota(),"TD");this.loadStorePersFattEle(this.getRacNaturaPrimaNota(),"NI");this.getTipoEsenzBollo().getStore().load()},loadStorePersFattEle:function(a,b){var c;c=43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?"/cba/osp/co/ws/genAmmIntgr/":"/cba/amm/cp/ws/integrazioni/";a.getStore().getProxy().url=
c+"tabelle/codificaExt/cbox";a.getStore().load({params:{tipoDatoExt:b,sistemaExt:"FPA"},callback:function(a,b,c){Ext.each(a,function(a){a.get("extra")})}}).sort([{property:"valore",direction:"ASC"}])},getCodeByString_storePersFattEle:function(a,b){var c=a.getStore().getData(),d;Ext.each(c.items,function(a){var c=a.get("extra");a.get("valore");a=a.get("codice");b==c&&(d=a)});return d},getExtraById_storePersFattEle:function(a,b){var c=a.getStore().getData(),d;Ext.each(c.items,function(a){var c=a.get("extra");
a.get("valore");a=a.get("codice");b==a&&(d=c)});return d},nuovo:function(){var a=this.getFormFE();this.getStoricoDataDal().setDisabled(!0);this.loadComboRaccordi();this.getBoxBottoni().queryById("btnNuovo").setDisabled(!0);this.getBoxBottoni().queryById("btnElimina").setDisabled(!0);controller_nuovoRecord(a);var a=this.getStoricoDataDal().getStore(),b=a.data.length-1;0<=b&&(a=a.getData().items[b],a.data.id=-9999,a.data.dal=new Date,this.impostaDatiFormFe(a))},verificaCampiFormFE:function(){var a=
this.getFormFE().getForm().getFieldValues(),b=[];null==a.canaleTrasmittente?msgAddError(b,this.getCbCanaleTrasmittente().getFieldLabel()):0<a.canaleTrasmittente&&(null==a.codFiscaleTrasmittente||""==a.codFiscaleTrasmittente)&&msgAddError(b,this.getEdtCodFiscaleTrasmittente().getFieldLabel());a.CkbPrimaNota&&(Ext.isEmpty(a.racNaturaPrimaNota)&&msgAddError(b,this.getRacNaturaPrimaNota().getFieldLabel()),Ext.isEmpty(a.racTipoPrimaNota)&&msgAddError(b,this.getRacTipoPrimaNota().getFieldLabel()));a.CkbRappFiscale&&
Ext.isEmpty(a.RFidIva)&&msgAddError(b,traduci("RAPP_FISCALE")+": "+this.getRFidIva().getFieldLabel());a.CkbInterFiscale&&Ext.isEmpty(a.IFidIva)&&msgAddError(b,traduci("INTER_FISCALE")+": "+this.getIFidIva().getFieldLabel());return msgShow("MSG_CAMPI_OBBLIGATORI",b)},salvaDatiFormFE:function(a){var b=this,c="/cba/gen/ws/general/fatturaElettronica/prszn/fePers/";a=b.getFormFE().getForm().getFieldValues();var d=a.id;if(!this.verificaCampiFormFE())return!1;if(""==d||0>=d){if(""==a.dal||null==a.dal){a.dal=
Ext.Date.clearTime(new Date);a.idEnte=101;b.idOrganizzazione=getIdOrg();if(""==a.codIpaUfficio||null==a.codIpaUfficio)a.codIpaUfficio=b.codIpaUfficio;if(""==a.codIpaAutofatture||null==a.codIpaAutofatture)a.codIpaAutofatture=b.codIpaAutofatture}c+="insert"}else c+="update";var d=b.getExtraById_storePersFattEle(b.getRegimeFiscale(),a.regimeFiscale),e=b.getExtraById_storePersFattEle(b.getRacTipoPrimaNota(),a.racTipoPrimaNota),g=b.getExtraById_storePersFattEle(b.getRacNaturaPrimaNota(),a.racNaturaPrimaNota);
annoParam=a.dal;annoParam=""==a.anno?a.dal.getFullYear():a.anno;a={id:a.id,dal:a.dal,anno:annoParam,primaNota:a.CkbPrimaNota?"T":"F",regimeFiscale:d,raccordoTipoDocConto:e,raccordoNaturaConto:g,ibanPagamento:a.IBAN,rappresentanteFiscale:a.CkbRappFiscale?"T":"F",idFiscaleIvaRappFiscale:a.RFidIva,idCodiceRappFiscale:a.RFidCode,denominazioneRappFiscale:a.RFdenom,cognomeRappFiscale:a.RFcognome,nomeRappFiscale:a.RFnome,titoloRappFiscale:a.RFtitolo,codEoriRappFiscale:a.RFcodeEori,userName:a.userName,password:a.password,
codIpa:a.codIpaUfficio,codIpaAutofatture:a.codIpaAutofatture,gestioneCodIpaOperatore:a.gestioneCodIpaOperatore?"T":"F",protocollaAttive:a.ProtAutoFattAtt?"T":"F",protocollaPassive:a.ProtAutoFattPas?"T":"F",visuFattNocig:a.visuFattNocig?"T":"F",bolloSenzaAddB2C:a.bolloSenzaAddB2C?"T":"F",bolloNAccNegativoB2C:a.bolloNAccNegativoB2C?"T":"F",descrizioneDaModelli:a.descrizioneDaModelli?"T":"F",tipoEsenzioneBollo:a.tipoEsenzioneBollo,fattPassivaNonAttiva:a.fattPassivaNonAttiva?"T":"F",disableB2C:b.getCkbDisableB2C().getValue()?
"T":"F",enableImportXml:b.getCkbEnableImportXML().getValue()?"T":"F",enableExportXml:b.getCkbEnableExportXML().getValue()?"T":"F",idOrganizzazione:b.idOrganizzazione,idEnte:101,canaleTrasmittente:a.canaleTrasmittente,codFiscaleTrasmittente:a.codFiscaleTrasmittente,intermediarioFiscale:a.CkbInterFiscale?"T":"F",idFiscaleIvaIntermFiscale:a.IFidIva,idCodiceIntermFiscale:a.IFidCode,denominazioneIntermFiscale:a.IFdenom,nomeIntermFiscale:a.IFnome,cognomeIntermFiscale:a.IFcognome,titoloIntermFiscale:a.IFtitolo,
codEoriIntermFiscale:a.IFcodeEori,numerazioneSeparata:a.numerazioneSeparata?"T":"F",codenteIntProtocollo:a.codenteIntProtocollo,versione:a.versione};var h=[];Ext.Ajax.request({url:c,method:"POST",jsonData:a,async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(msgAdd(h,a.message),b.aggiornaStoreStorico(a.data.id)):msgShowError("",a.message)}});return h},aggiornaStoreStorico:function(a){var b=this,c=b.getStoricoDataDal().getStore();c.load({params:{idOrganizzazione:b.idOrganizzazione},
callback:function(d,e,g){g&&(b.idEnte=101,Ext.isEmpty(d)||(b.codIpaUfficio=d[0].get("codIpaUfficio"),b.codIpaAutofatture=d[0].get("codIpaAutofatture"),e=b.getStoricoDataDal(),d=null!=a&&0<a?trovaRecord(c,"id",a):d[0],e.getSelectionModel().deselectAll(),e.getSelectionModel().select([d]),b.impostaDatiFormFe(d)),b.getBoxBottoni().queryById("btnConferma").setDisabled(!0),b.getBoxBottoni().queryById("btnAnnulla").setDisabled(!0),b.getFormFE().getForm().reset())}})},beforeEditGridCodUfficio:function(a,
b,c){if(!0===a.editing)return!1;this.abilitaBottoniGridCodUfficio(!1)},editGridCodUfficio:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();(c=controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1}))?(this.aggiornaStoreGridCodUfficio(c.id),this.abilitaBottoniGridCodUfficio(!0)):a.startEdit(b.record,0)},cancelEditGridCodUfficio:function(a,b,c){this.abilitaBottoniGridCodUfficio(!0);this.aggiornaStoreGridCodUfficio(b.record.get("id"))},validateEditGridCodUfficio:function(a,
b,c){this.abilitaBottoniGridCodUfficio(!0)},selectionChangeEditGridCodUfficio:function(a,b){this.selectedIdCodUfficio=b.id;this.aggiornaStoreGridCodUfficioOperatore(null,this.selectedIdCodUfficio);this.abilitaBottoniGridCodUfficioOperatore(!0,this.selectedIdCodUfficio)},abilitaBottoniGridCodUfficio:function(a){this.getBtnNuovoCodUfficio().setDisabled(!a);this.getBtnEliminaCodUfficio().setDisabled(!a)},aggiornaStoreGridCodUfficio:function(a,b){var c=this,d=c.getGridCodUfficio();c.storeGridCodUfficio||
(c.storeGridCodUfficio=d.getStore());Ext.isDefined(b)||(b={},c.cbaConfig.idOrganizzazione&&Ext.apply(b,{idOrganizzazione:c.cbaConfig.idOrganizzazione}));c.storeGridCodUfficio.load({params:b,callback:function(b,g,h){h?Ext.isEmpty(b)||(a?trovaRecord(c.storeGridCodUfficio,"id",a):d.getSelectionModel().select(0)):msgShowError("",g.getError())}})},clickBtnNuovoCodUfficio:function(a){a=this.getGridCodUfficio();a.getStore().insert(0,{idOrganizzazione:this.idOrganizzazione});a.getSelectionModel().select(0);
a.getPlugin().startEdit(0,0)},clickBtnEliminaCodUfficio:function(a){var b=this;a=b.getGridCodUfficio();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStoreGridCodUfficio()})},beforeEditGridCodUfficioOperatore:function(a,b,c){if(!0===a.editing)return!1;a=a.getEditor().getForm().findField("idOperatore");b=b.record;this.abilitaBottoniGridCodUfficioOperatore(!1);this.loadCbCodIpaOperatore(a,b.get("idOperatore"),b.get("desOperatore"))},
editGridCodUfficioOperatore:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();(c=controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1}))?(this.aggiornaStoreGridCodUfficioOperatore(c.id,this.selectedIdCodUfficio),this.abilitaBottoniGridCodUfficioOperatore(!0,this.selectedIdCodUfficio)):a.startEdit(b.record,0)},cancelEditGridCodUfficioOperatore:function(a,b,c){this.abilitaBottoniGridCodUfficioOperatore(!0,this.selectedIdCodUfficio);this.aggiornaStoreGridCodUfficioOperatore(b.record.get("id"),
this.selectedIdCodUfficio)},validateEditGridCodUfficioOperatore:function(a,b,c){this.abilitaBottoniGridCodUfficioOperatore(!0,this.selectedIdCodUfficio)},abilitaBottoniGridCodUfficioOperatore:function(a,b){var c;c=a?a&&b:a;this.getBtnNuovoCodUffOperatore().setDisabled(!c);this.getBtnEliminaCodUffOperatore().setDisabled(!c)},aggiornaStoreGridCodUfficioOperatore:function(a,b,c){var d=this,e=d.getGridCodUfficioOperatore();d.storeGridCodUfficioOperatore||(d.storeGridCodUfficioOperatore=e.getStore());
Ext.isDefined(c)&&c||(c={},b&&Ext.apply(c,{idAnagCodIpa:b}));d.storeGridCodUfficioOperatore.load({params:c,callback:function(b,c,k){k?Ext.isEmpty(b)||(a?trovaRecord(d.storeGridCodUfficioOperatore,"id",a):e.getSelectionModel().select(0)):msgShowError("",c.getError())}})},clickBtnNuovoCodUffOperatore:function(a){a=this.getGridCodUfficioOperatore();var b=a.getStore();Ext.isDefined(this.selectedIdCodUfficio)&&0<this.selectedIdCodUfficio&&(b.insert(0,{idAnagCodIpa:this.selectedIdCodUfficio}),a.getSelectionModel().select(0),
a.getPlugin().startEdit(0,0))},clickBtnEliminaCodUffOperatore:function(a){var b=this;a=b.getGridCodUfficioOperatore();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStoreGridCodUfficioOperatore(null,b.selectedIdCodUfficio)})},loadCbCodIpaOperatore:function(a,b,c){a.getStore().getProxy().extraParams={codEnte:CBA.parametriGenerali.codEntePwd,codiceModulo:CBA.moduli.moduloAttivo,idOrganizzazione:getIdOrg(),soloUtentiIdOrg:"T",
itemTutti:"T"};a.getStore().load()},onEditForm:function(a,b,c){boxBottoni=this.getBoxBottoni();boxBottoni.queryById("btnEsci").setVisible(!1);boxBottoni.queryById("btnNuovo").setVisible(!1);boxBottoni.queryById("btnElimina").setVisible(!1);b&&this.nascondiIconeTestConnessione()},onLaunch:function(){var a=this,b=a.getFormFE();a.getStoricoDataDal().controller=a;b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.getStoricoDataDal().getStore();b.controller=a;a.getCbCanaleTrasmittente().getStore().load();
var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(c){c=a.salvaDatiFormFE(c);a.TestConnessione();0!=c?(b.getForm().reset,a.getStoricoDataDal().setDisabled(!1),a.getBoxBottoni().queryById("btnConferma").setDisabled(!0),a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!0)):(a.getBoxBottoni().queryById("btnNuovo").setDisabled(!0),a.getBoxBottoni().queryById("btnElimina").setDisabled(!0),a.getBoxBottoni().queryById("btnConferma").setDisabled(!1),
a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!1))},annulla_callback:function(){var b=a.getFormFE().getValues().id;a.getStoricoDataDal().setDisabled(!1);clearForm(a.getFormFE());a.aggiornaStoreStorico(b);a.getBoxBottoni().queryById("btnConferma").setDisabled(!0);a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!0)},nuovo_callback:function(){a.nuovo()},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.aggiornaStoreStorico();
clearForm(a.getFormFE())})},verificaCampiForm_callback:function(){return!0}}});inserisciBottoni(a.getBoxBottoni(),c);a.getBoxBottoni().queryById("btnEsci").setVisible(!1);controller_abilitaBottoni(b);if("L"!=a.cbaConfig.permesso)b.getForm().on("dirtychange",function(b,c){controller_abilitaBottoni(a.getFormFE());c&&(a.getBoxBottoni().queryById("btnConferma").setDisabled(!1),a.getBoxBottoni().queryById("btnAnnulla").setDisabled(!1))});a.idOrganizzazione=a.cbaConfig.idOrganizzazione?a.cbaConfig.idOrganizzazione:
getIdOrg();a.storeCampiFattEle=Ext.create("Generali.person_fe.store.AccountFe",{});ImpostaUrl([a.storeCampiFattEle,a.getStoricoDataDal().getStore()]);a.loadComboRaccordi();a.aggiornaStoreStorico();b.getForm().reset;a.nascondiIconeTestConnessione()},destroy:function(){this.callParent()}});
Ext.define("Generali.person_fe.controller.GestBolli",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnCerca",selector:this.selContainer+"#BtnCerca"},{ref:"CBAnno",selector:this.selContainer+"#CBAnno"},{ref:"GridBolli",selector:this.selContainer+"#GridBolli"}]);this.control(this.selContainer+"#BtnCerca",{click:this.clickBtnCerca})},clickBtnCerca:function(){var a=this.getCBAnno().getValue(),
b=this.getCBAnno().getRawValue();this.aggiornaStore(a,b)},aggiornaConteggio:function(a){this.aggiornaStore(a.get("idAnnoEsercizio"),a.get("anno"))},scaricaElencoCsv:function(a){var b={},c=this.getGridBolli();b.url=getUrlGen()+"/ws/general/fatturaElettronica/attiva/bolli/exportFattBollo";b.params={idAnnoEse:a.get("idAnnoEsercizio"),anno:a.get("anno")};stampaEsporta(c,b,null)},aggiornaStore:function(a,b){var c=this.getGridBolli().getStore(),d={};a&&Ext.apply(d,{idAnnoEse:a?a:null});b&&Ext.apply(d,{anno:b?
b:null});c.load({params:d})},caricaStore:function(){this.getCBAnno().getStore().load({params:{idOrganizzazione:getIdOrg()}})},onLaunch:function(){var a=this.getGridBolli();this.caricaStore();this.aggiornaStore();a.controller=this},destroy:function(){this.callParent()}});
Ext.define("Generali.person_fe.controller.GestCodificaEsterna",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"RbTipo",selector:this.selContainer+"#RbTipo"},{ref:"GridGest",selector:this.selContainer+"#GridGest"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"CntRaccordo",selector:this.selContainer+"#CntRaccordo"},{ref:"BoxBottoni",
selector:this.selContainer+"#BoxBottoni"}]);this.control(this.selContainer+"#GridGest",{select:this.selectGrid,beforeedit:this.beforeeditGridGest,edit:this.editGridGest,canceledit:this.canceleditGridGest,validateedit:this.validateeditGridGest});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina});this.control(this.selContainer+"#RbTipo",{change:this.changeRbTipo})},selectGrid:function(a,b,c,d){b.get("id")&&
this.fireEvent("CodiceCaricato",b.get("id"))},changeRbTipo:function(a,b,c,d){if(!b)return!1;this.aggiornaStore()},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null,tipoDatoExt:this.getRbTipo().getValue().tipo,sistemaExt:this.sistemaExt},this.getGridGest())},clickBtnElimina:function(a){var b=this;a=b.getGridGest();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridGest:function(a,b,c){if(!0===
a.editing)return!1;this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo()&&this.getBtnNuovo().setDisabled(!a);this.getBtnElimina()&&this.getBtnElimina().setDisabled(!a);this.getCntRaccordo().down("#GridRacc").setDisabled(!a)},editGridGest:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridGest:function(a,
b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridGest:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=this.getGridGest(),c=b.getStore(),d;d=43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?"/cba/osp/co/ws/genAmmIntgr/":"/cba/amm/cp/ws/integrazioni/";c.getProxy().url=d+"tabelle/codificaExt/list";c.getProxy().api={read:d+"tabelle/codificaExt/list",create:d+"tabelle/codificaExt/insert",update:d+"tabelle/codificaExt/update",destroy:d+
"tabelle/codificaExt/delete"};c.load({params:{tipoDatoExt:this.getRbTipo().getValue().tipo,sistemaExt:this.sistemaExt},callback:function(d,g,h){h?(d=0,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().select(d?[d]:0)):msgShowError("",g.getError())}})},svuotaStore:function(){svuotaStore(this.getGridGest().getStore())},onLaunch:function(){var a=this;a.sistemaExt="FPA";a.getGridGest().controller=a;var b=a.getCntRaccordo().add(Ext.create(a.getCntRaccordo().cbaConfig.url,{cbaConfig:{idOrganizzazione:a.cbaConfig.idOrganizzazione}}));
a.on("CodiceCaricato",function(c){var d=a.getGridGest().getSelectionModel().getSelection()[0].getData(),e=d.ivaConImposta,k=d.codice;"NI"==d.tipoDatoExt&&(Ext.String.startsWith(k,"N6",!0)||Ext.String.startsWith(k,"N7",!0)||Ext.String.startsWith(k,"N2.2",!0)||Ext.String.startsWith(k,"N3.1",!0))&&(e=null);b.controller.caricaDati(a.getGridGest(),a.sistemaExt,a.getRbTipo().getValue().tipo,c,e)});var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{esci_callback:function(){a.cbaConfig.callbackRiapriStore&&
a.cbaConfig.callbackRiapriStore();a.getBoxBottoni().up("window").close()}}}),d=a.getRbTipo();d.on("afterrender",function(b){a.cbaConfig.tipoRaccordo&&d.setValue({tipo:a.cbaConfig.tipoRaccordo})},a,{single:!0});inserisciBottoni(a.getBoxBottoni(),c);a.getBoxBottoni().queryById("btnNuovo").hide();a.getBoxBottoni().queryById("btnElimina").hide();a.getBoxBottoni().queryById("btnConferma").hide();a.getBoxBottoni().queryById("btnAnnulla").hide();a.cbaConfig.mostraEsci||a.getBoxBottoni().queryById("btnEsci").hide();
a.aggiornaStore()},destroy:function(){this.callParent()}});
Ext.define("Generali.person_fe.controller.GestCodificaEsternaRaccordo",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridRacc",selector:this.selContainer+"#GridRacc"},{ref:"feRiferimentoNormativo",selector:this.selContainer+"#feRiferimentoNormativo"},{ref:"BtnNuovoRacc",selector:this.selContainer+"#BtnNuovoRacc"},{ref:"BtnEliminaRacc",selector:this.selContainer+"#BtnEliminaRacc"}]);this.control(this.selContainer+
"#GridRacc",{beforeedit:this.beforeeditGridRacc,edit:this.editGridRacc,canceledit:this.canceleditGridRacc,validateedit:this.validateeditGridRacc});this.control(this.selContainer+"#BtnNuovoRacc",{click:this.clickBtnNuovoRacc});this.control(this.selContainer+"#BtnEliminaRacc",{click:this.clickBtnEliminaRacc})},clickBtnNuovoRacc:function(a){controller_nuovoRecordGrid({id:null,idCodiceExt:this.idCodiceExt},this.getGridRacc())},clickBtnEliminaRacc:function(a){var b=this;a=b.getGridRacc();var c=a.getSelectionModel().getSelection()[0];
controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridRacc:function(a,b,c){if(!0===a.editing)return!1;a=a.getEditor().getForm();"CPG"==this.tipoDatoExt&&a.findField("idCodiceSipcar").bindStore(clonaStore(this.storeCPG));"NI"==this.tipoDatoExt&&a.findField("idCodiceSipcar").bindStore(clonaStore(this.storeNI));"TD"==this.tipoDatoExt&&a.findField("idCodiceSipcar").bindStore(clonaStore(this.storeTD));this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovoRacc().setDisabled(!a);
this.getBtnEliminaRacc().setDisabled(!a);this.grigliaPrincipale.setDisabled(!a)},editGridRacc:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();c.idOrganizzazione=this.idOrganizzazione;d.controller=this;d.store=b.view.getStore();var e;e=43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?"/cba/osp/co/ws/genAmmIntgr/":"/cba/amm/cp/ws/integrazioni/";d.store.getProxy().url=e+"tabelle/raccordoCodiciExt/list";d.store.getProxy().api={read:e+"tabelle/raccordoCodiciExt/list",create:e+
"tabelle/raccordoCodiciExt/insert",update:e+"tabelle/raccordoCodiciExt/update",destroy:e+"tabelle/raccordoCodiciExt/delete"};delete c.feRiferimentoNormativo;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?("NI"==this.tipoDatoExt&&(a=b.newValues.feRiferimentoNormativo,c.feRiferimentoNormativo=a,this.salvaRifNormativo(c,a)),this.abilitaBottoniGrid(!0)):a.startEdit(b.record,0)},salvaRifNormativo:function(a,b){feRiferimentoNormativo=b;idAliqIva=a.idCodiceSipcar;Ext.Ajax.request({url:"/cba/gen/ws/general/aliqiva/updateFeField",
method:"GET",scope:this,params:{idAliqIva:idAliqIva,feRiferimentoNormativo:feRiferimentoNormativo},async:!1,success:function(a){a=Ext.JSON.decode(a.responseText);a.success||msgShowError("",a.message)},failure:function(a){}})},canceleditGridRacc:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridRacc:function(a,b,c){return msgShow("",[])},caricaDati:function(a,b,c,d,e){this.grigliaPrincipale=a;this.sistemaExt=b;this.tipoDatoExt=c;this.idCodiceExt=d;
this.ivaConImposta=e;this.getFeRiferimentoNormativo().hide();"NI"==this.tipoDatoExt&&(this.getFeRiferimentoNormativo().show(),this.storeNI.load({params:{ivaMaggioreZero:this.ivaConImposta,rifNormativoFe:"T"}}));this.aggiornaStore()},aggiornaStore:function(a){var b=this.getGridRacc(),c=b.getStore(),d;d=43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?"/cba/osp/co/ws/genAmmIntgr/":"/cba/amm/cp/ws/integrazioni/";c.getProxy().url=d+"tabelle/raccordoCodiciExt/list";c.getProxy().api={read:d+"tabelle/raccordoCodiciExt/list",
create:d+"tabelle/raccordoCodiciExt/insert",update:d+"tabelle/raccordoCodiciExt/update",destroy:d+"tabelle/raccordoCodiciExt/delete"};"NI"==this.tipoDatoExt&&this.storeNI.load({params:{ivaMaggioreZero:this.ivaConImposta,rifNormativoFe:"T"}});c.load({params:{idOrganizzazione:this.idOrganizzazione,tipoDatoExt:this.tipoDatoExt,sistemaExt:this.sistemaExt,idCodiceExt:this.idCodiceExt},callback:function(d,g,h){h?(d=0,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().select(d?[d]:0)):msgShowError("",g.getError())}})},
svuotaStore:function(){svuotaStore(this.getGridRacc().getStore())},onLaunch:function(){this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();this.storeCPG=Ext.create("Generali.condizionidipagamento.store.cboxCondPagamento",{autoLoad:!0});this.storeNI=Ext.create("Generali.aliquotaiva.store.cboxAliquotaIva",{autoLoad:!1});this.storeTD=Ext.create("GeneraliAM.store.CausaliContabili",{autoLoad:!1});ImpostaUrl([this.storeTD]);this.storeTD.load({params:{idOrganizzazione:this.idOrganizzazione,
tipoCausale:"I"}});this.getGridRacc().controller=this},destroy:function(){eliminaStore(this.storeCPG);eliminaStore(this.storeNI);eliminaStore(this.storeTD);this.callParent()}});
Ext.define("Generali.person_fe.controller.MainPersonFE",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CntServizioDisattivato",selector:this.selContainer+"#CntServizioDisattivato"},{ref:"CntMainPersonFE",selector:this.selContainer+"#CntMainPersonFE"},{ref:"TabRicerca",selector:this.selContainer+"#TabRicerca"},{ref:"TabCodEsterna",selector:this.selContainer+"#TabCodEsterna"},{ref:"TabAccount",selector:this.selContainer+
"#TabAccount"},{ref:"TabBolli",selector:this.selContainer+"#TabBolli"}]);this.control(this.selContainer+"#TabRicerca",{tabchange:this.tabchangeTabRicerca})},tabchangeTabRicerca:function(a,b,c,d){a={};a.idOrganizzazione=this.cbaConfig.idOrganizzazione;a.permesso=this.cbaConfig.permesso;0==b.items.getCount()&&b.add(Ext.create(b.cbaConfig.url,{cbaConfig:a}));(b=b.down("grid"))&&!b.getSelectionModel().getSelection()[0]&&0<b.getStore().getCount()&&b.getSelectionModel().select(0)},onLaunch:function(){var a=
this.getCntMainPersonFE(),b=this.getCntServizioDisattivato();this.idOrganizzazione=this.cbaConfig.idOrganizzazione?this.cbaConfig.idOrganizzazione:getIdOrg();if(43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo){var c=getPersonContabili(this.cbaConfig.idOrganizzazione,new Date,!0,null);abilitaServizio=c?4==c.tipoContabilitaAbilitata||5==c.tipoContabilitaAbilitata:!1;a.setVisible(abilitaServizio);b.setVisible(!abilitaServizio);if(!abilitaServizio)return}else a.setVisible(!0),b.setVisible(!1);
this.tabchangeTabRicerca(this.getTabRicerca(),this.getTabCodEsterna())},destroy:function(){this.callParent()}});Ext.define("Generali.person_fe.controller.SbloccaCodIpaOperatori",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Allegato",selector:this.selContainer+"#Allegato"}])},onLaunch:function(){},loadData:function(){this.cbaConfig.callBack_CodIpaOpe&&(this.cbaConfig.callBack_CodIpaOpe(),this.getAllegato().up("window").close())}});
Ext.define("Generali.person_fe.store.AccountFe",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idEnte"},{name:"anno"},{name:"idOrganizzazione"},{name:"userName"},{name:"password"},{name:"codIpaUfficio"},{name:"gestioneCodIpaOperatore"},{name:"codIpaAutofatture"},{name:"canaleTrasmittente"},{name:"codFiscaleTrasmittente"},{name:"regimeFiscale"},{name:"rappresentanteFiscale"},{name:"idFiscaleIvaRappFiscale"},{name:"denominazioneRappFiscale"},{name:"nomeRappFiscale"},{name:"cognomeRappFiscale"},
{name:"titoloRappFiscale"},{name:"codEoriRappFiscale"},{name:"intermediarioFiscale"},{name:"idFiscaleIvaIntermFiscale"},{name:"idCodiceIntermFiscale"},{name:"denominazioneIntermFiscale"},{name:"nomeIntermFiscale"},{name:"cognomeIntermFiscale"},{name:"titoloIntermFiscale"},{name:"codEoriIntermFiscale"},{name:"raccordoTipoDocConto"},{name:"raccordoNaturaConto"},{name:"ibanPagamento"},{name:"protocollaAttive"},{name:"protocollaPassive"},{name:"bolloSenzaAddB2C"},{name:"bolloNAccNegativoB2C"},{name:"descrizioneDaModelli"},
{name:"tipoEsenzioneBollo"},{name:"fattPassivaNonAttiva"},{name:"enableImportXml"},{name:"dal",type:"date"},{name:"ei7AttivoDal",type:"date"},{name:"visuFattNocig"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/getListByIdOrg",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/getListByIdOrg",create:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/insert",update:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/update",
destroy:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/delete"}},autoLoad:!1,autoDestroy:!0});
Ext.define("Generali.person_fe.store.AnagCodIpa",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"codIpa"},{name:"descrizione"}],proxy:{type:"ajax",url:"cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/list",create:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/insert",update:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/update",
destroy:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/delete"}},autoDestroy:!0});
Ext.define("Generali.person_fe.store.AnagCodIpaOperatori",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idAnagCodIpa"},{name:"idOperatore"},{name:"desOperatore"}],proxy:{type:"ajax",url:"cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/listByCodIpa",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/listByCodIpa",create:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/insert",
update:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/update",destroy:"/cba/gen/ws/general/fatturaElettronica/codIpaUtente/anag/detail/delete"}},autoDestroy:!0});Ext.define("Generali.person_fe.store.Bolli",{extend:"Generali.data.StoreJson",fields:[{name:"anno"},{name:"numeroBolli"}],constructor:function(a){a=a||{};this.callParent([Ext.apply({proxy:{url:"/cba/osp/co/ws/general/fatturaElettronica/attiva/bolli/list"}},a)])},autoDestroy:!0});
Ext.define("Generali.person_fe.store.CodificaEsterna",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"sistemaExt"},{name:"tipoDatoExt"},{name:"codice"},{name:"descrizione"},{name:"ivaConImposta"}],proxy:{type:"ajax",url:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/list",create:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/insert",update:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/update",
destroy:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/delete"}},sorters:[{property:"codice",direction:"ASC"}],autoLoad:!1,autoDestroy:!0});Ext.define("Generali.person_fe.store.ParametriTracciatoSTD",{extend:"Generali.data.StoreJson",fields:[{name:"idOrganizzazione"},{name:"mastroCliente"},{name:"contoCliente"},{name:"numeroAttivita"},{name:"tipoRegistro"},{name:"numeroRegistroIVA"},{name:"cda"},{name:"categoriaCliente"},{name:"mastroIVA"},{name:"contoIVA"}]});
Ext.define("Generali.person_fe.store.RaccordoCodificaEsterna",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idCodiceSipcar"},{name:"idCodiceExt"},{name:"tipo"},{name:"desCodiceSipcar"},{name:"idEsercizio"}],proxy:{type:"ajax",url:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/list",create:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/insert",
update:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/update",destroy:"/cba/amm/cp/ws/integrazioni/tabelle/raccordoCodiciExt/delete"}},autoLoad:!1,autoDestroy:!0});Ext.define("Generali.person_fe.store.cboxCodificaEsterna",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/amm/cp/ws/integrazioni/tabelle/codificaExt/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.person_fe.view.GestAccountPersonFE",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},openConsultazione:function(a,b,c){var d={};Ext.apply(d,{label:a?traduci("P_IVA"):traduci("COD_UFFICIO")});Ext.isEmpty(b)||Ext.apply(d,{username:b});a="https://95.110.184.110";c||(a="https://95.110.184.137");window.open(a+"/consultazionedocumentale/login.php?"+Ext.Object.toQueryString(d))},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"gridpanel",
title:"ELENCO",width:110,itemId:"StoricoDataDal",reference:"StoricoDataDal",store:Ext.create("Generali.person_fe.store.AccountFe",{}),columns:[{xtype:"datecolumn",dataIndex:"dal",text:"DATA_DECORRENZA",flex:1,format:"d/m/Y"}],trackResetOnLoad:!0,selModel:Ext.create("Ext.selection.RowModel",{})},{xtype:"form",region:"center",flex:1,border:0,itemId:"FormFE",reference:"FormFE",layout:{type:"vbox"},autoScroll:!0,defaults:{margin:0},bodyPadding:10,title:"",trackResetOnLoad:!0,items:[{xtype:"textfield",
name:"id",hidden:!0},{xtype:"textfield",name:"anno",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",name:"idEnte",hidden:!0},{xtype:"textfield",name:"numerazioneSeparata",hidden:!0},{xtype:"textfield",name:"codenteIntProtocollo",hidden:!0},{xtype:"textfield",name:"versione",hidden:!0},{xtype:"datefield",itemId:"Dal",reference:"Dal",fieldLabel:"DATA_DECORRENZA",labelClsExtra:"cbaLabel",labelWidth:100,name:"dal",width:210},{xtype:"fieldset",bodyPadding:10,width:600,
collapsible:!0,title:"ACCOUNT",itemId:"fsAccount",reference:"fsAccount",name:"fsAccount",items:[{xtype:"combobox",width:340,allowBlank:!1,valueField:"codice",displayField:"valore",name:"canaleTrasmittente",fieldLabel:"CANALE_TRASMITTENTE",itemId:"CbCanaleTrasmittente",reference:"CbCanaleTrasmittente",labelClsExtra:"cbaLabel",store:Ext.create("Generali.data.StoreCodiceValore",{proxy:{url:"gen/ws/general/fatturaElettronica/canaleTrasmittenteCbox",autoLoad:!1,autoDestroy:!0}})},{xtype:"textfield",fieldLabel:"COD_FISC_TRASMITTENTE",
labelClsExtra:"cbaLabel",name:"codFiscaleTrasmittente",itemId:"EdtCodFiscaleTrasmittente",reference:"EdtCodFiscaleTrasmittente",width:340,maxLength:28,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"USERNAME",name:"userName",labelClsExtra:"cbaLabel",width:320,maxLength:100,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"PASSOWRD",inputType:"password",name:"password",width:320,labelClsExtra:"cbaLabel",listeners:{change:function(a,c,d,e){d=!0;c&&a.isValid()&&(Ext.isEmpty(c)||Ext.isEmpty(c.trim())||
(d=!1));a.triggers.change.setHidden(d)}},triggers:{change:{cls:"icon-copy",tooltip:traduci("COPIA"),hidden:!0,handler:function(a){!Ext.isEmpty(a.getValue())&&a.isValid()&&(a=document.getElementById(a.getId()+"-inputEl"),a.type="text",a.select(),document.execCommand("copy"),a.type="password")}}}},{xtype:"textfield",fieldLabel:"COD_UFFICIO",name:"codIpaUfficio",labelClsExtra:"cbaLabel",width:320,maxLength:6,enforceMaxLength:!0},{xtype:"checkboxfield",boxLabel:"COD_UFFICIO_BY_OPERATORE",inputValue:"T",
uncheckedValue:"F",flex:1,itemId:"ChkCodIpaOperatore",reference:"ChkCodIpaOperatore",name:"gestioneCodIpaOperatore",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"container",padding:5,layout:{align:"stretch",type:"hbox"},itemId:"CntCodIpaOperatori",reference:"CntCodIpaOperatori",autoScroll:!0,hidden:!0,width:600,items:[{xtype:"gridpanel",itemId:"GridCodUfficio",reference:"GridCodUfficio",height:180,store:Ext.create("Generali.person_fe.store.AnagCodIpa"),features:[{ftype:"summary",dock:"bottom"}],
listeners:{selectionchange:function(a,c){c&&0<c.length&&(record=c[0].data,record.id&&(form=a.view.up().up().up().up(),form.up().getController().selectionChangeEditGridCodUfficio(a,record)))}},columns:[{xtype:"gridcolumn",text:"CODICI_UFFICIO",dataIndex:"codIpa",itemId:"txCodUfficio",reference:"txCodUfficio",editor:{xtype:"textfield",labelClsExtra:"cbaLabel",name:"codIpa",width:60,maxLength:7,enforceMaxLength:!0,allowBlank:!1}},{xtype:"gridcolumn",text:"DESCRIZIONE",flex:1,dataIndex:"descrizione",
itemId:"txDescrizione",reference:"txDescrizione",editor:{xtype:"textfield",labelClsExtra:"cbaLabel",name:"descrizione",width:200,maxLength:100,allowBlank:!1}}],viewConfig:{width:260,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoCodUfficio",reference:"BtnNuovoCodUfficio",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaCodUfficio",reference:"BtnEliminaCodUfficio",
iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]},{xtype:"gridpanel",itemId:"GridCodUfficioOperatore",reference:"GridCodUfficioOperatore",width:300,height:180,store:Ext.create("Generali.person_fe.store.AnagCodIpaOperatori"),features:[{ftype:"summary",dock:"bottom"}],columns:[{xtype:"gridcolumn",text:"OPERATORI_ABILITATI",flex:1,dataIndex:"idOperatore",itemId:"CbCodIpaOperatore",reference:"CbCodIpaOperatore",selectOnFocus:!0,editor:{xtype:"combobox",labelClsExtra:"cbaLabel",name:"idOperatore",displayField:"valore",
store:Ext.create("Generali.gestPwdNew.store.CboxUtenti",{asynchronousLoad:!1}),queryMode:"local",valueField:"codice",minChars:3,listeners:{afterrender:function(a){a.doAutoSelect=function(){return StdAmm.doAutoSelect(a)}}},width:260,allowBlank:!1},renderer:function(a,c,d,e,g,h,k){return d.get("desOperatore")}}],viewConfig:{width:200,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoCodUffOperatore",
reference:"BtnNuovoCodUffOperatore",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaCodUffOperatore",reference:"BtnEliminaCodUffOperatore",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]},{xtype:"checkboxfield",boxLabel:"NO_FATTFE_PASSIVA",inputValue:"T",uncheckedValue:"F",flex:1,itemId:"ChkFattPassivaNonAttiva",reference:"ChkFattPassivaNonAttiva",name:"fattPassivaNonAttiva",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"PROTOCOLLA_ATTIVE",
inputValue:"T",uncheckedValue:"F",flex:1,itemId:"ProtAutoFattAtt",reference:"ProtAutoFattAtt",name:"ProtAutoFattAtt",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"PROTOCOLLA_PASSIVE",inputValue:"T",uncheckedValue:"F",flex:1,itemId:"ProtAutoFattPas",reference:"ProtAutoFattPas",name:"ProtAutoFattPas",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"VISU_FATTELE_NOCIG",inputValue:"T",uncheckedValue:"F",flex:1,itemId:"ChkVisuFattNocig",
reference:"ChkVisuFattNocig",name:"visuFattNocig",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"textfield",fieldLabel:"COD_UFFICIO_AUTO_FATTURE",name:"codIpaAutofatture",labelClsExtra:"cbaLabel",width:320,maxLength:7,enforceMaxLength:!0},{xtype:"image",itemId:"IconEmpty",reference:"IconEmpty",width:20,height:20},{xtype:"container",layout:"hbox",items:[{xtype:"image",itemId:"IconOK",reference:"IconOK",width:20,height:20,cls:"icon-conferma"},{xtype:"label",itemId:"LblIconOK",reference:"LblIconOK",
text:"TEST_RIUSCITO",margin:"5 0 0 5",cls:"cbaLabel"}]},{xtype:"container",layout:"hbox",items:[{xtype:"image",itemId:"IconNO",reference:"IconNO",width:20,height:20,cls:"icon-elimina"},{xtype:"label",itemId:"LblIconNO",reference:"LblIconNO",text:"TEST_NON_RIUSCITO",margin:"5 0 0 5",cls:"cbaLabel"}]}]},{xtype:"fieldset",title:"Collegamenti",width:400,collapsible:!0,margin:"5 0 0 0",items:[{xtype:"container",itemId:"BoxCollegamenti",reference:"BoxCollegamenti",border:0,defaults:{margin:"1 1 1 1",width:300},
layout:{type:"vbox"},items:[{xtype:"radiogroup",itemId:"rgTipoKtree",reference:"rgTipoKtree",vertical:!0,margin:"0 0 0 5",items:[{formId:a.getItemId()+"-form",boxLabel:"dal 01/01/2019",name:"tipoK",cls:"cbaLabel",inputValue:1,checked:!0},{formId:a.getItemId()+"-form",boxLabel:"fino al 31/12/2018",name:"tipoK",cls:"cbaLabel",inputValue:2}]},{xtype:"panel",border:0,layout:{type:"vbox"},defaults:{margin:"0 0 1 0"},items:[{xtype:"button",iconCls:"icon-connessione32",scale:"medium",textAlign:"left",width:230,
text:"FATTURAZIONE_ELETTRONICA_ATTIVA",listeners:{click:function(b,c,d){b=a.controller.getFormFE().getForm().findField("codIpaUfficio");c=1==a.controller.getRgTipoKtree().getValue().tipoK;b.getValue();a.openConsultazione(!0,CBA.parametriGenerali.partitaIva,c)}}},{xtype:"button",iconCls:"icon-connessione32",scale:"medium",textAlign:"left",width:230,text:"FATTURAZIONE_ELETTRONICA_PASSIVA",listeners:{click:function(b,c,d){c=a.controller.getFormFE().getForm().findField("codIpaUfficio");b=1==a.controller.getRgTipoKtree().getValue().tipoK;
c=c.getValue();a.openConsultazione(!1,c,b)}}},{xtype:"button",iconCls:"icon-pdf",scale:"medium",textAlign:"left",width:230,itemId:"BtnStampa",reference:"BtnStampa",text:"MANUALE_CONSERVAZIONE"}]}]},{xtype:"container",itemId:"BoxCollegamentiDm7",reference:"BoxCollegamentiDm7",hidden:!0,border:0,defaults:{margin:"1 1 1 1",width:300},layout:"vbox",items:[{xtype:"displayfield",labelWidth:30,name:"ei7AttivoDal",labelClsExtra:"cbaLabel",fieldStyle:"font-weight: bold;",renderer:function(a){a&&(a=traduci("DAL")+
" "+FormattaData(a,"d/m/Y"));return a}},{xtype:"button",iconCls:"icon-connessione32",scale:"medium",textAlign:"left",width:230,text:"EINVOICE7",listeners:{click:function(a,c,d){window.open("https://e-invoice7-009.conserva.cloud/")}}}]}]},{xtype:"fieldset",bodyPadding:10,margin:"5 0 0 0",width:400,collapsible:!0,hidden:50!=getModuloAttivo()&&43!=getModuloAttivo()&&44!=getModuloAttivo(),title:"FATTURAZIONE_ELETTRONICA_ATTIVA",itemId:"fsFattAttiva",reference:"fsFattAttiva",name:"fsFattAttiva",items:[{xtype:"checkboxfield",
boxLabel:"ENABLE_EXPORT_XML",inputValue:"T",uncheckedValue:"F",flex:1,itemId:"CkbEnableExportXML",reference:"CkbEnableExportXML",name:"CkbEnableExportXML",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"DESCRIZIONI_DA_MODELLI",inputValue:"T",uncheckedValue:"F",itemId:"DescDaModelli",reference:"DescDaModelli",name:"descrizioneDaModelli",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",boxLabel:"INSERISCI_BOLLO_SENZA_ADD_B2C",inputValue:"T",uncheckedValue:"F",itemId:"BolloSenzaAddB2C",reference:"BolloSenzaAddB2C",
name:"bolloSenzaAddB2C",labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",margin:"0 0 0 15",boxLabel:traduci("BOLLO_VIRTUALE_NEGATIVO_PER_NA")+" (B2C)",inputValue:"T",uncheckedValue:"F",itemId:"BolloNAccNegativoB2C",reference:"BolloNAccNegativoB2C",name:"bolloNAccNegativoB2C",labelClsExtra:"cbaLabel"},{xtype:"combobox",width:340,margin:"5 0 0 0",valueField:"codice",displayField:"valore",queryMode:"local",fieldLabel:"TIPO_ESENZIONE_BOLLO",itemId:"TipoEsenzBollo",reference:"TipoEsenzBollo",name:"tipoEsenzioneBollo",
labelClsExtra:"cbaLabel",store:Ext.create("Generali.data.StoreCodiceValore",{proxy:{url:"/cba/gen/ws/general/fatturaElettronica/prszn/fePers/tipoEsBollo/cbox"}})},{xtype:"combobox",width:340,margin:"5 0 0 0",valueField:"codice",displayField:"valore",queryMode:"local",fieldLabel:"REGIME_FISCALE",itemId:"regimeFiscale",reference:"regimeFiscale",name:"regimeFiscale",labelClsExtra:"cbaLabel",store:Ext.create("Generali.person_fe.store.cboxCodificaEsterna")},{xtype:"textfield",margin:"5 0 0 0",width:340,
fieldLabel:"IBAN",name:"IBAN",labelClsExtra:"cbaLabel",maxLength:27,enforceMaxLength:!0},{xtype:"checkboxfield",fieldLabel:"PRIMA_NOTA",margin:"10 0 0 0",inputValue:"T",uncheckedValue:"F",itemId:"CkbPrimaNota",reference:"CkbPrimaNota",name:"CkbPrimaNota",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"fieldset",itemId:"fsRacPrimaNota",reference:"fsRacPrimaNota",title:"",hidden:!0,items:[{xtype:"combobox",width:320,valueField:"codice",displayField:"valore",queryMode:"local",fieldLabel:"RACC_TIPO_PRIMA_NOTA",
itemId:"racTipoPrimaNota",reference:"racTipoPrimaNota",name:"racTipoPrimaNota",labelClsExtra:"cbaLabel",store:Ext.create("Generali.person_fe.store.cboxCodificaEsterna")},{xtype:"combobox",width:320,valueField:"codice",displayField:"valore",queryMode:"local",fieldLabel:"RACC_NATURA_PRIMA_NOTA",itemId:"racNaturaPrimaNota",reference:"racNaturaPrimaNota",name:"racNaturaPrimaNota",labelClsExtra:"cbaLabel",store:Ext.create("Generali.person_fe.store.cboxCodificaEsterna")}]},{xtype:"checkboxfield",fieldLabel:"RAPP_FISCALE",
margin:"10 0 0 0",inputValue:"T",uncheckedValue:"F",itemId:"CkbRappFiscale",reference:"CkbRappFiscale",name:"CkbRappFiscale",boxLabelAlign:"before",labelClsExtra:"cbaLabel"},{xtype:"fieldset",bodyPadding:10,title:"RAPP_FISCALE",itemId:"fsRapFiscale",reference:"fsRapFiscale",name:"fsRapFiscale",hidden:!0,items:[{xtype:"textfield",width:320,fieldLabel:"RAPP-INTER_FISCALE_IDFISCALEIVA",labelClsExtra:"cbaLabel",ItemId:"RFidIva",reference:"RFidIva",name:"RFidIva",maxLength:28,enforceMaxLength:!0},{xtype:"textfield",
width:320,fieldLabel:"RAPP-INTER_FISCALE_IDCODICE",labelClsExtra:"cbaLabel",ItemId:"RFidCode",reference:"RFidCode",name:"RFidCode",maxLength:16,enforceMaxLength:!0},{xtype:"textfield",width:320,fieldLabel:"RAPP-INTER_FISCALE_DENOM",labelClsExtra:"cbaLabel",name:"RFdenom",maxLength:80,enforceMaxLength:!0},{xtype:"textfield",width:320,fieldLabel:"COGNOME",labelClsExtra:"cbaLabel",name:"RFcognome",maxLength:60,enforceMaxLength:!0},{xtype:"textfield",width:320,fieldLabel:"NOME",labelClsExtra:"cbaLabel",
name:"RFnome",maxLength:60,enforceMaxLength:!0},{xtype:"textfield",width:320,fieldLabel:"TITOLO",labelClsExtra:"cbaLabel",name:"RFtitolo",maxLength:10,enforceMaxLength:!0},{xtype:"textfield",width:320,fieldLabel:"CODICE_EORI",labelClsExtra:"cbaLabel",name:"RFcodeEori",maxLength:5,enforceMaxLength:!0}]},{xtype:"checkboxfield",fieldLabel:"INTER_FISCALE",margin:"10 0 0 0",inputValue:"T",uncheckedValue:"F",itemId:"CkbInterFiscale",reference:"CkbInterFiscale",name:"CkbInterFiscale",boxLabelAlign:"before",
labelClsExtra:"cbaLabel"},{xtype:"fieldset",bodyPadding:10,title:"INTER_FISCALE",itemId:"fsInterFiscale",reference:"fsInterFiscale",name:"fsInterFiscale",hidden:!0,items:[{fieldLabel:"RAPP-INTER_FISCALE_IDFISCALEIVA",ItemId:"IFidIva",reference:"IFidIva",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFidIva",width:320,maxLength:28,enforceMaxLength:!0},{fieldLabel:"RAPP-INTER_FISCALE_IDCODICE",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFidCode",width:320,maxLength:16,enforceMaxLength:!0},
{fieldLabel:"RAPP-INTER_FISCALE_DENOM",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFdenom",width:320,maxLength:80,enforceMaxLength:!0},{fieldLabel:"COGNOME",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFcognome",width:320,maxLength:60,enforceMaxLength:!0},{fieldLabel:"NOME",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFnome",width:320,maxLength:60,enforceMaxLength:!0},{fieldLabel:"TITOLO",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFtitolo",width:320,maxLength:10,enforceMaxLength:!0},
{fieldLabel:"CODICE_EORI",xtype:"textfield",labelClsExtra:"cbaLabel",name:"IFcodeEori",width:320,maxLength:5,enforceMaxLength:!0}]},{xtype:"fieldset",title:"Abilitazioni",layout:{type:"hbox"},bodyPadding:10,margin:"5 0 5 0",width:350,collapsible:!0,items:[{xtype:"container",layout:"vbox",margin:"10 0 0 0",items:[{xtype:"checkboxfield",fieldLabel:"DISABLE_B2C",width:200,disabled:!0,inputValue:"T",uncheckedValue:"F",itemId:"CkbDisableB2C",reference:"CkbDisableB2C",name:"CkbDisableB2C",boxLabelAlign:"before",
labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",fieldLabel:"ENABLE_IMPORT_XML",disabled:!0,width:200,inputValue:"T",uncheckedValue:"F",itemId:"CkbEnableImportXML",reference:"CkbEnableImportXML",name:"CkbEnableImportXML",boxLabelAlign:"before",labelClsExtra:"cbaLabel"}]},{xtype:"button",itemId:"BtnEnableB2C",reference:"BtnEnableB2C",margin:"0 0 0 5",cls:"cba-button-25",iconCls:"icon-locked",tooltip:"SBLOCCA",width:25}]}]}]},{xtype:"panel",region:"east",itemId:"boxBottoni",reference:"boxBottoni",width:120,
title:""}]});a.callParent(arguments)}});
Ext.define("Generali.person_fe.view.GestBolli",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",border:0,flex:1,layout:{align:"stretch",type:"vbox"},items:[{xtype:"container",autoScroll:!0,height:50,layout:{type:"hbox",align:"fit"},padding:"10,5,0,0",trackResetOnLoad:!0,items:[{xtype:"combobox",width:350,labelWidth:70,fieldLabel:"ANNO",labelClsExtra:"cbaLabel",itemId:"CBAnno",reference:"CBAnno",displayField:"valore",queryMode:"local",
valueField:"codice",editable:!1,store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont",{autoload:!1})},{xtype:"button",cls:"btnLarge",itemId:"BtnCerca",reference:"BtnCerca",formBind:!0,margin:"0 5 0 5",width:40,iconCls:"icon-ricerca",scale:"medium"}]},{xtype:"gridpanel",itemId:"GridBolli",reference:"GridBolli",maxWidth:452,margin:"0 0 0 10",store:Ext.create("Generali.person_fe.store.Bolli"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",text:"IDANNOESERCIZIO",width:125,dataIndex:"idAnnoEsercizio",
align:"center",sortable:!1,hidden:!0},{xtype:"gridcolumn",text:"ANNO",width:125,dataIndex:"anno",align:"center",sortable:!1},{xtype:"gridcolumn",text:"N. BOLLI",width:125,dataIndex:"numeroBolli",align:"center",sortable:!1,renderer:function(a,c,d,e,g,h,k){c.style="text-align:right !important";return a}},{xtype:"actioncolumn",width:100,align:"center",text:traduci("AGGIORNA_DATO"),items:[{iconCls:"icon-refresh",tooltip:traduci("AGGIORNA_DATO"),handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.aggiornaConteggio(b)}}]},
{xtype:"actioncolumn",width:100,align:"center",text:traduci("ELENCO_FATTURE"),items:[{iconCls:"icon-download",tooltip:traduci("ELENCO_FATTURE"),handler:function(b,c,d){b=b.getStore().getAt(c);a.controller.scaricaElencoCsv(b)}}]}]}]}]});a.callParent(arguments)}});
Ext.define("Generali.person_fe.view.GestCodificaEsterna",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",nonDisabilitare:!0,padding:5,layout:{type:"hbox",align:"stretch"},items:[{xtype:"radiogroup",flex:1,padding:5,columns:1,vertical:!0,labelClsExtra:"cbaLabel",itemId:"RbTipo",reference:"RbTipo",height:70,cls:"cbaLabel",items:[{boxLabel:"CONDIZIONI_DI_PAGAMENTO",
name:"tipo",inputValue:"CPG",checked:!0},{boxLabel:"NATURA_IVA",name:"tipo",inputValue:"NI"},{boxLabel:"TIPI_DOCUMENTO",name:"tipo",inputValue:"TD"}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",title:"CODIFICA_ESTERNA",itemId:"GridGest",reference:"GridGest",flex:2,store:Ext.create("Generali.person_fe.store.CodificaEsterna"),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",
text:"CODICE",dataIndex:"codice",width:60,sortable:!1,editor:{xtype:"textfield",allowBlank:!1}},{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",sortable:!1,flex:1,editor:{xtype:"textfield",allowBlank:!1}},{xtype:"gridcolumn",text:"IVA_CON_IMPOSTA",dataIndex:"ivaConImposta",hidden:!0}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})]},{xtype:"splitter"},{xtype:"container",flex:1,itemId:"CntRaccordo",reference:"CntRaccordo",layout:"fit",cbaConfig:{url:"Generali.person_fe.view.GestCodificaEsternaRaccordo"}}]}]}]});
this.callParent(arguments)}});
Ext.define("Generali.person_fe.view.GestCodificaEsternaRaccordo",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",title:"COLLEGAMENTO_SIPCAR",width:180,itemId:"GridRacc",reference:"GridRacc",flex:1,store:Ext.create("Generali.person_fe.store.RaccordoCodificaEsterna",{autoLoad:!1}),viewConfig:{loadMask:!1},columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"idCodiceSipcar",flex:1,sortable:!1,renderer:function(a,b,c){return c.get("desCodiceSipcar")},
editor:{xtype:"combobox",displayField:"valore",allowBlank:!1,queryMode:"local",valueField:"codice",minChars:0,listeners:{change:function(a,b,c){a=this.up().up().controller;colRifN=a.getGridRacc().getColumnManager().getColumns()[1];"feRiferimentoNormativo"==colRifN.dataIndex&&(b=a.storeNI.findRecord("codice",b),b=null!=b?b.getData().extra:"",colRifN.getEditor().setValue(b))}}}},{xtype:"gridcolumn",text:"FE_RIFERIMENTONORMATIVO",dataIndex:"feRiferimentoNormativo",name:"feRiferimentoNormativo",itemId:"feRiferimentoNormativo",
reference:"feRiferimentoNormativo",flex:1,sortable:!1,renderer:function(a,b,c){a=this.getController().storeNI.findRecord("codice",c.getData().idCodiceSipcar);a=null!=a?a.getData().extra:"";c.data.feRiferimentoNormativo=null==a?"":a;return null==a?"":a},hidden:!0,editor:{xtype:"textfield",displayField:"extra",queryMode:"local",valueField:"codice",maxLength:100,enforceMaxLength:!0}}],plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",
items:[{xtype:"button",itemId:"BtnNuovoRacc",reference:"BtnNuovoRacc",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaRacc",reference:"BtnEliminaRacc",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.person_fe.view.MainPersonFE",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",border:0,itemId:"CntServizioDisattivato",reference:"CntServizioDisattivato",layout:{align:"stretch",type:"vbox"},title:"",hidden:!0,items:[{xtype:"panel",cls:"pannelloBiancoBordato",margin:3,layout:{align:"stretch",type:"vbox"},height:120,border:0,items:[{xtype:"label",margin:"30 15 0 15",cls:"cbaLabelDatiUtente",html:traduci("MSG_ATTIVAZIONE_FE"),
style:"text-align:center"}]}]},{xtype:"container",itemId:"CntMainPersonFE",reference:"CntMainPersonFE",flex:1,layout:{type:"vbox",align:"stretch"},hidden:!0,items:[{xtype:"tabpanel",border:0,itemId:"TabRicerca",reference:"TabRicerca",flex:1,activeTab:0,items:[{title:"CODIFICA_ESTERNA",layout:"fit",itemId:"TabCodEsterna",reference:"TabCodEsterna",cbaConfig:{url:"Generali.person_fe.view.GestCodificaEsterna"}},{title:traduci("ACCOUNT")+(50==getModuloAttivo()||43==getModuloAttivo()?" / "+traduci("PERS_FATT_ATTIVE"):
""),layout:"fit",itemId:"TabAccount",reference:"TabAccount",cbaConfig:{url:"Generali.person_fe.view.GestAccountPersonFE"}},{title:"BOLLI_FE_INVIATE",hidden:50!=getModuloAttivo()&&43!=getModuloAttivo(),layout:"fit",itemId:"TabBolli",reference:"TabBolli",cbaConfig:{url:"Generali.person_fe.view.GestBolli"}}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.person_fe.view.SbloccaCodIpaOperatori",{extend:"CbaUtils.componenti.all.PanelAttivaFunzioniCBA",messaggioAttivazione:"MSG_ATTIVAZIONE_CODIPAOPERATORI",nomeFunzioneDaAttivare:traduci("GE_CODIPA_OPE"),codiceFunzione:"GE_CODIPA_OPE",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"panel",itemId:"Allegato",reference:"Allegato",border:0,autoScroll:!0,flex:1,bodyPadding:10}]});this.callParent(arguments)}});
Ext.define("Generali.pianodeiconti.controller.AlberoConti",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:a+"#TreeRep"},{ref:"PnlDati",selector:a+"#PnlDati"},{ref:"BtnNuovo",selector:a+"#BtnNuovo"},{ref:"BtnElimina",selector:a+"#BtnElimina"},{ref:"BtnConferma",selector:a+"#BtnConferma"},{ref:"BtnEsci",selector:a+"#BtnEsci"},{ref:"CBAnno",selector:a+"#CBAnno"},{ref:"LblSelettore",selector:a+"#LblSelettore"},
{ref:"TxtCerca",selector:a+"#TxtCerca"}]);this.control(a+"#TreeRep",{render:this.renderTreeRep,beforeitemcontextmenu:this.beforeitemcontextmenuTreeRep,beforeedit:this.beforeeditTreeRep,edit:this.editTreeRep,canceledit:this.canceleditTreeRep,validateedit:this.validateeditTreeRep,beforeselect:this.beforeselectTreeRep,select:this.selectTreeRep,itemdblclick:this.itemdblclickTreeRep});this.control(a+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(a+"#BtnElimina",{click:this.clickBtnElimina});this.control(a+
"#BtnConferma",{click:this.clickBtnConferma});this.control(a+"#BtnEsci",{click:this.clickBtnEsci});this.control(a+"#CBAnno",{afterrender:this.afterrenderCBAnno,change:this.changeCBAnno});this.control(a+"#TxtCerca",{change:Ext.Function.createBuffered(this.cercaTree,500,this)})},cercaTree:function(a){var b=this.getTreeRep(),c=b.getStore(),d=[];this.getLblSelettore().setVisible(!1);c.clearFilter();Ext.isEmpty(a.getValue())?(c.each(function(a){a.set("cls","")}),b.getSelectionModel().hasSelection()?b.ensureVisible(b.getSelectionModel().getSelection()[0]):
b.getSelectionModel().select(0)):(c.each(function(b){if(b.isLeaf()){var c=!1,e=b.get("text");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);c?(b.set("cls","cba-dirty-record"),d.push(b)):b.set("cls","")}}),this.filtraTree(c,d),this.getLblSelettore().setVisible(1<d.length),Ext.isEmpty(d)?b.getSelectionModel().select(0):(b.ensureVisible(d[0]),this.getLblSelettore().setText(traduci("NUM_ELEMENTI_TROVATI",[d.length]))));a.focus()},filtraTree:function(a,b){a.filter(function(a){for(var c=
!1,e=0,g=b.length;e<g;e++)if(a.contains(b[e])){c=!0;break}else if(a.isLeaf()&&(c=a===b[e]))break;return c})},renderTreeRep:function(a){a.view.loadMask=!1},changeCBAnno:function(a,b,c,d){var e=this,g=e.getTreeRep().up("#CntPrincipale").down("#FormPianoConti").controller;a=e.getCBAnno().getValue();e.AnnobilancioScalare>a||0==e.AnnobilancioScalare?(g.getCBCosti().setVisible(!0),g.getCBRicavi().setVisible(!0),g.getCBContoEco().setVisible(!1)):(g.getCBCosti().setVisible(!1),g.getCBRicavi().setVisible(!1),
g.getCBContoEco().setVisible(!0));e.isPianoDeiContiBilingue=!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/pianoDeiConti/isPianoDeiContiBilingue",async:!1,params:{idOrganizzazione:e.cbaConfig.idOrganizzazione,idEsercizio:b},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(e.isPianoDeiContiBilingue="T"==a.data[0],g.getTxDescrBilingue().setDisabled(!e.isPianoDeiContiBilingue),g.getTxDescrBilingue().setVisible(e.isPianoDeiContiBilingue)):msgShowError("",a.message)}});g.extraParametri(g.storeSottoconto1);
g.extraParametri(g.storeSottoconto2);g.extraParametri(g.storeSottoconto3);g.extraParametri(g.storeSottoconto4);e.aggiornaStore()},itemdblclickTreeRep:function(a,b,c,d,e,g){this.selezionaEsci()},selezionaEsci:function(){var a=this.getBtnConferma();if(a.isVisible()){var b=this.getTreeRep().getSelectionModel().getSelection()[0];b&&b.get("leaf")&&(this.cbaConfig.afterConferma&&this.cbaConfig.afterConferma(b.get("id")),a.up("window").close())}},clickBtnConferma:function(a){this.selezionaEsci()},clickBtnEsci:function(a){a.up("window").close()},
beforeselectTreeRep:function(a,b){if(this.cbaConfig.verificaOnlus)return this.cbaConfig.verificaOnlus();if(0!=b.get("id"))return 0<b.get("id")},selectTreeRep:function(a,b){var c=this.getTreeRep().up("#CntPrincipale").down("#FormPianoConti").controller;this.getBtnElimina().setDisabled(0===b.get("id")||"L"==this.cbaConfig.permesso);this.getBtnConferma().setDisabled(0===b.get("id")||!b.get("leaf"));c.idTestata=b.get("id");c.foglia=b.get("leaf");c.livello=b.get("livello");c.recordAlbero=b;c.setVisibleTipoCE(!1);
var d=c.getCBtipoContoEconomico();(2==c.livello||2<c.livello)&&getVerificaContoEconomico(b.get("id"))&&d.getStore().load({params:{idPdcPadre:b.get("idPadre"),livelloPdc:c.livello},callback:function(a,b,d){d&&c.setVisibleTipoCE(!Ext.isEmpty(a))}});0==b.get("idPadre")&&0!=c.livello?(c.primoLivello=!0,c.getFsSezione().setVisible(!0)):(c.primoLivello=!1,c.getFsSezione().setVisible(!1));0!=b.get("id")?c.aggiornaStore():clearForm(c.getFormPianoConti());c.getCNTNonTotLivSup().setVisible(2==c.livello&&(1==
b.get("sezione")||2==b.get("sezione")));c.getCBCatCespite().setVisible(c.getCBCespite().checked);c.getCBAmmortamentoOrdinario().setVisible(c.getCBCespite().checked);c.getCBFondoAmmOrd().setVisible(c.getCBCespite().checked);c.getCBPlusvalenza().setVisible(c.getCBCespite().checked);c.getCBMinusvalenza().setVisible(c.getCBCespite().checked);c.getTIban().setVisible(c.getCBBanca().checked);c.getTCin().setVisible(c.getCBBanca().checked);c.getTConto().setVisible(c.getCBBanca().checked);c.getCBBanche().setVisible(c.getCBBanca().checked);
c.getCBSportelli().setVisible(c.getCBBanca().checked);c.getTxIbanCompleto().setVisible(c.getCBBanca().checked);c.getTxImpBudget().setVisible(1==c.foglia&0==!b.get("idPadre"));c.getFSBanca().setVisible(1==c.foglia&0==!b.get("idPadre"));CBA.moduli.modulo53.abilitato&&c.getFSCespite().setVisible(1==c.foglia&0==!b.get("idPadre"));c.getFSAttivitaBilancioOnlus().setVisible(1==c.foglia&0==!b.get("idPadre")&"T"==this.bilancioOnlus)},beforeeditTreeRep:function(a,b,c){if(!0===a.editing||0===b.record.get("id"))return!1;
this.abilitaBottoniGrid(!1)},editTreeRep:function(a,b,c){var d=b.record.getData();c=a.getEditor().getForm();c.controller=this;c.store=this.getTreeRep().getStore();d={id:d.id?d.id:null,idOrganizzazione:this.cbaConfig.idOrganizzazione,anno:this.getCBAnno().getValue(),idPadre:d.idPadre,descrizione:d.text};controller_salvaRecord(c,d,!1,!1)?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditTreeRep:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditTreeRep:function(a,
b,c){return msgShow("",[])},beforeitemcontextmenuTreeRep:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a){var b=this,c=b.getTreeRep(),d=c.getStore();Ext.isEmpty(b.getTxtCerca().getValue())||(d.clearFilter(),setValue(b.getTxtCerca(),null));Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/pianoDeiConti/isAttivoBilancioOnlus",params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.getCBAnno().getValue()},success:function(a){a=Ext.JSON.decode(a.responseText);
a.success?b.bilancioOnlus=a.data:msgShowError("",a.message)}});d.load({params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.getCBAnno().getValue()},callback:function(b,d,h){h?(b=c.getRootNode().findChild("id",a,!0),c.expandAll(),b?(c.getSelectionModel().select(0),c.getSelectionModel().select([b]),c.getPlugin().scrollTo(b.get("numRiga"),!0)):c.getSelectionModel().select(0)):msgShowError("",d.getError())}})},clickBtnNuovo:function(){var a=this.getTreeRep(),b=a.getStore(),c=a.getSelectionModel().getLastSelected();
b.clearFilter();c.set("leaf",!1);c.appendChild({leaf:!0,idPadre:c.get("id")});a.getView().refresh();c.expand();a.getPlugin().startEdit(c.lastChild,0);this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},clickBtnElimina:function(){var a=this,b=a.getTreeRep(),c=b.getSelectionModel().getSelection()[0],d=c.hasChildNodes()?"MSG_ELIMINA_NODO":"";controller_eliminaRecord(b.getStore(),{id:c?c.get("id"):""},function(){a.aggiornaStore()},
!1,d)},afterrenderCBAnno:function(a){var b=this,c;c=b.cbaConfig.idOrganizzazione;Ext.Ajax.request({method:"GET",async:!1,url:"/cba/gen/ws/general/org/src/getIdOrgAmministrazione",params:{idOrganizzazione:b.cbaConfig.idOrganizzazione},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c=a.data:msgShowError("",a.message)}});getIdEsercizioDefaultByIdOrg(c,function(d){b.idEsercizioDefault=d;b.cbaConfig.cespite&&(b.idEsercizioDefault=b.cbaConfig.idEsercizio);setCombo(a,b.idEsercizioDefault,
null,{idOrganizzazione:c});getAnnoBilancioScalare(c,b.idEsercizioDefault,function(a){b.AnnobilancioScalare=a})})},onLaunch:function(){this.getTreeRep().controller=this},destroy:function(){this.callParent()}});
Ext.define("Generali.pianodeiconti.controller.PianoConti",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"FormPianoConti",selector:this.selContainer+
"#FormPianoConti"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"CBAmmortamentoOrdinario",selector:this.selContainer+"#CBAmmortamentoOrdinario"},{ref:"CBFondoAmmOrd",selector:this.selContainer+"#CBFondoAmmOrd"},{ref:"CBPlusvalenza",selector:this.selContainer+"#CBPlusvalenza"},{ref:"CBMinusvalenza",selector:this.selContainer+"#CBMinusvalenza"},{ref:"CBBanche",selector:this.selContainer+"#CBBanche"},{ref:"CBSportelli",selector:this.selContainer+"#CBSportelli"},{ref:"CBCespite",selector:this.selContainer+
"#CBCespite"},{ref:"CBCatCespite",selector:this.selContainer+"#CBCatCespite"},{ref:"TIban",selector:this.selContainer+"#TIban"},{ref:"TCin",selector:this.selContainer+"#TCin"},{ref:"TConto",selector:this.selContainer+"#TConto"},{ref:"RFAttivo",selector:this.selContainer+"#RFAttivo"},{ref:"FSBanca",selector:this.selContainer+"#FSBanca"},{ref:"FSCespite",selector:this.selContainer+"#FSCespite"},{ref:"IdForm",selector:this.selContainer+"#IdForm"},{ref:"IdVisibile",selector:this.selContainer+"#IdVisibile"},
{ref:"CBObbligaCda",selector:this.selContainer+"#CBObbligaCda"},{ref:"CBCosti",selector:this.selContainer+"#CBCosti"},{ref:"CBRicavi",selector:this.selContainer+"#CBRicavi"},{ref:"CBContoEco",selector:this.selContainer+"#CBContoEco"},{ref:"CBBanca",selector:this.selContainer+"#CBBanca"},{ref:"TxImpBudget",selector:this.selContainer+"#TxImpBudget"},{ref:"FsSezione",selector:this.selContainer+"#FsSezione"},{ref:"TxIbanCompleto",selector:this.selContainer+"#TxIbanCompleto"},{ref:"CBtipoContoEconomico",
selector:this.selContainer+"#CBtipoContoEconomico"},{ref:"TxDescrizione",selector:this.selContainer+"#TxDescrizione"},{ref:"TxDescrBilingue",selector:this.selContainer+"#TxDescrBilingue"},{ref:"CNTNonTotLivSup",selector:this.selContainer+"#CNTNonTotLivSup"},{ref:"CBNonTotLivSup",selector:this.selContainer+"#CBNonTotLivSup"},{ref:"FSAttivitaBilancioOnlus",selector:this.selContainer+"#FSAttivitaBilancioOnlus"},{ref:"FSContiComuneConnessi",selector:this.selContainer+"#FSContiComuneConnessi"},{ref:"RFComune",
selector:this.selContainer+"#RFComune"},{ref:"CbContoIstituzionale",selector:this.selContainer+"#CbContoIstituzionale"},{ref:"CbAttivitaConnesse",selector:this.selContainer+"#CbAttivitaConnesse"},{ref:"RFConnesso",selector:this.selContainer+"#RFConnesso"},{ref:"RFIstituzionale",selector:this.selContainer+"#RFIstituzionale"},{ref:"BtnNuovoContoConnesso",selector:this.selContainer+"#BtnNuovoContoConnesso"},{ref:"BtnEliminaContoConnesso",selector:this.selContainer+"#BtnEliminaContoConnesso"},{ref:"GridContiConnessi",
selector:this.selContainer+"#GridContiConnessi"},{ref:"CBContoConnesso",selector:this.selContainer+"#CBContoConnesso"},{ref:"FSAttPrimaria",selector:this.selContainer+"#FSAttPrimaria"},{ref:"FSCollegaCdaEts",selector:this.selContainer+"#FSCollegaCdaEts"},{ref:"BtnNuovoAttPrimaria",selector:this.selContainer+"#BtnNuovoAttPrimaria"},{ref:"BtnEliminaAttPrimaria",selector:this.selContainer+"#BtnEliminaAttPrimaria"},{ref:"BtnNuovoCdaEts",selector:this.selContainer+"#BtnNuovoCdaEts"},{ref:"BtnEliminaCdaEts",
selector:this.selContainer+"#BtnEliminaCdaEts"},{ref:"GridEts",selector:this.selContainer+"#GridEts"},{ref:"GridAttPrimaria",selector:this.selContainer+"#GridAttPrimaria"},{ref:"CBContoOrd",selector:this.selContainer+"#CBContoOrd"},{ref:"txCodRaccordo",selector:this.selContainer+"#txCodRaccordo"},{ref:"ColEts",selector:this.selContainer+"#ColEts"}]);this.control(this.selContainer+"#CBBanche",{change:this.changeCBBanche});this.control(this.selContainer+"#CBCespite",{change:this.changeCBCespite});this.control(this.selContainer+
"#CBBanca",{change:this.changeCBBanca});this.control(this.selContainer+"#RFAttivo",{change:this.changeRFAttivo});this.control(this.selContainer+"#TConto",{blur:this.blurTConto});this.control(this.selContainer+"#CBSportelli",{blur:this.blurCBSportelli});this.control(this.selContainer+"#RFComune",{change:this.changeRFComune});this.control(this.selContainer+"#RFConnesso",{change:this.changeRFConnesso});this.control(this.selContainer+"#RFIstituzionale",{change:this.changeRFIstituzionale});this.control(this.selContainer+
"#BtnNuovoContoConnesso",{click:this.clickBtnNuovoContoConnesso});this.control(this.selContainer+"#BtnEliminaContoConnesso",{click:this.clickBtnEliminaContoConnesso});this.control(this.selContainer+"#CbContoIstituzionale",{change:this.changeCbContoIstituzionale});this.control(this.selContainer+"#GridContiConnessi",{beforeedit:this.beforeeditGridContiConnessi,edit:this.editGridContiConnessi,canceledit:this.canceleditGridContiConnessi,validateedit:this.validateeditGridContiConnessi});this.control(this.selContainer+
"#BtnNuovoAttPrimaria",{click:this.clickBtnNuovoAttPrimaria});this.control(this.selContainer+"#BtnEliminaAttPrimaria",{click:this.clickBtnEliminaAttPrimaria});this.control(this.selContainer+"#BtnNuovoCdaEts",{click:this.clickBtnNuovoCdaEts});this.control(this.selContainer+"#BtnEliminaCdaEts",{click:this.clickBtnEliminaCdaEts});this.control(this.selContainer+"#GridAttPrimaria",{beforeedit:this.beforeeditGridAttPrimaria,edit:this.editGridAttPrimaria,canceledit:this.canceleditGridAttPrimaria,validateedit:this.validateeditGridAttPrimaria});
this.control(this.selContainer+"#GridEts",{beforeedit:this.beforeeditGridEts,edit:this.editGridEts,canceledit:this.canceleditGridEts,validateedit:this.validateeditGridCdaEts,select:this.selectGridCdaEts})},selectGridCdaEts:function(a,b,c,d){this.recOrig=b},getIdEsercizioPdc:function(){var a=this.cbaConfig.controllerAlbero,b=this.idEsercizioOriginale;a&&(a=a.getCBAnno().getValue(),StdSipcar.isValidID(a)&&(b=a));return b},beforeeditGridContiConnessi:function(a,b,c){if(!0===a.editing)return!1;a=a.getEditor().getForm();
this.getFSContiComuneConnessi().isVisible()&&(this.storeComboContiConnessiGriglia.load({params:{idOrganizzazione:this.cbaConfig.idOrganizzazione,idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue(),contoBanca:"F",attivitaConto:1}}),a.findField("idContoConnesso").bindStore(this.storeComboContiConnessiGriglia));this.abilitaBottoniGrid(!1)},editGridContiConnessi:function(a,b,c){var d=this;c=b.record.getData();var e=a.getEditor().getForm();e.controller=this;e.store=b.view.getStore();delete c.desContoConnesso;
Ext.apply(c,{idContoSorgente:d.idTestata});controller_salvaRecord(e,c,!1,{forzaRegistrazione:!1})?(d.abilitaBottoniGrid(!0),d.storeGrigliaContiConnessi.load({params:{idContoSorgente:d.idTestata},callback:function(a,b,c){c&&(Ext.isEmpty(a)||d.getGridContiConnessi().getSelectionModel().select(0),100>d.cbaConfig.controlleCntPrincipale.attivitaComuneCompilata?d.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!0):d.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!1))}})):a.startEdit(b.record,0)},
canceleditGridContiConnessi:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridContiConnessi:function(a,b,c){var d=0;this.getGridContiConnessi().getStore().each(function(a){d=a.data.id!=b.record.data.id?d+a.get("percentuale"):d+b.newValues.percentuale});if(100<d)return Messaggio("ATTENZIONE","La somma percentuale supera il 100%","OK","WARNING"),!1;IsolaCmp(this.getFSContiComuneConnessi(),100!=d);this.cbaConfig.controlleCntPrincipale.attivitaComuneCompilata=
d},abilitaBottoniGrid:function(a){this.getBtnNuovoContoConnesso().setDisabled(!a);this.getBtnEliminaContoConnesso().setDisabled(!a)},clickBtnNuovoContoConnesso:function(a){a=this.getGridContiConnessi();var b=a.getStore(),c=0;b.each(function(a){c+=a.get("percentuale")});b.insert(0,{percentuale:100-c});a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0)},clickBtnEliminaContoConnesso:function(a){var b=this;a=b.getGridContiConnessi();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),
{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridAttPrimaria:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGridAttPrimaria(!1)},focusEts:function(){var a=this,b=a.getGridEts().getSelection()[0].get("idAbbinamento");Ext.create("CP.bilanciRiclassificati.store.BilanciRicTes").load({params:{idOrganizzazione:a.cbaConfig.idOrganizzazione,idEsercizio:a.cbaConfig.controllerAlbero.getCBAnno().getValue(),tipologia:"E",soloContrapposto:"T"},callback:function(c,d,e){e?Ext.isEmpty(c)||
(c=c.at(0),Ext.create("winCBA",{name:"CP.bilanciRiclassificati.view.AlberoPdc",titolo:"BILANCIO_RICLASSIFICATO",dimensione:7,configItem:{isWindow:!0,idOrganizzazione:a.cbaConfig.idOrganizzazione,idBilRicl:c.get("id"),idAbbinamento:b,albero:"alberoBilRic",soloFigli:"children",tipoAbbinamento:"R",afterConferma:function(b){b=void 0===b?[]:b;b=b[0];b[3]?a.getColEts().getEditor().up("form").getForm().setValues({idAbbinamento:b[1],descrAbbinamento:b[2]}):msgShowError("","PDC_SOLO_ULTIMO_LIVELLO")}},closable:!0}).show()):
msgShowError("",d.getError())}})},beforeeditGridEts:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGridEts(!1)},editGridAttPrimaria:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();delete c.desCda;this.editGridAtt=!0;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGridAttPrimaria(!0):a.startEdit(b.record,0)},editGridEts:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=
this;d.store=b.view.getStore();delete c.descrCda;c.idCda=c.cda;delete c.cda;delete c.descrAbbinamento;this.recOrig&&c.id==this.recOrig.get("id")&&""==c.idCda&&(c.idCda=this.recOrig.get("idCda"));this.editGridCdaEts=!0;controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1,tuttiCdaFinali:getBoolValue(d.soloFinali)})?this.abilitaBottoniGridEts(!0):a.startEdit(b.record,0);delete d.soloFinali},canceleditGridAttPrimaria:function(a,b,c){this.abilitaBottoniGridAttPrimaria(!0);this.aggiornaStoreGrigliaAttPrimaria(b.record.get("id"))},
canceleditGridEts:function(a,b,c){this.abilitaBottoniGridEts(!0);this.aggiornaStoreGrigliaCdaEts(b.record.get("id"))},validateeditGridAttPrimaria:function(a,b,c){var d=0;this.getGridAttPrimaria().getStore().each(function(a){d=a.data.id!=b.record.data.id?d+a.get("percentuale"):d+b.newValues.percentuale});if(100<arrotonda(d,2))return Messaggio("ATTENZIONE","SOMMA_PERCENTUALE_MAGGIORE_100","OK","WARNING"),!1;this.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!1)},validateeditGridCdaEts:function(a,
b,c){return!0},abilitaBottoniGridAttPrimaria:function(a){this.getBtnNuovoAttPrimaria().setDisabled(!a);this.getBtnEliminaAttPrimaria().setDisabled(!a)},abilitaBottoniGridEts:function(a){this.getBtnNuovoCdaEts().setDisabled(!a);this.getBtnEliminaCdaEts().setDisabled(!a)},clickBtnNuovoAttPrimaria:function(a){a=this.getGridAttPrimaria();var b=a.getStore(),c=0;b.each(function(a){c+=a.get("percentuale")});var d={idOrganizzazione:this.cbaConfig.idOrganizzazione,idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue(),
idConto:this.idTestata,percentuale:100-c};b.insert(0,d);a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0);cdaDoubleClick(a.columns[2].getEditor())},clickBtnNuovoCdaEts:function(a){a=this.getGridEts();var b=a.getStore(),c={idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue(),idPdc:this.idTestata};b.insert(0,c);a.getSelectionModel().select(0);a.getPlugin().startEdit(0,0);cdaDoubleClick(a.columns[2].getEditor())},clickBtnEliminaAttPrimaria:function(a){var b=this;a=b.getGridAttPrimaria();
var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStoreGrigliaAttPrimaria()})},clickBtnEliminaCdaEts:function(a){var b=this;a=b.getGridEts();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):""},function(){b.aggiornaStoreGrigliaCdaEts()})},changeCbContoIstituzionale:function(a,b,c,d){},changeRFIstituzionale:function(a){this.getRFIstituzionale().checked&&(this.getCbContoIstituzionale().allowBlank=
!0,this.getCbAttivitaConnesse().allowBlank=!0,this.getRFIstituzionale().checked&&(this.cbaConfig.controlleCntPrincipale.flagAttivitaComune="F"))},changeRFComune:function(a){var b=this;b.getCbContoIstituzionale().setVisible(b.getRFComune().checked);b.getRFComune().checked?(b.cbaConfig.controlleCntPrincipale.flagAttivitaComune="T",b.getCbContoIstituzionale().bindStore(b.storeContiIstituzionali),b.storeContiIstituzionali.load({params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue(),
contoBanca:"F",attivitaConto:0},callback:function(a,d,e){b.getCbContoIstituzionale().allowBlank=!1;b.getCbAttivitaConnesse().allowBlank=!0}}),b.storeGrigliaContiConnessi.removeAll()):b.cbaConfig.controlleCntPrincipale.flagAttivitaComune="F"},changeRFConnesso:function(){var a=this;a.getCbAttivitaConnesse().setVisible(a.getRFConnesso().checked);a.getRFConnesso().checked&&(a.cbaConfig.controlleCntPrincipale.flagAttivitaComune="F",a.getCbAttivitaConnesse().bindStore(a.storeAttivitaConnesse),a.storeAttivitaConnesse.load({params:{idOrganizzazione:getIdOrg()},
callback:function(b,c,d){d&&(a.getCbAttivitaConnesse().allowBlank=!1,a.getCbContoIstituzionale().allowBlank=!0)}}))},r0:function(a,b){for(var c=""+a;c.length<b;)c="0"+c;return c},calcola_BBAN:function(a,b,c){a=this.r0(a,5);b=this.r0(b,5);c=this.r0(c,12);if(-1==a.search(/^[0-9]{5}$/)||-1==b.search(/^[0-9]{5}$/)||-1==c.search(/^[0-9A-Z]{12}$/))return"";for(var d=[1,0,5,7,9,13,15,17,19,21,1,0,5,7,9,13,15,17,19,21,2,4,18,20,11,3,6,8,12,14,16,10,22,25,24,23],e=[0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,
10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],g=""+a+b+c,h=0,k=-1;21!==k;)h+=d["0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(g.charAt(++k))]+e["0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(g.charAt(++k))];return"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(10+h%26)+a+b+c},blurCBSportelli:function(a,b,c){this.getCBBanche().getValue()&&this.getCBSportelli().getValue()&&this.getTConto().getValue()&&(a=this.calcola_BBAN(this.getCBBanche().getValue(),this.getCBSportelli().getValue(),this.getTConto().getValue()),
a=a.charAt(0),this.getTCin().setValue(a))},changeCBBanche:function(a,b){b&&Ext.isNumber(b)&&this.getCBSportelli().getStore().load({params:{codAbi:b}})},changeCBCespite:function(a,b){this.getCBCatCespite().setVisible(b);this.getCBCatCespite().allowBlank=!b;this.getCBCatCespite().resetOriginalValue();this.getCBAmmortamentoOrdinario().setVisible(b);this.getCBAmmortamentoOrdinario().allowBlank=!b;this.getCBAmmortamentoOrdinario().resetOriginalValue();this.getCBFondoAmmOrd().setVisible(b);this.getCBFondoAmmOrd().allowBlank=
!b;this.getCBFondoAmmOrd().resetOriginalValue();this.getCBPlusvalenza().setVisible(b);this.getCBMinusvalenza().setVisible(b)},changeCBBanca:function(a,b){this.getTIban().setVisible(b);this.getTCin().setVisible(b);this.getTConto().setVisible(b);this.getCBBanche().setVisible(b);this.getCBSportelli().setVisible(b);this.getTxIbanCompleto().setVisible(b)},changeRFAttivo:function(a,b){},blurTConto:function(a,b,c){a=this.getTConto();b=a.getValue();if(""!=b){for(;12>b.length;)b="0"+b;a.setValue(b)}},verificaCampiForm:function(){var a=
[];this.getFormPianoConti().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){a=this.getFormPianoConti();var b=a.getForm().getFieldValues(),c=[];-9999==this.getIdForm().getValue()&&(b.idPadre=this.idTestata,b.livello=this.livello+1);b.idTipoContoEconomico||(b.idTipoContoEconomico=this.idTipoContoEconomico);var d="";b.sezione?d=b.sezione:b.idPadre&&0!=b.idPadre?d=this.storePianoConti.data.items[0].data.sezione:msgAddError(c,"MSG_CAMPI_OBBLIGATORI");Ext.apply(b,
{idOrganizzazione:this.cbaConfig.idOrganizzazione,idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue(),cespite:getBoolValue(b.cespite),obbligaCda:getBoolValue(b.obbligaCda),banca:getBoolValue(b.banca),nonTotalizzareLivelliSuperiori:getBoolValue(b.nonTotalizzareLivelliSuperiori),livello:b.livello?b.livello:this.livello,sezione:d});this.recordModificato=!0;this.controller_salvaRecord_locale(a,b,"F","F")},controller_salvaRecord_locale:function(a,b,c,d){var e=!1,g,h=this,k=b.id;g=a.store;
var l=a.boxBottoni,m={};g=!k||0>=k?g.getProxy().api.create:g.getProxy().api.update;Ext.Ajax.request({url:g,method:"POST",jsonData:b,params:{forzaRegistrazione:c,eseguiAzioniUlteriori:d},async:!1,success:function(c){c=Ext.JSON.decode(c.responseText);var d=[];"?"==c.message[0].testo[0]?Messaggio("ATTENZIONE",c.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){h.controller_salvaRecord_locale(a,b,"T","T")},function(){h.controller_salvaRecord_locale(a,b,"T","F")}):(c.success?(m=c.data,(!k||0>=
k)&&c.data&&(k=c.data.id),a.controller?a.controller.aggiornaStore(k,c):a.aggiornaStore(k),c.message&&"$"==c.message[0]?(c.message=c.message.substring(1),msgAddWarning(d,c.message)):null==c.data.errori?msgAdd(d,c.message):msgAddWarning(d,c.data.errori)):(c.message&&"$"==c.message[0]&&(c.message=c.message.substring(1)),msgAdd(d,c.message)),msgShow("MSG_SALVATAGGIO_DATI",d),e=c.success)}});!e&&l&&controller_abilitaBottoni(a);return e?m:!1},stampa:function(){var a=this.cbaConfig,b=a.winElaborazione,c=
{};Ext.apply(c,{idOrganizzazione:a.idOrganizzazione,idEsercizio:a.controllerAlbero.getCBAnno().getValue(),reportId:a.idRecord});"string"===typeof b&&(b=b===(!0).toString());Ext.apply(this.parametriStampa,{url:a.url,jsonData:a.jsonData,titolo:a.titolo,winElaborazione:b});a=this.parametriStampa;Ext.apply(a.params,c);this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params))},menuItemStampa:function(){var a;
Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/menuItem/src/byPrj",async:!1,params:{idModulo:CBA.moduli.moduloAttivo,codEnte:CBA.parametriGenerali.codEnte,progetto:"GEN_PianoDeiConti"},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a=b.data[0]:msgShowError("",b.message)}});return a},setVisibleTipoCE:function(a){a=a&&this.isBilancioScalare;this.getCBtipoContoEconomico().setVisible(a).setDisabled(!a)},gestioneForm:function(){var a=this,b=a.getFormPianoConti();b.permesso=a.permesso;
b.boxBottoni=a.getBoxBottoni();a.storeForm=b.store=a.storePianoConti;b.controller=a;a.getIdVisibile().setDisabled(!0);a.getTxDescrizione().setDisabled(!0);a.getTxDescrBilingue().setDisabled(!0);a.getTxCodRaccordo().setDisabled(!0);var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(c){var d=a.cbaConfig.controllerAlbero.getTreeRep().getStore();if(!StdSipcar.isValidID(b.getForm().findField("id").getValue()))var e=trovaRecord(d,"descrizione",a.getTxDescrizione().getValue());
e&&e.get("idPadre")!=a.idTestata?Messaggio("ATTENZIONE","CONTI_STESSA_DESCR","YESNO","QUESTION",!1,function(){a.salvaForm(c);a.cbaConfig.controllerAlbero.aggiornaStore;Ext.isEmpty(a.getFSContiComuneConnessi())||(a.getFSContiComuneConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked),a.getGridContiConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked))},function(){var c=b.getForm().findField("id").getValue();a.recordModificato=!0;a.aggiornaStore(c);a.abilitaBottoniGrid(!0)}):
(a.salvaForm(c),a.cbaConfig.controllerAlbero.aggiornaStore,Ext.isEmpty(a.getFSContiComuneConnessi())||(a.getFSContiComuneConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked),a.getGridContiConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked)))},annulla_callback:function(){var c=b.getForm().findField("id").getValue(),d=a.recordAlbero.get("id");a.recordModificato=!0;0<c?a.aggiornaStore(c):a.aggiornaStore(d);a.abilitaBottoniGrid(!0)},nuovo_callback:function(){var c=0;controller_nuovoRecord(b,
a.getTxDescrizione());"T"==a.bilancioOnlus&&a.getRFIstituzionale().setValue(0);a.cbaConfig.controllerAlbero.getTreeRep().getStore().clearFilter();var c=a.recordAlbero.get("livello"),d=a.getCBtipoContoEconomico();if(a.recordAlbero){var h;h=a.recordAlbero.childNodes[0]?a.recordAlbero.getChildAt(0).get("leaf"):a.foglia;CBA.moduli.modulo53.abilitato&&a.getFSCespite().setVisible(h&&6!=a.recordAlbero.get("sezione"));CBA.moduli.modulo51.abilitato&&(a.getCBObbligaCda().setVisible(h),h&&6==a.recordAlbero.get("sezione")&&
(Sipcar.app.getController("Login").loginApplicativo(51),Ext.Ajax.request({method:"GET",url:"/cba/amm/an/ws/prszn/general/list",params:{idOrganizzazione:a.cbaConfig.idOrganizzazione,idEsercizio:a.cbaConfig.controllerAlbero.getCBAnno().getValue()},success:function(b){b=Ext.JSON.decode(b.responseText);b.success&&b.data&&b.data[0]&&a.getCBObbligaCda().setValue(b.data[0].assocCdaObbligContiEcon);Sipcar.app.getController("Login").logoutApplicativo(51)}})));a.getFSBanca().setVisible(h&&6!=a.recordAlbero.get("sezione"));
a.getFSAttivitaBilancioOnlus().setVisible(h&&"T"==a.bilancioOnlus);a.setVisibleTipoCE(!1);0!=a.recordAlbero.get("id")&&getVerificaContoEconomico(a.recordAlbero.get("id"))&&(a.setVisibleTipoCE(2==c+1||3==c+1),d.getStore().load({params:{idPdcPadre:a.recordAlbero.get("id"),livelloPdc:c+1},callback:function(b,c,d){d&&a.setVisibleTipoCE(!Ext.isEmpty(b))}}))}a.getCNTNonTotLivSup().setVisible(h&&2==c+1&&(1==a.recordAlbero.get("sezione")||2==a.recordAlbero.get("sezione")));a.getFSAttPrimaria().setVisible(!1);
a.getFSCollegaCdaEts().setVisible(!1);a.getFsSezione().setVisible(0==a.recordAlbero.get("id"));a.getCbContoIstituzionale().allowBlank=!0;a.getCbAttivitaConnesse.allowBlank=!0;a.getFSContiComuneConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked);a.getGridContiConnessi().setVisible("T"==a.bilancioOnlus&&a.getRFComune().checked);a.getTxCodRaccordo().setVisible(h);Ext.Ajax.request({method:"GET",params:{idOrganizzazione:a.cbaConfig.idOrganizzazione,idEsercizio:a.cbaConfig.controllerAlbero.getCBAnno().getValue(),
idPadre:a.idTestata},url:"/cba/gen/ws/general/pianoDeiConti/nextIdVisibile",success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.getIdVisibile().setValue(b.data):msgShowError("",b.message)}});Ext.Ajax.request({method:"GET",params:{idOrganizzazione:a.cbaConfig.idOrganizzazione},url:"/cba/gen/ws/general/pianoDeiConti/nextCodRaccordo",success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.getTxCodRaccordo().setValue(b.data):msgShowError("",b.message)}})},elimina_callback:function(){var c=
b.getForm().findField("id").getValue(),d=b.getForm().findField("idPadre").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c},function(){a.recordModificato=!0;a.aggiornaStore(d)})},verificaCampiForm_callback:function(){return a.verificaCampiForm()},esci_callback:function(){if(a.cbaConfig.cespite)return a.cbaConfig.callbackRiapriStore(a.idTestata,!1),a.getFormPianoConti().up("window").close(),!1;a.cbaConfig.callbackRiapriStore&&a.cbaConfig.callbackRiapriStore();a.getFormPianoConti().up("window").close()},
sposta_callback:function(){Ext.create("winCBA",{name:"Generali.pianodeiconti.view.SpostamentoPdc",titolo:traduci("SPOSTAMENTO_CONTI"),altezzaWin:900,larghezzaWin:900,configItem:{controller:a,idOrganizzazione:a.cbaConfig.idOrganizzazione,formFieldValues:b.getForm().getFieldValues(),record:a.storeForm.getAt(0),isBilancioScalare:a.isBilancioScalare,callbackSposta:function(b){a.recordModificato=!0;a.aggiornaStore(b)}},maximizable:!1,closable:!0}).show()}}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnNuovo").up().add({xtype:"button",
itemId:"btnSposta",text:"SPOSTA",iconCls:"icon-switch",margin:"0 0 1 0",cls:"cba-button-25",handler:function(){c.cbaConfig.sposta_callback&&c.cbaConfig.sposta_callback()}});if(!a.cbaConfig.mostraEsci){var d=a.cbaConfig.controlleCntPrincipale,d=d?d.cbaConfig:null;b.boxBottoni.queryById("btnEsci").hide();d=d?!Ext.isEmpty(d.url):!1;43==CBA.moduli.moduloAttivo&&(d=!1);b.boxBottoni.queryById("BtnStampa").setVisible(d);a.configurePrintButton(b.boxBottoni.queryById("BtnStampa"),"preview")}if("L"!=b.permesso)b.getForm().on("dirtychange",
function(c,d){controller_abilitaBottoni(b);d&&validaForm(b);a.cbaConfig.controllerAlbero.getTreeRep().setDisabled(d)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStoreGrigliaAttPrimaria:function(a,b){var c=this,d=c.getGridAttPrimaria();c.storeGrigliaAttPrimaria||(c.storeGrigliaAttPrimaria=d.getStore());Ext.isDefined(b)||(b={},c.cbaConfig.idOrganizzazione&&Ext.apply(b,{idOrganizzazione:c.cbaConfig.idOrganizzazione}),c.cbaConfig.controllerAlbero&&c.cbaConfig.controllerAlbero.getCBAnno().getValue()&&
Ext.apply(b,{idEsercizio:c.cbaConfig.controllerAlbero.getCBAnno().getValue()}),c.idTestata&&Ext.apply(b,{idConto:c.idTestata}));c.storeGrigliaAttPrimaria.load({params:b,callback:function(b,g,h){if(h){if(!Ext.isEmpty(b)){var e;a&&(e=trovaRecord(c.storeGrigliaAttPrimaria,"id",a));d.getSelectionModel().select(e?[e]:0)}}else msgShowError("",g.getError())}})},aggiornaStoreGrigliaCdaEts:function(a,b){var c=this,d=c.getGridEts();c.storeGrigliaCdaEts||(c.storeGrigliaCdaEts=d.getStore());Ext.isDefined(b)||
(b={},c.cbaConfig.controllerAlbero&&c.cbaConfig.controllerAlbero.getCBAnno().getValue()&&Ext.apply(b,{idEsercizio:c.cbaConfig.controllerAlbero.getCBAnno().getValue()}),c.idTestata&&Ext.apply(b,{idConto:c.idTestata}));c.storeGrigliaCdaEts.load({params:b,callback:function(b,g,h){if(h){if(!Ext.isEmpty(b)){var e;a&&(e=trovaRecord(c.storeGrigliaCdaEts,"id",a));d.getSelectionModel().select(e?[e]:0)}}else msgShowError("",g.getError())}})},aggiornaStore:function(a){var b=this,c=b.storePianoConti,d=b.getFormPianoConti();
d.getForm();var e=0;CBA.moduli.modulo51.abilitato&&b.getCBObbligaCda().setVisible(b.foglia&&1<b.livello);b.getIdVisibile().setDisabled(null==b.idTestata);b.getTxDescrizione().setDisabled(null==b.idTestata);b.getTxDescrBilingue().setDisabled(null==b.idTestata);b.getTxCodRaccordo().setDisabled(null==b.idTestata);b.idTipoContoEconomico=0;var g=b.cbaConfig.controllerAlbero.getCBAnno().getValue(),h=b.cbaConfig.controllerAlbero.AnnobilancioScalare;b.isBilancioScalare=!(!h||0>=h);!b.cbaConfig.controllerAlbero.AnnobilancioScalare||
b.cbaConfig.controllerAlbero.AnnobilancioScalare>g||0==b.cbaConfig.controllerAlbero.AnnobilancioScalare?(b.getCBCosti().setVisible(!0),b.getCBRicavi().setVisible(!0),b.getCBContoEco().setVisible(!1)):(b.getCBCosti().setVisible(!1),b.getCBRicavi().setVisible(!1),b.getCBContoEco().setVisible(!0));Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/pianoDeiConti/isAttivoBilancioOnlus",params:{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue()},
success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.bilancioOnlus=a.data:msgShowError("",a.message)}});b.cbaConfig.controlleCntPrincipale.bilancioOnlus=b.bilancioOnlus;b.foglia&&1<b.livello&&b.getFSAttivitaBilancioOnlus().setVisible("T"==b.bilancioOnlus);if(b.editGridAtt)return delete b.editGridAtt,b.aggiornaStoreGrigliaAttPrimaria(a,{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue(),idConto:b.idTestata}),!1;if(b.editGridCdaEts)return delete b.editGridCdaEts,
b.aggiornaStoreGrigliaCdaEts(a,{idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue(),idConto:b.idTestata}),!1;b.recordModificato?(b.recordModificato=!1,b.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!1),b.cbaConfig.controllerAlbero.getTreeRep().getSelectionModel().deselectAll(),b.cbaConfig.controllerAlbero.aggiornaStore(a),b.cbaConfig.cespite&&(b.cbaConfig.callbackRiapriStore(b.idTestata,!0),b.getFormPianoConti().up("window").close())):c.load({params:{id:b.idTestata},callback:function(a,
c,g){g?(clearForm(d),a&&(b.idTipoContoEconomico=a[0].get("idTipoContoEconomico"),0<a[0].get("idPadre")&&(CBA.moduli.modulo53.abilitato&&b.getFSCespite().setVisible(6!=a[0].get("sezione")&&b.foglia),b.getFSBanca().setVisible(6!=a[0].get("sezione")&&b.foglia)),b.getFormPianoConti().loadRecord(a[0]),b.attivitaConto=a[0].get("attivitaConto"),2==b.attivitaConto?(b.getFSContiComuneConnessi().setVisible(!0),b.getGridContiConnessi().setVisible(!0),b.storeGrigliaContiConnessi.load({params:{idContoSorgente:b.idTestata},
callback:function(a,c,d){d&&(Ext.isEmpty(a)?(b.cbaConfig.controlleCntPrincipale.attivitaComuneCompilata=e,b.getGridContiConnessi().isVisible()&&(Messaggio("ATTENZIONE","ASSOCIAZIONE_CONTO_OBBLIGATORIA","OK","WARNING"),IsolaCmp(b.getFSContiComuneConnessi(),!0))):(b.getGridContiConnessi().getSelectionModel().select(0),b.storeGrigliaContiConnessi.each(function(a){e+=a.get("percentuale")}),b.cbaConfig.controlleCntPrincipale.attivitaComuneCompilata=e,100>e?b.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!0):
b.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!1)),b.cbaConfig.cespite&&"T"==a[0].cespite&&(b.cbaConfig.callbackRiapriStore(b.idTestata),b.getFormPianoConti().up("window").close()))}})):(b.getFSContiComuneConnessi().setVisible(!1),b.getGridContiConnessi().setVisible(!1),b.cbaConfig.controllerAlbero.getTreeRep().setDisabled(!1)),b.getFSAttPrimaria().setVisible(b.foglia&&0<a[0].get("idPadre")),b.aggiornaStoreGrigliaAttPrimaria(null,{idOrganizzazione:b.cbaConfig.idOrganizzazione,idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue(),
idConto:b.idTestata}),CBA.moduli.modulo51.abilitato&&(b.getFSCollegaCdaEts().setVisible(b.foglia&&0<a[0].get("idPadre")&&2<a[0].get("sezione")),b.aggiornaStoreGrigliaCdaEts(null,{idEsercizio:b.cbaConfig.controllerAlbero.getCBAnno().getValue(),idConto:b.idTestata})),a[0].get("ammortamentoOrdinario")&&setCombo(b.getCBAmmortamentoOrdinario(),a[0].get("ammortamentoOrdinario"),a[0].get("descrAmmortamentoOrdinario"),{descrizione:a[0].get("descrAmmortamentoOrdinario")}),a[0].get("fondoAmmortamentoOrdinario")&&
setCombo(b.getCBFondoAmmOrd(),a[0].get("fondoAmmortamentoOrdinario"),a[0].get("descrFondoAmmortamentoOrdinario"),{descrizione:a[0].get("descrFondoAmmortamentoOrdinario")}),a[0].get("plusValenza")&&setCombo(b.getCBPlusvalenza(),a[0].get("plusValenza"),a[0].get("descrPlusValenza"),{descrizione:a[0].get("descrPlusValenza")}),a[0].get("minusValenza")&&setCombo(b.getCBMinusvalenza(),a[0].get("minusValenza"),a[0].get("descrMinusValenza"),{descrizione:a[0].get("descrMinusValenza")}),c=b.isImportoBudgetConfermato(b.idTestata,
b.cbaConfig.controllerAlbero.getCBAnno().getValue()),"L"!=b.cbaConfig.permesso&&b.getTxImpBudget().setReadOnly(c),b.getTxCodRaccordo().setVisible(b.foglia&&0<a[0].get("idPadre")))):msgShowError("",c.getError())}})},isImportoBudgetConfermato:function(a,b){var c=this,d=!1,e=!1;CBA.moduli.modulo54.abilitato&&Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/pianoDeiConti/isImportoBudgetConfermato",async:!1,params:{idConto:a,idEsercizio:b},success:function(b){b=Ext.JSON.decode(b.responseText);var g=
b.data;b.success?Ext.isEmpty(g)||(e="T"==StdSipcar.coalesce(g.codice,"F"),d="T"==StdSipcar.coalesce(g.extra,"F"),e&&d&&c.aggiornaStore(a)):msgShowError("",b.message)}});return e},doPrint:function(a,b){this.stampa();this.callParent([a,b])},onLaunch:function(){var a=this;a.storeGrigliaContiConnessi=a.getGridContiConnessi().getStore();a.storePianoConti=Ext.create("Generali.pianodeiconti.store.PianoConti");a.storeAttivitaConnesse=Ext.create("Generali.pianodeiconti.store.cboxAttivitaConnesse");a.storeGrigliaAttPrimaria=
a.getGridAttPrimaria().getStore();a.storeContiIstituzionali=Ext.create("Generali.pianodeiconti.store.cboxContiIstituzionali",{autoLoad:!1,autoDestroy:!1});a.storeComboContiConnessiGriglia=Ext.create("Generali.pianodeiconti.store.cboxContiIstituzionali",{autoLoad:!1,autoDestroy:!1});a.storeSottoconto1=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.storeSottoconto2=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.storeSottoconto3=Ext.create("Generali.pianodeiconti.store.DesSottoconto");
a.storeSottoconto4=Ext.create("Generali.pianodeiconti.store.DesSottoconto");a.getCBAmmortamentoOrdinario().bindStore(a.storeSottoconto1);a.getCBFondoAmmOrd().bindStore(a.storeSottoconto2);a.getCBPlusvalenza().bindStore(a.storeSottoconto3);a.getCBMinusvalenza().bindStore(a.storeSottoconto4);getIdEsercizioDefaultByIdOrg(a.cbaConfig.idOrganizzazione,function(b){a.idEsercizioOriginale=b});a.gestioneForm()},extraParametri:function(a){a.getProxy().extraParams={idOrganizzazione:this.cbaConfig.idOrganizzazione,
idEsercizio:this.cbaConfig.controllerAlbero.getCBAnno().getValue()}},destroy:function(){eliminaStore(this.storePianoConti);eliminaStore(this.storeSottoconto1);eliminaStore(this.storeSottoconto2);eliminaStore(this.storeSottoconto3);eliminaStore(this.storeSottoconto4);eliminaStore(this.storeAttivitaConnesse);eliminaStore(this.storeContiConnessi);eliminaStore(this.storeComboContiConnessiGriglia);eliminaStore(this.storeGrigliaContiConnessi);eliminaStore(this.storeGrigliaAttPrimaria);eliminaStore(this.storeGrigliaCdaEts);
eliminaStore(this.storeForm);this.callParent()}});
Ext.define("Generali.pianodeiconti.controller.PnlPianoConti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CntPrincipale",selector:this.selContainer+"#CntPrincipale"}])},onLaunch:function(){var a=this,b;b={};a.attivitaComuneCompilata;a.flagAttivitaComune;a.bilancioOnlus;0==a.cbaConfig.idOrganizzazione&&(a.cbaConfig.idOrganizzazione=getIdOrg());Ext.apply(b,{idOrganizzazione:a.cbaConfig.idOrganizzazione,
permesso:a.cbaConfig.permesso,verificaOnlus:function(){(a.flagAttivitaComune="T",a.attivitaComuneCompilata)&&a.chiudiFormPdc()}});a.cbaConfig.cespite&&Ext.apply(b,{idEsercizio:a.cbaConfig.idEsercizio,permesso:a.cbaConfig.permesso,cespite:!0});b=Ext.create("Generali.pianodeiconti.view.AlberoConti",{cbaConfig:b});a.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:b});var c={controllerAlbero:b.down("#TreeRep").controller,permesso:a.cbaConfig.permesso,controlleCntPrincipale:a};Ext.apply(c,
a.cbaConfig);a.getCntPrincipale().add({xtype:"panel",layout:"fit",flex:1,items:Ext.create("Generali.pianodeiconti.view.PianoConti",{cbaConfig:c})});a.controllerAlbero=b.down("#TreeRep").controller;Sipcar.app.getController("Menu").getCardApplicativo().down("#dettab"+CBA.moduli.moduloAttivo).down("tabpanel").getActiveTab().cbaConfig.puoiChiudere=function(){return a.chiudiFormPdc()};!a.cbaConfig.chiamataEsterna&&a.cbaConfig.currentTab&&(a.cbaConfig.currentTab.cbaConfig.puoiChiudere=function(){return a.chiudiFormPdc()})},
chiudiFormPdc:function(){if(this.isDestroyed)return!0;var a=!0,b=0;"T"!=this.bilancioOnlus||isNaN(this.attivitaComuneCompilata)||(this.attivitaComuneCompilata=arrotonda(this.attivitaComuneCompilata,2),100>this.attivitaComuneCompilata&&(this.flagAttivitaComune="T")?(Messaggio("ATTENZIONE","SOMMA_PERCENTUALE_INFERIORE_100","OK","WARNING"),this.controllerAlbero.getTreeRep().setDisabled(!0),a=!1):this.controllerAlbero.getTreeRep()&&this.controllerAlbero.getTreeRep().setDisabled(!1));var c=this.getCntPrincipale(),
d=c.down("#GridAttPrimaria");c.down("#FormPianoConti").getRecord();d&&!d.isHidden()&&(c=d.getStore(),0<c.getCount()&&(c.each(function(a){b+=a.get("percentuale")}),b=arrotonda(b,2),100>b?(Messaggio("ATTENZIONE","SOMMA_PERCENTUALE_INFERIORE_100","OK","WARNING"),this.controllerAlbero.getTreeRep().setDisabled(!0),a=!1):this.controllerAlbero.getTreeRep()&&this.controllerAlbero.getTreeRep().setDisabled(!1)));return a}});
Ext.define("Generali.pianodeiconti.controller.SpostamentoPdc",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"TreeRep",selector:a+"#TreeRep"},{ref:"Form",selector:a+"#Form"},{ref:"BoxBottoni",selector:a+"#BoxBottoni"},{ref:"CBTipoContoEconomico",selector:a+"#CBTipoContoEconomico"},{ref:"Ricerca",selector:a+"#Ricerca"},{ref:"LblSelettore",selector:a+"#LblSelettore"}]);this.control(a+"#TreeRep",{select:this.selectTreeRep});
this.control(a+"#Ricerca",{change:Ext.Function.createBuffered(this.cercaTree,500,this)})},cercaTree:function(a){var b=this.getTreeRep(),c=b.getStore(),d=[];this.getLblSelettore().setVisible(!1);c.clearFilter();Ext.isEmpty(a.getValue())?(c.each(function(a){a.set("cls","")}),b.getSelectionModel().hasSelection()?b.ensureVisible(b.getSelectionModel().getSelection()[0]):b.getSelectionModel().select(0)):(c.each(function(b){if(b.isLeaf()){var c=!1,e=b.get("text");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&
(c=!0);c?(b.set("cls","cba-dirty-record"),d.push(b)):b.set("cls","")}}),this.filtraTree(c,d),this.getLblSelettore().setVisible(1<d.length),Ext.isEmpty(d)?b.getSelectionModel().select(0):(b.ensureVisible(d[0]),this.getLblSelettore().setText(traduci("NUM_ELEMENTI_TROVATI",[d.length]))));a.focus()},filtraTree:function(a,b){a.filter(function(a){for(var c=!1,e=0,g=b.length;e<g;e++)if(a.contains(b[e])){c=!0;break}else if(a.isLeaf()&&(c=a===b[e]))break;return c})},updatePosizione:function(a,b,c){b=void 0===
b?"F":b;c=void 0===c?"F":c;var d=this,e=!1,g=null;for(key in a)StdSipcar.isValidID(a[key])||delete a[key];Ext.apply(a,{forzaRegistrazione:b,eseguiAzioniUlteriori:c});Ext.Ajax.request({url:"/cba/gen/ws/general/pianoDeiConti/updatePosizione",method:"POST",params:a,timeout:36E5,async:!1,success:function(b){b=Ext.JSON.decode(b.responseText);var c=[];"?"==b.message[0].testo[0]?Messaggio("ATTENZIONE",b.message[0].testo.slice(1),"YESNO","QUESTION",!1,function(){d.updatePosizione(a,"T","T")},function(){d.updatePosizione(a,
"T","F")}):(b.success?(g=b.data,b.message&&"$"==b.message[0]?(b.message=b.message.substring(1),msgAddWarning(c,b.message)):null==b.data.errori?msgAdd(c,b.message):msgAddWarning(c,b.data.errori)):(b.message&&"$"==b.message[0]&&(b.message=b.message.substring(1)),msgAdd(c,b.message)),msgShow("MSG_SALVATAGGIO_DATI",c),e=b.success)}});e||controller_abilitaBottoni(d.getForm());return e?g:!1},salvaForm:function(a){a=this.getForm();var b=a.getForm().getFieldValues(),c={};Ext.apply(c,{id:b.id,idPadre:b.idPadre,
idVisibile:b.idVisibile,sezione:b.sezione,idTipoContoEconomico:b.idTipoContoEconomico,livello:this.livello+1});if(b=this.updatePosizione(c,"F","F"))this.cbaConfig.callbackSposta&&this.cbaConfig.callbackSposta(b.id),a.up("window").close()},loadContiEconomici:function(a){var b=this;return new Promise(function(c,d){var e=b.getCBTipoContoEconomico(),g=StdSipcar.coalesce(a.get("livello"),0)+1;b.checkLivelloCE(g)&&getVerificaContoEconomico(a.get("id"))&&e.getStore().load({params:{idPdcPadre:a.get("id"),
livelloPdc:g},callback:function(a,c,d){d&&b.setVisibleTipoCE(!Ext.isEmpty(a))}})})},checkLivelloCE:function(a){var b=!1;StdSipcar.isValidID(a)&&(b=2==a||3==a);return b},setVisibleTipoCE:function(a){var b=this.cbaConfig;a=a&&b.isBilancioScalare;this.getCBTipoContoEconomico().setVisible(a).setDisabled(!a)},setValuesForm:function(a){var b=this.getForm().getForm();for(key in a)b.findField(key).setValue(a[key])},selectTreeRep:function(a,b){var c=this;delete c.livello;c.setVisibleTipoCE(!1);if(!StdSipcar.isValidID(b.get("id")))return c.resetForm(),
!1;c.getForm().getForm();c.getNextIdVisibile(b.getData()).then(function(a){c.setValuesForm({idVisibile:a,idPadre:b.get("id"),sezione:b.get("sezione")});c.livello=b.get("livello");return c.loadContiEconomici(b)})},getNextIdVisibile:function(a){return(new Promise(function(b,c){var d={};StdSipcar.isValidID(a.idOrganizzazione)&&Ext.apply(d,{idOrganizzazione:a.idOrganizzazione});StdSipcar.isValidID(a.idEsercizio)&&Ext.apply(d,{idEsercizio:a.idEsercizio});StdSipcar.isValidID(a.id)&&Ext.apply(d,{idPadre:a.id});
Ext.Ajax.request({method:"GET",params:d,url:"/cba/gen/ws/general/pianoDeiConti/nextIdVisibile",success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b(a.data):c(a.message)}})}))["catch"](function(a){return msgShowError("",a)})},loadAlberoConti:function(a){var b=this;return(new Promise(function(c,d){var e=b.getTreeRep(),g=e.getStore(),h=a?a.getData():{},k={};StdSipcar.isValidID(h.id)&&Ext.apply(k,{idPdcDaSpostare:h.id});g.load({params:k,callback:function(a,b,g){g?(e.expandAll(),c()):d(b.getError())}})}))["catch"](function(a){return msgShowError("",
a)})},aggiornaStore:function(){this.getForm().up("window").close()},resetForm:function(){var a=this.cbaConfig.record,b=this.getForm(),c=this.getTreeRep().getSelectionModel();b.loadRecord(a);c.deselectAll()},gestioneForm:function(){var a=this,b=a.getForm();b.permesso=a.cbaConfig.permesso;b.boxBottoni=a.getBoxBottoni();b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoni",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.resetForm()},esci_callback:function(){b.up("window").close()},
verificaCampiForm_callback:function(){return!0}}});inserisciBottoni(b.boxBottoni,c,!0);b.boxBottoni.queryById("btnNuovo").hide();b.boxBottoni.queryById("btnElimina").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(a,c){controller_abilitaBottoni(b)})},onLaunch:function(){var a=this,b=a.cbaConfig.record;a.gestioneForm();b?a.loadAlberoConti(b).then(function(c){a.getForm().loadRecord(b)}):msgShowError("",traduci("NESSUNA_SELEZIONE"))},destroy:function(){this.callParent()}});
Ext.define("Generali.pianodeiconti.model.AlberoConti",{extend:"Ext.data.Model",fields:[{name:"id"},{name:"idPadre"},{name:"idOrganizzazione"},{name:"idVisibile"},{name:"livello"},{name:"numRiga"},{name:"text",convert:function(a,b){var c=b.get("descrizione");b.get("idVisibile")&&(c=b.get("idVisibile")+" . "+b.get("descrizione"));return c}},{name:"expanded"},{name:"leaf"},{name:"iconCls"},{name:"children"}]});
Ext.define("Generali.pianodeiconti.store.AlberoConti",{extend:"Ext.data.TreeStore",model:"Generali.pianodeiconti.model.AlberoConti",autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"},api:{read:"/cba/gen/ws/general/pianoDeiConti/tree",create:"/cba/gen/ws/general/pianoDeiConti/insert",update:"/cba/gen/ws/general/pianoDeiConti/update",destroy:"/cba/gen/ws/general/pianoDeiConti/deleteRicorsivo"}},
autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.AlberoSpostamento",{extend:"Ext.data.TreeStore",model:"Generali.pianodeiconti.model.AlberoConti",root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/spostamento/tree",reader:{type:"json",messageProperty:"message",rootProperty:"children"},api:{read:"/cba/gen/ws/general/pianoDeiConti/spostamento/tree",create:"/cba/gen/ws/general/pianoDeiConti/insert",update:"/cba/gen/ws/general/pianoDeiConti/update",destroy:"/cba/gen/ws/general/pianoDeiConti/deleteRicorsivo"}},autoLoad:!1,
autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.AttribuzionePrimaria",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"idEsercizio"},{name:"idConto"},{name:"cda"},{name:"percentuale"},{name:"desCda"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/attribuzPrimaria/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/attribuzPrimaria/list",create:"/cba/gen/ws/general/attribuzPrimaria/insert",update:"/cba/gen/ws/general/attribuzPrimaria/update",destroy:"/cba/gen/ws/general/attribuzPrimaria/delete"}},
autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.CollegaCdaEts",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idEsercizio"},{name:"idPdc"},{name:"idCda"},{name:"cda"},{name:"descrCda"},{name:"idAbbinamento"},{name:"descrAbbinamento"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/abbinaPdcEts/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/pianoDeiConti/abbinaPdcEts/list",create:"/cba/gen/ws/general/pianoDeiConti/abbinaPdcEts/insert",update:"/cba/gen/ws/general/pianoDeiConti/abbinaPdcEts/update",
destroy:"/cba/gen/ws/general/pianoDeiConti/abbinaPdcEts/delete"}},autoDestroy:!0});Ext.define("Generali.pianodeiconti.store.DesSottoconto",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"descrizione",convert:function(a,b){b.get("extra")&&(a=b.get("extra").split(",")[4]);return a}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/leaf/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.PianoConti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"idPadre"},{name:"idVisibile"},{name:"idEsercizio"},{name:"descrizione"},{name:"descrBilingue"},{name:"obbligaCda"},{name:"cespite"},{name:"idCategoriaCespite"},{name:"ammortamentoOrdinario"},{name:"fondoAmmortamentoOrdinario"},{name:"plusValenza"},{name:"minusValenza"},{name:"importoBudget"},{name:"sezione"},{name:"idTipoContoEconomico"},{name:"banca"},{name:"iban"},{name:"attivitaConto"},
{name:"idAttivitaConnessa"},{name:"idContoIstituzionale"},{name:"nonTotalizzareLivelliSuperiori"},{name:"cin"},{name:"abi"},{name:"cab"},{name:"cc"},{name:"clcIbanCompleto",convert:function(a,b){var c=b.get("iban"),d=b.get("cin"),e=b.get("abi"),g=b.get("cab"),h=b.get("cc");1E4>e&&(e="0"+e);1E4>g&&(g="0"+g);if(""!=c&&""!=d&&""!=e&&""!=g&&c)for(;4>c.length;)c=" "+c;else return"";if(d)for(;1>d.length;)d=" "+d;else return"";if(h)for(;12>h.length;)h=" "+h;else return"";return c+d+e+g+h}},{name:"codiceRaccordo"}],
proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/pianoDeiConti/get",create:"/cba/gen/ws/general/pianoDeiConti/insert",update:"/cba/gen/ws/general/pianoDeiConti/update",destroy:"/cba/gen/ws/general/pianoDeiConti/deleteRicorsivo"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.PianoContiAttiviaConnesse",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idContoSorgente"},{name:"idContoConnesso"},{name:"percentuale"},{name:"desContoConnesso"}],proxy:{type:"ajax",url:"cba/gen/ws/general/pianoDeiConti/contiConnessi/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/pianoDeiConti/contiConnessi/list",create:"/cba/gen/ws/general/pianoDeiConti/contiConnessi/insert",update:"/cba/gen/ws/general/pianoDeiConti/contiConnessi/update",
destroy:"/cba/gen/ws/general/pianoDeiConti/contiConnessi/delete"}},autoDestroy:!0});Ext.define("Generali.pianodeiconti.store.cboxAttivitaConnesse",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/attivitaCommerciale/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.cboxContiIstituzionali",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/leaf/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.cboxPianoConti",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.store.cboxTipoContoEconomico",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/pianoDeiConti/tipoContoEconomico/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.pianodeiconti.view.AlberoConti",{extend:"Generali.standard.ControlledContainer",layout:{type:"vbox",align:"stretch"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"treepanel",header:{title:{hidden:!0},layout:{pack:"center"},padding:6,items:[{xtype:"combobox",fieldLabel:traduci("ESERCIZIO"),labelClsExtra:"cbaLabel",editable:!1,labelWidth:60,itemId:"CBAnno",reference:"CBAnno",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont")}]},
plugins:[{ptype:"bufferedrenderer"}],viewConfig:{loadMask:!1,getRowClass:function(a,c,d,e){return a.get("cls")}},width:500,flex:1,itemId:"TreeRep",reference:"TreeRep",store:Ext.create("Generali.pianodeiconti.store.AlberoConti"),useArrows:!0,rootVisible:!1,columns:[{xtype:"treecolumn",dataIndex:"text",text:"PIANO_DEI_CONTI",flex:1,editor:{xtype:"textfield",allowBlank:!1},renderer:function(b,c,d){a.controller.isPianoDeiContiBilingue&&(b+=Ext.isEmpty(d.get("descrBilingue"))?"":" / "+d.get("descrBilingue"));
return b}}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",hidden:!0},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",hidden:!0},{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",hidden:!0},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",hidden:!0},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:300,fieldLabel:"",emptyText:"CERCA"}]},{xtype:"label",border:0,dock:"top",hidden:!0,itemId:"LblSelettore",
reference:"LblSelettore"}]}]});a.callParent(arguments)}});
Ext.define("Generali.pianodeiconti.view.PianoConti",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"panel",flex:1,layout:{align:"stretch",type:"hbox"},items:[{xtype:"form",flex:1,itemId:"FormPianoConti",reference:"FormPianoConti",autoScroll:!0,layout:{type:"vbox"},defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},bodyPadding:5,trackResetOnLoad:!0,items:[{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",
margin:"0 0 5 0"},{xtype:"textfield",fieldLabel:"ID",name:"id",itemId:"IdForm",reference:"IdForm",hidden:!0},{xtype:"textfield",name:"idOrganizzazione",hidden:!0},{xtype:"textfield",name:"idEsercizio",hidden:!0},{xtype:"textfield",name:"idPadre",hidden:!0},{xtype:"textfield",name:"idVisibile",itemId:"IdVisibile",reference:"IdVisibile",fieldLabel:"CODICE_CONTO",width:150,labelWidth:100,allowBlank:!1,maxLength:4,enforceMaxLength:!0,maskRe:/[0-9.]/},{xtype:"textfield",fieldLabel:"DESCRIZIONE",itemId:"TxDescrizione",
reference:"TxDescrizione",name:"descrizione",width:600,labelWidth:100,allowBlank:!1,maxLength:100,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"DESCR_BILINGUE",itemId:"TxDescrBilingue",reference:"TxDescrBilingue",name:"descrBilingue",width:600,labelWidth:100,maxLength:100,enforceMaxLength:!0},{xtype:"container",itemId:"CNTNonTotLivSup",reference:"CNTNonTotLivSup",layout:"hbox",flex:1,maxWidth:400,hidden:!0,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"checkboxfield",itemId:"CBNonTotLivSup",
reference:"CBNonTotLivSup",fieldLabel:"",boxLabel:"NON_TOTALIZZA_LIVSUP",inputValue:"T",uncheckedValue:"F",name:"nonTotalizzareLivelliSuperiori"},{xtype:"label",width:22,height:22,cls:"icon-info",margin:"0 0 0 5",listeners:{afterrender:function(){this.getEl().dom.setAttribute("data-qtip",traduci("INFO_NON_TOTALIZZA_LIVSUP"))}}}]},{xtype:"combobox",width:400,fieldLabel:"TIPO_CONTO_ECONOMICO",labelWidth:100,itemId:"CBtipoContoEconomico",reference:"CBtipoContoEconomico",name:"idTipoContoEconomico",displayField:"valore",
queryMode:"local",valueField:"codice",store:Ext.create("Generali.pianodeiconti.store.cboxTipoContoEconomico")},{xtype:"fieldset",title:"CESPITE",itemId:"FSCespite",reference:"FSCespite",hidden:!0,width:600,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"checkboxfield",itemId:"CBCespite",reference:"CBCespite",fieldLabel:"",boxLabel:"CESPITE",inputValue:"T",uncheckedValue:"F",name:"cespite"},{xtype:"combobox",margin:"5 0 5 0",width:580,fieldLabel:"CATEGORIA",labelWidth:125,itemId:"CBCatCespite",
reference:"CBCatCespite",name:"idCategoriaCespite",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.categoriecespiti.store.cboxCategoCespiti",{autoLoad:!0})},{xtype:"combobox",width:580,fieldLabel:"AMMORTAMENTO",labelWidth:125,itemId:"CBAmmortamentoOrdinario",reference:"CBAmmortamentoOrdinario",name:"ammortamentoOrdinario",displayField:"valore",queryParam:"descrizione",valueField:"codice",minChars:3},{xtype:"combobox",width:580,fieldLabel:"FONDO_AMM_TO",labelWidth:125,
itemId:"CBFondoAmmOrd",reference:"CBFondoAmmOrd",name:"fondoAmmortamentoOrdinario",displayField:"valore",queryParam:"descrizione",valueField:"codice",minChars:3},{xtype:"combobox",width:580,fieldLabel:"PLUSVALENZA",labelWidth:125,itemId:"CBPlusvalenza",reference:"CBPlusvalenza",name:"plusValenza",displayField:"valore",queryParam:"descrizione",valueField:"codice",minChars:3},{xtype:"combobox",margin:"5 0 5 0",width:580,fieldLabel:"MINUSVALENZA",labelWidth:125,itemId:"CBMinusvalenza",reference:"CBMinusvalenza",
name:"minusValenza",displayField:"valore",queryParam:"descrizione",valueField:"codice",minChars:3}]},{xtype:"checkboxfield",itemId:"CBObbligaCda",reference:"CBObbligaCda",width:380,fieldLabel:"",hidden:!0,boxLabel:"ASSOCIAZIONE_CDA_OBBLIGATORIA",inputValue:"T",uncheckedValue:"F",name:"obbligaCda"},{xtype:"fieldset",title:"BANCA",itemId:"FSBanca",reference:"FSBanca",width:600,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"BANCA",inputValue:"T",
uncheckedValue:"F",name:"banca",itemId:"CBBanca",reference:"CBBanca"},{xtype:"textfield",fieldLabel:"IBAN",name:"iban",labelWidth:125,width:200,itemId:"TIban",reference:"TIban",maxLength:4,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"CIN",name:"cin",labelWidth:125,width:200,itemId:"TCin",reference:"TCin",maxLength:1,enforceMaxLength:!0},{xtype:"textfield",fieldLabel:"CONTO",name:"cc",labelWidth:125,width:250,itemId:"TConto",reference:"TConto",maxLength:12,enforceMaxLength:!0},{xtype:"combobox",
enableRegEx:!0,width:580,fieldLabel:"BANCA",labelWidth:125,itemId:"CBBanche",reference:"CBBanche",name:"abi",displayField:"valore",queryMode:"local",valueField:"codice",minChars:3,store:Ext.create("Generali.banche.store.cboxBanche",{autoLoad:!0})},{xtype:"combobox",width:580,labelWidth:125,fieldLabel:"SPORTELLO",itemId:"CBSportelli",reference:"CBSportelli",name:"cab",displayField:"valore",queryMode:"local",valueField:"codice",minChars:3,store:Ext.create("Generali.banche.store.cboxSportelli")},{xtype:"textfield",
fieldLabel:"IBAN_COMPLETO",width:400,labelWidth:125,itemId:"TxIbanCompleto",reference:"TxIbanCompleto",name:"clcIbanCompleto",disabled:!0}]},{xtype:"numberfield",fieldLabel:"IMPORTO_BUDGET",name:"importoBudget",itemId:"TxImpBudget",reference:"TxImpBudget",labelWidth:100,width:250},{xtype:"fieldset",title:"ATTIVITA",width:600,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},itemId:"FSAttivitaBilancioOnlus",reference:"FSAttivitaBilancioOnlus",items:[{xtype:"radiogroup",flex:1,layout:{align:"stretchmax",
type:"vbox"},items:[{xtype:"container",flex:1,defaults:{margin:"10 10 0 0"},layout:{type:"hbox"},items:[{xtype:"radiofield",name:"attivitaConto",boxLabel:"ISTITUZIONALE",labelWidth:125,inputValue:"0",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},itemId:"RFIstituzionale",reference:"RFIstituzionale"}]},{xtype:"container",flex:1,defaults:{margin:"10 10 0 0"},layout:{type:"hbox"},items:[{xtype:"radiofield",name:"attivitaConto",width:110,boxLabel:"CONNESSO",labelWidth:125,inputValue:"1",itemId:"RFConnesso",
reference:"RFConnesso"},{xtype:"combobox",width:450,hidden:!0,name:"idAttivitaConnessa",labelClsExtra:"cbaLabel",labelWidth:60,itemId:"CbAttivitaConnesse",reference:"CbAttivitaConnesse",displayField:"valore",queryParam:"valore",queryMode:"local",valueField:"codice"}]},{xtype:"container",defaults:{margin:"10 10 0 0"},layout:{type:"hbox"},items:[{xtype:"radiofield",name:"attivitaConto",boxLabel:"COMUNE",width:110,inputValue:"2",itemId:"RFComune",reference:"RFComune"},{xtype:"combobox",width:450,hidden:!0,
labelClsExtra:"cbaLabel",labelWidth:60,itemId:"CbContoIstituzionale",reference:"CbContoIstituzionale",name:"idContoIstituzionale",displayField:"valore",minChars:3,queryParam:"valore",queryMode:"local",valueField:"codice"}]}]},{xtype:"fieldset",title:"CONTI_CONNESSI",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},border:0,hidden:!0,height:200,itemId:"FSContiComuneConnessi",reference:"FSContiComuneConnessi",items:[{xtype:"gridpanel",itemId:"GridContiConnessi",reference:"GridContiConnessi",hidden:!0,
height:180,store:Ext.create("Generali.pianodeiconti.store.PianoContiAttiviaConnesse"),features:[{ftype:"summary",dock:"bottom"}],columns:[{xtype:"gridcolumn",text:"CONTO",flex:1,dataIndex:"idContoConnesso",itemId:"CBContoConnesso",reference:"CBContoConnesso",editor:{xtype:"combobox",labelClsExtra:"cbaLabel",name:"idContoConnesso",displayField:"valore",queryMode:"local",valueField:"codice",allowBlank:!1},renderer:function(a,c,d,e,g,h,k){return d.get("desContoConnesso")}},{xtype:"gridcolumn",text:"PERCENTUALE",
itemId:"ColPercentualeConto",reference:"ColPercentualeConto",align:"center",renderer:cell_renderer_importo,width:105,dataIndex:"percentuale",summaryType:"sum",summaryRenderer:function(a,c,d){return'Totale %: <span style="font-weight:bold;">'+Ext.String.format("{0}",formatFloat(a))+"</span>"},editor:{xtype:"numberfield",allowBlank:!1},renderer:function(a,c,d,e,g,h,k){c.style="text-align:right !important";return formatFloat(a)}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",
{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoContoConnesso",reference:"BtnNuovoContoConnesso",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaContoConnesso",reference:"BtnEliminaContoConnesso",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]}]},{xtype:"fieldset",title:"SEZIONE",itemId:"FsSezione",reference:"FsSezione",defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},items:[{xtype:"radiogroup",
width:370,layout:{align:"stretchmax",type:"vbox"},items:[{xtype:"radiofield",name:"sezione",boxLabel:"ATTIVO",inputValue:"1",itemId:"RFAttivo",reference:"RFAttivo"},{xtype:"radiofield",name:"sezione",boxLabel:"PASSIVO",inputValue:"2"},{xtype:"radiofield",itemId:"CBRicavi",reference:"CBRicavi",name:"sezione",boxLabel:"PROFITTI",inputValue:"3"},{xtype:"radiofield",itemId:"CBCosti",reference:"CBCosti",name:"sezione",boxLabel:"PERDITE",inputValue:"4"},{xtype:"radiofield",itemId:"CBContoEco",reference:"CBContoEco",
name:"sezione",boxLabel:"CONTO_ECONOMICO",inputValue:"6"},{xtype:"radiofield",itemId:"CBContoOrd",reference:"CBContoOrd",name:"sezione",boxLabel:"CONTO_ORDINE",inputValue:"5"}]}]},{xtype:"fieldset",title:"ATTRIBUZIONE_PRIMARIA",hidden:!0,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},width:600,height:200,itemId:"FSAttPrimaria",reference:"FSAttPrimaria",items:[{xtype:"gridpanel",itemId:"GridAttPrimaria",reference:"GridAttPrimaria",height:180,store:Ext.create("Generali.pianodeiconti.store.AttribuzionePrimaria"),
features:[{ftype:"summary",dock:"bottom"}],columns:[{xtype:"numbercolumn",hidden:!0,dataIndex:"id"},{xtype:"gridcolumn",dataIndex:"cda",hidden:!0,editor:{xtype:"textfield"}},{xtype:"gridcolumn",text:"CENTRO_ATTIVITA",flex:1,dataIndex:"desCda",editor:{xtype:"cdaGrid",cbaConfig:{tipoContabilita:4},allowBlank:!1,listeners:{focus:function(b){var c=null;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/esercizioCont/idEsercizioByOrganization",async:!1,params:{idEsercizio:a.controller.getIdEsercizioPdc(),
idOrganizzazione:a.cbaConfig.idOrganizzazione},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?c=a.data:(c=null,msgShowError("",a.message))}});null!=c&&Ext.apply(b.cbaConfig,{idOrganizzazione:a.cbaConfig.idOrganizzazione,idEsercizio:c});b.focus()}}}},{xtype:"gridcolumn",text:"PERCENTUALE",itemId:"ColPercAttPrimaria",reference:"ColPercAttPrimaria",width:90,dataIndex:"percentuale",align:"right",summaryType:"sum",summaryRenderer:function(a){return'Totale: <span style="font-weight:bold;">'+
Ext.String.format("{0}",formatFloat(a))+"</span>"},editor:{xtype:"numberfield",allowBlank:!1},renderer:function(a,c,d,e,g,h,k){c.style="text-align:right !important";return formatFloat(a)}},{xtype:"numbercolumn",hidden:!0,dataIndex:"idEsercizio"}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoAttPrimaria",reference:"BtnNuovoAttPrimaria",iconCls:"icon-inserisciGriglia",
text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaAttPrimaria",reference:"BtnEliminaAttPrimaria",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]},,{xtype:"fieldset",title:"GESTIONE_ETS",hidden:!0,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},width:600,height:200,itemId:"FSCollegaCdaEts",reference:"FSCollegaCdaEts",items:[{xtype:"gridpanel",itemId:"GridEts",reference:"GridEts",height:180,store:Ext.create("Generali.pianodeiconti.store.CollegaCdaEts"),features:[{ftype:"summary",dock:"bottom"}],
columns:[{xtype:"numbercolumn",hidden:!0,dataIndex:"id"},{xtype:"gridcolumn",dataIndex:"cda",hidden:!0,editor:{xtype:"textfield"}},{xtype:"gridcolumn",text:"CENTRO_ATTIVITA",flex:1,dataIndex:"descrCda",editor:{xtype:"cdaGrid",cbaConfig:{tipoContabilita:4,bottoneCdaFinali:!0},allowBlank:!1,listeners:{focus:function(b){Ext.apply(b.cbaConfig,{idOrganizzazione:a.cbaConfig.idOrganizzazione,idEsercizio:a.controller.getIdEsercizioPdc()});b.focus()}}}},{xtype:"gridcolumn",dataIndex:"idAbbinamento",hidden:!0,
editor:{xtype:"textfield"}},{xtype:"gridcolumn",text:"DESCRIZIONE",itemId:"ColEts",reference:"ColEts",dataIndex:"descrAbbinamento",width:210,sortable:!1,editor:{xtype:"textfield",maxLength:200,enforceMaxLength:!0,editable:!1,listeners:{render:function(b){b.getEl().on("click",function(b,d,e){a.controller.focusEts()})}}}},{xtype:"numbercolumn",hidden:!0,dataIndex:"idEsercizio"}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",
dock:"top",items:[{xtype:"button",itemId:"BtnNuovoCdaEts",reference:"BtnNuovoCdaEts",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaCdaEts",reference:"BtnEliminaCdaEts",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]},{xtype:"textfield",fieldLabel:"COD_RACCORDO",name:"codiceRaccordo",labelWidth:100,width:250,itemId:"txCodRaccordo",reference:"txCodRaccordo",maxLength:11,enforceMaxLength:!0}]}]}]});a.callParent(arguments)}});
Ext.define("Generali.pianodeiconti.view.PnlPianoConti",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"CntPrincipale",reference:"CntPrincipale",layout:{align:"stretch",type:"hbox"}}]});this.callParent(arguments)}});
Ext.define("Generali.pianodeiconti.view.SpostamentoPdc",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",itemId:"TreeRep",reference:"TreeRep",flex:1,maxWidth:500,store:Ext.create("Generali.pianodeiconti.store.AlberoSpostamento"),plugins:[{ptype:"bufferedrenderer"}],viewConfig:{loadMask:!1,getRowClass:function(a,b,c,d){return a.get("cls")}},useArrows:!0,rootVisible:!1,columns:[{xtype:"treecolumn",
dataIndex:"text",text:"PIANO_DEI_CONTI",flex:1,editor:{xtype:"textfield",allowBlank:!1}}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"textfield",itemId:"Ricerca",reference:"Ricerca",width:300,fieldLabel:"",emptyText:"CERCA"}]},{xtype:"label",itemId:"LblSelettore",reference:"LblSelettore",border:0,dock:"top",hidden:!0}]},{xtype:"form",itemId:"Form",reference:"Form",flex:1,defaults:{cls:"cbaLabel",labelClsExtra:"cbaLabel"},bodyPadding:5,trackResetOnLoad:!0,items:[{xtype:"container",itemId:"BoxBottoni",
reference:"BoxBottoni",margin:"0 0 5 0"},{xtype:"textfield",fieldLabel:"ID",name:"id",hidden:!0},{xtype:"textfield",name:"idPadre",hidden:!0},{xtype:"textfield",name:"sezione",hidden:!0},{xtype:"textfield",name:"idVisibile",itemId:"IdVisibile",reference:"IdVisibile",fieldLabel:"CODICE_CONTO",width:150,labelWidth:100,allowBlank:!1,maxLength:4,enforceMaxLength:!0,maskRe:/[0-9.]/},{xtype:"textfield",fieldLabel:"DESCRIZIONE",name:"descrizione",readOnly:!0},{xtype:"combobox",fieldLabel:"TIPO_CONTO_ECONOMICO",
itemId:"CBTipoContoEconomico",reference:"CBTipoContoEconomico",name:"idTipoContoEconomico",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.pianodeiconti.store.cboxTipoContoEconomico"),hidden:!0}]}]});this.callParent(arguments)}});
Ext.define("Generali.portletController.controller.SalvaPortlet",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"LayoutFas",selector:a+"#LayoutFas"},{ref:"RgLayout",selector:a+"#RgLayout"},{ref:"Colonna1",selector:a+"#Colonna1"},{ref:"Colonna2",selector:a+"#Colonna2"},{ref:"Colonna3",selector:a+"#Colonna3"},{ref:"BtnSalva",selector:a+"#BtnSalva"}]);this.control(a+"#LayoutFas",{beforerender:this.beforeRenderLayoutFas,
afterrender:this.afterRenderLayoutFas});this.control(a+"#RgLayout",{change:this.changeRgLayout});this.control(a+"#BtnSalva",{click:this.clickBtnSalva})},clickBtnSalva:function(a){for(var b=this,c=[],d,e,g=0;g<b.regionPortlet.items.getCount();g++)if(a=b.regionPortlet.items.items[g],0<a.items.getCount())for(var h=e=0;h<a.items.getCount();h++)e++,d=a.items.items[h],c.push({id:d.cbaConfig.idUserPrefs,codUtente:CBA.parametriGenerali.codUtente,colonna:g+1,ordine:e,codVideata:d.cbaConfig.codVideata});Ext.Ajax.request({method:"POST",
url:"/cba/gen/auth/prefs/save",jsonData:Ext.JSON.encode(c),params:{programId:b.controllerWebPortal.cbaConfig.idModulo},success:function(a){a=Ext.JSON.decode(a.responseText);var c="",d=[];a.success?(Ext.each(a.data,function(a){var c=b.regionPortlet.down("#Portlet_"+a.codVideata);c.cbaConfig&&(c.cbaConfig.idUserPrefs=a.id)}),c="MSG_SALVATAGGIO_DATI",msgAdd(d,a.message)):msgAddError(d,a.message);msgShow(c,d)}})},beforeRenderLayoutFas:function(){this.regionPortlet=this.controllerWebPortal.getContainerPortlet();
this.getRgLayout().setValue({numCol:this.regionPortlet.items.getCount()})},afterRenderLayoutFas:function(){this.getColonna1().bodyEl.insertHtml("afterEnd",'<div class="icon-1colonna" style="height:32px; width: 32px; margin: 0px 0px 5px 10px;"></div>');this.getColonna2().bodyEl.insertHtml("afterEnd",'<div class="icon-2colonne" style="height:32px; width: 32px; margin: 0px 0px 5px 10px;"></div>');this.getColonna3().bodyEl.insertHtml("afterEnd",'<div class="icon-3colonne" style="height:32px; width: 32px; margin: 0px 0px 5px 10px;"></div>')},
changeRgLayout:function(a,b){var c=this.regionPortlet.items.getCount(),d=parseFloat(b.numCol),e;if(d>c)for(e=c+1;e<=d;e++)this.regionPortlet.down("#Col-"+e)||this.regionPortlet.add({itemId:"Col-"+e});else if(d<c)for(e=d+1;e<=c;e++)this.regionPortlet.down("#Col-"+d).add(this.regionPortlet.down("#Col-"+e).items.items),this.regionPortlet.down("#Col-"+e).destroy()},onLaunch:function(){},destroy:function(){this.callParent()}});
Ext.define("Generali.portletController.controller.WebPortal",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.MSG_NESSUNA_ANAG_SEL=traduci("MSG_NESSUNA_ANAG_SEL");this.callParent(arguments);this.addRef([{ref:"ContainerPortlet",selector:a+"#ContainerPortlet"},{ref:"Ricerca",selector:a+"#Ricerca"},{ref:"DatiPrincipali",selector:a+"#DatiPrincipali"},{ref:"DatiAggiuntivi",selector:a+"#DatiAggiuntivi"},{ref:"FotoDip",selector:a+"#FotoDip"},{ref:"BtnFotoDip",
selector:a+"#BtnFotoDip"},{ref:"WebPortal",selector:a+"#WebPortal"}]);this.control(a+"#ContainerPortlet [cls=x-portlet]",{render:this.renderPortlet});this.control(a+"#FotoDip",{render:this.renderFotoDip});this.control(a+"#BtnFotoDip",{change:this.changeBtnFotoDip,afterrender:this.afterrenderBtnFotoDip})},updateTooltipBtnFotoDip:function(){this.getBtnFotoDip().fileInputEl.el.dom.title=traduci("MSG_CANCELLA_FOTO")},afterrenderBtnFotoDip:function(){this.updateTooltipBtnFotoDip()},renderPortlet:function(a){"CLASSIFICAZIONI"!=
a.cbaConfig.id.toUpperCase()&&"DENARO"!=a.cbaConfig.id.toUpperCase()&&"FAR"!=a.cbaConfig.id.toUpperCase()&&"FARBINA"!=a.cbaConfig.id.toUpperCase()&&"REGIONALE"!=a.cbaConfig.id.toUpperCase()&&creaToolTip(a.getId(),"MSG_DBLCLICK_PORTLET","",!1,150)},estensioneValida:function(a){if(-1!=a.search(/.png/i)||-1!=a.search(/.jpg/i)||-1!=a.search(/.jpeg/i))return!0;Messaggio("ATTENZIONE","PER_ERRORE_FORMATO_FOTO","OK","ERROR");return!1},changeBtnFotoDip:function(a,b){var c=this,d=c.getFotoDip(),e=b.lastIndexOf("\\")||
b.lastIndexOf("/");b=b.substring(e+1);if(""!==b&&this.estensioneValida(b)){var e=a.fileInputEl.dom.files[0],g=new FormData;g.append("file",e);Ext.Ajax.request({url:d.urlUpload,method:"POST",rawData:g,headers:{"Content-Type":null},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(a.message&&msgShowText("TRASFERIMENTO_FILE",a.message),setSrcImage(d,d.urlSrc+"&date="+Ext.Date.now()),c.updateTooltipBtnFotoDip()):msgShowError("",a.message)},failure:function(a){msgShowError("",a.responseText);
c.getBtnAllegaFile().show();c.getBtnAllegaFile().enable()}})}},renderFotoDip:function(a){a.setSrc(CBA.parametriGenerali.defaultUserPic);var b=Ext.create("Ext.tip.ToolTip",{target:a.getEl(),anchor:"left",listeners:{beforeshow:function(b){this.update('<img src="'+a.src+'" />')}}});a.tooltip=b;"L"!=this.cbaConfig.controllerFascicolo.cbaConfig.permesso&&getPopupMenuFoto(a,CBA.parametriGenerali.defaultUserPic)},dblclickPortlet:function(a){var b=this.cbaConfig.controllerFascicolo,c=isArea("Utenti")?"OSP":
getPrefissoGen(),d;d=64==CBA.moduli.moduloAttivo?this.cbaConfig.genModulo+".portlet.view."+("RAPSospensioni"==a.cbaConfig.codVideata?"Assenze":a.cbaConfig.codVideata):this.cbaConfig.genModulo+".portlet.view."+a.cbaConfig.codVideata;if(43==CBA.moduli.moduloAttivo&&"FlussiRegionali"==a.cbaConfig.codVideata&&"undefined"!==typeof currRicovero&&"undefined"!==typeof currRicovero.servizio){if(!currRicovero.servizio.tipoFlusso)return Messaggio("ATTENZIONE",traduci("FR_TIPOFLUSSO_KO"),"OK","WARNING"),!1;if(![3,
5,6,7,8,9,10,13,14,15,16,12].includes(currRicovero.servizio.tipoFlusso))return!1}Ext.isEmpty(b.currentAss)?Messaggio("ATTENZIONE",this.MSG_NESSUNA_ANAG_SEL+"!","OK","WARNING"):Ext.create("winCBA",{permesso:a.cbaConfig.permesso,name:d,titolo:traduci(c+"_"+a.cbaConfig.codVideata),nominativo:"undefined"!==typeof currOspite&&isArea("Utenti")?currOspite.nominativo:null,dimensione:a.cbaConfig.dimensioneWindow,larghezzaWin:a.cbaConfig.larghezzaWindow,altezzaWin:a.cbaConfig.altezzaWindow,configItem:{permesso:a.cbaConfig.permesso,
controllerFascicolo:b,controllerPortlet:a.down("#Container").controller,portlet:a,recRicovero:"undefined"!==typeof currRicovero?currRicovero:null}}).show()},getAuthModules:function(){var a=this,b=this.cbaConfig.controllerFascicolo,c=[],d=[];a.getContainerPortlet().removeAll();Ext.Ajax.request({url:"/cba/gen/auth/prefs/get",params:{programID:a.cbaConfig.idModulo,buttonId:a.cbaConfig.buttonId?a.cbaConfig.buttonId:"Fascicolo"},method:"GET",async:!1,success:function(e){e=Ext.JSON.decode(e.responseText);
if(e.success){e=e.data;for(var g=e.length,h=1,k=!1,l=!1,m="43"==a.cbaConfig.idModulo||"50"==a.cbaConfig.idModulo||"48"==a.cbaConfig.idModulo||"55"==a.cbaConfig.idModulo||"64"==a.cbaConfig.idModulo?"OSP":getPrefissoGen(),n,p,q=0;q<g;q++){if(e[q].isPortlet&&"N"!=e[q].permesso){n=!0;"43"!=a.cbaConfig.idModulo&&"50"!=a.cbaConfig.idModulo||"EstrattoConto"!=e[q].codVideata||(h=getPersonContabili(getIdOrg(),new Date,!0,null),n=["2","4","5"].includes(h.tipoContabilitaAbilitata),k=!n);"OSP_Residenziale"==
e[q].codVideata&&48==a.cbaConfig.idModulo&&(n=!1);"FAR"==e[q].codVideata&&(n=CBA.moduli.modulo55.abilitato);"FlussiRegionali"==e[q].codVideata&&(n=!0);e[q].idDB=e[q].id;e[q].permessoDB=e[q].permesso;e[q].idUserPrefs=e[q].idUserPrefs;e[q].titolo=traduci(m+"_"+e[q].id.toUpperCase());if("Regionale"==e[q].codVideata&&-1==CBA.moduli.modulo43.regioni.indexOf("V"))continue;d.push(e[q]);h=e[q].colonna;if(n){p=n="";switch(e[q].collapsed){case "T":p="top";break;case "B":p="bottom";break;case "L":p="left";break;
case "R":p="right"}n="Denaro"==e[q].codVideata?"CU.denaro.portlet.view.PortletDenaro":a.cbaConfig.genModulo+".portlet.view.Portlet"+e[q].id;n=Ext.create("Generali.portletController.view.Portlet",{items:Ext.create(n,{itemId:"Portlet_"+e[q].codVideata,cbaConfig:{permesso:e[q].permesso,controllerFascicolo:b}}),idUserPrefs:e[q].idUserPrefs,title:traduci(m+"_"+e[q].codVideata),height:getHeightPortlet(e[q].id),cbaConfig:e[q],collapsed:p,listeners:{render:function(b){b.el.on("dblclick",function(){"CLASSIFICAZIONI"!=
b.cbaConfig.id.toUpperCase()&&"DENARO"!=b.cbaConfig.id.toUpperCase()&&"FAR"!=b.cbaConfig.id.toUpperCase()&&"FARBINA"!=b.cbaConfig.id.toUpperCase()&&"REGIONALE"!=b.cbaConfig.id.toUpperCase()&&a.dblclickPortlet(b)});Ext.each(b.query("displayfield"),function(a){a.on("render",function(){a.el.on("dblclick",function(){CBA.moduli["modulo"+CBA.moduli.moduloAttivo].cbaFieldLink=a})})})}}});"Classificazioni"==e[q].codVideata&&(l=n);for(p=1;p<=h;p++)c[p]||(c[p]={itemId:"Col-"+p,items:[]});c[h].items.push(n)}}"EditServizi"==
e[q].codVideata&&(b.cbaConfig.permessoEditServizi=e[q].permesso);"EditAssenze"==e[q].codVideata&&(b.cbaConfig.permessoEditAssenze=e[q].permesso);"EditScontiSupp"==e[q].codVideata&&d.push(e[q])}if("43"==a.cbaConfig.idModulo||"50"==a.cbaConfig.idModulo)k&&l&&l.queryById("BtnCauzioni").setVisible(!0),"43"==a.cbaConfig.idModulo?Ext.apply(CBA.moduli.modulo43,{moduli:d}):Ext.apply(CBA.moduli.modulo50,{moduli:d})}else msgShowError("",e.message)}});a.getContainerPortlet().add(c)},onLaunch:function(){this.getWebPortal().controller=
this;this.getAuthModules()},destroy:function(){this.callParent()}});Ext.define("Generali.portletController.view.CbaPortlet",{extend:"Ext.panel.Panel",alias:"widget.portlet",layout:"fit",anchor:"100%",cls:"x-portlet",ui:"cbaPortlet",iconCls:"icon-doctor24",tools:[{type:"add",height:24,width:24,tooltip:"NUOVO",handler:function(){alert("add")}},{type:"find",height:24,width:24,tooltip:"CERCA",handler:function(){alert("find")}}],draggable:{moveOnDrag:!1}});
Ext.define("Generali.portletController.view.PortalColumn",{extend:"Ext.container.Container",alias:"widget.portalcolumn",requires:["Ext.layout.container.Anchor","Generali.portletController.view.Portlet"],layout:"anchor",defaultType:"portlet",cls:"x-portal-column"});
Ext.define("Generali.portletController.view.PortalDropZone",{extend:"Ext.dd.DropTarget",constructor:function(a,b){this.portal=a;Ext.dd.ScrollManager.register(a.body);Generali.portletController.view.PortalDropZone.superclass.constructor.call(this,a.body,b);a.body.ddScrollConfig=this.ddScrollConfig},ddScrollConfig:{vthresh:50,hthresh:-1,animate:!0,increment:200},createEvent:function(a,b,c,d,e,g){return{portal:this.portal,panel:c.panel,columnIndex:d,column:e,position:g,data:c,source:a,rawEvent:b,status:this.dropAllowed}},
notifyOver:function(a,b,c){var d=b.getXY(),e=this.portal,g=a.proxy;this.grid||(this.grid=this.getGrid());var h=e.body.dom.clientWidth;this.lastCW?this.lastCW!=h&&(this.lastCW=h,this.grid=this.getGrid()):this.lastCW=h;var h=0,k,l=this.grid.columnX,m=l.length,n=!1;for(m;h<m;h++)if(k=l[h].x+l[h].w,d[0]<k){n=!0;break}n||h--;var p;k=0;var q,l=!1,n=e.items.getAt(h),t=n.items.items,v=!1,m=t.length;for(m;k<m;k++)if(p=t[k],q=p.el.getHeight(),0===q)v=!0;else if(p.el.getY()+q/2>d[1]){l=!0;break}k=(l&&p?k:n.items.getCount())+
(v?-1:0);b=this.createEvent(a,b,c,h,n,k);!1!==e.fireEvent("validatedrop",b)&&!1!==e.fireEvent("beforedragover",b)&&(g.getProxy().setWidth("auto"),p?a.panelProxy.moveProxy(p.el.dom.parentNode,l?p.el.dom:null):a.panelProxy.moveProxy(n.el.dom,null),this.lastPos={c:n,col:h,p:v||l&&p?k:!1},this.scrollPos=e.body.getScroll(),e.fireEvent("dragover",b));return b.status},notifyOut:function(){delete this.grid},notifyDrop:function(a,b,c){delete this.grid;if(this.lastPos){var d=this.lastPos.c,e=this.lastPos.p,
g=a.panel;b=this.createEvent(a,b,c,this.lastPos.col,d,!1!==e?e:d.items.getCount());if(!1!==this.portal.fireEvent("validatedrop",b)&&!1!==this.portal.fireEvent("beforedrop",b)){Ext.suspendLayouts();g.el.dom.style.display="";a.panelProxy.hide();a.proxy.hide();!1!==e?d.insert(e,g):d.add(g);Ext.resumeLayouts(!0);this.portal.fireEvent("drop",b);var h=this.scrollPos.top;if(h){var k=this.portal.body.dom;setTimeout(function(){k.scrollTop=h},10)}}delete this.lastPos;return!0}},getGrid:function(){var a=this.portal.body.getBox();
a.columnX=[];this.portal.items.each(function(b){a.columnX.push({x:b.el.getX(),w:b.el.getWidth()})});return a},unreg:function(){this.portal&&(Ext.dd.ScrollManager.unregister(this.portal.body),Generali.portletController.view.PortalDropZone.superclass.unreg.call(this),delete this.portal.afterLayout)}});
Ext.define("Generali.portletController.view.PortalPanel",{extend:"Ext.panel.Panel",alias:"widget.portalpanel",requires:["Ext.layout.container.Column","Generali.portletController.view.PortalDropZone","Generali.portletController.view.PortalColumn"],cls:"x-portal",bodyCls:"x-portal-body",defaultType:"portalcolumn",scrollable:!0,manageHeight:!1,initComponent:function(){this.layout={type:"column"};this.callParent()},beforeLayout:function(){var a=this.layout.getLayoutItems(),b=a.length,c=["x-portal-column-first",
"x-portal-column-last"],d,e,g;for(d=0;d<b;d++)e=a[d],e.columnWidth=1/b,g=d==b-1,d?g?(e.addCls("x-portal-column-last"),e.removeCls("x-portal-column-first")):e.removeCls(c):g?e.addCls(c):(e.addCls("x-portal-column-first"),e.removeCls("x-portal-column-last"));return this.callParent(arguments)},initEvents:function(){this.callParent();this.dd=Ext.create("Generali.portletController.view.PortalDropZone",this,this.dropConfig)},beforeDestroy:function(){this.dd&&this.dd.unreg();this.callParent()}});
Ext.define("Generali.portletController.view.SalvaPortlet",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",itemId:"Container",reference:"Container",layout:{type:"fit"},items:[{xtype:"form",noModificaDati:!0,border:0,padding:10,trackResetOnLoad:!0,items:[{xtype:"fieldset",title:"LAYOUT_FASCICOLO",itemId:"LayoutFas",reference:"LayoutFas",items:[{xtype:"radiogroup",itemId:"RgLayout",reference:"RgLayout",columns:1,items:[{xtype:"radiofield",
itemId:"Colonna1",reference:"Colonna1",name:"numCol",boxLabel:"1"+traduci("COLONNA"),inputValue:"1"},{xtype:"radiofield",itemId:"Colonna2",reference:"Colonna2",name:"numCol",boxLabel:"2"+traduci("COLONNE"),inputValue:"2"},{xtype:"radiofield",itemId:"Colonna3",reference:"Colonna3",name:"numCol",boxLabel:"3"+traduci("COLONNE"),inputValue:"3"}]}]}]},{xtype:"container",height:35,itemId:"boxBottoni",reference:"boxBottoni",layout:{align:"center",type:"vbox"},items:[{xtype:"button",itemId:"BtnSalva",reference:"BtnSalva",
iconCls:"icon-layout",text:"SALVA_PORTLET"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.portletController.view.WebPortal",{extend:"Generali.standard.ControlledContainer",uses:["Generali.portletController.view.PortalPanel","Generali.portletController.view.PortalColumn"],initComponent:function(){Ext.apply(this,{layout:{type:"border"},items:[{xtype:"container",region:"center",layout:"border",itemId:"WebPortal",reference:"WebPortal",items:[{title:"RICERCA",region:"west",itemId:"Ricerca",reference:"Ricerca",animCollapse:!0,width:260,split:!1,collapsible:!0,layout:"fit"},
{xtype:"container",region:"center",layout:"border",items:[{region:"north",xtype:"container",cls:"backgroundContainer",defaults:{margin:"5 5 5 5"},layout:{type:"hbox",align:"stretch"},height:140,items:[{xtype:"panel",itemId:"DatiPrincipali",reference:"DatiPrincipali",flex:6,ui:"cbaPanelBlu",bodyPadding:5,layout:"fit"},{xtype:"panel",itemId:"DatiAggiuntivi",reference:"DatiAggiuntivi",hidden:this.cbaConfig.datiAggiuntivi?!this.cbaConfig.datiAggiuntivi:!0,flex:4,layout:"fit"},{xtype:"panel",itemId:"Foto",
reference:"Foto",border:0,layout:{type:"vbox",align:"stretch"},hidden:this.cbaConfig.foto?!this.cbaConfig.foto:!0,width:100,items:[{xtype:"image",flex:1,border:0,itemId:"FotoDip",reference:"FotoDip",margin:"0 0 3 0"},{xtype:"form",border:0,itemId:"FormFotoDip",reference:"FormFotoDip",items:[{xtype:"filefield",width:100,margin:"1 0 0 0",cls:"cba-stdbutton-25",disabled:!0,itemId:"BtnFotoDip",reference:"BtnFotoDip",hideLabel:!0,readOnly:!1,name:"f_fotoDip",buttonConfig:{iconCls:"icon-upload",height:25},
buttonOnly:!0,buttonText:traduci("PO_DA_CAMBIA_FOTO")}]}]}]},{xtype:"portalpanel",itemId:"ContainerPortlet",reference:"ContainerPortlet",region:"center",nonDisabilitare:!0,border:0}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.profili.controller.Modulo_45",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"CkbTutteAss",selector:this.selContainer+"#CkbTutteAss"},{ref:"PnlDip",selector:this.selContainer+"#PnlDip"},{ref:"CBPerStat",selector:this.selContainer+"#CBPerStat"},{ref:"CkbValoriCent",selector:this.selContainer+"#CkbValoriCent"},{ref:"FieldProfiloDett",selector:this.selContainer+"#FieldProfiloDett"},
{ref:"PnlAnnoMeseDalAl",selector:this.selContainer+"#PnlAnnoMeseDalAl"},{ref:"Mese",selector:this.selContainer+"#Mese"},{ref:"MeseDal",selector:this.selContainer+"#MeseDal"},{ref:"MeseAl",selector:this.selContainer+"#MeseAl"},{ref:"Anno",selector:this.selContainer+"#Anno"},{ref:"RGTipoGiust",selector:this.selContainer+"#RGTipoGiust"},{ref:"FsPerStat",selector:this.selContainer+"#FsPerStat"},{ref:"CkbGiustPresenza",selector:this.selContainer+"#CkbGiustPresenza"},{ref:"CkbGiustNoFormula",selector:this.selContainer+
"#CkbGiustNoFormula"},{ref:"CntParams",selector:this.selContainer+"#CntParams"},{ref:"CkbEscludiValAZero",selector:this.selContainer+"#CkbEscludiValAZero"}]);this.control(this.selContainer+"#RGTipoGiust",{change:this.changeRGTipoGiust});this.control(this.selContainer+"#CBPerStat",{change:this.changeCBPerStat});this.control(this.selContainer+"#CkbValoriCent",{change:this.changeCkbValoriCent})},changeCkbValoriCent:function(a,b){this.controllerProfili.isProfiloSQLPaghe&&!this.caricaProfiloPadre&&this.controllerProfili.caricaDettagliProfilo(!0,
!0)},changeCBPerStat:function(a,b){this.controllerProfili.isProfiloSQLPaghe&&!this.caricaProfiloPadre&&this.controllerProfili.caricaDettagliProfilo(!0,!0)},eliminaProfilo:function(){var a=this,b=this.combo_profili.controller.id_record;b&&Ext.Ajax.request({method:"GET",url:"/cba/per/prz/ws/tabgen/profiliExp/delete",params:{id:b},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.combo_profili.controller.id_record=null:msgShowError("",b.message)}})},caricaProfilo:function(a){this.combo_profili.controller.itemsTarget=
this.original_items_target;this.combo_profili.controller.setItemsTarget();this.combo_profili.controller.loadCampi(a,"/cba/per/prz/ws/tabgen/profiliExp/get",{idPerson:a})},salvaProfilo:function(a){var b=this,c=a.id;Ext.Ajax.request({method:"GET",url:"/cba/per/prz/ws/tabgen/profiliExp/get",params:{idPerson:c},success:function(d){d=Ext.JSON.decode(d.responseText);d.success?(d=d.data&&d.data.id,b.combo_profili.controller.salva(d,a.descrizione,null,"/cba/per/prz/ws/tabgen/profiliExp/",{id:d,idPerson:c,
descrizione:a.descrizione,campiStampa:b.combo_profili.controller.getItemsTarget()})):msgShowError("",d.message)}})},changeRGTipoGiust:function(a,b){"F"==b.personOrGiust?this.getCBPerStat().bindStore(this.strCBGiust):this.getCBPerStat().bindStore(this.strCBPerStat);this.personOrGiust=b.personOrGiust;this.loadStore_mod45_personStat()},controllaErrori:function(a){this.getCBPerStat();var b=this.controllerProfili.profiloSelez.get("codProfilo"),c=this.getPnlDip().down("gridpanel").getSelectionModel().getSelection();
switch(b){case "PRZ_TOTALI_MESE_DIP":0===c.length&&msgAddError(a,"NO_DIP_SEL");break;case "PRZ_DATI_ANAGRAFICI":0===c.length&&msgAddError(a,"NO_DIP_SEL");break;case "PRZ_TIMBRATURE_DIP":0===c.length&&msgAddError(a,"NO_DIP_SEL");break;case "PRZ_DATI_PERSONALE":0===c.length&&msgAddError(a,"NO_DIP_SEL");break;case "PRZ_ORE_CONTR_DIP":0===c.length&&msgAddError(a,"NO_DIP_SEL")}},loadStore_mod45_personStat:function(){var a=this.getCBPerStat(),b=this;a.getStore().load({params:{idGroup:getIdGruppo(),escludiNegativi:"F",
raggrupgiust:"T"},callback:function(c,d,e){e&&b.combo_profili.controller.setItemsTarget(a.getItemId())}})},addParametriPersProfilo:function(a){Ext.apply(a,{idTestata:this.controllerProfili.profiloSelez.get("id")?this.controllerProfili.profiloSelez.get("id"):0,esporta:"T",pagheAbilitato:getBoolValue(CBA.moduli.modulo11.installato),portalePersonaleAbilitato:this.portalePersonaleAbilitato})},addParametriElaboazione:function(a){var b="",c=this.getPnlDip(),d=c.down("gridpanel"),e=c.down("#DataDal").getValue(),
g=c.down("#DataAl").getValue(),c=c.down("combobox").getValue();null!=d.getSelectionModel().getSelection()&&0<d.getSelectionModel().getSelection().length&&(Ext.each(d.getSelectionModel().getSelection(),function(a){b=b+a.get("id")+","}),b=b.substring(0,b.length-1));Ext.apply(a,{idGruppo:getIdGruppo(),person:this.controllerProfili.profiloSelez.get("codProfilo"),tutteAss:getBoolValue(this.getCkbTutteAss().getValue()),dataDal:e,dataAl:g,elencoDip:null!=b&&""!=b?b:null,inCentesimi:getBoolValue(this.getCkbValoriCent().getValue()),
idPerson:this.getCBPerStat().getValue(),annoI:this.getAnno().getValue(),annoF:this.getAnno().getValue(),meseI:this.getMese().getValue(),meseF:this.getMeseAl().getValue(),personOrGiust:this.personOrGiust,pagheAbilitato:getBoolValue(CBA.moduli.modulo11.installato),noPresenze:getBoolValue(this.getCkbGiustPresenza().getValue()),noFormula:getBoolValue(this.getCkbGiustNoFormula().getValue()),escludiValAZero:getBoolValue(this.getCkbEscludiValAZero().getValue()),idOrgs:c.join()})},onLaunch:function(){var a=
this;this.combo_profili=Ext.create("Generali.standard.profiliStampe.view.Profili",{codStampa:-1,target:this.view,hidden:!0});this.getCntParams().add(this.combo_profili);this.strCBPerStat=Ext.create("GeneraliPE.personalizzazioni.store.CboxPersonStat",{autoDestroy:!1});this.strCBGiust=Ext.create("RP.tabelle.store.GiustificativiCombo",{autoDestroy:!1});this.personOrGiust="T";this.getCBPerStat().bindStore(this.strCBPerStat);this.loadStore_mod45_personStat();this.portalePersonaleAbilitato="F";Ext.Ajax.request({method:"GET",
url:"/cba/per/prz/ws/prnz/pgen/src",params:{idGroup:getIdGruppo()},success:function(b){b=Ext.JSON.decode(b.responseText);b.success?a.portalePersonaleAbilitato=b.data[0].portale:msgShowError("",b.message[0].testo)}});this.controllerProfili.getCbProfilo().on("changeProfilo",function(b,c){if(a.controllerProfili.profiloSelez){var d=a.controllerProfili.profiloSelez.get("codProfilo");a.getCkbTutteAss().setVisible(["PRZ_DATI_ANAGRAFICI","PRZ_DATI_PERSONALE"].includes(d));a.getFsPerStat().setVisible(["PRZ_TOTALI_MESE_DIP",
"PRZ_TOTALIMESEORIZZ"].includes(d));a.getCkbValoriCent().setVisible(["PRZ_TOTALI_MESE_DIP","PRZ_TIMBRATURE_DIP","PRZ_TOTALIMESEORIZZ"].includes(d));a.getPnlAnnoMeseDalAl().setVisible(["PRZ_TOTALI_MESE_DIP","PRZ_ORE_CONTR_DIP","PRZ_TOTALIMESEORIZZ"].includes(d));a.getCkbGiustPresenza().setVisible(["PRZ_TIMBRATURE_DIP"].includes(d));a.getCkbGiustNoFormula().setVisible(["PRZ_TIMBRATURE_DIP"].includes(d));a.getCkbEscludiValAZero().setVisible(["PRZ_TOTALI_MESE_DIP"].includes(d))}});this.original_items_target=
this.combo_profili.controller.getItemsTarget()},destroy:function(){eliminaStore(this.strCBPerStat);eliminaStore(this.strCBGiust);this.callParent()}});
Ext.define("Generali.profili.controller.ProfiliExp",{extend:"Generali.standard.ViewController",requires:["Generali.standard.EsportaXls"],init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"Paginatore",selector:this.selContainer+"#Paginatore"},{ref:"TabProfili",selector:this.selContainer+"#TabProfili"},{ref:"TabRisultati",selector:this.selContainer+"#TabRisultati"},{ref:"BtnElabora",selector:this.selContainer+"#BtnElabora"},{ref:"BtnEsporta",selector:this.selContainer+
"#BtnEsporta"},{ref:"CbProfilo",selector:this.selContainer+"#CbProfilo"},{ref:"GridCampiSel",selector:this.selContainer+"#GridCampiSel"},{ref:"GridCampiDisp",selector:this.selContainer+"#GridCampiDisp"},{ref:"GridRisultati",selector:this.selContainer+"#GridRisultati"},{ref:"FieldProfiloDett",selector:this.selContainer+"#FieldProfiloDett"},{ref:"FormParametri",selector:this.selContainer+"#FormParametri"},{ref:"BtnClearFilters",selector:this.selContainer+"#BtnClearFilters"},{ref:"CntModulo",selector:this.selContainer+
"#CntModulo"},{ref:"TbRisultati",selector:this.selContainer+"#TbRisultati"},{ref:"BtnMoveUp",selector:this.selContainer+"#BtnMoveUp"},{ref:"BtnMoveDown",selector:this.selContainer+"#BtnMoveDown"}]);this.control(this.selContainer+"#Paginatore",{tabchange:this.tabchangePaginatore});this.control(this.selContainer+"#CbProfilo",{change:this.changeCbProfilo});this.control(this.selContainer+"#BtnElabora",{click:this.clickBtnElabora});this.control(this.selContainer+"#BtnEsporta",{click:this.clickBtnEsporta});
this.control(this.selContainer+"#BtnClearFilters",{click:this.clickBtnClearFilters});this.control(this.selContainer+"#GridCampiSel",{select:this.selectGridCampiSel,beforedrop:this.beforedropGridCampiSel,drop:this.dropGridCampiSel})},beforedropGridCampiSel:function(a,b,c,d,e,g){this.posDrop=this.getGridCampiDisp().getStore().indexOf(this.getGridCampiDisp().getSelection()[0])},dropGridCampiSel:function(a,b,c,d,e,g){this.posDrop&&0<this.posDrop&&this.getGridCampiDisp().getSelectionModel().select(this.posDrop-
1)},selectGridCampiSel:function(a,b){this.handeButtonUpDown()},tabchangePaginatore:function(a,b,c){a=b==this.getTabRisultati();this.getBtnElabora().setDisabled(a);this.getBtnEsporta().setDisabled(!a)},clickBtnClearFilters:function(){this.getGridRisultati().filters.clearFilters()},clearParametri:function(){var a=this.getFormParametri();a.removeAll();a.setVisible(0<this.elencoParametri.length)},setParametri:function(){var a=this,b=this.getFormParametri();this.clearParametri();var c=[];this.elencoParametri.forEach(function(b){var d=
JSON.parse(b.extComponent,function(a,c){return"{FUNCTION}"==c&&b.extInit?(new Function(b.extInit))():c});d.store&&Ext.apply(d,{store:Ext.create(d.store)});var g=null;if(a.valoriFiltro&&0<a.valoriFiltro.length){var h=a.valoriFiltro.find(function(a){return a.codice==d.name});h&&(g=h.valore)}"anno"!=d.xtype||g||(g=(new Date).getFullYear());Ext.apply(d,{value:d.value||g,flex:1,labelClsExtra:"cbaLabel",labelWidth:150,allowBlank:!1,useThousandSeparator:!1});var k=Ext.create(d);d.store&&k.store.load({params:k.store_params?
k.store_params:{},callback:function(a,b,c){c?k.setValue(g):msgShowError("",b.getError())}});c.push(k)});b.add(c);b.isValid()},nuovoProfilo:function(a){var b=this;Ext.create("inputBoxCBA",{cbaConfig:{titoloFinestra:"NUOVO_PROFILO",height:200,items:[{xtype:"textfield",margin:"20 0 0 0",itemId:"TxtNuovoProfilo",width:250,emptyText:traduci("NUOVO_PROFILO")}],callBack:function(c){Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/expCBA/new",jsonData:{idOrganizzazione:getIdOrg(),idModulo:CBA.moduli.moduloAttivo,
idPadre:a,descrizione:c.down("#TxtNuovoProfilo").getValue(),url:b.profiloSelez.get("url"),codProfilo:b.profiloSelez.get("codProfilo")},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.caricaStoreProfili(a.data.id):msgShowError("",a.message)}})}}}).show().down("#TxtNuovoProfilo").focus()},eliminaProfilo:function(a){var b=this;Messaggio("Elimina","MSG_ELIMINA","YESNOCANCEL","QUESTION","",function(){Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/expCBA/delete",params:{id:a},
success:function(a){a=Ext.JSON.decode(a.responseText);a.success?(b.emptyDetails(),b.caricaStoreProfili(),b.controller_modulo&&b.controller_modulo.eliminaProfilo&&b.controller_modulo.eliminaProfilo()):msgShowError("",a.message)}})})},clearGridRisultati:function(){var a=this.getGridRisultati();a.reconfigure(a.getStore(),[]);this.getTbRisultati().setDisabled(!0)},caricaDettagliProfilo:function(a,b){a=void 0===a?!0:a;b=void 0===b?!1:b;if(!this.controller_modulo||!this.controller_modulo.caricaProfiloPadre){var c=
this,d=c.getGridCampiDisp().getStore(),e=c.getGridCampiSel().getStore(),g=c.profiloSelez.get("id"),h={},k=null,l=null;svuotaStore(d);svuotaStore(e);this.clearGridRisultati();c.isProfiloSQLPaghe&&(k=c.controller_modulo.getRGTipoGiust().getValue().personOrGiust,l=c.controller_modulo.getCBPerStat().getValue(),inCentesimi=c.controller_modulo.getCkbValoriCent().getValue(),c.isProfiloSQLPaghe&&0!=c.profiloSelez.get("idPadre")&&!b&&(c.controller_modulo.caricaProfiloPadre=!0,c.controller_modulo.caricaProfilo(g),
setTimeout(function(){c.controller_modulo.caricaProfiloPadre=!1},1E3)),null!=l&&Ext.Ajax.request({method:"GET",url:"/cba/per/prz/ws/tracciati/creaquery/export/dati",timeout:36E5,async:!1,params:{personOrGiust:k,idPerson:l,idProfilo:g,inCentesimi:getBoolValue(inCentesimi)},success:function(a){a=Ext.JSON.decode(a.responseText);a.success||msgShowError("",a.message)}}));this.controller_modulo&&this.controller_modulo.addParametriPersProfilo&&this.controller_modulo.addParametriPersProfilo(h);var m=[];Object.entries(h).forEach(function(a){m.push({codice:a[0],
valore:a[1]})});Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/expCBA/getDettagliProfilo",params:{idProfilo:g},jsonData:m,success:function(b){b=Ext.JSON.decode(b.responseText);b.success?(c.elencoCampiProfilo=b.data[0],c.elencoParametri=c.isProfiloSQLPaghe?[]:b.data[1],c.valoriFiltro=b.data[2],a&&c.setParametri(),null!=c.elencoCampiProfilo&&0<c.elencoCampiProfilo.length&&c.elencoCampiProfilo.forEach(function(a){null==a.tipoCampo&&(a.tipoCampo="STRING");"T"==a.esporta?e.add(a):d.add(a)}),
!c.isProfiloSQLPaghe&&c.controller_modulo&&c.controller_modulo.caricaProfilo&&c.controller_modulo.caricaProfilo(g)):msgShowError("",b.message)}})}},salvaDettagliProfilo:function(a){var b=this,c=[];a=b.getGridCampiDisp().getStore();var d=b.getGridCampiSel().getStore(),e=1,g=null;a.each(function(a){g=a.getData();g.esporta="F";delete g.desCampo;c.push(g)});d.each(function(a){g=a.getData();g.esporta="T";g.ordine=e;delete g.desCampo;c.push(g);e++});var h=this.getFormParametri().getForm();a=h.getFieldValues();
var k=[];Object.entries(a).forEach(function(a){var b=a[0];a=a[1];var c=h.findField(b);c&&"datefield"==c.getXType()&&(a=Ext.Date.format(a,"Y-m-d"));k.push({codice:b,valore:a})});a=JSON.stringify(c);d=JSON.stringify(k);a=[a,d];Ext.Ajax.request({method:"POST",url:"/cba/gen/ws/general/expCBA/saveDettagliProfilo",params:{idProfilo:b.profiloSelez.get("id")},jsonData:a,success:function(a){a=Ext.JSON.decode(a.responseText);a.success?b.caricaDettagliProfilo(!1):msgShowError("",a.message)}});this.isProfiloSQL&&
this.isProfiloSQLPaghe&&this.controller_modulo&&this.controller_modulo.salvaProfilo&&this.controller_modulo.salvaProfilo(b.profiloSelez.getData())},caricaStoreProfili:function(a){var b=this;b.getCbProfilo().getStore().load({params:{idModulo:CBA.moduli.moduloAttivo},callback:function(c,d,e){if(e){var g=0,h="";null!=c&&0<c.length&&(c.forEach(function(a){0==a.get("idPadre")?(g=a.get("id"),h=a.get("descrizione")):a.data.descrizione=a.data.descrizione+" ("+(g==a.get("idPadre")?h:"--")+")"}),null!=a&&0<
a&&b.getCbProfilo().setValue(a))}else msgShowError("",d.getError())}})},emptyDetails:function(){this.elencoCampiProfilo=[];this.elencoParametri=[];this.valoriFiltro=[];svuotaStore(this.getGridCampiDisp().getStore());svuotaStore(this.getGridCampiSel().getStore());this.clearGridRisultati();this.getCntModulo().hide();this.clearParametri()},changeCbProfilo:function(a,b){null!=this.storeRisultati&&eliminaStore(this.storeRisultati);this.profiloSelez=null;this.isProfiloSQLPaghe=this.isProfiloSQL=!1;var c=
this.getCbProfilo();c.triggers.nuovo.hide();c.triggers.salva.hide();c.triggers.elimina.hide();null!=b&&""!=b?(this.profiloSelez=a.store.getById(b),this.isProfiloSQL="SQL_QUERY"===this.profiloSelez.get("codProfilo"),"PRZ_TOTALIMESEORIZZ"===this.profiloSelez.get("codProfilo")&&(this.isProfiloSQLPaghe=this.isProfiloSQL=!0),0===this.profiloSelez.get("idPadre")?c.triggers.nuovo.show():(c.triggers.salva.show(),c.triggers.elimina.show()),this.caricaDettagliProfilo(!0),this.getCntModulo().setVisible(!this.isProfiloSQL||
this.isProfiloSQLPaghe)):this.emptyDetails();a.fireEvent("changeProfilo")},spostaTuttiDettagli:function(a){var b=this.getGridCampiDisp().getStore(),c=this.getGridCampiSel().getStore(),d=a?c:b;a=a?b:c;a.each(function(a){d.add(a)});svuotaStore(a)},sposta:function(a,b,c){b=void 0===b?!0:b;var d=this.getGridCampiDisp().getStore(),e=this.getGridCampiSel().getStore();b?(e.add(a),d.remove(a),c&&0<c&&this.getGridCampiDisp().getSelectionModel().select(c-1)):(d.add(a),e.remove(a))},handeButtonUpDown:function(){var a=
this.getGridCampiSel(),b=a.getStore();(a=a.getSelectionModel().getSelection()[0])?(a=b.findExact("campo",a.get("campo")),this.getBtnMoveUp().setDisabled(0===a),this.getBtnMoveDown().setDisabled(a===b.getCount()-1)):(this.getBtnMoveUp().setDisabled(!0),this.getBtnMoveDown().setDisabled(!0))},moveUpDown:function(a){a=void 0===a?!0:a;var b=this.getGridCampiSel(),c=b.getSelectionModel().getSelection()[0],d=b.getStore(),e=b.getStore().indexOf(c);if(a){if(e--,0>e)return}else if(e++,e>=b.getStore().getCount())return;
d.remove(c);d.insert(e,c);b.getSelectionModel().select(e)},controllaErrori:function(){var a=[];Ext.isEmpty(this.profiloSelez)||this.isProfiloSQLPaghe&&null==this.profiloSelez.get("id")?msgAddError(a,"NESSUN_PROFILO_SELEZIONATO"):(this.controller_modulo&&this.controller_modulo.controllaErrori&&this.controller_modulo.controllaErrori(a),this.isProfiloSQL&&(this.getFormParametri().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI")));0<a.length&&this.getPaginatore().setActiveTab(this.getTabProfili());return msgShow("",
a)},clickBtnEsporta:function(){if(null==this.storeRisultati||0==this.storeRisultati.getCount())msgShow("","NESSUN_DATO_DA_STAMPARE");else{var a=Ext.create("Generali.standard.EsportaXls",{grid:this.getGridRisultati(),file_name:this.getCbProfilo().getSelectedRecord().get("descrizione")});a.esportaXls();Ext.destroy(a);msgShow("","FINE_ESPORTAZIONE")}},clickBtnElabora:function(){var a=this,b=null;a.getTbRisultati().setDisabled(!0);null!=a.storeRisultati&&eliminaStore(a.storeRisultati);if(a.controllaErrori()){var c=
{},d="";a.getGridCampiSel().getStore().getData().each(function(a){d=d+a.get("campo")+","});d=d.substring(0,d.length-1);this.controller_modulo&&this.controller_modulo.addParametriElaboazione&&this.controller_modulo.addParametriElaboazione(c);var e=null,g={idProfilo:a.profiloSelez.get("id")};if(a.isProfiloSQL){e=this.getFormParametri();Ext.apply(c,e.getForm().getFieldValues());var h=[];Object.entries(c).forEach(function(a){h.push({codice:a[0],valore:a[1]})});e=Ext.JSON.encode(h);Ext.apply(g,{campiExport:d})}else b=
newIdElab(),Ext.apply(c,{campi:d}),Ext.apply(g,c,{idAvanzamentoElaborazione:b});Ext.Ajax.request({method:"POST",url:a.isProfiloSQL?"/cba/gen/ws/general/expCBA/elaboraDati":a.profiloSelez.get("url"),timeout:36E5,params:g,jsonData:e,success:function(b){b=Ext.JSON.decode(b.responseText);if(b.success)if(null==b.data||"[]"==b.data)msgShowWarning("","MSG_NORECORD");else{b=JSON.parse(b.data);var c=d.split(","),e=a.getGridRisultati(),g=a.createColumns(c);a.storeRisultati=a.creaStoreDaJson(b,c);e.reconfigure(a.storeRisultati,
g);a.getPaginatore().setActiveTab(a.getTabRisultati());a.getTbRisultati().setDisabled(!1)}else msgShowError("",b.message)}});b&&Ext.create("winElaborazione",{idElaborazione:b}).start()}},creaStoreDaJson:function(a,b){for(var c=[],d=0;d<b.length;d++){var e={},g={name:b[d]},h=this.elencoCampiProfilo.find(function(a){return a.campo==b[d]});!h||"DATE"!=h.tipoCampo&&"DATETIME"!=h.tipoCampo&&"TIME"!=h.tipoCampo||Ext.apply(g,{type:"date"});Ext.apply(e,g);c.push(e)}return Ext.create("Generali.data.Store",
{fields:c,autoDestroy:!0,data:a})},createColumns:function(a){var b=this,c=[];a=a.map(function(a){var d=b.elencoCampiProfilo.find(function(b){return b.campo==a}),g=d.tipoCampo,h,k=0,k="",l=!0,m="string",n={},p="left";colWidth=250;g.includes("NON_PREVISTO")?(msgAddWarning(c,d.desCampo),g="STRING"):g.includes("NUMBER")&&(k=g.match(/\d+/),k=+k[0],k=0<k?"0."+"".padStart(k,"0"):"0",g="NUMBER");switch(g){case "STRING":h="gridcolumn";break;case "NUMBER":h="numbercolumn";p="right";colWidth=150;m="number";
n={gt:{allowDecimals:"0"!=k},lt:{allowDecimals:"0"!=k},eq:{allowDecimals:"0"!=k}};break;case "DATE":h="datecolumn";p="center";colWidth=100;k="d/m/Y";m="date";break;case "DATETIME":h="datecolumn";p="center";colWidth=120;k="d/m/Y H:i";l=!1;break;case "TIME":h="datecolumn";p="center";colWidth=60;k="H:i";l=!1;break;default:h="gridcolumn"}d={xtype:h,format:k,text:d.desCampo,dataIndex:a,width:colWidth,align:p,locked:!0,renderer:function(a,b,c){if("numbercolumn"==h)return b.style="white-space: nowrap; text-align:right",
c=b.column.format,textalign="center",b=0,c=c.split("."),c[1]&&(b=c[1].length),formatFloat(a,b);if("datecolumn"==h)return b.style="white-space: nowrap; text-align:center","H:i"==b.column.format?FormattaOra(a):FormattaData(a,b.column.format);b.style="white-space: nowrap;";return a}};l&&Ext.apply(d,{filter:{type:m,fields:n}});return d});msgShow("MSG_EXPORT_FORMAT_NOT_SUPPORTED",c);return a},onLaunch:function(){var a=this;null!=CBA.moduli.moduloAttivo?this.caricaStoreProfili():msgShowError("ACCEDERE",
"OPEN_MODULE_REQUIRED");this.getGridCampiSel().getStore().on("datachanged",function(b){0===b.getCount()&&a.getGridCampiSel().getSelectionModel().deselectAll();a.handeButtonUpDown()});this.controller_modulo=this.storeRisultati=null;var b="Generali.profili.view.Modulo_"+CBA.moduli.moduloAttivo;CBA.parametriGenerali.produzione?Ext.ClassManager.get(b)&&this.loadModulo(b):Ext.Loader.loadScript({url:Ext.Loader.getPath(b),onLoad:function(){a.loadModulo(b)}})},loadModulo:function(a){a=Ext.create(a,{controllerProfili:this});
this.getCntModulo().add(a);this.controller_modulo=a.controller},destroy:function(){eliminaStore(this.storeCampiProfilo);eliminaStore(this.storeRisultati);this.callParent()}});Ext.define("Generali.profili.store.ProfiliExp",{extend:"Generali.data.StoreJson",fields:[{name:"id"},{name:"idPadre"},{name:"idOrganizzazione"},{name:"idModulo"},{name:"codProfilo"},{name:"descrizione",convert:function(a,b){return traduci(a)}},{name:"url"}],proxy:{url:"/cba/gen/ws/general/expCBA/src"},autoLoad:!1});
Ext.define("Generali.profili.store.ProfiliExpDe",{extend:"Ext.data.ArrayStore",fields:[{name:"id"},{name:"idProfilo"},{name:"campo"},{name:"ordine"},{name:"esporta"},{name:"campoInesistente"},{name:"desCampo"}]});
Ext.define("Generali.profili.view.Modulo_45",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",itemId:"PnlDip",reference:"PnlDip",ui:"cbaPanelRosa",margin:"0 0 0 20",layout:{type:"fit"},items:[Ext.create("GeneraliPE.fascicolo.view.Cerca",{width:300,cbaConfig:{permesso:"S",checkBoxModel:!0,multiSelectOrg:!0,callBackCerca:function(a){}}})]},{xtype:"container",itemId:"CntParams",
reference:"CntParams",margin:"0 0 0 20",layout:{type:"vbox"},items:[{xtype:"fieldset",title:"PERIODO_RIFERIMENTO",itemId:"PnlAnnoMeseDalAl",reference:"PnlAnnoMeseDalAl",cls:"bgYellow",padding:5,hidden:!0,layout:{type:"vbox"},items:[{xtype:"mese",itemId:"Mese",reference:"Mese",labelWidth:80,fieldLabel:"MESE_DAL",labelAlign:"left",width:200,margin:"0 0 5 0",store:Ext.create("Generali.store.cboxMesi"),value:(new Date).getMonth()+1,puoiCancellare:!1},{xtype:"mese",itemId:"MeseAl",reference:"MeseAl",name:"meseAl",
labelWidth:80,fieldLabel:"MESE_AL",labelAlign:"left",width:200,margin:"0 0 5 0",store:Ext.create("Generali.store.cboxMesi"),value:(new Date).getMonth()+1,puoiCancellare:!1},{xtype:"anno",labelAlign:"left",itemId:"Anno",reference:"Anno",width:150,labelWidth:80,value:(new Date).getFullYear()}]},{xtype:"checkboxfield",cls:"cbaLabel",hidden:!0,itemId:"CkbGiustPresenza",reference:"CkbGiustPresenza",boxLabel:"GEN_GIUSTIF_PRESENZA",checked:!1,inputValue:"T",uncheckedValue:"F",isProfileComponent:!0},{xtype:"checkboxfield",
cls:"cbaLabel",hidden:!0,itemId:"CkbGiustNoFormula",reference:"CkbGiustNoFormula",boxLabel:"GEN_GIUSTIF_NOFORMULA",checked:!1,inputValue:"T",uncheckedValue:"F",isProfileComponent:!0},{xtype:"checkboxfield",cls:"cbaLabel",hidden:!0,itemId:"CkbTutteAss",reference:"CkbTutteAss",boxLabel:"GEN_TUTTE_ASS",checked:!1,inputValue:"T",uncheckedValue:"F",isProfileComponent:!0},{xtype:"fieldset",width:450,hidden:!0,itemId:"FsPerStat",reference:"FsPerStat",items:[{xtype:"radiogroup",border:0,width:450,itemId:"RGTipoGiust",
reference:"RGTipoGiust",isProfileComponent:!0,items:[{boxLabel:"GIUSTIFICATIVO",formId:this.getItemId()+"-form",name:"personOrGiust",cls:"cbaLabel",inputValue:"F"},{boxLabel:"PRZTREE_PERSONSTAT",formId:this.getItemId()+"-form",name:"personOrGiust",cls:"cbaLabel",inputValue:"T",checked:!0}]},{xtype:"combobox",margin:"0 0 10 0",width:430,itemId:"CBPerStat",reference:"CBPerStat",labelAlign:"top",labelClsExtra:"cbaLabel",emptyText:"SELEZIONA_TUTTI",displayField:"valore",queryMode:"local",valueField:"codice",
isProfileComponent:!0}]},{xtype:"checkboxfield",cls:"cbaLabel",hidden:!0,itemId:"CkbValoriCent",reference:"CkbValoriCent",boxLabel:"GEN_VAL_CENTESIMI",checked:!1,inputValue:"T",uncheckedValue:"F",isProfileComponent:!0},{xtype:"checkboxfield",cls:"cbaLabel",hidden:!0,itemId:"CkbEscludiValAZero",reference:"CkbEscludiValAZero",boxLabel:"GEN_ESCL_VAL_A_ZERO",checked:!1,inputValue:"T",uncheckedValue:"F",isProfileComponent:!0}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.profili.view.ProfiliExp",{extend:"Generali.standard.ControlledContainer",initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"tabpanel",itemId:"Paginatore",reference:"Paginatore",border:0,flex:1,tabBar:{height:44,items:[{xtype:"tbfill"},{xtype:"toolbar",border:0,items:[{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-elabora32",scale:"large",text:"ELABORA"},{xtype:"button",itemId:"BtnEsporta",reference:"BtnEsporta",scale:"large",iconCls:"icon-xls",
text:"ESPORTA",disabled:!0}]}]},items:[{xtype:"container",itemId:"TabProfili",reference:"TabProfili",tabConfig:{title:"PARAMETRI_GENERALI",height:44},layout:{align:"stretch",type:"hbox"},padding:5,items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},width:440,items:[{xtype:"fieldset",cls:"bgYellow",title:"SELEZIONA_PROFILO",layout:"anchor",items:[{xtype:"combobox",itemId:"CbProfilo",reference:"CbProfilo",anchor:"100%",valueField:"id",displayField:"descrizione",queryMode:"local",store:Ext.create("Generali.profili.store.ProfiliExp"),
listConfig:{tpl:new Ext.XTemplate('<tpl for="."><tpl if="idPadre===0"><div class="x-boundlist-item">{descrizione}</div><tpl else><div style="font-style:oblique;margin-left:30px"; class="x-boundlist-item">{descrizione}</div></tpl></tpl>')},triggers:{nuovo:{cls:"icon-inserisciGriglia",tooltip:"NUOVO",hidden:!0,handler:function(b){a.controller.nuovoProfilo(b.getValue())}},elimina:{cls:"icon-elimina",tooltip:"ELIMINA",hidden:!0,handler:function(b){a.controller.eliminaProfilo(b.getValue())}},salva:{cls:"icon-save",
tooltip:"SALVA",hidden:!0,handler:function(b){a.controller.salvaDettagliProfilo(b.getValue())}}}}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",itemId:"GridCampiDisp",reference:"GridCampiDisp",ui:"cbaPanelBlu",flex:1,minHeight:200,title:"CAMPI_DISPONIBILI",dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",iconCls:"icon-arrow-right",text:"SPOSTA_TUTTI",handler:function(b){a.controller.spostaTuttiDettagli(!0)}}]}],selModel:Ext.create("Ext.selection.RowModel",
{mode:"MULTI"}),viewConfig:{loadMask:!1,plugins:{ptype:"gridviewdragdrop",dragGroup:"firstGroup",dropGroup:"secondGroup"}},store:Ext.create("Generali.profili.store.ProfiliExpDe"),columns:[{text:"CAMPO",dataIndex:"campo",renderer:function(a,c,d){"T"==d.get("campoInesistente")&&(c.tdCls="bgOrange");return d.get("desCampo")},flex:1},{xtype:"actioncolumn",width:25,align:"center",items:[{iconCls:"icon-addSvg",tooltip:traduci("AGGIUNGI"),handler:function(b,c){var d=b.getStore().getAt(c);a.controller.sposta(d,
!0,c)}}]}]},{xtype:"container",width:10},{xtype:"gridpanel",itemId:"GridCampiSel",reference:"GridCampiSel",store:Ext.create("Generali.profili.store.ProfiliExpDe"),ui:"cbaPanelAzzurro",flex:1,minHeight:200,title:"CAMPI_DAEXPORT",dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",iconCls:"icon-elimina",text:"RESET",handler:function(b){a.controller.spostaTuttiDettagli(!1)}},{xtype:"button",itemId:"BtnMoveUp",reference:"BtnMoveUp",iconCls:"icon-up",tooltip:"MOVE_UP",disabled:!0,handler:function(b){a.controller.moveUpDown(!0)}},
{xtype:"button",itemId:"BtnMoveDown",reference:"BtnMoveDown",iconCls:"icon-down",tooltip:"MOVE_DOWN",disabled:!0,handler:function(b){a.controller.moveUpDown(!1)}}]}],viewConfig:{loadMask:!1,plugins:{ptype:"gridviewdragdrop",dragGroup:"secondGroup",dropGroup:"firstGroup"}},columns:[{text:"CAMPO",dataIndex:"campo",renderer:function(a,c,d){"T"==d.get("campoInesistente")&&(c.tdCls="bgOrange");return d.get("desCampo")},flex:1},{xtype:"actioncolumn",width:25,align:"center",items:[{iconCls:"icon-elimina",
tooltip:traduci("RIMUOVI"),handler:function(b,c){var d=b.getStore().getAt(c);a.controller.sposta(d,!1)}}]}],selModel:Ext.create("Ext.selection.RowModel",{mode:"MULTI"})}]}]},{xtype:"container",padding:10,items:[{xtype:"form",noModificaDati:!0,title:"PARAMETRI",width:49==CBA.moduli.moduloAttivo?450:500,bodyPadding:10,layout:{type:"vbox",align:"stretch"},hidden:!0,itemId:"FormParametri",reference:"FormParametri"}]},{xtype:"container",itemId:"CntModulo",reference:"CntModulo",hidden:!0,layout:"fit"}]},
{xtype:"container",itemId:"TabRisultati",reference:"TabRisultati",tabConfig:{title:"RISULTATI_RICERCA",height:44},layout:{type:"vbox",align:"stretch"},padding:5,items:[{xtype:"gridpanel",itemId:"GridRisultati",reference:"GridRisultati",flex:1,plugins:"gridfilters",dockedItems:[{xtype:"toolbar",itemId:"TbRisultati",reference:"TbRisultati",dock:"top",items:[{xtype:"button",itemId:"BtnClearFilters",references:"BtnClearFilters",scale:"medium",text:"CLEAR_FILTERS"},{xtype:"tbspacer",width:10},{xtype:"label",
text:"FILTER_TIP"}]}]}]}]}]});a.callParent(arguments)}});Ext.define("Generali.province.store.cboxProvince",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/province/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0,autoLoad:!0});
Ext.define("Generali.sediReparti.controller.Letti",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridLetti",selector:this.selContainer+"#GridLetti"},{ref:"BtnNuovoLetto",selector:this.selContainer+"#BtnNuovoLetto"},{ref:"BtnEliminaLetto",selector:this.selContainer+"#BtnEliminaLetto"}]);this.control(this.selContainer+"#GridLetti",{beforeedit:this.beforeeditGridLetti,edit:this.editGridLetti,canceledit:this.canceleditGridLetti,
validateedit:this.validateeditGridLetti});this.control(this.selContainer+"#BtnNuovoLetto",{click:this.clickBtnNuovoLetto});this.control(this.selContainer+"#BtnEliminaLetto",{click:this.clickBtnEliminaLetto})},clickBtnNuovoLetto:function(a){if(!this.cbaConfig.ContainerGestione.down("#FormStanza").isValid())return msgShowError("","MSG_CAMPI_OBBLIGATORI"),!1;controller_nuovoRecordGrid({id:null},this.getGridLetti())},clickBtnEliminaLetto:function(a){var b=this;a=b.getGridLetti();var c=a.getSelectionModel().getSelection()[0];
controller_eliminaRecord(a.getStore(),{id:c?c.get("id"):"",codEnte:b.cbaConfig.codEnte?b.cbaConfig.codEnte:-1},function(){b.aggiornaStore()})},beforeeditGridLetti:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovoLetto().setDisabled(!a);this.getBtnEliminaLetto().setDisabled(!a);containerSolaLettura(this.cbaConfig.ContainerGestione.down("#FormStanza"),!a);this.cbaConfig.ContainerGestione.down("#FormStanza").controller.getBoxBottoni().setDisabled(!a);
this.cbaConfig.controllerTree.getTreeView().setDisabled(!a)},editGridLetti:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();var e=this.getGridLetti().up("#ContainerGestione").down("#NumeroLetti").getValue();Ext.apply(c,{codiceEnte:this.cbaConfig.codiceEnte,codiceStanza:this.cbaConfig.codiceStanza,annullato:getBoolValue(c.annullato),idEntePwd:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1});controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1,
maxNumLetti:e})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridLetti:function(a,b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridLetti:function(a,b,c){return msgShow("",[])},aggiornaStore:function(a){var b=this.getGridLetti(),c=b.getStore();c.load({params:{stanza:this.cbaConfig.codiceStanza,codEnte:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),
b.getSelectionModel().select(d?[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridLetti().getStore())},onLaunch:function(){var a=this;Sipcar.app.getController("Menu");var b=a.cbaConfig.controllerTree.cbaConfig.currentTab;a.getGridLetti().controller=a;a.aggiornaStore();if(43!=CBA.moduli.moduloAttivo&&50!=CBA.moduli.moduloAttivo&&b&&(b.on("beforeclose",function(b){if(!a.isDestroyed&&!Ext.isEmpty(a.getGridLetti())&&Ext.isDefined(a.getGridLetti()))return!a.getGridLetti().editingPlugin.editing}),
b.up("#content")))b.up("#content").on("beforetabchange",function(c,d,e,g){if(!a.isDestroyed&&!Ext.isEmpty(a.getGridLetti())&&Ext.isDefined(a.getGridLetti())&&b===e)return!a.getGridLetti().editingPlugin.editing})}});
Ext.define("Generali.sediReparti.controller.Reparto",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormReparto",selector:this.selContainer+"#FormReparto"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"DescrizioneReparto",selector:this.selContainer+"#DescrizioneReparto"},{ref:"CodiceSede",selector:this.selContainer+"#CodiceSede"}])},verificaCampiForm:function(){var a=[];this.getFormReparto().isValid()||
msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormReparto(),c=b.getForm().getFieldValues();Ext.apply(c,{annullato:getBoolValue(c.annullato),idEntePwd:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1});this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})||(this.recordModificato=!0)},gestioneForm:function(){var a=this,b=a.getFormReparto();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeReparto;b.controller=
a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.cbaConfig.controllerTree.getTreeView().setDisabled(!1);a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b)},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c,codEnte:a.cbaConfig.codEnte?a.cbaConfig.codEnte:-1},function(){a.recordModificato=!0;a.aggiornaStore()})},
verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});null==a.cbaConfig.codiceStanza&&(inserisciBottoni(b.boxBottoni,c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.getTreeView().setDisabled(e)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStore:function(a){var b=this,c=b.storeReparto,d=b.getFormReparto().getForm();
null!=b.cbaConfig.codiceStanza&&containerSolaLettura(b.getFormReparto());b.cbaConfig.codiceReparto||a?c.load({params:{id:b.cbaConfig.codiceReparto?b.cbaConfig.codiceReparto:a,codEnte:b.cbaConfig.codEnte?b.cbaConfig.codEnte:-1},callback:function(c,g,h){h?(Ext.isEmpty(c)||d.loadRecord(c[0]),b.recordModificato&&(b.recordModificato=!1,Ext.isEmpty(c)?b.cbaConfig.controllerTree.aggiornaStore(null,b.cbaConfig.codiceSede):b.cbaConfig.controllerTree.aggiornaStore(null,null,a))):msgShowError("",g.getError())}}):
b.cbaConfig.ContainerGestione.removeAll()},onLaunch:function(){this.storeReparto=Ext.create("Generali.sediReparti.store.Reparto");this.gestioneForm();this.cbaConfig.nuovoInserimento?(this.getBoxBottoni().queryById("btnNuovo").handler(),this.getCodiceSede().setValue(this.cbaConfig.codiceSede)):this.aggiornaStore()},destroy:function(){eliminaStore(this.storeReparto)}});
Ext.define("Generali.sediReparti.controller.Sede",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormSede",selector:this.selContainer+"#FormSede"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"DescrizioneSede",selector:this.selContainer+"#DescrizioneSede"},{ref:"cntCda",selector:this.selContainer+"#cntCda"}])},verificaCampiForm:function(){var a=[];this.getFormSede().isValid()||
msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormSede(),c=b.getForm().getFieldValues();Ext.apply(c,{annullato:getBoolValue(c.annullato),idEntePwd:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1});c.cda&&(c.codiceCda=c.cda);c.cda1&&(c.idCda=c.cda1);delete c.tipoContabilita;delete c.descrizioneCodice;delete c.cda;delete c.cda1;delete c.desAnnoCda;this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})?a&&this.callbackEsci&&
this.callbackEsci():this.recordModificato=!0},gestioneForm:function(){var a=this,b=a.getFormSede();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeSede;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.cbaConfig.controllerTree.getTreeView().setDisabled(!1);a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);b.getForm().setValues({idOrganizzazione:a.cbaConfig.idOrganizzazione})},
elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c,codEnte:a.cbaConfig.codEnte?a.cbaConfig.codEnte:-1},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});null==a.cbaConfig.codiceReparto&&(inserisciBottoni(b.boxBottoni,c),b.boxBottoni.queryById("btnEsci").hide(),b.boxBottoni.queryById("btnNuovo").hide());if("L"!=b.permesso)b.getForm().on("dirtychange",
function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.getTreeView().setDisabled(e)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStore:function(a){var b=this,c=b.storeSede,d=b.getFormSede().getForm();null!=b.cbaConfig.codiceReparto&&containerSolaLettura(b.getFormSede());b.cbaConfig.codiceSede||a?c.load({params:{id:b.cbaConfig.codiceSede?b.cbaConfig.codiceSede:a,codEnte:b.cbaConfig.codEnte?b.cbaConfig.codEnte:-1},callback:function(c,g,h){if(h){Ext.isEmpty(c)||(d.loadRecord(c[0]),
c[0].get("codiceCda")&&d.setValues({descrizioneCodice:c[0].get("codiceCda")}));if(43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo)d.setValues({tipoContabilita:b.personContabili.tipoContabilitaAbilitata,idEsercizio:b.personContabili.idEsercizio}),b.cbaConfig.controllerTree.getTreeView().setDisabled(!1);b.recordModificato&&(b.recordModificato=!1,Ext.isEmpty(c)?b.cbaConfig.controllerTree.aggiornaStore(a):b.cbaConfig.controllerTree.aggiornaStore(null,a))}else msgShowError("",g.getError())}}):
b.cbaConfig.ContainerGestione.removeAll()},onLaunch:function(){this.storeSede=Ext.create("Generali.sediReparti.store.Sede");43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?(this.getCntCda().setVisible(!0),Ext.apply(this.getCntCda().cbaConfig,{tipoContabilita:null}),this.personContabili=getPersonContabili(getIdOrg(),new Date,!0,null),this.getFormSede().getForm().findField("cda").setReadOnly(!this.personContabili.vediCda)):this.getCntCda().setVisible(!1);this.gestioneForm();this.cbaConfig.nuovoInserimento?
this.getBoxBottoni().queryById("btnNuovo").handler():this.aggiornaStore()},destroy:function(){eliminaStore(this.storeSede)}});
Ext.define("Generali.sediReparti.controller.SediReparti",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){var a="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"TreeView",selector:a+"#TreeView"},{ref:"ContainerGestione",
selector:a+"#ContainerGestione"},{ref:"BtnNuovo",selector:a+"#BtnNuovo"}]);this.control(a+"#TreeView",{select:this.selectTree,beforeitemcontextmenu:this.beforeitemcontextmenuTree});this.control(a+"#BtnNuovo",{click:this.clickBtnNuovo})},clickBtnNuovo:function(){var a=this.getTreeView().getSelectionModel().getSelection()[0],b=this.getContainerGestione();b.removeAll();var c={nuovoInserimento:!0,controllerTree:this};c.ContainerGestione=b;c.codEnte=this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1;c.idOrganizzazione=
this.cbaConfig.idOrganizzazione;c.codiceSede=a.get("idSede");c.codiceReparto=a.get("idReparto");c.codiceStanza=a.get("idStanza");a&&(Ext.isEmpty(a.get("idSede"))?b.add(Ext.create("Generali.sediReparti.view.Sede",{cbaConfig:c})):Ext.isEmpty(a.get("idReparto"))?b.add(Ext.create("Generali.sediReparti.view.Reparto",{cbaConfig:c})):b.add(Ext.create("Generali.sediReparti.view.Stanza",{cbaConfig:c})))},beforeitemcontextmenuTree:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},selectTree:function(a,b,
c,d){var e=this;a={};b=b.data;b.params&&(a=b.params[0]);c=this.getContainerGestione();a.permesso=this.cbaConfig.permesso;a.text=b.text;a.codiceSede=b.idSede;a.codiceReparto=b.idReparto;a.codiceStanza=b.idStanza;a.codEnte=this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1;a.nuovoInserimento=this.nuovoInserimento;a.controllerTree=this;a.ContainerGestione=c;c.removeAll();d=function(a,b){return a.setDisabled(b||"L"==e.cbaConfig.permesso)};Ext.isEmpty(b.idSede)&&!Ext.isEmpty(b.idStanza)?(this.getBtnNuovo().setText(traduci("NUOVO")),
d(this.getBtnNuovo(),!0)):(this.getBtnNuovo().setText(traduci("NUOVA_SEDE")),d(this.getBtnNuovo(),!1),Ext.isEmpty(b.idSede)||(this.getBtnNuovo().setText(traduci("NUOVO_REPARTO")),c.add(Ext.create("Generali.sediReparti.view.Sede",{cbaConfig:a}))),Ext.isEmpty(b.idReparto)||(this.getBtnNuovo().setText(traduci("NUOVA_STANZA")),c.add(Ext.create("Generali.sediReparti.view.Reparto",{cbaConfig:a}))),Ext.isEmpty(b.idStanza)||(this.getBtnNuovo().setText(traduci("NUOVO")),d(this.getBtnNuovo(),!0),c.add(Ext.create("Generali.sediReparti.view.Stanza",
{cbaConfig:a})),50!=CBA.moduli.moduloAttivo&&c.add(Ext.create("Generali.sediReparti.view.Letti",{cbaConfig:a}))))},beforeitemcontextmenuTreeView:function(a,b,c,d,e,g){return getPopupMenuTree(e,a)},aggiornaStore:function(a,b,c,d){var e=this.getTreeView();e.getStore().load({params:{codEnte:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1,idOrganizzazione:this.cbaConfig.idOrganizzazione},callback:function(g,h,k){if(k){var l;d&&(l=e.getRootNode().findChild("idStanza",d,!0));c&&(l=e.getRootNode().findChild("idReparto",
c,!0));b&&(l=e.getRootNode().findChild("idSede",b,!0));a&&(l=e.getRootNode().findChild("idCalc",a,!0));e.expandAll();l?(e.getSelectionModel().select(0),e.getSelectionModel().select([l])):e.getSelectionModel().select(0)}else msgShowError("",h.getError())}})},abilitaBottoniGrid:function(a){},stampaAlbero:function(){var a=this.cbaConfig,b=a.winElaborazione,c={};Ext.apply(c,{idOrganizzazione:a.idOrganizzazione});"string"===typeof b&&(a.winElaborazione=b===(!0).toString());Ext.apply(this.parametriStampa,
{url:a.url,jsonData:a.jsonData,titolo:a.titolo,winElaborazione:b,params:{reportId:a.idRecord}});a=this.parametriStampa;Ext.apply(a.params,c);this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampaAlbero();this.callParent([a,b])},onLaunch:function(){this.getBtnStampa().setVisible(!Ext.isEmpty(this.cbaConfig.url));this.aggiornaStore()},destroy:function(){}});
Ext.define("Generali.sediReparti.controller.Stanza",{extend:"Generali.standard.ViewController",init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"FormStanza",selector:this.selContainer+"#FormStanza"},{ref:"BoxBottoni",selector:this.selContainer+"#BoxBottoni"},{ref:"DescrizioneStanza",selector:this.selContainer+"#DescrizioneStanza"},{ref:"CodiceSede",selector:this.selContainer+"#CodiceSede"},{ref:"CodiceReparto",selector:this.selContainer+"#CodiceReparto"},
{ref:"cntCda",selector:this.selContainer+"#cntCda"}])},verificaCampiForm:function(){var a=[];this.getFormStanza().isValid()||msgAddError(a,"MSG_CAMPI_OBBLIGATORI");return msgShow("",a)},salvaForm:function(a){var b=this.getFormStanza(),c=b.getForm().getFieldValues();Ext.apply(c,{annullato:getBoolValue(c.annullato),conBagno:getBoolValue(c.conBagno),idEntePwd:this.cbaConfig.codEnte?this.cbaConfig.codEnte:-1});c.cda&&(c.codiceCda=c.cda);c.cda1&&(c.idCda=c.cda1);delete c.tipoContabilita;delete c.descrizioneCodice;
delete c.cda;delete c.cda1;delete c.desAnnoCda;this.recordModificato=!0;controller_salvaRecord(b,c,a,{forzaRegistrazione:"F"})||(this.recordModificato=!0)},gestioneForm:function(){var a=this,b=a.getFormStanza();b.permesso=a.permesso;b.boxBottoni=a.getBoxBottoni();b.store=a.storeStanza;b.controller=a;var c=Ext.create("Generali.standard.controller_PannelloBottoniVert",{cbaConfig:{conferma_callback:function(b){a.salvaForm(b)},annulla_callback:function(){a.cbaConfig.controllerTree.getTreeView().setDisabled(!1);
a.aggiornaStore()},nuovo_callback:function(){controller_nuovoRecord(b);50==CBA.moduli.moduloAttivo&&b.getForm().setValues({stanzaAdibita:"C"})},elimina_callback:function(){var c=b.getForm().findField("id").getValue();Ext.isEmpty(c)||controller_eliminaRecord(b.store,{id:c,codEnte:a.cbaConfig.codEnte?a.cbaConfig.codEnte:-1},function(){a.recordModificato=!0;a.aggiornaStore()})},verificaCampiForm_callback:function(){return a.verificaCampiForm()}}});inserisciBottoni(b.boxBottoni,c);b.boxBottoni.queryById("btnEsci").hide();
b.boxBottoni.queryById("btnNuovo").hide();if("L"!=b.permesso)b.getForm().on("dirtychange",function(c,e){controller_abilitaBottoni(b);a.cbaConfig.controllerTree.getTreeView().setDisabled(e)});"L"==b.permesso&&containerSolaLettura(a.getContainer())},aggiornaStore:function(a){var b=this,c=b.storeStanza,d=b.getFormStanza().getForm();b.cbaConfig.codiceStanza||a?c.load({params:{id:b.cbaConfig.codiceStanza?b.cbaConfig.codiceStanza:a,codEnte:b.cbaConfig.codEnte?b.cbaConfig.codEnte:-1},callback:function(c,
g,h){if(h){Ext.isEmpty(c)||(d.loadRecord(c[0]),c[0].get("codiceCda")&&d.setValues({descrizioneCodice:c[0].get("codiceCda")}));if(43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo)d.setValues({tipoContabilita:b.personContabili.tipoContabilitaAbilitata,idEsercizio:b.personContabili.idEsercizio}),b.cbaConfig.controllerTree.getTreeView().setDisabled(!1);b.recordModificato&&(b.recordModificato=!1,Ext.isEmpty(c)?b.cbaConfig.controllerTree.aggiornaStore(null,null,b.cbaConfig.codiceReparto):b.cbaConfig.controllerTree.aggiornaStore(null,
null,null,a))}else msgShowError("",g.getError())}}):b.cbaConfig.ContainerGestione.removeAll()},onLaunch:function(){this.storeStanza=Ext.create("Generali.sediReparti.store.Stanza");43==CBA.moduli.moduloAttivo||50==CBA.moduli.moduloAttivo?(this.getCntCda().setVisible(!0),Ext.apply(this.getCntCda().cbaConfig,{tipoContabilita:null}),this.personContabili=getPersonContabili(getIdOrg(),new Date,!0,null),this.getFormStanza().getForm().findField("cda").setReadOnly(!this.personContabili.vediCda)):this.getCntCda().setVisible(!1);
this.gestioneForm();this.cbaConfig.nuovoInserimento?(this.getBoxBottoni().queryById("btnNuovo").handler(),this.getCodiceSede().setValue(this.cbaConfig.codiceSede),this.getCodiceReparto().setValue(this.cbaConfig.codiceReparto)):this.aggiornaStore()},destroy:function(){eliminaStore(this.storeStanza)}});
Ext.define("Generali.sediReparti.store.CboxReparti",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagReparti/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.CboxSedi",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagSedi/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.CboxStanze",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagStanze/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.Letti",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codiceStanza"},{name:"codiceEnte"},{name:"numeroLetto"},{name:"descrizioneLetto"},{name:"classificazione"},{name:"classificazioneRegionale"},{name:"annullato"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagLetti/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anagLetti/list",create:"/cba/gen/ws/general/anagLetti/insert",update:"/cba/gen/ws/general/anagLetti/update",
destroy:"/cba/gen/ws/general/anagLetti/delete"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.Reparto",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"codiceSede"},{name:"codiceEnte"},{name:"codiceCdc"},{name:"descrizioneReparto"},{name:"annullato"},{name:"immagine"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagReparti/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anagReparti/get",create:"/cba/gen/ws/general/anagReparti/insert",update:"/cba/gen/ws/general/anagReparti/update",destroy:"/cba/gen/ws/general/anagReparti/delete"}},
autoDestroy:!0});
Ext.define("Generali.sediReparti.store.Sede",{extend:"Ext.data.Store",fields:[{name:"id"},{name:"idOrganizzazione"},{name:"codiceEnte"},{name:"codiceCda"},{name:"idCda"},{name:"annoCda"},{name:"desAnnoCda"},{name:"descrizioneSede"},{name:"annullato"},{name:"idEntePwd"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagSedi/get",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/anagSedi/get",create:"/cba/gen/ws/general/anagSedi/insert",update:"/cba/gen/ws/general/anagSedi/update",
destroy:"/cba/gen/ws/general/anagSedi/delete"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.SediReparti",{extend:"Ext.data.TreeStore",fields:[{name:"expanded"},{name:"iconCls"},{name:"idLetto"},{name:"idReparto"},{name:"idSede"},{name:"idStanza"},{name:"leaf"},{name:"nodeID"},{name:"text"},{name:"idOrganizzazione"},{name:"idCalc",convert:function(a,b){return b.get("idSede")+b.get("idReparto")+b.get("idStanza")}}],autoLoad:!1,root:{expanded:!1},proxy:{type:"ajax",url:"/cba/gen/ws/general/tree/sedeRepartoStanza",reader:{type:"json",messageProperty:"message",
rootProperty:"children"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.Stanza",{extend:"Ext.data.Store",fields:[{name:"codiceEnte"},{name:"codiceSede"},{name:"codiceReparto"},{name:"id"},{name:"idCda"},{name:"annoCda"},{name:"desAnnoCda"},{name:"codiceCda"},{name:"descrizioneStanza"},{name:"annullato"},{name:"numeroStanza"},{name:"numeroLetti"},{name:"stanzaAdibita"},{name:"conBagno"},{name:"coordinateX"},{name:"coordinateY"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/anagStanze/get",reader:{type:"json",messageProperty:"message",
rootProperty:"data"},api:{read:"/cba/gen/ws/general/anagStanze/get",create:"/cba/gen/ws/general/anagStanze/insert",update:"/cba/gen/ws/general/anagStanze/update",destroy:"/cba/gen/ws/general/anagStanze/delete"}},autoDestroy:!0});
Ext.define("Generali.sediReparti.store.stAdibita",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"descrizione",convert:function(a,b){return traduci(a)}}],data:[["C","ADIBITA_A_C"],["F","ADIBITA_A_F"],["M","ADIBITA_A_M"],["N","ADIBITA_A_N"],["A","ADIBITA_A_A"],["G","ADIBITA_A_G"]],autoDestroy:!0});
Ext.define("Generali.sediReparti.view.Letti",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridLetti",reference:"GridLetti",title:"GESTIONE_LETTI",flex:1,height:300,margin:"0 0 15 0",store:Ext.create("Generali.sediReparti.store.Letti"),columns:[{xtype:"gridcolumn",text:"NUM_LETTO",dataIndex:"numeroLetto",width:100,editor:{xtype:"textfield",allowBlank:!1,maxLength:10}},{xtype:"gridcolumn",text:"DESCRIZIONE_LETTO",dataIndex:"descrizioneLetto",
flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:50,enforceMaxLength:!0}},{xtype:"gridcolumn",width:80,align:"center",style:"text-align:center",dataIndex:"annullato",text:"ANNULLATO",renderer:function(a,b){renderCheckColumn(b,a)},editor:{xtype:"checkboxfield",inputValue:"T",uncheckedValue:"F"}}],viewConfig:{loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovoLetto",reference:"BtnNuovoLetto",
iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnEliminaLetto",reference:"BtnEliminaLetto",iconCls:"icon-eliminaGriglia",text:"Elimina"}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.sediReparti.view.Reparto",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",title:"GESTIONE_REPARTO",flex:1,items:[{xtype:"form",itemId:"FormReparto",reference:"FormReparto",trackResetOnLoad:!0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"codiceEnte"},{xtype:"textfield",hidden:!0,name:"codiceSede",itemId:"CodiceSede",reference:"CodiceSede"},
{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",labelWidth:150,maxLength:40,enforceMaxLength:!0,flex:1,itemId:"DescrizioneReparto",reference:"DescrizioneReparto",fieldLabel:"DESCRIZIONE_REPARTO",name:"descrizioneReparto",allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"ANNULLATO",inputValue:"T",uncheckedValue:"F",name:"annullato",cls:"cbaLabel"}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.sediReparti.view.Sede",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",title:"GESTIONE_SEDE",flex:1,items:[{xtype:"form",itemId:"FormSede",reference:"FormSede",trackResetOnLoad:!0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"codiceEnte"},{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",hidden:!0,name:"idOrganizzazione"},
{xtype:"textfield",labelWidth:150,maxLength:40,flex:1,itemId:"DescrizioneSede",reference:"DescrizioneSede",fieldLabel:"DESCRIZIONE_SEDE",name:"descrizioneSede",allowBlank:!1,enforceMaxLength:!0,labelClsExtra:"cbaLabel"},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"ANNULLATA",inputValue:"T",uncheckedValue:"F",name:"annullato",cls:"cbaLabel"},{xtype:"cda",annoData:"annoCda",labelWidth:100,width:500,margin:"0 0 0 80",hideCodice:!0,showDesCda:!0,
hideAnno:!1,itemId:"cntCda",reference:"cntCda",cbaConfig:{tipoContabilita:4,allowChangeAnno:!0}},{xtype:"textfield",hidden:!0,name:"idCda"},{xtype:"textfield",hidden:!0,name:"codiceCda"}]}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.sediReparti.view.SediReparti",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],layout:{type:"hbox",align:"stretch"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"treepanel",width:380,border:0,itemId:"TreeView",reference:"TreeView",store:Ext.create("Generali.sediReparti.store.SediReparti"),useArrows:!0,rootVisible:!1,animate:!0,viewConfig:{getRowClass:function(a,b,c,d){a.get("checked")&&a.set("checked",null);0==b&&a.set("text",
traduci("RESIDENZIALE"));return!0}},dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"NUOVO"},{xtype:"newButtonStampa",itemId:"BtnStampa",reference:"BtnStampa",text:"STAMPA",scale:"small",hidden:!0}]}]},{xtype:"splitter"},{xtype:"panel",itemId:"ContainerGestione",reference:"ContainerGestione",flex:1,autoScroll:!0,layout:{type:"vbox",align:"stretch"}}]});this.callParent(arguments)}});
Ext.define("Generali.sediReparti.view.Stanza",{extend:"Generali.standard.ControlledContainer",layout:{align:"stretch",type:"hbox"},initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",title:"GESTIONE_STANZA",flex:1,items:[{xtype:"form",itemId:"FormStanza",reference:"FormStanza",trackResetOnLoad:!0,bodyPadding:10,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",hidden:!0,name:"codiceEnte"},{xtype:"textfield",hidden:!0,name:"codiceSede",itemId:"CodiceSede",reference:"CodiceSede"},
{xtype:"textfield",hidden:!0,name:"codiceReparto",itemId:"CodiceReparto",reference:"CodiceReparto"},{xtype:"textfield",hidden:!0,name:"id"},{xtype:"textfield",labelWidth:150,maxLength:40,flex:1,enforceMaxLength:!0,itemId:"DescrizioneSede",reference:"DescrizioneSede",fieldLabel:"DESCRIZIONE_STANZA",name:"descrizioneStanza",allowBlank:!1,labelClsExtra:"cbaLabel"},{xtype:"combobox",fieldLabel:"ADIBITA_A",store:Ext.create("Generali.sediReparti.store.stAdibita"),labelWidth:150,queryMode:"local",displayField:"descrizione",
valueField:"codice",name:"stanzaAdibita",labelClsExtra:"cbaLabel"},{xtype:"textfield",labelWidth:150,flex:1,enforceMaxLength:!0,maxLength:5,itemId:"NumeroStanza",reference:"NumeroStanza",fieldLabel:"NUM_STANZA",name:"numeroStanza",labelClsExtra:"cbaLabel"},{xtype:"numberfield",labelWidth:150,flex:1,maxValue:32767,minValue:0,enforceMaxLength:!0,maxLength:5,allowDecimals:!1,fieldStyle:"text-align:left !important",itemId:"NumeroLetti",reference:"NumeroLetti",fieldLabel:"NUM_LETTI",allowBlank:50==CBA.moduli.moduloAttivo,
name:"numeroLetti",labelClsExtra:"cbaLabel",hidden:50==CBA.moduli.moduloAttivo},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"checkboxfield",fieldLabel:"",boxLabel:"CON_BAGNO",inputValue:"T",uncheckedValue:"F",name:"conBagno",cls:"cbaLabel",hidden:50==CBA.moduli.moduloAttivo},{xtype:"checkboxfield",fieldLabel:"",boxLabel:"ANNULLATA",inputValue:"T",uncheckedValue:"F",name:"annullato",cls:"cbaLabel"}]},{xtype:"cda",
annoData:"annoCda",labelWidth:100,width:500,margin:"0 0 0 75",hideCodice:!0,showDesCda:!0,hideAnno:!1,itemId:"cntCda",reference:"cntCda",cbaConfig:{tipoContabilita:4,allowChangeAnno:!0}},{xtype:"textfield",hidden:!0,name:"idCda"},{xtype:"textfield",hidden:!0,name:"codiceCda"}]}]}]},{xtype:"container",itemId:"BoxBottoni",reference:"BoxBottoni",width:120}]});this.callParent(arguments)}});
Ext.define("Generali.stampe.controller.StpClientiFornitori",{extend:"Generali.standard.stampe.Controller",parametriStampa:{},init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"TabPrincipale",selector:this.selContainer+"#TabPrincipale"},
{ref:"TbTabPrincipale",selector:this.selContainer+"#TbTabPrincipale"},{ref:"BtnAvanti",selector:this.selContainer+"#BtnAvanti"},{ref:"BtnIndietro",selector:this.selContainer+"#BtnIndietro"},{ref:"PageParametri",selector:this.selContainer+"#PageParametri"},{ref:"PageEtichette",selector:this.selContainer+"#PageEtichette"},{ref:"PageAnteprima",selector:this.selContainer+"#PageAnteprima"},{ref:"CBTipoStampa",selector:this.selContainer+"#CBTipoStampa"},{ref:"GridCliFor",selector:this.selContainer+"#GridCliFor"},
{ref:"LblSelettore",selector:this.selContainer+"#LblSelettore"},{ref:"CbxClienti",selector:this.selContainer+"#CbxClienti"},{ref:"CbxFornitori",selector:this.selContainer+"#CbxFornitori"},{ref:"CbxTutte",selector:this.selContainer+"#CbxTutte"},{ref:"GridCategorie",selector:this.selContainer+"#GridCategorie"},{ref:"CbxAttivi",selector:this.selContainer+"#CbxAttivi"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"},{ref:"CbxMovAnno",selector:this.selContainer+"#CbxMovAnno"}]);this.control(this.selContainer+
"#CBTipoStampa",{change:this.changeCBTipoStampa});this.control(this.selContainer+"#CbxClienti",{change:this.changeTipoClientiFornitori});this.control(this.selContainer+"#CbxFornitori",{change:this.changeTipoClientiFornitori});this.control(this.selContainer+"#GridCliFor",{selectionchange:this.CambioSelezioneGriglia});this.control(this.selContainer+"#GridCategorie",{selectionchange:this.cambioSelezioneGrigliaCat});this.control(this.selContainer+"#CbxAttivi",{change:this.changeCbxAttivi});this.control(this.selContainer+
"#CbxMovAnno",{change:this.changeCbxMovAnno});this.control(this.selContainer+"#CBEsercizio",{change:this.changeCBEsercizio})},changeCBEsercizio:function(a,b,c,d){a=this.storeCliFor.getProxy().extraParams;null!=b&&(Ext.apply(a,{idEsercizio:b}),this.storeCliFor.load())},changeCbxMovAnno:function(a,b,c,d){a=this.storeCliFor.getProxy().extraParams;b?(this.getCBEsercizio().setVisible(!0),Ext.apply(a,{flagMovimentatoEsercizio:getBoolValue(b),idEsercizio:this.getCBEsercizio().getValue()})):(this.getCBEsercizio().setVisible(!1),
delete a.flagMovimentatoEsercizio,delete a.idEsercizio);this.storeCliFor.load()},changeCBTipoStampa:function(a,b,c,d){"E"==b&&(this.cbaConfig.pageEtichette?tabPrincipale.items.get("PageEtichette").tab.show():tabPrincipale.remove(this.getPageEtichette()))},changeTipoClientiFornitori:function(a,b,c,d){a=this.getCbxClienti().getValue();b=this.getCbxFornitori().getValue();this.storeCliFor.getProxy();this.getGridCliFor().getSelectionModel().deselectAll();svuotaStore(this.storeCliFor);StdAmm.setValueNoEvent(this.getCbxAttivi(),
!1);this.getGridCategorie().getSelectionModel().deselectAll();this.storeCategCliFor.clearFilter();a&&this.storeCategCliFor.addFilter(this.filtroCatClienti);b&&this.storeCategCliFor.addFilter(this.filtroCatFornitori);this.getGridCategorie().bindStore(this.storeCategCliFor);c=null;if(a&&!b||!a&&b)c=a?"C":"F";this.storeCliFor.getProxy().extraParams={idOrganizzazione:this.idOrganizzazione,tipo:c};a=this.storeCliFor.getProxy().extraParams;this.getCbxMovAnno().getValue()?(this.getCBEsercizio().setVisible(!0),
Ext.apply(a,{flagMovimentatoEsercizio:getBoolValue(this.getCbxMovAnno().getValue()),idEsercizio:this.getCBEsercizio().getValue()})):(delete a.flagMovimentatoEsercizio,delete a.idEsercizio);this.storeCliFor.load();this.getGridCliFor().bindStore(this.storeCliFor);this.getGridCliFor().getView().getHeaderAtIndex(0).setText(traduci("RAGIONE_SOCIALE"))},changeCbxAttivi:function(a,b,c,d){var e=this.getCbxTutte().getValue(),g=this.getGridCliFor();a=this.storeCliFor.getProxy().extraParams;whenLoaded(this.storeCliFor,
function(a,b,c,d,n){if(c)g.getSelectionModel()[e?"selectAll":"deselectAll"]()},this);b?Ext.apply(a,{attivo:getBoolValue(b)}):delete a.attivo;this.storeCliFor.load()},cambioSelezioneGrigliaCat:function(a,b){var c=this.getCbxClienti().getValue(),d=this.getCbxFornitori().getValue(),e,g=[];e=$jscomp.makeIterator(b);for(var h=e.next();!h.done;h=e.next())g.push(h.value.get("codice"));e=null;if(c&&!d||!c&&d)e=c?"C":"F";this.storeCliFor.getProxy().extraParams={idOrganizzazione:this.idOrganizzazione,elencoCategorie:g.toString(),
tipo:e};this.storeCliFor.load()},changeCbxTutte:function(){var a=this.getCbxTutte().getValue(),b=this.getGridCliFor(),c=b.getSelectionModel(),d=this.getLblSelettore();a?(c.selectAll(),d.setText(b.getStore().getCount()+" "+traduci("ELEMENTI_SELEZIONATI"))):(c.deselectAll(),this.CambioSelezioneGriglia())},CambioSelezioneGriglia:function(a,b,c){c=this.getCbxTutte();var d=this.getLblSelettore();a=this.getGridCliFor();var e=a.getStore();a=a.getSelectionModel();b||(b=a.getSelection());e.isLoaded()&&c.setValue(e.getCount()===
b.length);d.setText(a.getCount()+" "+traduci("ELEMENTI_SELEZIONATI"))},verificaParametri:function(a){return this.getCbxTutte().getValue()||0!=this.getGridCliFor().getSelectionModel().getCount()?"pdf"!=a||(this.getTabPrincipale(),this.getPageEtichette().down().controller.verificaImpostazioniEtichette(traduci("IMPOSTAZIONI_ETICHETTE")))?!0:!1:(msgShowError("","SELEZIONARE_ALMENO_UN_ELEMENTO"),!1)},stampa:function(a){var b=this.cbaConfig;this.getTabPrincipale().getLayout();a={};Ext.apply(a,{idOrganizzazione:this.idOrganizzazione,
tipoStampa:this.getCBTipoStampa().getValue()});var c=this.getGridCliFor(),d=c.getStore(),e=[],c=c.getSelectionModel().getSelection();d.getTotalCount();this.getGridCategorie();d=$jscomp.makeIterator(c);for(c=d.next();!c.done;c=d.next())e.push(c.value.get("codice"));Ext.apply(a,{elencoIdCliFor:e.toString()});b=this.parametriStampa={url:this.cbaConfig.url,jsonData:b.jsonData?b.jsonData:null,titolo:b.titolo,renderTo:this.getPageAnteprima(),winElaborazione:this.cbaConfig.winElaborazione,params:{reportId:b.id}};
d=this.getPageEtichette();e=this.getPageEtichette().down("#abilitaFormModifica").getValue();c=d.down("#formEtichette");e||d.down("#abilitaFormModifica").setValue(!0);d=c.getValues();Ext.isEmpty(d.dimensioneCarattere)&&(d.dimensioneCarattere=10);e||this.getPageEtichette().down("#abilitaFormModifica").setValue(!1);for(var g in d)Ext.isEmpty(d[g])||(e={},Ext.apply(b.params,(e[g]=d[g],e)));Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&
Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params))},selezioneDatiEsportazione:function(a){return Ext.create("Ext.panel.Panel",{border:0,autoScroll:!0,flex:1,bodyPadding:10,layout:{align:"stretch",type:"hbox"},dockedItems:[{xtype:"toolbar",dock:"bottom",height:30,layout:{pack:"center"},items:[{xtype:"button",itemId:"BtnConferma",reference:"BtnConferma",iconCls:"icon-ok",text:traduci("CONFERMA"),handler:function(b,c){var d=b.up("panel").query("checkboxgroup")[0];if(d){for(var e={},d=$jscomp.makeIterator(d.getRefItems()),
g=d.next();!g.done;g=d.next()){var g=g.value,h={};Ext.apply(e,(h[g.name]=getBoolValue(g.getValue()),h))}a&&a(e)}b.up("window").close()}},{xtype:"tbspacer",width:30},{xtype:"button",itemId:"BtnEsci",reference:"BtnEsci",iconCls:"icon-esciGriglia",text:traduci("ANNULLA"),handler:function(a,c){a.up("window").close()}}]}],items:[{xtype:"checkboxgroup",columns:3,vertical:!0,defaults:{width:200},items:[{boxLabel:traduci("INDIRIZZO"),name:"visualizzaIndirizzo",cls:"cbaLabel",checked:!0},{boxLabel:traduci("CONTATTO"),
name:"visualizzaContatto",cls:"cbaLabel",checked:!0},{boxLabel:traduci("CONTABILITA"),name:"visualizzaContabilita",cls:"cbaLabel",checked:!0},{boxLabel:traduci("CONDIZIONE_DI_PAGAMENTO"),name:"visualizzaCondizionePag",cls:"cbaLabel",checked:!0},{boxLabel:traduci("CODICI_CIG_CUP"),name:"visualizzaCodiciCigCup",cls:"cbaLabel",checked:!0},{boxLabel:traduci("DURC"),name:"visualizzaDurc",cls:"cbaLabel",checked:!0},{boxLabel:traduci("FATTURAZIONE_ELETTRONICA"),name:"visualizzaFattElett",cls:"cbaLabel",
checked:!0},{boxLabel:traduci("LAVORO_AUTONOMO"),name:"visualizzaLavAutonomo",cls:"cbaLabel",checked:!0},{boxLabel:traduci("SPESOMETRO"),name:"visualizzaSpesometro",cls:"cbaLabel",checked:!0},{boxLabel:traduci("CERTIFICAZIONE_CREDITI"),name:"visualizzaCertCrediti",cls:"cbaLabel",checked:!0}]}]})},doPrint:function(a,b,c){var d=this;(void 0===c?0:c)?d.callParent([a,b]):d.verificaParametri(b)&&(d.stampa(b),"pdf"!=b?Ext.create("winCBA",{name:d.selezioneDatiEsportazione(function(c){Ext.apply(d.parametriStampa.params,
c);d.doPrint(a,b,!0)}),titolo:"PARAMETRI_STAMPA",closable:!0}).show():d.callParent([a,b]))},onLaunch:function(){var a=this,b=a.getTabPrincipale();a.idOrganizzazione=getIdOrg();getIdEsercizioDefaultByIdOrg(a.idOrganizzazione,function(b){setCombo(a.getCBEsercizio(),b)});a.storeCliFor=Ext.create("Generali.anaCliFor.store.cboxAnaCliFor",{autoLoad:!1,autoDestroy:!1});a.storeCategCliFor=Ext.create("Generali.catCliFor.store.cboxCatCliFor");a.storeCategCliFor.load({params:{idOrganizzazione:a.cbaConfig.idOrganizzazione}});
a.getGridCategorie().bindStore(a.storeCategCliFor);a.filtroCatClienti=new Ext.util.Filter({filterFn:function(a){return"F"!=a.get("extra")}});a.filtroCatFornitori=new Ext.util.Filter({filterFn:function(a){return"C"!=a.get("extra")}});a.cbaConfig.pageParametri?b.items.get("PageParametri").tab.show():b.remove(a.getPageParametri());setCombo(a.getCBTipoStampa(),"E");a.CambioSelezioneGriglia();a.getCbxTutte().setValue(!1);a.changeTipoClientiFornitori();var c=a.getTabPrincipale().items.getCount();a.getBtnAvanti().setVisible(2<
c);a.getBtnIndietro().setVisible(2<c);if(1==c||a.cbaConfig.eseguiStampa)b=b.down("#BtnStampa"),a.doPrint(b)},destroy:function(){eliminaStore(this.storeCliFor);this.callParent()}});
Ext.define("Generali.stampe.controller.StpPianoDeiConti",{extend:"Generali.standard.stampe.Controller",init:function(){this.selContainer="#"+this.containerId+" ";this.cbaConfig.configBtnStampa&&(Ext.applyIf(this.parametriStampa,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(this.parametriStampa.params,this.cbaConfig.configBtnStampa.params));this.callParent(arguments);this.addRef([{ref:"TabPrincipale",selector:this.selContainer+"#TabPrincipale"},{ref:"BtnAvanti",
selector:this.selContainer+"#BtnAvanti"},{ref:"BtnIndietro",selector:this.selContainer+"#BtnIndietro"},{ref:"PageParametri",selector:this.selContainer+"#PageParametri"},{ref:"PageAnteprima",selector:this.selContainer+"#PageAnteprima"},{ref:"CBEsercizio",selector:this.selContainer+"#CBEsercizio"},{ref:"CBTipoStampa",selector:this.selContainer+"#CBTipoStampa"},{ref:"CbxNonAbbinati",selector:this.selContainer+"#CbxNonAbbinati"}]);this.control(this.selContainer+"#CBTipoStampa",{change:this.changeCBTipoStampa})},
configStampa:function(a,b,c){var d=!1;Ext.Ajax.request({method:"GET",url:"/cba/gen/ws/general/menuItem/src/byPrj",async:!1,params:{idModulo:a,codEnte:b,progetto:c},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?d=a.data[0]:(d=!1,msgShowError("",a.message))}});return d},changeCBTipoStampa:function(a,b,c,d){if(!b)return!1;this.getCbxNonAbbinati().setVisible("C"===b)},stampa:function(){var a=this.getCBTipoStampa(),b=this.cbaConfig,c={};Ext.apply(c,{idOrganizzazione:this.idOrganizzazione,
idEsercizio:this.getCBEsercizio().getValue()});if("B"!=a.getValue())Ext.apply(c,{tipoStampa:a.getValue()}),this.getCbxNonAbbinati().isVisible()&&Ext.apply(c,{soloNonAbbinatiCda:getBoolValue(this.getCbxNonAbbinati().getValue())});else if(b=this.configStampa(CBA.moduli.moduloAttivo,CBA.parametriGenerali.codEnte,"GEN_AttPrimaria"),!b)return!1;a=this.parametriStampa={url:b.url,jsonData:b.jsonData,titolo:b.titolo,renderTo:this.getPageAnteprima(),winElaborazione:b.winElaborazione,params:{reportId:b.id}};
Ext.apply(a.params,c);this.cbaConfig.configBtnStampa&&(Ext.applyIf(a,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(a.params,this.cbaConfig.configBtnStampa.params));return!0},doPrint:function(a,b){this.stampa()&&this.callParent([a,b])},onLaunch:function(){var a=this,b=a.getTabPrincipale();a.idOrganizzazione=getIdOrg();getIdEsercizioDefaultByIdOrg(a.idOrganizzazione,function(b){setCombo(a.getCBEsercizio(),b)});a.cbaConfig.pageParametri?b.items.get("PageParametri").tab.show():
b.remove(a.getPageParametri());b.queryById("BtnStampa").setWidth(114);b.queryById("BtnStampa").setTextAlign("left");var c=a.getTabPrincipale().items.getCount(),d=1===c;a.getBtnAvanti().setVisible(2<c);a.getBtnIndietro().setVisible(2<c);if(d||a.cbaConfig.eseguiStampa)b=b.down("#BtnStampa"),a.doPrint(b)}});Ext.define("Generali.stampe.store.CboxTipoStampaClientiFornitori",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"}],data:[{valore:"Etichette",codice:"E"}],autoDestroy:!0});
Ext.define("Generali.stampe.view.StpClientiFornitori",{extend:"Generali.standard.ControlledContainer",requires:["Generali.stampe.controller.StpClientiFornitori"],uses:["Ext.selection.CheckboxModel","Generali.standard.stampe.Button","Generali.anaCliFor.store.cboxAnaCliFor"],initComponent:function(){var a=this;Ext.applyIf(a,{items:[{xtype:"stampaCBA",useNewButtonStampa:!0,border:0,itemId:"TabPrincipale",reference:"TabPrincipale",items:[{xtype:"panel",tabConfig:{title:"PARAMETRI_GENERALI",height:44},
itemId:"PageParametri",reference:"PageParametri",hidden:!1,layout:{align:"stretch",type:"hbox"},bodyPadding:5,title:"",items:[{xtype:"container",nonDisabilitare:!0,scrollable:!0,border:0,flex:1,layout:{type:"hbox"},items:[{xtype:"container",width:300,layout:{align:"stretch",type:"vbox"},items:[{xtype:"fieldset",title:"PARAMETRI",padding:2,height:50,items:[{xtype:"combobox",itemId:"CBTipoStampa",reference:"CBTipoStampa",hidden:!1,editable:!1,allowBlank:!1,fieldLabel:"TIPO_STAMPA",labelWidth:80,width:250,
displayField:"valore",labelAlign:"left",valueField:"codice",queryMode:"local",store:Ext.create("Generali.stampe.store.CboxTipoStampaClientiFornitori",{autoLoad:!0}),labelClsExtra:"cbaLabel"}]}]},{xtype:"container",width:400,margin:"0 0 0 15",items:[{xtype:"fieldset",title:"TIPO",padding:2,border:0,maxHeight:600,items:[{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"checkboxfield",flex:1,checked:!0,itemId:"CbxClienti",reference:"CbxClienti",cls:"cbaLabel",fieldLabel:"",boxLabel:"CLIENTI",
inputValue:"T",uncheckedValue:"F"},{xtype:"checkboxfield",flex:2,checked:!0,itemId:"CbxFornitori",reference:"CbxFornitori",cls:"cbaLabel",fieldLabel:"",boxLabel:"FORNITORI",inputValue:"T",uncheckedValue:"F"}]},{xtype:"container",layout:{align:"stretch",type:"hbox"},items:[{xtype:"combobox",itemId:"CBEsercizio",reference:"CBEsercizio",fieldLabel:"ESERCIZIO",displayField:"valore",labelWidth:50,valueField:"codice",minChars:0,allowBlank:!1,hidden:!0,store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont",
{autoLoad:!1}),flex:1,queryMode:"local"},{xtype:"checkboxfield",checked:!1,itemId:"CbxMovAnno",reference:"CbxMovAnno",cls:"cbaLabel",fieldLabel:"",boxLabel:"MOVIMENTATI_ESERCIZIO",inputValue:"T",uncheckedValue:"F"}]},{xtype:"gridpanel",border:0,selModel:Ext.create("Ext.selection.CheckboxModel"),itemId:"GridCategorie",reference:"GridCategorie",hideHeaders:!0,maxHeight:125,flex:1,columns:[{xtype:"gridcolumn",dataIndex:"valore",flex:1,sortable:!1,align:"left"}]},{xtype:"container",layout:"column",flex:1,
items:[{xtype:"checkboxfield",boxLabel:"SELEZIONA_TUTTI",inputValue:"T",uncheckedValue:"F",margin:"auto 10 auto auto",flex:1,itemId:"CbxTutte",reference:"CbxTutte",listeners:{afterrender:function(b,c){b.getEl().on("click",Ext.bind(a.controller.changeCbxTutte,a.controller))}}},{xtype:"checkboxfield",boxLabel:traduci("SOLO_ANAGRAFICHE_ATTIVE"),inputValue:"T",uncheckedValue:"F",flex:1,itemId:"CbxAttivi",reference:"CbxAttivi"}]},{xtype:"gridpanel",selModel:Ext.create("Ext.selection.CheckboxModel"),border:0,
itemId:"GridCliFor",reference:"GridCliFor",hideHeaders:!0,height:390,flex:1,columns:[{xtype:"gridcolumn",text:"RAGIONE_SOCIALE",dataIndex:"valore",flex:1,sortable:!1,align:"left"}],viewConfig:{loadMask:!1,preserveScrollOnRefresh:!0,forceFit:!1},dockedItems:[{xtype:"textfield",dock:"top",border:0,itemId:"TxtCerca",reference:"TxtCerca",flex:1,fieldLabel:"",emptyText:"CERCA",listeners:{change:{fn:a.onTextfieldChange,scope:a}}},{xtype:"label",border:0,dock:"bottom",itemId:"LblSelettore",reference:"LblSelettore"}]}]}]}]}]},
{xtype:"panel",itemId:"PageEtichette",reference:"PageEtichette",tabConfig:{title:"IMPOSTAZIONI_ETICHETTE",height:44},layout:{align:"stretch",type:"vbox"},items:Ext.create("Generali.etichette.view.EtichetteGen",{flex:1,cbaConfig:{personalizzazioni:!1}})}]}]});a.callParent(arguments)},onTextfieldChange:function(a,b,c,d){var e=this;setTaskField(a,function(){var b=a.up("gridpanel"),c=b.getStore();c.clearFilter();c.filter(function(c){var d=!1,e=c.get("valore");e&&0<=e.toUpperCase().indexOf(a.getValue().toUpperCase())&&
(d=!0);d||b.getSelectionModel().isSelected(c)&&(d=!0);return d});e.controller.CambioSelezioneGriglia();a.focus()},200)}});
Ext.define("Generali.stampe.view.StpPianoDeiConti",{extend:"Generali.standard.ControlledContainer",requires:["Generali.stampe.controller.StpPianoDeiConti"],uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"stampaCBA",useNewButtonStampa:!0,border:0,itemId:"TabPrincipale",reference:"TabPrincipale",items:[{xtype:"panel",tabConfig:{title:"PARAMETRI_GENERALI",height:44},itemId:"PageParametri",reference:"PageParametri",layout:{align:"stretch",type:"vbox"},
bodyPadding:5,items:[{xtype:"container",flex:1,maxWidth:380,items:[{xtype:"fieldset",title:"PERIODO",items:[{xtype:"combobox",itemId:"CBEsercizio",reference:"CBEsercizio",store:Ext.create("Generali.esercizioCont.store.cboxEsercizioCont",{autoLoad:!0}),labelWidth:80,width:365,fieldLabel:"ESERCIZIO",labelClsExtra:"cbaLabel",displayField:"valore",valueField:"codice",queryMode:"local"}]},{xtype:"fieldset",title:"PARAMETRI",items:[{xtype:"combobox",itemId:"CBTipoStampa",reference:"CBTipoStampa",labelClsExtra:"cbaLabel",
fieldLabel:"TIPO_STAMPA",labelWidth:80,width:365,displayField:"valore",valueField:"codice",queryMode:"local",store:Ext.create("Ext.data.ArrayStore",{fields:[{name:"codice"},{name:"valore"}],data:[["A",traduci("ALBERO")],["B",traduci("ATTRIBUZIONE_PRIMARIA")],["C",traduci("CONTI_OBBLIGO_CDA")]],autoLoad:!0,autoDestroy:!0}),listeners:{afterrender:function(a,b){a.setValue(a.getStore().getAt(0))}}},{xtype:"checkboxfield",itemId:"CbxNonAbbinati",reference:"CbxNonAbbinati",boxLabel:"SOLO_CONTI_NON_MOVIMENTATI",
cls:"cbaLabel",hidden:!0}]}]}]}]}]});this.callParent(arguments)}});Ext.define("Generali.store.AliquotaIva",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/aliqiva/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Articolo",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore",convert:function(a,b){if(b.get("codice"))return b.get("codice")+" - "+a}},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/articl/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Capitolo",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/capitl/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Categoria",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/catPgn/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.store.CategoriaEntePrevidenziale",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/entePrevidenziale/categoria/cbox"}});
Ext.define("Generali.store.CausaleContabilita",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/general/causali/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.CausaliLavoroAutonomo",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"},{name:"clcDescrizione",convert:function(a,b){return b.get("codice")+" - "+b.get("valore")}}],proxy:{type:"ajax",url:"/cba/gen/ws/general/causaleLavoroAutonomo/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.store.CboxModelliFattura",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/osp/co/ws/rette/modfatt/list"}});
Ext.define("Generali.store.CboxPersonalizzazioni",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/osp/co/ws/rette/perste/list"}});Ext.define("Generali.store.CodiceAltreSomme",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/codiceAltreSommeNonSoggette/cbox"},autoLoad:!0});Ext.define("Generali.store.CodiceValoreExtra",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],autoDestroy:!0});
Ext.define("Generali.store.CondizioniPagamento",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"gruppo"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/condpag/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},params:{leggiTabellaNuova:!1},autoDestroy:!0});
Ext.define("Generali.store.Conto",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/conto/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.store.DebitoCredito",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"}],data:[["D","Debito"],["C","Credito"]],autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.ElencoCausali",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/osp/co/ws/general/causali/byTipiDoc/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},params:{},autoDestroy:!0});Ext.define("Generali.store.EntePrevidenziale",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/entePrevidenziale/cbox"},autoLoad:!0});
Ext.define("Generali.store.Euro",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"}],data:[["I",decodeTipoQuota("I")]],autoLoad:!0,autoDestroy:!0});Ext.define("Generali.store.EuroPerc",{extend:"Generali.store.Euro",data:[["P",decodeTipoQuota("P")],["I",decodeTipoQuota("I")]]});Ext.define("Generali.store.EuroPercMese",{extend:"Generali.store.EuroPerc",data:[["P",decodeTipoQuota("P")],["G",decodeTipoQuota("G",!0)],["M",decodeTipoQuota("M",!0)],["T",decodeTipoQuota("T",!0)]]});
Ext.define("Generali.store.FormaFarmaceutica",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",method:"GET",url:"/cba/css/cs/ws/farmaci/formaFarma/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Franchigia",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",urlGen:"/ws/genOsp/prszn/franc/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.store.FranchigiaTipoCalcolo",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"}],data:[["C","Continuativo"],["M","Mensile"],["S","A soglia"]],autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.GiornoSettimana",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/calendar/weekday/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.Mesi",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore",convert:function(a,b){return traduci(Ext.Date.monthNames[b.get("codice")-1])}},{name:"extra",convert:function(a,b){return traduci(Ext.Date.monthNames[b.get("codice")-1].substr(0,3))}}],data:[[1,"GENNAIO","GEN"],[2,"FEBBRAIO","FEB"],[3,"MARZO","MAR"],[4,"APRILE","APR"],[5,"MAGGIO","MAG"],[6,"GIUGNO","GIU"],[7,"LUGLIO","LUG"],[8,"AGOSTO","AGO"],[9,"SETTEMBRE","SET"],[10,"OTTOBRE","OTT"],[11,"NOVEMBRE",
"NOV"],[12,"DICEMBRE","DIC"]],autoLoad:!0,autoDestroy:!0});Ext.define("Generali.store.NumGiornoSettimana",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/calendar/numweekday/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.Organizzazioni",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/org/loggedUser/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.PermessiVideateGen",{extend:"Ext.data.Store",fields:[{name:"codModulo",convert:function(a,b){return b.get("codice")}},{name:"codVideata",convert:function(a,b){return b.get("valore")}},{name:"permesso",convert:function(a,b){return b.get("extra")}}],proxy:{type:"ajax",url:"/cba/gen/ws/pwd/videatepwd/permessiVideateGen",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Regione",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/regioni/cbox"},autoLoad:!0});Ext.define("Generali.store.Registro",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",urlGen:"/ws/genOsp/regstr/src",url:"/cba/osp/co/ws/genOsp/regstr/src",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.store.Sesso",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore",convert:function(a,b){return traduci(a)}}],data:[["M","MASCHIO"],["F","FEMMINA"]],autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.TabProcedura",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],data:[[1,"PROCEDURA APERTA"],[2,"PROCEDURA RISTRETTA"],[3,"PROCEDURA NEGOZIATA PREVIA PUBBLICAZIONE"],[4,"PROCEDURA NEGOZIATA SENZA PREVIA PUBBLICAZIONE"],[5,"DIALOGO COMPETITIVO"],[6,"PROCEDURA NEGOZIATA SENZA PREVIA INDIZIONE DI GARA (SETTORI SPECIALI)"],[7,"SISTEMA DINAMICO DI ACQUISIZIONE"],[8,"AFFIDAMENTO IN ECONOMIA COTTIMO FIDUCIARIO"],[14,"PROCEDURA SELETTIVA EX ART 238 C.7, D.LGS. 163/2006"],
[17,"AFFIDAMENTO DIRETTO EX ART. 5 DELLA LEGGE 381/91"],[21,"PROCEDURA RISTRETTA DERIVANTE DA AVVISI CON CUI SI INDICE LA GARA"],[22,"PROCEDURA NEGOZIATA CON PREVIA INDIZIONE DI GARA (SETTORI SPECIALI)"],[23,"AFFIDAMENTO DIRETTO"],[24,"AFFIDAMENTO DIRETTO A SOCIETA IN HOUSE"],[25,"AFFIDAMENTO DIRETTO A SOCIETA RAGGRUPPATE/CONSORZIATE O CONTROLLATE NELLE CONCESSIONI E NEI PARTENARIATI"],[26,"AFFIDAMENTO DIRETTO IN ADESIONE AD ACCORDO QUADRO/CONVENZIONE"],[27,"CONFRONTO COMPETITIVO IN ADESIONE AD ACCORDO QUADRO/CONVENZIONE"],
[28,"PROCEDURA AI SENSI DEI REGOLAMENTI DEGLI ORGANI COSTITUZIONALI"],[29,"PROCEDURA RISTRETTA SEMPLIFICATA"],[30,"PROCEDURA DERIVANTE DA LEGGE REGIONALE"],[31,"AFFIDAMENTO DIRETTO PER VARIANTE SUPERIORE AL 20% DELL IMPORTO CONTRATTUALE"],[32,"AFFIDAMENTO RISERVATO"],[33,"PROCEDURA NEGOZIATA PER AFFIDAMENTI SOTTO SOGLIA"],[34,"PROCEDURA ART.16 COMMA 2-BIS DPR 380/2001 PER OPERE URBANIZZAZIONE A SCOMPUTO PRIMARIE SOTTO SOGLIA COMUNITARIA"],[35,"PARTERNARIATO PER L INNOVAZIONE"],[36,"AFFIDAMENTO DIRETTO PER LAVORI, SERVIZI O FORNITURE SUPPLEMENTARI"],
[37,"PROCEDURA COMPETITIVA CON NEGOZIAZIONE"],[38,"PROCEDURA DISCIPLINATA DA REGOLAMENTO INTERNO PER SETTORI SPECIALI"]],autoLoad:!0,autoDestroy:!0});Ext.define("Generali.store.TipoDocRette",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/osp/co/cnt/tipiDocRette/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},params:{soloTipiGenerici:!1},sorters:[{property:"valore",direction:"ASC"}],autoDestroy:!0});
Ext.define("Generali.store.Trimestri",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore",convert:function(a,b){return traduci(a)}}],data:[[1,"TRIMESTRE1"],[2,"TRIMESTRE2"],[3,"TRIMESTRE3"],[4,"TRIMESTRE4"]],autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.UnitaMisuraCombo",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/unimis/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});Ext.define("Generali.store.cboxMesi",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/calendar/month/cbox"},autoLoad:!0,autoDestroy:!0});
Ext.define("Generali.store.cboxTipoCompetenza",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/tipoCompetenza/cbox"},autoDestroy:!0});Ext.define("Generali.store.cboxTipoDocumentoEconomica",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/tipoDocumentoEconomica/cbox",reader:{type:"json"}},autodestroy:!0});
Ext.define("Generali.store.cboxTrimestri",{extend:"Generali.data.StoreCodiceValore",proxy:{url:"/cba/gen/ws/general/calendar/quarters/cbox"},autoLoad:!0,autoDestroy:!0});Ext.define("Generali.tributi.store.cboxTributi",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/tributi/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.unitaMisura.controller.UniMis",{extend:"Generali.standard.stampe.Controller",parametriStampa:{hideMenu:!0,params:{}},init:function(){this.selContainer="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridUniMis",selector:this.selContainer+"#GridUniMis"},{ref:"BtnNuovo",selector:this.selContainer+"#BtnNuovo"},{ref:"BtnElimina",selector:this.selContainer+"#BtnElimina"},{ref:"ColUdmSomm",selector:this.selContainer+"#ColUdmSomm"}]);this.control(this.selContainer+
"#GridUniMis",{beforeedit:this.beforeeditGridUniMis,edit:this.editGridUniMis,canceledit:this.canceleditGridUniMis,validateedit:this.validateeditGridUniMis});this.control(this.selContainer+"#BtnNuovo",{click:this.clickBtnNuovo});this.control(this.selContainer+"#BtnElimina",{click:this.clickBtnElimina})},clickBtnNuovo:function(a){controller_nuovoRecordGrid({id:null},this.getGridUniMis())},clickBtnElimina:function(a){var b=this;a=b.getGridUniMis();var c=a.getSelectionModel().getSelection()[0];controller_eliminaRecord(a.getStore(),
{id:c?c.get("id"):""},function(){b.aggiornaStore()})},beforeeditGridUniMis:function(a,b,c){if(!0===a.editing)return!1;this.abilitaBottoniGrid(!1)},abilitaBottoniGrid:function(a){this.getBtnNuovo().setDisabled(!a);this.getBtnElimina().setDisabled(!a)},editGridUniMis:function(a,b,c){c=b.record.getData();var d=a.getEditor().getForm();d.controller=this;d.store=b.view.getStore();controller_salvaRecord(d,c,!1,{forzaRegistrazione:!1})?this.abilitaBottoniGrid(!0):a.startEdit(b.record,0)},canceleditGridUniMis:function(a,
b,c){this.abilitaBottoniGrid(!0);this.aggiornaStore(b.record.get("id"))},validateeditGridUniMis:function(a,b,c){return msgShow("",[])},stampa:function(){var a={},b=this.cbaConfig.winElaborazione;b&&"string"===typeof b&&(this.cbaConfig.winElaborazione=b===(!0).toString());Ext.apply(a,{codEnte:CBA.parametriGenerali.codEnte});Ext.apply(this.parametriStampa,{url:this.cbaConfig.url,jsonData:this.cbaConfig.jsonData,titolo:this.cbaConfig.titolo,winElaborazione:this.cbaConfig.winElaborazione,params:{reportId:this.cbaConfig.idRecord}});
b=this.parametriStampa;Ext.apply(b.params,a);this.cbaConfig.configBtnStampa&&(Ext.applyIf(b,this.cbaConfig.configBtnStampa),this.cbaConfig.configBtnStampa.params&&Ext.applyIf(b.params,this.cbaConfig.configBtnStampa.params))},doPrint:function(a,b){this.stampa();this.callParent([a,b])},aggiornaStore:function(a){var b=this.getGridUniMis(),c=b.getStore();c.load({params:{descrizione:""},callback:function(d,e,g){g?(d=null,a&&(d=trovaRecord(c,"id",a)),b.getSelectionModel().deselectAll(),b.getSelectionModel().select(d?
[d]:0)):msgShowError("",e.getError())}})},svuotaStore:function(){svuotaStore(this.getGridUniMis().getStore())},onLaunch:function(){!StdSipcar.isValidID(this.cbaConfig.idRecord)&&StdSipcar.isValidID(this.cbaConfig.id)&&(this.cbaConfig.idRecord=this.cbaConfig.id);var a=57==CBA.moduli.moduloAttivo||62==CBA.moduli.moduloAttivo;this.getColUdmSomm().setVisible(a);this.getGridUniMis().controller=this;this.getBtnStampa().setVisible(!Ext.isEmpty(this.cbaConfig.url));this.aggiornaStore()}});
Ext.define("Generali.unitaMisura.store.CboxUniMisAbbr",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/unimis/cboxAbbr",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.unitaMisura.store.UnitaMisura",{extend:"Ext.data.Store",fields:[{name:"codEnte"},{name:"id"},{name:"descrizione"},{name:"sigla"},{name:"codUniMisBDF"},{name:"uniMisEsclusa"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/unimis/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"},api:{read:"/cba/gen/ws/general/unimis/list",create:"/cba/gen/ws/general/unimis/insert",update:"/cba/gen/ws/general/unimis/update",destroy:"/cba/gen/ws/general/unimis/delete"}},autoDestroy:!0});
Ext.define("Generali.unitaMisura.store.UnitaMisuraCbox",{extend:"Ext.data.Store",fields:[{name:"codice"},{name:"valore"},{name:"extra"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/unimis/cbox",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.unitaMisura.view.UniMis",{extend:"Generali.standard.ControlledContainer",uses:["Generali.standard.stampe.Button"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"gridpanel",itemId:"GridUniMis",reference:"GridUniMis",store:Ext.create("Generali.unitaMisura.store.UnitaMisura"),columns:[{xtype:"gridcolumn",text:"DESCRIZIONE",dataIndex:"descrizione",flex:1,editor:{xtype:"textfield",allowBlank:!1,maxLength:30,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"SIGLA",width:80,
dataIndex:"sigla",editor:{xtype:"textfield",allowBlank:!1,maxLength:3,enforceMaxLength:!0}},{xtype:"gridcolumn",text:"UM_SOMM",width:250,dataIndex:"codUniMisBDF",itemId:"ColUdmSomm",reference:"ColUdmSomm",editor:{xtype:"combobox",displayField:"valore",allowBlank:!0,queryMode:"local",valueField:"valore",store:Ext.create("Generali.unitaMisura.store.CboxUniMisAbbr",{autoLoad:!0})}}],viewConfig:{width:300,loadMask:!1},plugins:[Ext.create("Ext.grid.plugin.RowEditing",{autoCancel:!1,errorSummary:!1})],
dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",itemId:"BtnNuovo",reference:"BtnNuovo",iconCls:"icon-inserisciGriglia",text:"Nuovo"},{xtype:"button",itemId:"BtnElimina",reference:"BtnElimina",iconCls:"icon-eliminaGriglia",text:"Elimina"},{xtype:"newButtonStampa",itemId:"BtnStampa",reference:"BtnStampa",text:"STAMPA",scale:"small",hidden:!0},{xtype:"textfield",itemId:"TxtCerca",reference:"TxtCerca",width:200,fieldLabel:"",emptyText:"CERCA",listeners:{change:{fn:this.onTextfieldChange,
scope:this}}}]}]}]});this.callParent(arguments)},onTextfieldChange:function(a,b,c,d){setTaskField(a,function(){var b=a.up("gridpanel").getStore();b.clearFilter();b.filter(function(b){var c=!1;(b=b.get("descrizione"))&&0<=b.toUpperCase().indexOf(a.getValue().toUpperCase())&&(c=!0);return c});a.focus()})}});
Ext.define("Generali.utility.controller.DatiExp",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"BtnElabora",selector:a+"#BtnElabora"}]);this.control(a+"#BtnElabora",{click:this.clickBtnElabora})},clickBtnElabora:function(a,b,c){b="";c=!1;switch(this.type){case 40:b="/cba/per/prz/ws/ptl/reset/mail";break;case 41:b="/cba/per/prz/ws/general/sync/trn1";break;case 42:b="/cba/per/prz/ws/general/crea/cmpexp";break;case 43:c=
!0;b="/cba/per/prz/ws/tracciati/crea/cmpexp";break;case 44:b="/cba/per/prz/ws/general/crea/expBI";break;case 45:b="/cba/per/prz/ws/general/crea/mobw";break;case 46:b="/cba/per/prz/ws/general/abilita/trcgg"}c?stampaEsporta(a,{url:b,params:{}},function(a){}):Ext.Ajax.request({method:"GET",url:b,params:{idGroup:getIdGruppo()},success:function(a){a=Ext.JSON.decode(a.responseText);a.success?Messaggio("ELABORAZIONE",a.message[0].testo,"OK"):msgShowError("",a.message)}})},onLaunch:function(){},destroy:function(){this.callParent()}});
Ext.define("Generali.utility.controller.Log",{extend:"Generali.standard.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.addRef([{ref:"GridFiles",selector:a+"#GridFiles"},{ref:"BtnCerca",selector:a+"#BtnCerca"},{ref:"NumRighe",selector:a+"#NumRighe"},{ref:"TxtLog",selector:a+"#TxtLog"}]);this.control(a+"#BtnCerca",{click:this.clickBtnCerca});this.control(a+"#GridFiles",{select:this.selectGridFiles})},loadFileLog:function(){var a=this,b=a.getGridFiles().getSelectionModel().getSelection()[0],
c=a.getNumRighe().getValue();b&&this.storeRigheFile.load({params:{logFileName:b.get("fileName"),linesNum:0<c?c:100},callback:function(b,c,g){g?Ext.isEmpty(b)?a.getTxtLog().setValue(""):(b=b[0].get("text"),b=b.replace(/<br>/gi,"\n"),a.getTxtLog().setValue(b)):msgShowError("",c.getError())}})},selectGridFiles:function(){this.loadFileLog()},clickBtnCerca:function(){this.loadFileLog()},onLaunch:function(){var a=this;CBA.parametriGenerali.produzione&&"T"!==CBA.parametriGenerali.amministratore&&Ext.widget("passwordCBA",
{avvisaPasswordCorretta:!1,callBackSbloccoPwd:function(b){b||a.getView().destroy()}}).show();this.storeRigheFile=Ext.create("Generali.utility.store.RigheFile")},destroy:function(){eliminaStore(this.storeRigheFile);this.callParent()}});
Ext.define("Generali.utility.controller.Utility",{extend:"Ext.app.ViewController",init:function(){var a="#"+this.containerId+" ";this.callParent(arguments);this.control(a+"#CBUtility",{select:this.selectCBUtility})},selectCBUtility:function(a,b){var c=this.lookupReference("PnlDati");if(a){c.setTitle(a.getDisplayValue());var d;switch(a.getValue()){case 1:d="Generali.utility.view.Log";break;case 2:d="Generali.organizzazioni.view.PersonAdHoc";break;case 3:d="Generali.imports.view.ImportBancheSportelli";
break;case 10:d="Generali.fatturazioneElettronica.view.FEProtocollazioneMassiva";break;case 11:d="CP.importExport.view.ImportAnagClientiFornitori";break;case 12:d="CP.importExport.view.ImportFatture";break;case 13:d="CP.importExport.view.ImportStipendi";break;case 14:d="CP.utilita.view.InizializzaAnagrafiche";break;case 40:d="Generali.utility.view.DatiExp";break;case 41:d="Generali.utility.view.DatiExp";break;case 42:d="Generali.utility.view.DatiExp";break;case 43:d="Generali.utility.view.DatiExp";
break;case 44:d="Generali.utility.view.DatiExp";break;case 45:d="Generali.utility.view.DatiExp";break;case 46:d="Generali.utility.view.DatiExp"}c.removeAll();c.add(Ext.create(d,{type:a.getValue()}));c.show()}else c.hide()},onLaunch:function(){}});
Ext.define("Generali.utility.store.FilesLog",{extend:"Ext.data.Store",fields:[{name:"fileName"},{name:"isFileDirectory"},{name:"bytes"},{name:"executable"},{name:"readable"},{name:"writable"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/logFiles/list",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.utility.store.RigheFile",{extend:"Ext.data.Store",fields:[{name:"fileName"},{name:"linesNum"},{name:"text"}],proxy:{type:"ajax",url:"/cba/gen/ws/general/logFiles/less",reader:{type:"json",messageProperty:"message",rootProperty:"data"}},autoDestroy:!0});
Ext.define("Generali.utility.store.Utility",{extend:"Ext.data.ArrayStore",fields:[{name:"codice"},{name:"valore"}],data:[[1,"[Generali] - Lettura files di log / conf"],[2,"[Generali] - Gestione voci menu"],[3,"[Generali] - Importazione Banche e Sportelli"],[14,"[Amministrazione] - Pre-caricamento Anagrafiche di base"],[10,"[Amministrazione] - Protocollazione massiva fatture elettroniche passive"],[11,"[Amministrazione] - Importazione anagrafiche Clienti/Fornitori"],[12,"[Amministrazione] - Importazione Fatture Fornitore"],
[13,"[Amministrazione] - Importazione Stipendi in Prima Nota"],[40,"[Presenze] Imposta mail a testingpresenze@cba.it"],[41,"[Presenze] Allinea tabelle per Turni"],[43,"[Presenze] LUL: crea file raccordo giustificativi"],[45,"[Presenze] MOBWORK: imposta"],[46,"[Presenze] Attiva Tracciato Giornaliero"],[47,"[Economato] - FormIO"]],autoDestroy:!0});
Ext.define("Generali.utility.view.DatiExp",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",heigh:100,margin:"20 20 20 20",items:[{xtype:"button",itemId:"BtnElabora",reference:"BtnElabora",iconCls:"icon-elabora32",scale:"large",text:"ELABORA"}]}]});this.callParent(arguments)}});
Ext.define("Generali.utility.view.Log",{extend:"Generali.standard.ControlledContainer",uses:["Generali.utility.store.FilesLog","Generali.utility.store.RigheFile"],initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",padding:5,defaults:{margin:"0 10 0 0"},layout:{type:"hbox"},items:[{xtype:"numberfield",fieldLabel:"NUM_RIGHE",labelClsExtra:"cbaLabel",itemId:"NumRighe",reference:"NumRighe",reference:"NumRighe",value:100,
minValue:1,width:150,allowDecimals:!1},{xtype:"button",itemId:"BtnCerca",reference:"BtnCerca",reference:"BtnCerca",text:"CERCA",iconCls:"icon-ricerca",scale:"large"}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",layout:{type:"fit"},width:250,items:[{xtype:"gridpanel",itemId:"GridFiles",reference:"GridFiles",reference:"GridFiles",store:Ext.create("Generali.utility.store.FilesLog",{autoLoad:!0}),columns:[{xtype:"gridcolumn",dataIndex:"fileName",text:"ELENCO",
flex:1}],viewConfig:{border:0,loadMask:!1}}]},{xtype:"textarea",itemId:"TxtLog",reference:"TxtLog",reference:"TxtLog",autoScroll:!0,readOnly:!0,flex:1}]}]}]});this.callParent(arguments)}});
Ext.define("Generali.utility.view.Utility",{extend:"Generali.standard.ControlledContainer",initComponent:function(){Ext.applyIf(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",padding:5,items:[{xtype:"combobox",itemId:"CBUtility",reference:"CBUtility",width:350,emptyText:"SELEZIONA_UTILITY",labelClsExtra:"cbaLabel",displayField:"valore",queryMode:"local",valueField:"codice",store:Ext.create("Generali.utility.store.Utility",{autoLoad:!0})}]},{xtype:"panel",
itemId:"PnlDati",reference:"PnlDati",hidden:!0,flex:1,layout:{type:"fit"}}]}]});this.callParent(arguments)}});